<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FunctionalDependencies #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-comment">-- The pattern completeness checker is much weaker before ghc-9.0. Rather than introducing redundant</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- cases and turning off the overlap check in newer ghc versions we disable the check for old</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- versions.</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 900
</span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-incomplete-patterns #-}</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-21"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Constrained.Spec.Pairs</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Constrained.Base.html"><span class="hs-identifier">Constrained.Base</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Constrained.Core.html"><span class="hs-identifier">Constrained.Core</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Constrained.List.html"><span class="hs-identifier">Constrained.List</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Constrained.Univ.html"><span class="hs-identifier">Constrained.Univ</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-2a3691b0d4b1bdc822a79fb5692876209ab38096bef059ce51f5ca6624737ade/share/doc/html/src"><span class="hs-identifier">Test.QuickCheck</span></a></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-comment">-- HasSpec ----------------------------------------------------------------</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span id="local-6989586621679817724"><span id="local-6989586621679817725"><span id="local-6989586621679817726"><span class="annot"><a href="Constrained.Spec.Pairs.html#cartesian"><span class="hs-identifier hs-type">cartesian</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817726"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817725"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817726"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817724"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Specification"><span class="hs-identifier hs-type">Specification</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817726"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817725"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Specification"><span class="hs-identifier hs-type">Specification</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817726"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817724"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-36"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Specification"><span class="hs-identifier hs-type">Specification</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817726"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#Prod"><span class="hs-identifier hs-type">Prod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817725"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817724"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-37"></span><span id="cartesian"><span class="annot"><span class="annottext">cartesian :: forall (fn :: [*] -&gt; * -&gt; *) a b.
(HasSpec fn a, HasSpec fn b) =&gt;
Specification fn a
-&gt; Specification fn b -&gt; Specification fn (Prod a b)
</span><a href="Constrained.Spec.Pairs.html#cartesian"><span class="hs-identifier hs-var hs-var">cartesian</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span id="local-6989586621679817466"><span class="annot"><span class="annottext">NonEmpty String
</span><a href="#local-6989586621679817466"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span id="local-6989586621679817465"><span class="annot"><span class="annottext">NonEmpty String
</span><a href="#local-6989586621679817465"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
NonEmpty String -&gt; Specification fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty String
</span><a href="#local-6989586621679817466"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty String
</span><a href="#local-6989586621679817465"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="annot"><a href="Constrained.Spec.Pairs.html#cartesian"><span class="hs-identifier hs-var">cartesian</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span id="local-6989586621679817464"><span class="annot"><span class="annottext">NonEmpty String
</span><a href="#local-6989586621679817464"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Specification fn b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
NonEmpty String -&gt; Specification fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty String
</span><a href="#local-6989586621679817464"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-39"></span><span class="annot"><a href="Constrained.Spec.Pairs.html#cartesian"><span class="hs-identifier hs-var">cartesian</span></a></span><span> </span><span class="annot"><span class="annottext">Specification fn a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span id="local-6989586621679817463"><span class="annot"><span class="annottext">NonEmpty String
</span><a href="#local-6989586621679817463"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
NonEmpty String -&gt; Specification fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty String
</span><a href="#local-6989586621679817463"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-40"></span><span class="annot"><a href="Constrained.Spec.Pairs.html#cartesian"><span class="hs-identifier hs-var">cartesian</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Specification fn b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). OrdSet a -&gt; Specification fn a
</span><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-var">MemberSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-41"></span><span class="annot"><a href="Constrained.Spec.Pairs.html#cartesian"><span class="hs-identifier hs-var">cartesian</span></a></span><span> </span><span class="annot"><span class="annottext">Specification fn a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). OrdSet a -&gt; Specification fn a
</span><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-var">MemberSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-42"></span><span class="annot"><a href="Constrained.Spec.Pairs.html#cartesian"><span class="hs-identifier hs-var">cartesian</span></a></span><span> </span><span id="local-6989586621679817461"><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817461"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679817460"><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817460"><span class="hs-identifier hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Specification fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
Specification fn a -&gt; Specification fn b -&gt; PairSpec fn a b
</span><a href="Constrained.Spec.Pairs.html#Cartesian"><span class="hs-identifier hs-var">Cartesian</span></a></span><span> </span><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817461"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817460"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-keyword">data</span><span> </span><span id="PairSpec"><span class="annot"><a href="Constrained.Spec.Pairs.html#PairSpec"><span class="hs-identifier hs-var">PairSpec</span></a></span></span><span> </span><span id="local-6989586621679817704"><span class="annot"><a href="#local-6989586621679817704"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679817703"><span class="annot"><a href="#local-6989586621679817703"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679817702"><span class="annot"><a href="#local-6989586621679817702"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Cartesian"><span class="annot"><a href="Constrained.Spec.Pairs.html#Cartesian"><span class="hs-identifier hs-var">Cartesian</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Specification"><span class="hs-identifier hs-type">Specification</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817704"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817703"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Specification"><span class="hs-identifier hs-type">Specification</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817704"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817702"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679817693"><span id="local-6989586621679817694"><span id="local-6989586621679817695"><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-2a3691b0d4b1bdc822a79fb5692876209ab38096bef059ce51f5ca6624737ade/share/doc/html/src"><span class="hs-identifier hs-type">Arbitrary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Specification"><span class="hs-identifier hs-type">Specification</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817695"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817694"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-2a3691b0d4b1bdc822a79fb5692876209ab38096bef059ce51f5ca6624737ade/share/doc/html/src"><span class="hs-identifier hs-type">Arbitrary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Specification"><span class="hs-identifier hs-type">Specification</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817695"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817693"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-2a3691b0d4b1bdc822a79fb5692876209ab38096bef059ce51f5ca6624737ade/share/doc/html/src"><span class="hs-identifier hs-type">Arbitrary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Pairs.html#PairSpec"><span class="hs-identifier hs-type">PairSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817695"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817694"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817693"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-47"></span><span>  </span><span id="local-6989586621679817445"><span class="annot"><span class="annottext">arbitrary :: Gen (PairSpec fn a b)
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-2a3691b0d4b1bdc822a79fb5692876209ab38096bef059ce51f5ca6624737ade/share/doc/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">arbitrary</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
Specification fn a -&gt; Specification fn b -&gt; PairSpec fn a b
</span><a href="Constrained.Spec.Pairs.html#Cartesian"><span class="hs-identifier hs-var">Cartesian</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Arbitrary a =&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-2a3691b0d4b1bdc822a79fb5692876209ab38096bef059ce51f5ca6624737ade/share/doc/html/src"><span class="hs-identifier hs-var">arbitrary</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Arbitrary a =&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-2a3691b0d4b1bdc822a79fb5692876209ab38096bef059ce51f5ca6624737ade/share/doc/html/src"><span class="hs-identifier hs-var">arbitrary</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span id="local-6989586621679817438"><span class="annot"><span class="annottext">shrink :: PairSpec fn a b -&gt; [PairSpec fn a b]
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-2a3691b0d4b1bdc822a79fb5692876209ab38096bef059ce51f5ca6624737ade/share/doc/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">shrink</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Pairs.html#Cartesian"><span class="hs-identifier hs-type">Cartesian</span></a></span><span> </span><span id="local-6989586621679817436"><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817436"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679817435"><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817435"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
Specification fn a -&gt; Specification fn b -&gt; PairSpec fn a b
</span><a href="Constrained.Spec.Pairs.html#Cartesian"><span class="hs-identifier hs-var">Cartesian</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Arbitrary a =&gt; a -&gt; [a]
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-2a3691b0d4b1bdc822a79fb5692876209ab38096bef059ce51f5ca6624737ade/share/doc/html/src"><span class="hs-identifier hs-var">shrink</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817436"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817435"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679817407"><span id="local-6989586621679817409"><span id="local-6989586621679817411"><span id="local-6989586621679817716"><span id="local-6989586621679817717"><span id="local-6989586621679817718"><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817718"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817717"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817718"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817716"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817718"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#Prod"><span class="hs-identifier hs-type">Prod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817717"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817716"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="TypeSpec"><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span></span><span> </span><span id="local-6989586621679817716"><span id="local-6989586621679817717"><span id="local-6989586621679817718"><span class="annot"><a href="#local-6989586621679817718"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#Prod"><span class="hs-identifier hs-type">Prod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817717"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817716"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Spec.Pairs.html#PairSpec"><span class="hs-identifier hs-type">PairSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817718"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817717"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817716"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Prerequisites"><span class="annot"><a href="Constrained.Base.html#Prerequisites"><span class="hs-identifier hs-var">Prerequisites</span></a></span></span><span> </span><span id="local-6989586621679817716"><span id="local-6989586621679817717"><span id="local-6989586621679817718"><span class="annot"><a href="#local-6989586621679817718"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#Prod"><span class="hs-identifier hs-type">Prod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817717"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817716"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817718"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817717"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817718"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817716"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span>  </span><span id="local-6989586621679817401"><span class="annot"><span class="annottext">emptySpec :: TypeSpec fn (Prod a b)
</span><a href="Constrained.Base.html#emptySpec"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptySpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
Specification fn a -&gt; Specification fn b -&gt; PairSpec fn a b
</span><a href="Constrained.Spec.Pairs.html#Cartesian"><span class="hs-identifier hs-var">Cartesian</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span>  </span><span id="local-6989586621679817394"><span class="annot"><span class="annottext">combineSpec :: TypeSpec fn (Prod a b)
-&gt; TypeSpec fn (Prod a b) -&gt; Specification fn (Prod a b)
</span><a href="Constrained.Base.html#combineSpec"><span class="hs-identifier hs-var hs-var hs-var hs-var">combineSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Pairs.html#Cartesian"><span class="hs-identifier hs-type">Cartesian</span></a></span><span> </span><span id="local-6989586621679817392"><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817392"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679817391"><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817391"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Pairs.html#Cartesian"><span class="hs-identifier hs-type">Cartesian</span></a></span><span> </span><span id="local-6989586621679817390"><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817390"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span id="local-6989586621679817389"><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817389"><span class="hs-identifier hs-var">b'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
(HasSpec fn a, HasSpec fn b) =&gt;
Specification fn a
-&gt; Specification fn b -&gt; Specification fn (Prod a b)
</span><a href="Constrained.Spec.Pairs.html#cartesian"><span class="hs-identifier hs-var">cartesian</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817392"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817390"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817391"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817389"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span>  </span><span id="local-6989586621679817385"><span class="annot"><span class="annottext">conformsTo :: HasCallStack =&gt; Prod a b -&gt; TypeSpec fn (Prod a b) -&gt; Bool
</span><a href="Constrained.Base.html#conformsTo"><span class="hs-identifier hs-var hs-var hs-var hs-var">conformsTo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#Prod"><span class="hs-identifier hs-type">Prod</span></a></span><span> </span><span id="local-6989586621679817382"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679817382"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679817381"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679817381"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Pairs.html#Cartesian"><span class="hs-identifier hs-type">Cartesian</span></a></span><span> </span><span id="local-6989586621679817380"><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817380"><span class="hs-identifier hs-var">sa</span></a></span></span><span> </span><span id="local-6989586621679817379"><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817379"><span class="hs-identifier hs-var">sb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Specification fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-identifier hs-var">conformsToSpec</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679817382"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817380"><span class="hs-identifier hs-var">sa</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Specification fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-identifier hs-var">conformsToSpec</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679817381"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817379"><span class="hs-identifier hs-var">sb</span></a></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span>  </span><span id="local-6989586621679817356"><span class="annot"><span class="annottext">genFromTypeSpec :: forall (m :: * -&gt; *).
(HasCallStack, MonadGenError m) =&gt;
TypeSpec fn (Prod a b) -&gt; GenT m (Prod a b)
</span><a href="Constrained.Base.html#genFromTypeSpec"><span class="hs-identifier hs-var hs-var hs-var hs-var">genFromTypeSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Pairs.html#Cartesian"><span class="hs-identifier hs-type">Cartesian</span></a></span><span> </span><span id="local-6989586621679817354"><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817354"><span class="hs-identifier hs-var">sa</span></a></span></span><span> </span><span id="local-6989586621679817353"><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817353"><span class="hs-identifier hs-var">sb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; Prod a b
</span><a href="Constrained.Univ.html#Prod"><span class="hs-identifier hs-var">Prod</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (m :: * -&gt; *).
(HasCallStack, HasSpec fn a, MonadGenError m) =&gt;
Specification fn a -&gt; GenT m a
</span><a href="Constrained.Base.html#genFromSpecT"><span class="hs-identifier hs-var">genFromSpecT</span></a></span><span> </span><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817354"><span class="hs-identifier hs-var">sa</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (m :: * -&gt; *).
(HasCallStack, HasSpec fn a, MonadGenError m) =&gt;
Specification fn a -&gt; GenT m a
</span><a href="Constrained.Base.html#genFromSpecT"><span class="hs-identifier hs-var">genFromSpecT</span></a></span><span> </span><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817353"><span class="hs-identifier hs-var">sb</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span>  </span><span id="local-6989586621679817349"><span class="annot"><span class="annottext">shrinkWithTypeSpec :: TypeSpec fn (Prod a b) -&gt; Prod a b -&gt; [Prod a b]
</span><a href="Constrained.Base.html#shrinkWithTypeSpec"><span class="hs-identifier hs-var hs-var hs-var hs-var">shrinkWithTypeSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Pairs.html#Cartesian"><span class="hs-identifier hs-type">Cartesian</span></a></span><span> </span><span id="local-6989586621679817347"><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817347"><span class="hs-identifier hs-var">sa</span></a></span></span><span> </span><span id="local-6989586621679817346"><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817346"><span class="hs-identifier hs-var">sb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#Prod"><span class="hs-identifier hs-type">Prod</span></a></span><span> </span><span id="local-6989586621679817345"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679817345"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679817344"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679817344"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; Prod a b
</span><a href="Constrained.Univ.html#Prod"><span class="hs-identifier hs-var">Prod</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679817343"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679817344"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679817343"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679817343"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Specification fn a -&gt; a -&gt; [a]
</span><a href="Constrained.Base.html#shrinkWithSpec"><span class="hs-identifier hs-var">shrinkWithSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817347"><span class="hs-identifier hs-var">sa</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679817345"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-65"></span><span>      </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; Prod a b
</span><a href="Constrained.Univ.html#Prod"><span class="hs-identifier hs-var">Prod</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679817345"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679817341"><span class="hs-identifier hs-var">b'</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679817341"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679817341"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Specification fn a -&gt; a -&gt; [a]
</span><a href="Constrained.Base.html#shrinkWithSpec"><span class="hs-identifier hs-var">shrinkWithSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817346"><span class="hs-identifier hs-var">sb</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679817344"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span>  </span><span id="local-6989586621679817308"><span class="annot"><span class="annottext">toPreds :: Term fn (Prod a b) -&gt; TypeSpec fn (Prod a b) -&gt; Pred fn
</span><a href="Constrained.Base.html#toPreds"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPreds</span></a></span></span><span> </span><span id="local-6989586621679817306"><span class="annot"><span class="annottext">Term fn (Prod a b)
</span><a href="#local-6989586621679817306"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Pairs.html#Cartesian"><span class="hs-identifier hs-type">Cartesian</span></a></span><span> </span><span id="local-6989586621679817305"><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817305"><span class="hs-identifier hs-var">sf</span></a></span></span><span> </span><span id="local-6989586621679817304"><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817304"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Specification fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#satisfies"><span class="hs-identifier hs-var">satisfies</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
Member (PairFn fn) fn =&gt;
fn '[Prod a b] a
</span><a href="Constrained.Univ.html#fstFn"><span class="hs-identifier hs-var">fstFn</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (Prod a b)
</span><a href="#local-6989586621679817306"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817305"><span class="hs-identifier hs-var">sf</span></a></span><span>
</span><span id="line-69"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Specification fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#satisfies"><span class="hs-identifier hs-var">satisfies</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
Member (PairFn fn) fn =&gt;
fn '[Prod a b] b
</span><a href="Constrained.Univ.html#sndFn"><span class="hs-identifier hs-var">sndFn</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (Prod a b)
</span><a href="#local-6989586621679817306"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817304"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span>  </span><span id="local-6989586621679817292"><span class="annot"><span class="annottext">cardinalTypeSpec :: TypeSpec fn (Prod a b) -&gt; Specification fn Integer
</span><a href="Constrained.Base.html#cardinalTypeSpec"><span class="hs-identifier hs-var hs-var hs-var hs-var">cardinalTypeSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Pairs.html#Cartesian"><span class="hs-identifier hs-type">Cartesian</span></a></span><span> </span><span id="local-6989586621679817290"><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817290"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679817289"><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817289"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
Specification fn Integer
-&gt; Specification fn Integer -&gt; Specification fn Integer
</span><a href="Constrained.Base.html#multSpecInt"><span class="hs-identifier hs-var">multSpecInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(Eq a, BaseUniverse fn, HasSpec fn a) =&gt;
Specification fn a -&gt; Specification fn Integer
</span><a href="Constrained.Base.html#cardinality"><span class="hs-identifier hs-var">cardinality</span></a></span><span> </span><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817290"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(Eq a, BaseUniverse fn, HasSpec fn a) =&gt;
Specification fn a -&gt; Specification fn Integer
</span><a href="Constrained.Base.html#cardinality"><span class="hs-identifier hs-var">cardinality</span></a></span><span> </span><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817289"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span id="local-6989586621679817276"><span id="local-6989586621679817278"><span id="local-6989586621679817285"><span id="local-6989586621679817654"><span id="local-6989586621679817655"><span id="local-6989586621679817656"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817656"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817655"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817656"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817654"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Pairs.html#PairSpec"><span class="hs-identifier hs-type">PairSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817656"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817655"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817654"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- Functions for working on pairs -----------------------------------------</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679817588"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817588"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Functions"><span class="hs-identifier hs-type">Functions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#PairFn"><span class="hs-identifier hs-type">PairFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817588"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679817588"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-78"></span><span>  </span><span id="local-6989586621679817247"><span class="annot"><span class="annottext">propagateSpecFun :: forall (as :: [*]) a b.
(TypeList as, Typeable as, HasSpec fn a, HasSpec fn b,
 All (HasSpec fn) as) =&gt;
PairFn fn as b
-&gt; ListCtx Value as (HOLE a)
-&gt; Specification fn b
-&gt; Specification fn a
</span><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var hs-var hs-var hs-var">propagateSpecFun</span></a></span></span><span> </span><span class="annot"><span class="annottext">PairFn fn as b
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Specification fn b
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Specification fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var">propagateSpecFun</span></a></span><span> </span><span class="annot"><span class="annottext">PairFn fn as b
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span id="local-6989586621679817244"><span class="annot"><span class="annottext">NonEmpty String
</span><a href="#local-6989586621679817244"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
NonEmpty String -&gt; Specification fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty String
</span><a href="#local-6989586621679817244"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-80"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var">propagateSpecFun</span></a></span><span> </span><span id="local-6989586621679817243"><span class="annot"><span class="annottext">PairFn fn as b
</span><a href="#local-6989586621679817243"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679817242"><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679817242"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679817241"><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817241"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PairFn fn as b
</span><a href="#local-6989586621679817243"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><span class="annottext">PairFn fn as b
</span><a href="Constrained.Univ.html#Fst"><span class="hs-identifier hs-var">Fst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-82"></span><span>      </span><span class="hs-comment">-- No TypeAbstractions in ghc-8.10</span><span>
</span><span id="line-83"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PairFn fn as b
</span><a href="#local-6989586621679817243"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-84"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679817235"><span id="local-6989586621679817236"><span class="annot"><span class="annottext">PairFn fn '[Prod b b] b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Univ.html#PairFn"><span class="hs-identifier hs-type">PairFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817588"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Univ.html#Prod"><span class="hs-identifier hs-type">Prod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817236"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817235"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679817236"><span class="hs-identifier hs-type">a</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.List.html#NilCtx"><span class="hs-identifier hs-type">NilCtx</span></a></span><span> </span><span class="annot"><span class="annottext">HOLE a (Prod b b)
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679817242"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-86"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Evidence (Prerequisites fn (Prod b b))
</span><a href="Constrained.Core.html#Evidence"><span class="hs-identifier hs-var">Evidence</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Evidence (Prerequisites fn a)
</span><a href="Constrained.Base.html#prerequisites"><span class="hs-identifier hs-var">prerequisites</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679817588"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#Prod"><span class="hs-identifier hs-type">Prod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817236"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817235"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-87"></span><span>              </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
(HasSpec fn a, HasSpec fn b) =&gt;
Specification fn a
-&gt; Specification fn b -&gt; Specification fn (Prod a b)
</span><a href="Constrained.Spec.Pairs.html#cartesian"><span class="hs-identifier hs-var">cartesian</span></a></span><span> </span><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817241"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Specification fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><span class="annottext">PairFn fn as b
</span><a href="Constrained.Univ.html#Snd"><span class="hs-identifier hs-var">Snd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-89"></span><span>      </span><span class="hs-comment">-- No TypeAbstractions in ghc-8.10</span><span>
</span><span id="line-90"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PairFn fn as b
</span><a href="#local-6989586621679817243"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-91"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679817217"><span id="local-6989586621679817218"><span class="annot"><span class="annottext">PairFn fn '[Prod a b] b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Univ.html#PairFn"><span class="hs-identifier hs-type">PairFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817588"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Univ.html#Prod"><span class="hs-identifier hs-type">Prod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817218"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817217"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679817217"><span class="hs-identifier hs-type">b</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.List.html#NilCtx"><span class="hs-identifier hs-type">NilCtx</span></a></span><span> </span><span class="annot"><span class="annottext">HOLE a (Prod a b)
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679817242"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-93"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Evidence (Prerequisites fn (Prod a b))
</span><a href="Constrained.Core.html#Evidence"><span class="hs-identifier hs-var">Evidence</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Evidence (Prerequisites fn a)
</span><a href="Constrained.Base.html#prerequisites"><span class="hs-identifier hs-var">prerequisites</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679817588"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#Prod"><span class="hs-identifier hs-type">Prod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817218"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817217"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-94"></span><span>              </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
(HasSpec fn a, HasSpec fn b) =&gt;
Specification fn a
-&gt; Specification fn b -&gt; Specification fn (Prod a b)
</span><a href="Constrained.Spec.Pairs.html#cartesian"><span class="hs-identifier hs-var">cartesian</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Specification fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817241"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><span class="annottext">PairFn fn as b
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-96"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-type">SuspendedSpec</span></a></span><span> </span><span id="local-6989586621679817206"><span class="annot"><span class="annottext">Var b
</span><a href="#local-6989586621679817206"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679817205"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679817205"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817241"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-97"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.List.html#ListCtx"><span class="hs-identifier hs-type">ListCtx</span></a></span><span> </span><span id="local-6989586621679817200"><span class="annot"><span class="annottext">List Value as
</span><a href="#local-6989586621679817200"><span class="hs-identifier hs-var">pre</span></a></span></span><span> </span><span class="annot"><span class="annottext">HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span id="local-6989586621679817182"><span class="annot"><span class="annottext">List Value as'
</span><a href="#local-6989586621679817182"><span class="hs-identifier hs-var">suf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679817242"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-98"></span><span>          </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) p.
(IsPred p fn, HasSpec fn a) =&gt;
(Term fn a -&gt; p) -&gt; Specification fn a
</span><a href="Constrained.Base.html#constrained"><span class="hs-identifier hs-var">constrained</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679817180"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679817180"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-99"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679817179"><span class="annot"><span class="annottext">args :: List (Term fn) (Append as (a : as'))
</span><a href="#local-6989586621679817179"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {a} (f :: a -&gt; *) (as :: [a]) (bs :: [a]).
List f as -&gt; List f bs -&gt; List f (Append as bs)
</span><a href="Constrained.List.html#appendList"><span class="hs-identifier hs-var">appendList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (as :: [k]).
(forall (a :: k). f a -&gt; g a) -&gt; List f as -&gt; List g as
</span><a href="Constrained.List.html#mapList"><span class="hs-identifier hs-var">mapList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679817173"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679817173"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679817173"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List Value as
</span><a href="#local-6989586621679817200"><span class="hs-identifier hs-var">pre</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679817180"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (a :: k) (as1 :: [k]).
f a -&gt; List f as1 -&gt; List f (a : as1)
</span><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (as :: [k]).
(forall (a :: k). f a -&gt; g a) -&gt; List f as -&gt; List g as
</span><a href="Constrained.List.html#mapList"><span class="hs-identifier hs-var">mapList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679817168"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679817168"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679817168"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List Value as'
</span><a href="#local-6989586621679817182"><span class="hs-identifier hs-var">suf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (as :: [*]) (fn :: [*] -&gt; * -&gt; *) a.
(Typeable as, TypeList as, All (HasSpec fn) as, HasSpec fn a,
 BaseUniverse fn) =&gt;
fn as a -&gt; List (Term fn) as -&gt; Term fn a
</span><a href="Constrained.Base.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="annot"><span class="annottext">PairFn fn as b
</span><a href="#local-6989586621679817243"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List (Term fn) (Append as (a : as'))
</span><a href="#local-6989586621679817179"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var b
</span><a href="#local-6989586621679817206"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679817205"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><span class="annottext">PairFn fn as b
</span><a href="Constrained.Univ.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span><span>
</span><span id="line-102"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3F"><span class="hs-operator hs-type">:?</span></a></span><span> </span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679817140"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679817140"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">List Value as1
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679817242"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-103"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679817136"><span class="annot"><span class="annottext">sameSnd :: [Prod a a] -&gt; [a]
</span><a href="#local-6989586621679817136"><span class="hs-identifier hs-var hs-var">sameSnd</span></a></span></span><span> </span><span id="local-6989586621679817135"><span class="annot"><span class="annottext">[Prod a a]
</span><a href="#local-6989586621679817135"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679817134"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.Univ.html#Prod"><span class="hs-identifier hs-type">Prod</span></a></span><span> </span><span id="local-6989586621679817134"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679817134"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679817133"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679817133"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Prod a a]
</span><a href="#local-6989586621679817135"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679817140"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679817133"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-104"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817241"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-105"></span><span>                </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Pairs.html#Cartesian"><span class="hs-identifier hs-type">Cartesian</span></a></span><span> </span><span id="local-6989586621679817122"><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817122"><span class="hs-identifier hs-var">sa</span></a></span></span><span> </span><span id="local-6989586621679817121"><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817121"><span class="hs-identifier hs-var">sb</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679817120"><span class="annot"><span class="annottext">OrdSet b
</span><a href="#local-6989586621679817120"><span class="hs-identifier hs-var">cant</span></a></span></span><span>
</span><span id="line-106"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679817140"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Specification fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-operator hs-var">`conformsToSpec`</span></a></span><span> </span><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817121"><span class="hs-identifier hs-var">sb</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817122"><span class="hs-identifier hs-var">sa</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Specification fn a
</span><a href="Constrained.Base.html#notEqualSpec"><span class="hs-identifier hs-var">notEqualSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Prod a a] -&gt; [a]
</span><a href="#local-6989586621679817136"><span class="hs-identifier hs-var">sameSnd</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet b
</span><a href="#local-6989586621679817120"><span class="hs-identifier hs-var">cant</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>                  </span><span class="hs-comment">-- TODO: better error message</span><span>
</span><span id="line-108"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-109"></span><span>                      </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
NonEmpty String -&gt; Specification fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; NonEmpty a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">NE.fromList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;propagateSpecFun (Pair a b) has conformance failure on b&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817121"><span class="hs-identifier hs-var">sb</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>                </span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span id="local-6989586621679817115"><span class="annot"><span class="annottext">OrdSet b
</span><a href="#local-6989586621679817115"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). OrdSet a -&gt; Specification fn a
</span><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-var">MemberSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Prod a a] -&gt; [a]
</span><a href="#local-6989586621679817136"><span class="hs-identifier hs-var">sameSnd</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet b
</span><a href="#local-6989586621679817115"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679817107"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679817107"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%21"><span class="hs-operator hs-type">:!</span></a></span><span> </span><span class="annot"><a href="Constrained.List.html#NilCtx"><span class="hs-identifier hs-type">NilCtx</span></a></span><span> </span><span class="annot"><span class="annottext">HOLE a b
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679817242"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-112"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679817103"><span class="annot"><span class="annottext">sameFst :: [Prod a a] -&gt; [a]
</span><a href="#local-6989586621679817103"><span class="hs-identifier hs-var hs-var">sameFst</span></a></span></span><span> </span><span id="local-6989586621679817102"><span class="annot"><span class="annottext">[Prod a a]
</span><a href="#local-6989586621679817102"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679817101"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.Univ.html#Prod"><span class="hs-identifier hs-type">Prod</span></a></span><span> </span><span id="local-6989586621679817100"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679817100"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span id="local-6989586621679817101"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679817101"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Prod a a]
</span><a href="#local-6989586621679817102"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679817107"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679817100"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-113"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817241"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-114"></span><span>                </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Pairs.html#Cartesian"><span class="hs-identifier hs-type">Cartesian</span></a></span><span> </span><span id="local-6989586621679817091"><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817091"><span class="hs-identifier hs-var">sa</span></a></span></span><span> </span><span id="local-6989586621679817090"><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817090"><span class="hs-identifier hs-var">sb</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679817089"><span class="annot"><span class="annottext">OrdSet b
</span><a href="#local-6989586621679817089"><span class="hs-identifier hs-var">cant</span></a></span></span><span>
</span><span id="line-115"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679817107"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Specification fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-operator hs-var">`conformsToSpec`</span></a></span><span> </span><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817091"><span class="hs-identifier hs-var">sa</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817090"><span class="hs-identifier hs-var">sb</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Specification fn a
</span><a href="Constrained.Base.html#notEqualSpec"><span class="hs-identifier hs-var">notEqualSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Prod a a] -&gt; [a]
</span><a href="#local-6989586621679817103"><span class="hs-identifier hs-var">sameFst</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet b
</span><a href="#local-6989586621679817089"><span class="hs-identifier hs-var">cant</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>                  </span><span class="hs-comment">-- TODO: better error message</span><span>
</span><span id="line-117"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-118"></span><span>                      </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
NonEmpty String -&gt; Specification fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; NonEmpty a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">NE.fromList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;propagateSpecFun (Pair a b) has conformance failure on a&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Specification fn a
</span><a href="#local-6989586621679817091"><span class="hs-identifier hs-var">sa</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>                </span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span id="local-6989586621679817088"><span class="annot"><span class="annottext">OrdSet b
</span><a href="#local-6989586621679817088"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). OrdSet a -&gt; Specification fn a
</span><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-var">MemberSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Prod a a] -&gt; [a]
</span><a href="#local-6989586621679817103"><span class="hs-identifier hs-var">sameFst</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet b
</span><a href="#local-6989586621679817088"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span>  </span><span id="local-6989586621679817083"><span class="annot"><span class="annottext">rewriteRules :: forall (as :: [*]) b.
(TypeList as, Typeable as, HasSpec fn b, All (HasSpec fn) as) =&gt;
PairFn fn as b -&gt; List (Term fn) as -&gt; Maybe (Term fn b)
</span><a href="Constrained.Base.html#rewriteRules"><span class="hs-identifier hs-var hs-var hs-var hs-var">rewriteRules</span></a></span></span><span> </span><span class="annot"><span class="annottext">PairFn fn as b
</span><a href="Constrained.Univ.html#Fst"><span class="hs-identifier hs-var">Fst</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
Member (PairFn fn) fn =&gt;
Term fn (Prod a b) -&gt; Maybe (Term fn a, Term fn b)
</span><a href="Constrained.Spec.Pairs.html#pairView"><span class="hs-identifier hs-var">pairView</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679817074"><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679817074"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term fn b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as1
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679817074"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-122"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#rewriteRules"><span class="hs-identifier hs-var">rewriteRules</span></a></span><span> </span><span class="annot"><span class="annottext">PairFn fn as b
</span><a href="Constrained.Univ.html#Snd"><span class="hs-identifier hs-var">Snd</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
Member (PairFn fn) fn =&gt;
Term fn (Prod a b) -&gt; Maybe (Term fn a, Term fn b)
</span><a href="Constrained.Spec.Pairs.html#pairView"><span class="hs-identifier hs-var">pairView</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term fn a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679817066"><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679817066"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as1
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679817066"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-123"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#rewriteRules"><span class="hs-identifier hs-var">rewriteRules</span></a></span><span> </span><span class="annot"><span class="annottext">PairFn fn as b
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span>  </span><span id="local-6989586621679817062"><span class="annot"><span class="annottext">mapTypeSpec :: forall a b.
(HasSpec fn a, HasSpec fn b) =&gt;
PairFn fn '[a] b -&gt; TypeSpec fn a -&gt; Specification fn b
</span><a href="Constrained.Base.html#mapTypeSpec"><span class="hs-identifier hs-var hs-var hs-var hs-var">mapTypeSpec</span></a></span></span><span> </span><span id="local-6989586621679817060"><span class="annot"><span class="annottext">PairFn fn '[a] b
</span><a href="#local-6989586621679817060"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679817059"><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679817059"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PairFn fn '[a] b
</span><a href="#local-6989586621679817060"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><span class="annottext">PairFn fn '[a] b
</span><a href="Constrained.Univ.html#Fst"><span class="hs-identifier hs-var">Fst</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.Spec.Pairs.html#Cartesian"><span class="hs-identifier hs-type">Cartesian</span></a></span><span> </span><span id="local-6989586621679817056"><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817056"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">Specification fn b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679817059"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817056"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><span class="annottext">PairFn fn '[a] b
</span><a href="Constrained.Univ.html#Snd"><span class="hs-identifier hs-var">Snd</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.Spec.Pairs.html#Cartesian"><span class="hs-identifier hs-type">Cartesian</span></a></span><span> </span><span class="annot"><span class="annottext">Specification fn a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679817053"><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817053"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679817059"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Specification fn b
</span><a href="#local-6989586621679817053"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="annot"><a href="Constrained.Spec.Pairs.html#pairView"><span class="hs-identifier hs-type">pairView</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679817524"><span class="annot"><a href="#local-6989586621679817524"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679817523"><span class="annot"><a href="#local-6989586621679817523"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679817522"><span class="annot"><a href="#local-6989586621679817522"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.Univ.html#Member"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#PairFn"><span class="hs-identifier hs-type">PairFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817524"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679817524"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817524"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#Prod"><span class="hs-identifier hs-type">Prod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817523"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817522"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817524"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817523"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817524"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817522"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span id="pairView"><span class="annot"><span class="annottext">pairView :: forall (fn :: [*] -&gt; * -&gt; *) a b.
Member (PairFn fn) fn =&gt;
Term fn (Prod a b) -&gt; Maybe (Term fn a, Term fn b)
</span><a href="Constrained.Spec.Pairs.html#pairView"><span class="hs-identifier hs-var hs-var">pairView</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fnU as b -&gt; Maybe (fn as b)
</span><a href="Constrained.Univ.html#extractFn"><span class="hs-identifier hs-var">extractFn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#PairFn"><span class="hs-identifier hs-type">PairFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679817524"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679817524"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><span class="annottext">PairFn fn as (Prod a b)
</span><a href="Constrained.Univ.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679817027"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679817027"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679817026"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679817026"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as1
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679817027"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679817026"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span class="annot"><a href="Constrained.Spec.Pairs.html#pairView"><span class="hs-identifier hs-var">pairView</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (Prod a b)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-133"></span></pre></body></html>