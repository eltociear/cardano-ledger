<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE DefaultSignatures #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE FunctionalDependencies #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE ImportQualifiedPost #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE ImpredicativeTypes #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE QuantifiedConstraints #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-20"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-21"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-22"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><span id="line-23"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-name-shadowing #-}</span><span>
</span><span id="line-24"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-25"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-redundant-constraints #-}</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-comment">-- The pattern completeness checker is much weaker before ghc-9.0. Rather than introducing redundant</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- cases and turning off the overlap check in newer ghc versions we disable the check for old</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- versions.</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 900
</span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-incomplete-patterns #-}</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- | This module contains most of the implementation</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- of the framework.</span><span>
</span><span id="line-36"></span><span class="hs-comment">--</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- NOTE: This is a very big module. Splitting it up would</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- be a nice thing to do but it's not very easy. The problem</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- is that a lot of the things in here depend on each other</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- via a cycle like `Pred` depends on `Term` which depend on</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- `HasSpec` which depends on `Spec` and `Generic` and `Spec`</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- depends in turn on `Pred` and so on.</span><span>
</span><span id="line-43"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Constrained.Base</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Control.Applicative</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Control.Arrow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">first</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/mtl-2.2.2/src"><span class="hs-identifier">Control.Monad.Identity</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/mtl-2.2.2/src"><span class="hs-identifier">Control.Monad.Writer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier">Writer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier">runWriter</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/mtl-2.2.2/src"><span class="hs-identifier">tell</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Foldable</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Kind</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">intersect</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">nub</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">partition</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator">(\\)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier">Map</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Semigroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Max</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">getAll</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">getMax</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Semigroup</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Semigroup</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier">Set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.String</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Typeable</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Word</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">GHC.Int</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">GHC.Natural</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">GHC.Real</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">GHC.Stack</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">GHC.TypeLits</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier">Prettyprinter</span></a></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/random-1.2.1.1-97d351bf97dd57637441798736e25556058018a1de673671ce7fdce6e47d0d77/share/doc/html/src"><span class="hs-identifier">System.Random</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/random-1.2.1.1-97d351bf97dd57637441798736e25556058018a1de673671ce7fdce6e47d0d77/share/doc/html/src"><span class="hs-identifier">System.Random.Stateful</span></a></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-a65fd1c4eb4ae76375c6e3f3845a1ba912285f018239b330ae730fef533366f9/share/doc/html/src"><span class="hs-identifier">Test.QuickCheck</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-a65fd1c4eb4ae76375c6e3f3845a1ba912285f018239b330ae730fef533366f9/share/doc/html/src"><span class="hs-identifier">Args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-a65fd1c4eb4ae76375c6e3f3845a1ba912285f018239b330ae730fef533366f9/share/doc/html/src"><span class="hs-identifier">Fun</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-a65fd1c4eb4ae76375c6e3f3845a1ba912285f018239b330ae730fef533366f9/share/doc/html/src"><span class="hs-identifier">forAll</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Constrained.Core.html"><span class="hs-identifier">Constrained.Core</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Constrained.Env.html"><span class="hs-identifier">Constrained.Env</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Constrained.GenT.html"><span class="hs-identifier">Constrained.GenT</span></a></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Constrained.Graph.html"><span class="hs-identifier">Constrained.Graph</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Graph.html#dependency"><span class="hs-keyword">dependency</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Graph.html#irreflexiveDependencyOn"><span class="hs-identifier">irreflexiveDependencyOn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Graph.html#noDependencies"><span class="hs-identifier">noDependencies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Constrained.Graph.html"><span class="hs-identifier">Constrained.Graph</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Graph</span></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Constrained.List.html"><span class="hs-identifier">Constrained.List</span></a></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Constrained.Univ.html"><span class="hs-identifier">Constrained.Univ</span></a></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-comment">{- NOTE [High level overview of generation from predicates]:

-- The overall strategy ---------------------------------------------------

The strategy for generating things from `Pred`s is relatively straightforward
and relies on one key fact: any constraint that has only one free variable `x`
and where `x` occurs only once can be turned into a `Spec` for `x`.

We say that such constraints _define_ `x` and given a set of constraints `ps`
and a variable `x` we can split `ps` into the constraints that define `x` and
any constraints that don't. We can then generate a value from `x` by computing
a spec for each defining constraint in `ps` and using the `Semigroup` structure
of `Spec`s to combine them and give them to `genFromSpec`. Once we obtain a
value for `x` we can substitute this value in all other constraints and pick
another variable to solve.

For example, given the following constraints on integers `x` and `y`

  x &lt; 10
  3 &lt;= x
  y &lt; x

we see that `x &lt; 10` and `3 &lt;= x` are defining constraints for `x` and there
are no definining constraints for `y`. We compute a `Spec` for `x` for each
constraint, in this case `x &lt; 10` turns into something like `(-&#8734;,10)` and
`3 &lt;= x` turns into `[3, &#8734;)`. We combine the specs to form `[3, 10)` from which we
can generate a value, e.g. 4 (chosen by fair dice roll). We then substitute
`[x := 4]` in the remaining constraints and obtain `y &lt; 4`, giving us a defining
constraint for `y`.

-- How to pick the variable order -----------------------------------------

At this point it should be relatively clear that the order we pick for the
variables matters a great deal. If we choose to generate `y` before `x` in our
example we will have no defining constraints for `y` and so we pick a value for
it freely. But that renders `x` unsolveable if `y &gt; 9` - which will result in
the generator failing to generate a value (one could consider backtracking, but
that is very computationally expensive so _relying_ on it would probably not be
wise).

Computing a good choice of variable order that leaves the least room for error
is obviously undecidable and difficult and we choose instead an explicit
syntax-directed variable order. Specifically, variable dependency in terms is
_left-to-right_, meaning that the variables in `x + y &lt; z` will be solved in
the order `z -&gt; y -&gt; x`. On top of that there is a constraint `dependsOn y x`
that allows you to overwrite the order of two variables. Consequently, the
following constraints will be solved in the order `z -&gt; x -&gt; y`:

  x + y &lt; z
  y `dependsOn` x

A consequence of this is that it is possible to form dependency loops by
specifying multiple constraints, e.g. in:

  x &lt; y
  y &lt; x + 10

However, this situation can be addressed by the introduction of `dependsOn` to
settle the order.  It is worth noting that the choice of order in `dependsOn`
is important as it affects the solveability of the constraints (as we saw
above). We leave the choice of `dependsOn` in the example below as an exercise
for the reader.

  x &lt; y
  y &lt; x + 10
  0 &lt; x
  ? `dependsOn` ?

-- The total definition requirement ---------------------------------------

For the sake of efficiency we require that all constraints are dispatched as
definining constraints for a variable before we begin solving. We call this the
total definition requirement. This requirement is necessary because a set of
constraints with left over constraints are unlikely to be solveable.

Consider the following example for `p :: (Int, Int)`

fst p &lt; snd p

in which there is no defining constraint for `p`, which would lead us to
compute the spec `mempty` for `p` during solving - meaning we would pick an
arbitrary `p` that is irrespective of the constraints. This is problematic as
the probability of picking `p = (x, y)` such that `x &lt; y` is roughly `1/2`, as
you add more constraints things get much worse.

The principal problem above is that information that is present in the
constraints is lost, which would force us to rely on a `suchThat` approach to
generation - which will become very slow as constraint systems grow.

-- Let binders ------------------------------------------------------------

A solution to the total definition requirement is to introduce more variables.
We can rewrite the problematic `fst p &lt; snd p` example below as:

fst p = x
snd p = y
x &lt; y

The dependency graph for these constraints will be the following:

x `dependsOn` y
p `dependsOn` x

This configuration is solveable, one picks `y` first, then picks `x &lt; y`
and finally constructs `p = (x, y)`.

Note that (1) we introduced more variables than were initially in the
constraints - these need to be bound somewhere - and (2) the order of
`fst p = x` is important - `p` depends on `x` and not the other way
around.

To do both of these things at the same time we introduce the `letBind` construct
to the language:

letBind tm $ \ x -&gt; preds

Which is semantically equivalent to:

exists $ \ x -&gt;
  tm == x
  preds

-- Reify ----------------------------------------------------------------

Sometimes it's important to be able to perform complex calculations on data
to obtain values that further constrain later variables. For this purpose
the language contains the the `reify` construct:

reify :: IsPred p fn
      =&gt; Term fn a
      -&gt; (a -&gt; b)
      -&gt; (Term fn b -&gt; p)
      -&gt; Pred fn

The important thing about `reify` is that because everything in the term
being reified needs to be solved before the body can be solved, all
variables in the body depend on the term being reified.

-}</span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-223"></span><span class="hs-comment">-- Terms and Predicates</span><span>
</span><span id="line-224"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="hs-comment">-- | Typed first order terms with function symbols from `fn`.</span><span>
</span><span id="line-227"></span><span class="hs-keyword">data</span><span> </span><span id="Term"><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-var">Term</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679180951"><span class="annot"><a href="#local-6989586621679180951"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679180950"><span class="annot"><a href="#local-6989586621679180950"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-228"></span><span>  </span><span id="local-6989586621679180949"><span id="local-6989586621679182758"><span id="local-6989586621679182759"><span id="App"><span class="annot"><a href="Constrained.Base.html#App"><span class="hs-identifier hs-var">App</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180949"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.List.html#TypeList"><span class="hs-identifier hs-type">TypeList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180949"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.List.html#All"><span class="hs-identifier hs-type">All</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182759"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679180949"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182759"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182758"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-233"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182759"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-235"></span><span>    </span><span class="annot"><a href="#local-6989586621679182759"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180949"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182758"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-236"></span><span>    </span><span class="annot"><a href="Constrained.List.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182759"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679180949"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-237"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182759"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182758"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-238"></span><span>  </span><span id="local-6989586621679183441"><span id="local-6989586621679183442"><span id="Lit"><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-239"></span><span>    </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183442"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-240"></span><span>    </span><span class="annot"><a href="#local-6989586621679183442"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-241"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183441"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183442"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-242"></span><span>  </span><span id="local-6989586621679183225"><span id="local-6989586621679183226"><span id="V"><span class="annot"><a href="Constrained.Base.html#V"><span class="hs-identifier hs-var">V</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-243"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183226"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183225"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-244"></span><span>    </span><span class="annot"><a href="Constrained.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183225"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183226"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183225"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679180943"><span id="local-6989586621679183502"><span id="local-6989586621679183503"><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183503"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183502"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183503"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183502"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-248"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span id="local-6989586621679180940"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180940"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679180939"><span class="annot"><span class="annottext">== :: Term fn a -&gt; Term fn a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span id="local-6989586621679180935"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180935"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180940"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180935"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-249"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679180933"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180933"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679180930"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180930"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180933"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180930"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679180923"><span id="local-6989586621679180924"><span id="local-6989586621679180922"><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679180922"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679183503"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180924"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180923"><span class="hs-identifier hs-type">b</span></a></span></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679180921"><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679180921"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679180912"><span id="local-6989586621679180913"><span id="local-6989586621679180911"><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679180911"><span class="hs-identifier hs-var">f'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679183503"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180913"><span class="hs-identifier hs-type">as'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180912"><span class="hs-identifier hs-type">b'</span></a></span></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679180910"><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679180910"><span class="hs-identifier hs-var">ts'</span></a></span></span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><span class="annottext">as :~: as
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Refl</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {k} (a :: k) (b :: k).
(Typeable a, Typeable b) =&gt;
Maybe (a :~: b)
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">eqT</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679180924"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679180913"><span class="hs-identifier hs-type">as'</span></a></span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679180922"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679180911"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-253"></span><span>        </span><span class="annot"><span class="annottext">forall {k} (c :: k -&gt; Constraint) (as :: [k]) (f :: k -&gt; *)
       (g :: k -&gt; *).
All c as =&gt;
(forall (a :: k). c a =&gt; f a -&gt; g a) -&gt; List f as -&gt; List g as
</span><a href="Constrained.List.html#mapListC"><span class="hs-identifier hs-var">mapListC</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183503"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (f :: * -&gt; *).
HasSpec fn a =&gt;
f a -&gt; WithHasSpec fn f a
</span><a href="Constrained.Base.html#WithHasSpec"><span class="hs-identifier hs-var">WithHasSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679183503"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679180921"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-254"></span><span>          </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (c :: k -&gt; Constraint) (as :: [k]) (f :: k -&gt; *)
       (g :: k -&gt; *).
All c as =&gt;
(forall (a :: k). c a =&gt; f a -&gt; g a) -&gt; List f as -&gt; List g as
</span><a href="Constrained.List.html#mapListC"><span class="hs-identifier hs-var">mapListC</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183503"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (f :: * -&gt; *).
HasSpec fn a =&gt;
f a -&gt; WithHasSpec fn f a
</span><a href="Constrained.Base.html#WithHasSpec"><span class="hs-identifier hs-var">WithHasSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679183503"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679180910"><span class="hs-identifier hs-var">ts'</span></a></span><span>
</span><span id="line-255"></span><span>  </span><span class="annot"><span class="annottext">Term fn a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-comment">-- NOTE: Fourmolu made me do this - it happily breaks the code unless you</span><span>
</span><span id="line-258"></span><span class="hs-comment">-- make this a standalone type synonym.</span><span>
</span><span id="line-259"></span><span class="hs-keyword">type</span><span> </span><span id="HasSpecImpliesEq"><span class="annot"><a href="Constrained.Base.html#HasSpecImpliesEq"><span class="hs-identifier hs-var">HasSpecImpliesEq</span></a></span></span><span> </span><span id="local-6989586621679180893"><span class="annot"><a href="#local-6989586621679180893"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679180892"><span class="annot"><a href="#local-6989586621679180892"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679180891"><span class="annot"><a href="#local-6989586621679180891"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180893"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180892"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679180891"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180892"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Constraint</span></a></span><span>
</span><span id="line-260"></span><span id="local-6989586621679180887"><span id="local-6989586621679180889"><span id="local-6989586621679183460"><span id="local-6989586621679183461"><span id="local-6989586621679183462"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpecImpliesEq"><span class="hs-identifier hs-type">HasSpecImpliesEq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183462"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183461"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183460"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#WithHasSpec"><span class="hs-identifier hs-type">WithHasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183462"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183460"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183461"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679180882"><span id="local-6989586621679180884"><span id="local-6989586621679183456"><span id="local-6989586621679183457"><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183457"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183456"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183457"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183456"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183457"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-263"></span><span>  </span><span id="local-6989586621679180858"><span class="annot"><span class="annottext">&lt;&gt; :: Term fn (Set a) -&gt; Term fn (Set a) -&gt; Term fn (Set a)
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(Member (SetFn fn) fn, Ord a) =&gt;
fn '[Set a, Set a] (Set a)
</span><a href="Constrained.Univ.html#unionFn"><span class="hs-identifier hs-var">unionFn</span></a></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679180849"><span id="local-6989586621679180851"><span id="local-6989586621679183444"><span id="local-6989586621679183445"><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183445"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183444"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183445"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183444"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183445"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-266"></span><span>  </span><span id="local-6989586621679180844"><span class="annot"><span class="annottext">mempty :: Term fn (Set a)
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="hs-keyword">data</span><span> </span><span id="Binder"><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-var">Binder</span></a></span></span><span> </span><span id="local-6989586621679180843"><span class="annot"><a href="#local-6989586621679180843"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679180842"><span class="annot"><a href="#local-6989586621679180842"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-269"></span><span>  </span><span id="local-6989586621679182887"><span id="local-6989586621679182888"><span id="%3A-%3E"><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">(:-&gt;)</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-270"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182888"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182887"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-271"></span><span>    </span><span class="annot"><a href="Constrained.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182887"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-272"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182888"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-273"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182888"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182887"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span id="local-6989586621679180835"><span id="local-6989586621679180837"><span id="local-6989586621679180839"><span id="local-6989586621679183437"><span id="local-6989586621679183438"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183438"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183437"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="hs-keyword">data</span><span> </span><span id="Pred"><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-var">Pred</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679180833"><span class="annot"><a href="#local-6989586621679180833"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-278"></span><span>  </span><span id="local-6989586621679183434"><span id="Block"><span class="annot"><a href="Constrained.Base.html#Block"><span class="hs-identifier hs-var">Block</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183434"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-280"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183434"><span class="hs-identifier hs-type">fn</span></a></span></span><span>
</span><span id="line-281"></span><span>  </span><span id="local-6989586621679180831"><span id="local-6989586621679182963"><span id="Exists"><span class="annot"><a href="Constrained.Base.html#Exists"><span class="hs-identifier hs-var">Exists</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-comment">-- | Constructive recovery function for checking</span><span>
</span><span id="line-283"></span><span>    </span><span class="hs-comment">-- existential quantification</span><span>
</span><span id="line-284"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183288"><span class="annot"><a href="#local-6989586621679183288"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182963"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183288"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679183288"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.GenT.html#GE"><span class="hs-identifier hs-type">GE</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180831"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-285"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182963"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180831"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-286"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182963"><span class="hs-identifier hs-type">fn</span></a></span></span></span><span>
</span><span id="line-287"></span><span>  </span><span id="local-6989586621679180828"><span id="local-6989586621679180829"><span id="Subst"><span class="annot"><a href="Constrained.Base.html#Subst"><span class="hs-identifier hs-var">Subst</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-288"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180829"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180828"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-289"></span><span>    </span><span class="annot"><a href="Constrained.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180828"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-290"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180829"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180828"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-291"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180829"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-292"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180829"><span class="hs-identifier hs-type">fn</span></a></span></span></span><span>
</span><span id="line-293"></span><span>  </span><span id="local-6989586621679180826"><span id="local-6989586621679182965"><span id="Let"><span class="annot"><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-var">Let</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-294"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182965"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180826"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-295"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182965"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180826"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-296"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182965"><span class="hs-identifier hs-type">fn</span></a></span></span></span><span>
</span><span id="line-297"></span><span>  </span><span id="local-6989586621679183151"><span id="Assert"><span class="annot"><a href="Constrained.Base.html#Assert"><span class="hs-identifier hs-var">Assert</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-298"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183151"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-300"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183151"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-301"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183151"><span class="hs-identifier hs-type">fn</span></a></span></span><span>
</span><span id="line-302"></span><span>  </span><span id="local-6989586621679180822"><span id="local-6989586621679180823"><span id="local-6989586621679182722"><span id="Reify"><span class="annot"><a href="Constrained.Base.html#Reify"><span class="hs-identifier hs-var">Reify</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182722"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180823"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182722"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180822"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182722"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180823"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-307"></span><span>    </span><span class="hs-comment">-- | Recover a useable value from the `a` term.</span><span>
</span><span id="line-308"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679180823"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679180822"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-comment">-- | Everything in here depends on the `a` term.</span><span>
</span><span id="line-310"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182722"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180822"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182722"><span class="hs-identifier hs-type">fn</span></a></span></span></span></span><span>
</span><span id="line-312"></span><span>  </span><span id="local-6989586621679180819"><span id="local-6989586621679180820"><span id="local-6989586621679182719"><span id="DependsOn"><span class="annot"><a href="Constrained.Base.html#DependsOn"><span class="hs-identifier hs-var">DependsOn</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-313"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182719"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180820"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182719"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180819"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-315"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-316"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182719"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180820"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-317"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182719"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180819"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-318"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182719"><span class="hs-identifier hs-type">fn</span></a></span></span></span></span><span>
</span><span id="line-319"></span><span>  </span><span id="local-6989586621679180816"><span id="local-6989586621679180817"><span id="local-6989586621679182727"><span id="ForAll"><span class="annot"><a href="Constrained.Base.html#ForAll"><span class="hs-identifier hs-var">ForAll</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-320"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#Forallable"><span class="hs-identifier hs-type">Forallable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180817"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180816"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-321"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182727"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180817"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-322"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182727"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180816"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-323"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-324"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182727"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180817"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-325"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182727"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180816"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-326"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182727"><span class="hs-identifier hs-type">fn</span></a></span></span></span></span><span>
</span><span id="line-327"></span><span>  </span><span id="local-6989586621679180814"><span id="local-6989586621679182725"><span id="Case"><span class="annot"><a href="Constrained.Base.html#Case"><span class="hs-identifier hs-var">Case</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-328"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182725"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#SumOver"><span class="hs-identifier hs-type">SumOver</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180814"><span class="hs-keyword hs-type">as</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-329"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182725"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#SumOver"><span class="hs-identifier hs-type">SumOver</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180814"><span class="hs-keyword hs-type">as</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-330"></span><span>    </span><span class="hs-comment">-- | Each branch of the type is bound with</span><span>
</span><span id="line-331"></span><span>    </span><span class="hs-comment">-- only one variable because `as` are types.</span><span>
</span><span id="line-332"></span><span>    </span><span class="hs-comment">-- Constructors with multiple arguments are</span><span>
</span><span id="line-333"></span><span>    </span><span class="hs-comment">-- encoded with `ProdOver` (c.f. `Constrained.Univ`).</span><span>
</span><span id="line-334"></span><span>    </span><span class="annot"><a href="Constrained.List.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182725"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679180814"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-335"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182725"><span class="hs-identifier hs-type">fn</span></a></span></span></span><span>
</span><span id="line-336"></span><span>  </span><span id="local-6989586621679180812"><span id="local-6989586621679182735"><span id="GenHint"><span class="annot"><a href="Constrained.Base.html#GenHint"><span class="hs-identifier hs-var">GenHint</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-337"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#HasGenHint"><span class="hs-identifier hs-type">HasGenHint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182735"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180812"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-338"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Hint"><span class="hs-identifier hs-type">Hint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180812"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-339"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182735"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180812"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-340"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182735"><span class="hs-identifier hs-type">fn</span></a></span></span></span><span>
</span><span id="line-341"></span><span>  </span><span id="local-6989586621679183430"><span id="TruePred"><span class="annot"><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183430"><span class="hs-identifier hs-type">fn</span></a></span></span><span>
</span><span id="line-342"></span><span>  </span><span id="local-6989586621679183435"><span id="FalsePred"><span class="annot"><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-var">FalsePred</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183435"><span class="hs-identifier hs-type">fn</span></a></span></span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679180804"><span id="local-6989586621679180806"><span id="local-6989586621679183436"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183436"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183436"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-345"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-type">FalsePred</span></a></span><span> </span><span id="local-6989586621679180803"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679180803"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679180802"><span class="annot"><span class="annottext">&lt;&gt; :: Pred fn -&gt; Pred fn -&gt; Pred fn
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></a></span></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). [String] -&gt; Pred fn
</span><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-var">FalsePred</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679180803"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-346"></span><span>  </span><span class="annot"><span class="annottext">Pred fn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-type">FalsePred</span></a></span><span> </span><span id="local-6989586621679180801"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679180801"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). [String] -&gt; Pred fn
</span><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-var">FalsePred</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679180801"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-347"></span><span>  </span><span class="annot"><span class="annottext">Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span id="local-6989586621679180800"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180800"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180800"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-348"></span><span>  </span><span id="local-6989586621679180799"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180799"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180799"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-349"></span><span>  </span><span id="local-6989586621679180798"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180798"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span id="local-6989586621679180797"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180797"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). [Pred fn] -&gt; Pred fn
</span><a href="Constrained.Base.html#Block"><span class="hs-identifier hs-var">Block</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {fn :: [*] -&gt; * -&gt; *}. Pred fn -&gt; [Pred fn]
</span><a href="#local-6989586621679180796"><span class="hs-identifier hs-var">unpackPred</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180798"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall {fn :: [*] -&gt; * -&gt; *}. Pred fn -&gt; [Pred fn]
</span><a href="#local-6989586621679180796"><span class="hs-identifier hs-var">unpackPred</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180797"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-351"></span><span>      </span><span id="local-6989586621679180796"><span class="annot"><span class="annottext">unpackPred :: Pred fn -&gt; [Pred fn]
</span><a href="#local-6989586621679180796"><span class="hs-identifier hs-var hs-var">unpackPred</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span id="local-6989586621679180795"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679180795"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679180795"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-352"></span><span>      </span><span class="annot"><a href="#local-6989586621679180796"><span class="hs-identifier hs-var">unpackPred</span></a></span><span> </span><span id="local-6989586621679180794"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180794"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180794"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679180787"><span id="local-6989586621679180789"><span id="local-6989586621679183431"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183431"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183431"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-355"></span><span>  </span><span id="local-6989586621679180786"><span class="annot"><span class="annottext">mempty :: Pred fn
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="hs-comment">-- | Contexts for Terms, basically a term with a _single_ HOLE</span><span>
</span><span id="line-358"></span><span class="hs-comment">-- instead of a variable. This is used to traverse the defining</span><span>
</span><span id="line-359"></span><span class="hs-comment">-- constraints for a variable and turn them into a spec. Each</span><span>
</span><span id="line-360"></span><span class="hs-comment">-- subterm `f vs Ctx vs'` for lists of values `vs` and `vs'`</span><span>
</span><span id="line-361"></span><span class="hs-comment">-- gets given to the `propagateSpecFun` for `f` as</span><span>
</span><span id="line-362"></span><span class="hs-comment">-- `f vs HOLE vs'`.</span><span>
</span><span id="line-363"></span><span class="hs-keyword">data</span><span> </span><span id="Ctx"><span class="annot"><a href="Constrained.Base.html#Ctx"><span class="hs-identifier hs-var">Ctx</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679180785"><span class="annot"><a href="#local-6989586621679180785"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679180784"><span class="annot"><a href="#local-6989586621679180784"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679180783"><span class="annot"><a href="#local-6989586621679180783"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-364"></span><span>  </span><span class="hs-comment">-- | A single hole of type `v`</span><span>
</span><span id="line-365"></span><span>  </span><span id="local-6989586621679183384"><span id="local-6989586621679183385"><span id="CtxHOLE"><span class="annot"><a href="Constrained.Base.html#CtxHOLE"><span class="hs-identifier hs-var">CtxHOLE</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-366"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183385"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183384"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-367"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Ctx"><span class="hs-identifier hs-type">Ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183385"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183384"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183384"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-368"></span><span>  </span><span class="hs-comment">-- | The application `f vs Ctx vs'`</span><span>
</span><span id="line-369"></span><span>  </span><span id="local-6989586621679180781"><span id="local-6989586621679183401"><span id="local-6989586621679183404"><span id="local-6989586621679183405"><span id="CtxApp"><span class="annot"><a href="Constrained.Base.html#CtxApp"><span class="hs-identifier hs-var">CtxApp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-370"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183405"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183404"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-371"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.List.html#TypeList"><span class="hs-identifier hs-type">TypeList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180781"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-372"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180781"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-373"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.List.html#All"><span class="hs-identifier hs-type">All</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183405"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679180781"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-374"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-375"></span><span>    </span><span class="annot"><a href="#local-6989586621679183405"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180781"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183404"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-376"></span><span>    </span><span class="hs-comment">-- This is basically a `List` where</span><span>
</span><span id="line-377"></span><span>    </span><span class="hs-comment">-- everything is `Value` except for</span><span>
</span><span id="line-378"></span><span>    </span><span class="hs-comment">-- one entry which is `Ctx fn v`.</span><span>
</span><span id="line-379"></span><span>    </span><span class="annot"><a href="Constrained.List.html#ListCtx"><span class="hs-identifier hs-type">ListCtx</span></a></span><span> </span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180781"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Ctx"><span class="hs-identifier hs-type">Ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183405"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183401"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-380"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Ctx"><span class="hs-identifier hs-type">Ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183405"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183401"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183404"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="hs-comment">-- | This is used together with `ListCtx` to form</span><span>
</span><span id="line-383"></span><span class="hs-comment">-- just the arguments to `f vs Ctx vs'` - replacing</span><span>
</span><span id="line-384"></span><span class="hs-comment">-- `Ctx` with `HOLE` - to provide to `propagateSpecFun`.</span><span>
</span><span id="line-385"></span><span class="hs-keyword">data</span><span> </span><span id="HOLE"><span class="annot"><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span></span><span> </span><span id="local-6989586621679180779"><span class="annot"><a href="#local-6989586621679180779"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679180778"><span class="annot"><a href="#local-6989586621679180778"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-386"></span><span>  </span><span id="local-6989586621679183100"><span id="HOLE"><span class="annot"><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-type">HOLE</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183100"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183100"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="annot"><a href="Constrained.Base.html#toCtx"><span class="hs-identifier hs-type">toCtx</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-389"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183427"><span class="annot"><a href="#local-6989586621679183427"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679183429"><span class="annot"><a href="#local-6989586621679183429"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679183428"><span class="annot"><a href="#local-6989586621679183428"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679183424"><span class="annot"><a href="#local-6989586621679183424"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-390"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183429"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183428"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-392"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.GenT.html#MonadGenError"><span class="hs-identifier hs-type">MonadGenError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183427"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-393"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span>
</span><span id="line-394"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-395"></span><span>  </span><span class="annot"><a href="Constrained.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183428"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-396"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183429"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183424"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-397"></span><span>  </span><span class="annot"><a href="#local-6989586621679183427"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Ctx"><span class="hs-identifier hs-type">Ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183429"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183428"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183424"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span id="toCtx"><span class="annot"><span class="annottext">toCtx :: forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *) v a.
(BaseUniverse fn, Typeable v, MonadGenError m, HasCallStack) =&gt;
Var v -&gt; Term fn a -&gt; m (Ctx fn v a)
</span><a href="Constrained.Base.html#toCtx"><span class="hs-identifier hs-var hs-var">toCtx</span></a></span></span><span> </span><span id="local-6989586621679180764"><span class="annot"><span class="annottext">Var v
</span><a href="#local-6989586621679180764"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b. Term fn b -&gt; m (Ctx fn v b)
</span><a href="#local-6989586621679180763"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
BaseUniverse fn =&gt;
Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#simplifyTerm"><span class="hs-identifier hs-var">simplifyTerm</span></a></span><span>
</span><span id="line-399"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-400"></span><span>    </span><span class="annot"><a href="#local-6989586621679180763"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183415"><span class="annot"><a href="#local-6989586621679183415"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183429"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183415"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679183427"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Ctx"><span class="hs-identifier hs-type">Ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183429"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183428"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183415"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>    </span><span id="local-6989586621679180763"><span class="annot"><span class="annottext">go :: forall b. Term fn b -&gt; m (Ctx fn v b)
</span><a href="#local-6989586621679180763"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679180751"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679180751"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a
</span><a href="Constrained.GenT.html#fatalError"><span class="hs-identifier hs-var">fatalError</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;toCtx (Lit &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679180751"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-402"></span><span>    </span><span class="annot"><a href="#local-6989586621679180763"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span id="local-6989586621679180733"><span class="annot"><span class="annottext">fn as b
</span><a href="#local-6989586621679180733"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679180732"><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679180732"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (a :: [*]) v.
(HasSpec fn b, TypeList a, Typeable a, All (HasSpec fn) a) =&gt;
fn a b -&gt; ListCtx Value a (Ctx fn v) -&gt; Ctx fn v b
</span><a href="Constrained.Base.html#CtxApp"><span class="hs-identifier hs-var">CtxApp</span></a></span><span> </span><span class="annot"><span class="annottext">fn as b
</span><a href="#local-6989586621679180733"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *) v (as :: [*]).
(BaseUniverse fn, Typeable v, MonadGenError m, HasCallStack) =&gt;
Var v -&gt; List (Term fn) as -&gt; m (ListCtx Value as (Ctx fn v))
</span><a href="Constrained.Base.html#toCtxList"><span class="hs-identifier hs-var">toCtxList</span></a></span><span> </span><span class="annot"><span class="annottext">Var v
</span><a href="#local-6989586621679180764"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679180732"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-403"></span><span>    </span><span class="annot"><a href="#local-6989586621679180763"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span id="local-6989586621679180716"><span class="annot"><span class="annottext">Var b
</span><a href="#local-6989586621679180716"><span class="hs-identifier hs-var">v'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><span class="annottext">v :~: b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Refl</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a a'.
(Typeable a, Typeable a') =&gt;
Var a -&gt; Var a' -&gt; Maybe (a :~: a')
</span><a href="Constrained.Core.html#eqVar"><span class="hs-identifier hs-var">eqVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var v
</span><a href="#local-6989586621679180764"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var b
</span><a href="#local-6989586621679180716"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) v. HasSpec fn v =&gt; Ctx fn v v
</span><a href="Constrained.Base.html#CtxHOLE"><span class="hs-identifier hs-var">CtxHOLE</span></a></span><span>
</span><span id="line-405"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a
</span><a href="Constrained.GenT.html#fatalError"><span class="hs-identifier hs-var">fatalError</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;toCtx &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Var v
</span><a href="#local-6989586621679180764"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; (V &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Var b
</span><a href="#local-6989586621679180716"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span class="annot"><a href="Constrained.Base.html#toCtxList"><span class="hs-identifier hs-type">toCtxList</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-408"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183394"><span class="annot"><a href="#local-6989586621679183394"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679183396"><span class="annot"><a href="#local-6989586621679183396"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679183395"><span class="annot"><a href="#local-6989586621679183395"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679183393"><span class="annot"><a href="#local-6989586621679183393"><span class="hs-keyword hs-type">as</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-409"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183396"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183395"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.GenT.html#MonadGenError"><span class="hs-identifier hs-type">MonadGenError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183394"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-410"></span><span>  </span><span class="annot"><a href="Constrained.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183395"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-411"></span><span>  </span><span class="annot"><a href="Constrained.List.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183396"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679183393"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-412"></span><span>  </span><span class="annot"><a href="#local-6989586621679183394"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.List.html#ListCtx"><span class="hs-identifier hs-type">ListCtx</span></a></span><span> </span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183393"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Ctx"><span class="hs-identifier hs-type">Ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183396"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183395"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-413"></span><span id="toCtxList"><span class="annot"><span class="annottext">toCtxList :: forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *) v (as :: [*]).
(BaseUniverse fn, Typeable v, MonadGenError m, HasCallStack) =&gt;
Var v -&gt; List (Term fn) as -&gt; m (ListCtx Value as (Ctx fn v))
</span><a href="Constrained.Base.html#toCtxList"><span class="hs-identifier hs-var hs-var">toCtxList</span></a></span></span><span> </span><span id="local-6989586621679180701"><span class="annot"><span class="annottext">Var v
</span><a href="#local-6989586621679180701"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (as' :: [*]).
HasCallStack =&gt;
List (Term fn) as' -&gt; m (ListCtx Value as' (Ctx fn v))
</span><a href="#local-6989586621679180700"><span class="hs-identifier hs-var">prefix</span></a></span><span>
</span><span id="line-414"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-415"></span><span>    </span><span class="annot"><a href="#local-6989586621679180700"><span class="hs-identifier hs-type">prefix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183380"><span class="annot"><a href="#local-6989586621679183380"><span class="hs-identifier hs-type">as'</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.List.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183396"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679183380"><span class="hs-identifier hs-type">as'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679183394"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.List.html#ListCtx"><span class="hs-identifier hs-type">ListCtx</span></a></span><span> </span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183380"><span class="hs-identifier hs-type">as'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Ctx"><span class="hs-identifier hs-type">Ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183396"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183395"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>    </span><span id="local-6989586621679180700"><span class="annot"><span class="annottext">prefix :: forall (as' :: [*]).
HasCallStack =&gt;
List (Term fn) as' -&gt; m (ListCtx Value as' (Ctx fn v))
</span><a href="#local-6989586621679180700"><span class="hs-identifier hs-var hs-var">prefix</span></a></span></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as'
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a
</span><a href="Constrained.GenT.html#fatalError"><span class="hs-identifier hs-var">fatalError</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;toCtxList without hole&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-417"></span><span>    </span><span class="annot"><a href="#local-6989586621679180700"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679180686"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180686"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679180684"><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679180684"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-418"></span><span>      </span><span id="local-6989586621679180683"><span class="annot"><span class="annottext">ListCtx Value as (Ctx fn v)
</span><a href="#local-6989586621679180683"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (as' :: [*]).
HasCallStack =&gt;
List (Term fn) as' -&gt; m (ListCtx Value as' (Ctx fn v))
</span><a href="#local-6989586621679180700"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679180684"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-419"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; Value a
</span><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-var">Value</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180686"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a (a :: [*]) (c :: * -&gt; *).
f a -&gt; ListCtx f a c -&gt; ListCtx f (a : a) c
</span><a href="Constrained.List.html#%3A%21"><span class="hs-operator hs-var">:!</span></a></span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (Ctx fn v)
</span><a href="#local-6989586621679180683"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-420"></span><span>    </span><span class="annot"><a href="#local-6989586621679180700"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679180671"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679180671"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679180670"><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679180670"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-421"></span><span>      </span><span id="local-6989586621679180669"><span class="annot"><span class="annottext">Ctx fn v a
</span><a href="#local-6989586621679180669"><span class="hs-identifier hs-var">hole</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *) v a.
(BaseUniverse fn, Typeable v, MonadGenError m, HasCallStack) =&gt;
Var v -&gt; Term fn a -&gt; m (Ctx fn v a)
</span><a href="Constrained.Base.html#toCtx"><span class="hs-identifier hs-var">toCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Var v
</span><a href="#local-6989586621679180701"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679180671"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-422"></span><span>      </span><span id="local-6989586621679180668"><span class="annot"><span class="annottext">List Value as
</span><a href="#local-6989586621679180668"><span class="hs-identifier hs-var">suf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (as' :: [*]). List (Term fn) as' -&gt; m (List Value as')
</span><a href="#local-6989586621679180667"><span class="hs-identifier hs-var">suffix</span></a></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679180670"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-423"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx fn v a
</span><a href="#local-6989586621679180669"><span class="hs-identifier hs-var">hole</span></a></span><span> </span><span class="annot"><span class="annottext">forall (c :: * -&gt; *) a (f :: * -&gt; *) (a :: [*]).
c a -&gt; List f a -&gt; ListCtx f (a : a) c
</span><a href="Constrained.List.html#%3A%3F"><span class="hs-operator hs-var">:?</span></a></span><span> </span><span class="annot"><span class="annottext">List Value as
</span><a href="#local-6989586621679180668"><span class="hs-identifier hs-var">suf</span></a></span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span>    </span><span class="annot"><a href="#local-6989586621679180667"><span class="hs-identifier hs-type">suffix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183370"><span class="annot"><a href="#local-6989586621679183370"><span class="hs-identifier hs-type">as'</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.List.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183396"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679183370"><span class="hs-identifier hs-type">as'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679183394"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.List.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183370"><span class="hs-identifier hs-type">as'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>    </span><span id="local-6989586621679180667"><span class="annot"><span class="annottext">suffix :: forall (as' :: [*]). List (Term fn) as' -&gt; m (List Value as')
</span><a href="#local-6989586621679180667"><span class="hs-identifier hs-var hs-var">suffix</span></a></span></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as'
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *). List f '[]
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span>
</span><span id="line-427"></span><span>    </span><span class="annot"><a href="#local-6989586621679180667"><span class="hs-identifier hs-var">suffix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679180659"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180659"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679180658"><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679180658"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; Value a
</span><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-var">Value</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180659"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (a :: k) (a :: [k]).
f a -&gt; List f a -&gt; List f (a : a)
</span><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (as' :: [*]). List (Term fn) as' -&gt; m (List Value as')
</span><a href="#local-6989586621679180667"><span class="hs-identifier hs-var">suffix</span></a></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679180658"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-428"></span><span>    </span><span class="annot"><a href="#local-6989586621679180667"><span class="hs-identifier hs-var">suffix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term fn a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a
</span><a href="Constrained.GenT.html#fatalError"><span class="hs-identifier hs-var">fatalError</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;toCtxList with too many holes&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-429"></span><span>
</span><span id="line-430"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-431"></span><span class="hs-comment">-- Semantics of `Term` and `Pred`</span><span>
</span><span id="line-432"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span id="local-6989586621679183352"><span id="local-6989586621679183353"><span id="local-6989586621679183355"><span class="annot"><a href="Constrained.Base.html#runTerm"><span class="hs-identifier hs-type">runTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.GenT.html#MonadGenError"><span class="hs-identifier hs-type">MonadGenError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183355"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183353"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183352"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679183355"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183352"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-435"></span><span id="runTerm"><span class="annot"><span class="annottext">runTerm :: forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *) a.
MonadGenError m =&gt;
Env -&gt; Term fn a -&gt; m a
</span><a href="Constrained.Base.html#runTerm"><span class="hs-identifier hs-var hs-var">runTerm</span></a></span></span><span> </span><span id="local-6989586621679180648"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679180648"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-436"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679180645"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180645"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180645"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-437"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span id="local-6989586621679180640"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180640"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(Typeable a, MonadGenError m) =&gt;
Env -&gt; Var a -&gt; m a
</span><a href="Constrained.Env.html#findEnv"><span class="hs-identifier hs-var">findEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679180648"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180640"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-438"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span id="local-6989586621679180626"><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679180626"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679180625"><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679180625"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-439"></span><span>    </span><span id="local-6989586621679180624"><span class="annot"><span class="annottext">List Identity as
</span><a href="#local-6989586621679180624"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {k} (m :: * -&gt; *) (f :: k -&gt; *) (g :: k -&gt; *) (as :: [k]).
Applicative m =&gt;
(forall (a :: k). f a -&gt; m (g a)) -&gt; List f as -&gt; m (List g as)
</span><a href="Constrained.List.html#mapMList"><span class="hs-identifier hs-var">mapMList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Identity a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Identity</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *) a.
MonadGenError m =&gt;
Env -&gt; Term fn a -&gt; m a
</span><a href="Constrained.Base.html#runTerm"><span class="hs-identifier hs-var">runTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679180648"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679180625"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-440"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (ts :: [*]) (f :: * -&gt; *) r.
TypeList ts =&gt;
(forall a. f a -&gt; a) -&gt; FunTy ts r -&gt; List f ts -&gt; r
</span><a href="Constrained.List.html#uncurryList_"><span class="hs-identifier hs-var">uncurryList_</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Identity a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">runIdentity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (as :: [*]) b.
FunctionLike fn =&gt;
fn as b -&gt; FunTy as b
</span><a href="Constrained.Univ.html#sem"><span class="hs-identifier hs-var">sem</span></a></span><span> </span><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679180626"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List Identity as
</span><a href="#local-6989586621679180624"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span class="annot"><a href="Constrained.Base.html#checkPred"><span class="hs-identifier hs-type">checkPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183325"><span class="annot"><a href="#local-6989586621679183325"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679183324"><span class="annot"><a href="#local-6989586621679183324"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#FunctionLike"><span class="hs-identifier hs-type">FunctionLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183325"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.GenT.html#MonadGenError"><span class="hs-identifier hs-type">MonadGenError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183324"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183325"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679183324"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-443"></span><span id="checkPred"><span class="annot"><span class="annottext">checkPred :: forall (fn :: [*] -&gt; * -&gt; *) (m :: * -&gt; *).
(FunctionLike fn, MonadGenError m) =&gt;
Env -&gt; Pred fn -&gt; m Bool
</span><a href="Constrained.Base.html#checkPred"><span class="hs-identifier hs-var hs-var">checkPred</span></a></span></span><span> </span><span id="local-6989586621679180601"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679180601"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-444"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span id="local-6989586621679180596"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180596"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679180595"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679180595"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679180594"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180594"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (m :: * -&gt; *).
(FunctionLike fn, MonadGenError m) =&gt;
Env -&gt; Pred fn -&gt; m Bool
</span><a href="Constrained.Base.html#checkPred"><span class="hs-identifier hs-var">checkPred</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679180601"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#substitutePred"><span class="hs-identifier hs-var">substitutePred</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180596"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679180595"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180594"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-445"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Assert"><span class="hs-identifier hs-type">Assert</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679180590"><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679180590"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *) a.
MonadGenError m =&gt;
Env -&gt; Term fn a -&gt; m a
</span><a href="Constrained.Base.html#runTerm"><span class="hs-identifier hs-var">runTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679180601"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679180590"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-446"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Assert"><span class="hs-identifier hs-type">Assert</span></a></span><span> </span><span id="local-6989586621679180581"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679180581"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679180580"><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679180580"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a -&gt; m a
</span><a href="Constrained.GenT.html#explain"><span class="hs-identifier hs-var">explain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;assert:&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679180581"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *) a.
MonadGenError m =&gt;
Env -&gt; Term fn a -&gt; m a
</span><a href="Constrained.Base.html#runTerm"><span class="hs-identifier hs-var">runTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679180601"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679180580"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-447"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#GenHint"><span class="hs-identifier hs-type">GenHint</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-448"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Reify"><span class="hs-identifier hs-type">Reify</span></a></span><span> </span><span id="local-6989586621679180572"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679180572"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679180571"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679180571"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679180563"><span class="annot"><span class="annottext">Var b
</span><a href="#local-6989586621679180563"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679180562"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180562"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-449"></span><span>    </span><span id="local-6989586621679180561"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180561"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *) a.
MonadGenError m =&gt;
Env -&gt; Term fn a -&gt; m a
</span><a href="Constrained.Base.html#runTerm"><span class="hs-identifier hs-var">runTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679180601"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679180572"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-450"></span><span>    </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (m :: * -&gt; *).
(FunctionLike fn, MonadGenError m) =&gt;
Env -&gt; Pred fn -&gt; m Bool
</span><a href="Constrained.Base.html#checkPred"><span class="hs-identifier hs-var">checkPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Typeable a, Show a) =&gt; Var a -&gt; a -&gt; Env -&gt; Env
</span><a href="Constrained.Env.html#extendEnv"><span class="hs-identifier hs-var">extendEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var b
</span><a href="#local-6989586621679180563"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679180571"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180561"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679180601"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180562"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-451"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#ForAll"><span class="hs-identifier hs-type">ForAll</span></a></span><span> </span><span id="local-6989586621679180554"><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679180554"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679180540"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180540"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679180539"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180539"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-452"></span><span>    </span><span id="local-6989586621679180538"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679180538"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *) a.
MonadGenError m =&gt;
Env -&gt; Term fn a -&gt; m a
</span><a href="Constrained.Base.html#runTerm"><span class="hs-identifier hs-var">runTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679180601"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679180554"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-453"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">and</span></a></span><span>
</span><span id="line-454"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">sequence</span></a></span><span>
</span><span id="line-455"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (m :: * -&gt; *).
(FunctionLike fn, MonadGenError m) =&gt;
Env -&gt; Pred fn -&gt; m Bool
</span><a href="Constrained.Base.html#checkPred"><span class="hs-identifier hs-var">checkPred</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679180535"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180539"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-456"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679180534"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180534"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall t e. Forallable t e =&gt; t -&gt; [e]
</span><a href="Constrained.Base.html#forAllToList"><span class="hs-identifier hs-var">forAllToList</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679180538"><span class="hs-identifier hs-var">set</span></a></span><span>
</span><span id="line-457"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679180535"><span class="annot"><span class="annottext">env' :: Env
</span><a href="#local-6989586621679180535"><span class="hs-identifier hs-var hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Typeable a, Show a) =&gt; Var a -&gt; a -&gt; Env -&gt; Env
</span><a href="Constrained.Env.html#extendEnv"><span class="hs-identifier hs-var">extendEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180540"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180534"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679180601"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-458"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-459"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Case"><span class="hs-identifier hs-type">Case</span></a></span><span> </span><span id="local-6989586621679180529"><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679180529"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679180528"><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679180528"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-460"></span><span>    </span><span id="local-6989586621679180527"><span class="annot"><span class="annottext">SumOver as
</span><a href="#local-6989586621679180527"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *) a.
MonadGenError m =&gt;
Env -&gt; Term fn a -&gt; m a
</span><a href="Constrained.Base.html#runTerm"><span class="hs-identifier hs-var">runTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679180601"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679180529"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-461"></span><span>    </span><span class="annot"><span class="annottext">forall (as :: [*]) (fn :: [*] -&gt; * -&gt; *) r.
SumOver as
-&gt; List (Binder fn) as
-&gt; (forall a. HasSpec fn a =&gt; Var a -&gt; a -&gt; Pred fn -&gt; r)
-&gt; r
</span><a href="Constrained.Base.html#runCaseOn"><span class="hs-identifier hs-var">runCaseOn</span></a></span><span> </span><span class="annot"><span class="annottext">SumOver as
</span><a href="#local-6989586621679180527"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679180528"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679180518"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180518"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679180517"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180517"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621679180516"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180516"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (m :: * -&gt; *).
(FunctionLike fn, MonadGenError m) =&gt;
Env -&gt; Pred fn -&gt; m Bool
</span><a href="Constrained.Base.html#checkPred"><span class="hs-identifier hs-var">checkPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Typeable a, Show a) =&gt; Var a -&gt; a -&gt; Env -&gt; Env
</span><a href="Constrained.Env.html#extendEnv"><span class="hs-identifier hs-var">extendEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180518"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180517"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679180601"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180516"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>  </span><span class="annot"><span class="annottext">Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-463"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-type">FalsePred</span></a></span><span> </span><span id="local-6989586621679180515"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679180515"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a -&gt; m a
</span><a href="Constrained.GenT.html#explain"><span class="hs-identifier hs-var">explain</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679180515"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-464"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#DependsOn"><span class="hs-identifier hs-type">DependsOn</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-465"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span id="local-6989586621679180511"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679180511"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (t :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *).
(MonadGenError m, Traversable t, FunctionLike fn) =&gt;
Env -&gt; t (Pred fn) -&gt; m Bool
</span><a href="Constrained.Base.html#checkPreds"><span class="hs-identifier hs-var">checkPreds</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679180601"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679180511"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-466"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span id="local-6989586621679180509"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679180509"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679180499"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180499"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679180498"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180498"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-467"></span><span>    </span><span id="local-6989586621679180497"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180497"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *) a.
MonadGenError m =&gt;
Env -&gt; Term fn a -&gt; m a
</span><a href="Constrained.Base.html#runTerm"><span class="hs-identifier hs-var">runTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679180601"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679180509"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-468"></span><span>    </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (m :: * -&gt; *).
(FunctionLike fn, MonadGenError m) =&gt;
Env -&gt; Pred fn -&gt; m Bool
</span><a href="Constrained.Base.html#checkPred"><span class="hs-identifier hs-var">checkPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Typeable a, Show a) =&gt; Var a -&gt; a -&gt; Env -&gt; Env
</span><a href="Constrained.Env.html#extendEnv"><span class="hs-identifier hs-var">extendEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180499"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180497"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679180601"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180498"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-469"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Exists"><span class="hs-identifier hs-type">Exists</span></a></span><span> </span><span id="local-6989586621679180496"><span class="annot"><span class="annottext">(forall b. Term fn b -&gt; b) -&gt; GE a
</span><a href="#local-6989586621679180496"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679180486"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180486"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679180485"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180485"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-470"></span><span>    </span><span id="local-6989586621679180484"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180484"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r. MonadGenError m =&gt; GE r -&gt; m r
</span><a href="Constrained.GenT.html#runGE"><span class="hs-identifier hs-var">runGE</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(forall b. Term fn b -&gt; b) -&gt; GE a
</span><a href="#local-6989586621679180496"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. GE a -&gt; a
</span><a href="Constrained.GenT.html#errorGE"><span class="hs-identifier hs-var">errorGE</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a -&gt; m a
</span><a href="Constrained.GenT.html#explain"><span class="hs-identifier hs-var">explain</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;checkPred: Exists&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *) a.
MonadGenError m =&gt;
Env -&gt; Term fn a -&gt; m a
</span><a href="Constrained.Base.html#runTerm"><span class="hs-identifier hs-var">runTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679180601"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>    </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (m :: * -&gt; *).
(FunctionLike fn, MonadGenError m) =&gt;
Env -&gt; Pred fn -&gt; m Bool
</span><a href="Constrained.Base.html#checkPred"><span class="hs-identifier hs-var">checkPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Typeable a, Show a) =&gt; Var a -&gt; a -&gt; Env -&gt; Env
</span><a href="Constrained.Env.html#extendEnv"><span class="hs-identifier hs-var">extendEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180486"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180484"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679180601"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180485"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span id="local-6989586621679183290"><span id="local-6989586621679183291"><span id="local-6989586621679183292"><span class="annot"><a href="Constrained.Base.html#checkPreds"><span class="hs-identifier hs-type">checkPreds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.GenT.html#MonadGenError"><span class="hs-identifier hs-type">MonadGenError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183292"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Traversable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183291"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Univ.html#FunctionLike"><span class="hs-identifier hs-type">FunctionLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183290"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679183291"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183290"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679183292"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span></span><span>
</span><span id="line-474"></span><span id="checkPreds"><span class="annot"><span class="annottext">checkPreds :: forall (m :: * -&gt; *) (t :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *).
(MonadGenError m, Traversable t, FunctionLike fn) =&gt;
Env -&gt; t (Pred fn) -&gt; m Bool
</span><a href="Constrained.Base.html#checkPreds"><span class="hs-identifier hs-var hs-var">checkPreds</span></a></span></span><span> </span><span id="local-6989586621679180462"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679180462"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621679180461"><span class="annot"><span class="annottext">t (Pred fn)
</span><a href="#local-6989586621679180461"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">and</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (m :: * -&gt; *).
(FunctionLike fn, MonadGenError m) =&gt;
Env -&gt; Pred fn -&gt; m Bool
</span><a href="Constrained.Base.html#checkPred"><span class="hs-identifier hs-var">checkPred</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679180462"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t (Pred fn)
</span><a href="#local-6989586621679180461"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-475"></span><span>
</span><span id="line-476"></span><span id="local-6989586621679183275"><span class="annot"><a href="Constrained.Base.html#checkPredPure"><span class="hs-identifier hs-type">checkPredPure</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Univ.html#FunctionLike"><span class="hs-identifier hs-type">FunctionLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183275"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183275"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-477"></span><span id="checkPredPure"><span class="annot"><span class="annottext">checkPredPure :: forall (fn :: [*] -&gt; * -&gt; *).
FunctionLike fn =&gt;
Env -&gt; Pred fn -&gt; Bool
</span><a href="Constrained.Base.html#checkPredPure"><span class="hs-identifier hs-var hs-var">checkPredPure</span></a></span></span><span> </span><span id="local-6989586621679180455"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679180455"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621679180454"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180454"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ([String] -&gt; a) -&gt; GE a -&gt; a
</span><a href="Constrained.GenT.html#fromGE"><span class="hs-identifier hs-var">fromGE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (m :: * -&gt; *).
(FunctionLike fn, MonadGenError m) =&gt;
Env -&gt; Pred fn -&gt; m Bool
</span><a href="Constrained.Base.html#checkPred"><span class="hs-identifier hs-var">checkPred</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679180455"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180454"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-478"></span><span>
</span><span id="line-479"></span><span id="local-6989586621679183296"><span id="local-6989586621679183298"><span id="local-6989586621679183299"><span class="annot"><a href="Constrained.Base.html#runCaseOn"><span class="hs-identifier hs-type">runCaseOn</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-480"></span><span>  </span><span class="annot"><a href="Constrained.Univ.html#SumOver"><span class="hs-identifier hs-type">SumOver</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183299"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-481"></span><span>  </span><span class="annot"><a href="Constrained.List.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183298"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679183299"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-482"></span><span>  </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183297"><span class="annot"><a href="#local-6989586621679183297"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183298"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183297"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183297"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679183297"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183298"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679183296"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-483"></span><span>  </span><span class="annot"><a href="#local-6989586621679183296"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-484"></span><span id="runCaseOn"><span class="annot"><span class="annottext">runCaseOn :: forall (as :: [*]) (fn :: [*] -&gt; * -&gt; *) r.
SumOver as
-&gt; List (Binder fn) as
-&gt; (forall a. HasSpec fn a =&gt; Var a -&gt; a -&gt; Pred fn -&gt; r)
-&gt; r
</span><a href="Constrained.Base.html#runCaseOn"><span class="hs-identifier hs-var hs-var">runCaseOn</span></a></span></span><span> </span><span class="annot"><span class="annottext">SumOver as
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. HasSpec fn a =&gt; Var a -&gt; a -&gt; Pred fn -&gt; r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The impossible happened in runCaseOn&quot;</span></span><span>
</span><span id="line-485"></span><span class="annot"><a href="Constrained.Base.html#runCaseOn"><span class="hs-identifier hs-var">runCaseOn</span></a></span><span> </span><span id="local-6989586621679180445"><span class="annot"><span class="annottext">SumOver as
</span><a href="#local-6989586621679180445"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679180442"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180442"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679180441"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180441"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679180438"><span class="annot"><span class="annottext">forall a. HasSpec fn a =&gt; Var a -&gt; a -&gt; Pred fn -&gt; r
</span><a href="#local-6989586621679180438"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasSpec fn a =&gt; Var a -&gt; a -&gt; Pred fn -&gt; r
</span><a href="#local-6989586621679180438"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180442"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">SumOver as
</span><a href="#local-6989586621679180445"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180441"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-486"></span><span class="annot"><a href="Constrained.Base.html#runCaseOn"><span class="hs-identifier hs-var">runCaseOn</span></a></span><span> </span><span id="local-6989586621679180437"><span class="annot"><span class="annottext">SumOver as
</span><a href="#local-6989586621679180437"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679180434"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180434"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679180433"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180433"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679180432"><span class="annot"><span class="annottext">bs :: List (Binder fn) as
</span><a href="#local-6989586621679180432"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Binder fn a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679180429"><span class="annot"><span class="annottext">forall a. HasSpec fn a =&gt; Var a -&gt; a -&gt; Pred fn -&gt; r
</span><a href="#local-6989586621679180429"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SumOver as
</span><a href="#local-6989586621679180437"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-487"></span><span>  </span><span class="annot"><a href="Constrained.Univ.html#SumLeft"><span class="hs-identifier hs-type">SumLeft</span></a></span><span> </span><span id="local-6989586621679180427"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180427"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasSpec fn a =&gt; Var a -&gt; a -&gt; Pred fn -&gt; r
</span><a href="#local-6989586621679180429"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180434"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180427"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180433"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-488"></span><span>  </span><span class="annot"><a href="Constrained.Univ.html#SumRight"><span class="hs-identifier hs-type">SumRight</span></a></span><span> </span><span id="local-6989586621679180425"><span class="annot"><span class="annottext">SumOver (a : as)
</span><a href="#local-6989586621679180425"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (as :: [*]) (fn :: [*] -&gt; * -&gt; *) r.
SumOver as
-&gt; List (Binder fn) as
-&gt; (forall a. HasSpec fn a =&gt; Var a -&gt; a -&gt; Pred fn -&gt; r)
-&gt; r
</span><a href="Constrained.Base.html#runCaseOn"><span class="hs-identifier hs-var">runCaseOn</span></a></span><span> </span><span class="annot"><span class="annottext">SumOver (a : as)
</span><a href="#local-6989586621679180425"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679180432"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. HasSpec fn a =&gt; Var a -&gt; a -&gt; Pred fn -&gt; r
</span><a href="#local-6989586621679180429"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-489"></span><span>
</span><span id="line-490"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-491"></span><span class="hs-comment">-- Specs</span><span>
</span><span id="line-492"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-493"></span><span>
</span><span id="line-494"></span><span class="hs-comment">-- NOTE: in the future one might consider using sets when a type</span><span>
</span><span id="line-495"></span><span class="hs-comment">-- has `Ord` here. Beware, this means that one needs to have a check</span><span>
</span><span id="line-496"></span><span class="hs-comment">-- for instances of Ord at runtime!</span><span>
</span><span id="line-497"></span><span class="hs-keyword">type</span><span> </span><span id="OrdSet"><span class="annot"><a href="Constrained.Base.html#OrdSet"><span class="hs-identifier hs-var">OrdSet</span></a></span></span><span> </span><span id="local-6989586621679180422"><span class="annot"><a href="#local-6989586621679180422"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679180422"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-498"></span><span>
</span><span id="line-499"></span><span class="hs-comment">-- | A `Spec fn a` denotes a set of `a`s</span><span>
</span><span id="line-500"></span><span class="hs-keyword">data</span><span> </span><span id="Spec"><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-var">Spec</span></a></span></span><span> </span><span id="local-6989586621679180421"><span class="annot"><a href="#local-6989586621679180421"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679180420"><span class="annot"><a href="#local-6989586621679180420"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-501"></span><span>  </span><span class="hs-comment">-- | Elements of a known set</span><span>
</span><span id="line-502"></span><span>  </span><span id="local-6989586621679183247"><span id="local-6989586621679183249"><span id="MemberSpec"><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-var">MemberSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-503"></span><span>    </span><span class="hs-comment">-- | It must be an element of this set</span><span>
</span><span id="line-504"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#OrdSet"><span class="hs-identifier hs-type">OrdSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183249"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-505"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183247"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183249"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-506"></span><span>  </span><span class="hs-comment">-- | The empty set</span><span>
</span><span id="line-507"></span><span>  </span><span id="local-6989586621679183253"><span id="local-6989586621679183254"><span id="ErrorSpec"><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-508"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-509"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183254"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183253"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-510"></span><span>  </span><span class="hs-comment">-- | The set described by some predicates</span><span>
</span><span id="line-511"></span><span>  </span><span class="hs-comment">-- over the bound variable.</span><span>
</span><span id="line-512"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-513"></span><span>  </span><span class="hs-comment">-- TODO: possibly we want to use a `Binder` here</span><span>
</span><span id="line-514"></span><span>  </span><span id="local-6989586621679183232"><span id="local-6989586621679183233"><span id="SuspendedSpec"><span class="annot"><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-var">SuspendedSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-515"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183233"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183232"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-516"></span><span>    </span><span class="hs-comment">-- | This variable ranges over values denoted by</span><span>
</span><span id="line-517"></span><span>    </span><span class="hs-comment">-- the spec</span><span>
</span><span id="line-518"></span><span>    </span><span class="annot"><a href="Constrained.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183232"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-519"></span><span>    </span><span class="hs-comment">-- | And the variable is subject to these constraints</span><span>
</span><span id="line-520"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183233"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-521"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183233"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183232"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-522"></span><span>  </span><span class="hs-comment">-- | A type-specific spec</span><span>
</span><span id="line-523"></span><span>  </span><span id="local-6989586621679183236"><span id="local-6989586621679183237"><span id="TypeSpec"><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-524"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183237"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183236"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-525"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183237"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183236"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-526"></span><span>    </span><span class="hs-comment">-- | It can't be any of the elements of this set</span><span>
</span><span id="line-527"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#OrdSet"><span class="hs-identifier hs-type">OrdSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183236"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-528"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183237"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183236"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-529"></span><span>  </span><span class="hs-comment">-- | Anything</span><span>
</span><span id="line-530"></span><span>  </span><span id="local-6989586621679183217"><span id="local-6989586621679183218"><span id="TrueSpec"><span class="annot"><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183218"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183217"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-531"></span><span>
</span><span id="line-532"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679180410"><span id="local-6989586621679180412"><span id="local-6989586621679183257"><span id="local-6989586621679183258"><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183258"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183257"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183258"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183257"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-533"></span><span>  </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span id="local-6989586621679180399"><span class="annot"><span class="annottext">&lt;&gt; :: Spec fn a -&gt; Spec fn a -&gt; Spec fn a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></a></span></span><span> </span><span id="local-6989586621679180398"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679180398"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679180398"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-534"></span><span>  </span><span id="local-6989586621679180397"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679180397"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679180397"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-535"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span id="local-6989586621679180396"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679180396"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span id="local-6989586621679180395"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679180395"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679180396"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679180395"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-536"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span id="local-6989586621679180393"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679180393"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679180393"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-537"></span><span>  </span><span class="annot"><span class="annottext">Spec fn a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span id="local-6989586621679180392"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679180392"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679180392"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-538"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679180391"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180391"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span id="local-6989586621679180390"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679180390"><span class="hs-identifier hs-var">spec</span></a></span></span><span>
</span><span id="line-539"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180391"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-operator hs-var">`conformsToSpec`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679180390"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-var">MemberSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180391"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-540"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180391"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;does not conform to&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679180390"><span class="hs-identifier hs-var">spec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-541"></span><span>  </span><span id="local-6989586621679180388"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679180388"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679180387"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180387"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-var">MemberSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180387"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679180388"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-542"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span id="local-6989586621679180386"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679180386"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span id="local-6989586621679180385"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679180385"><span class="hs-identifier hs-var">as'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-var">MemberSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">intersect</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679180386"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679180385"><span class="hs-identifier hs-var">as'</span></a></span><span>
</span><span id="line-543"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span id="local-6989586621679180384"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679180384"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span id="local-6989586621679180377"><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180377"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679180376"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679180376"><span class="hs-identifier hs-var">cant</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-544"></span><span>    </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-var">MemberSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-545"></span><span>      </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span>
</span><span id="line-546"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn a, HasCallStack) =&gt;
a -&gt; TypeSpec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsTo"><span class="hs-identifier hs-var">conformsTo</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679183258"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180377"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-547"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`notElem`</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679180376"><span class="hs-identifier hs-var">cant</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679180384"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-548"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span id="local-6989586621679180369"><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180369"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679180368"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679180368"><span class="hs-identifier hs-var">cant</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span id="local-6989586621679180367"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679180367"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-var">MemberSpec</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679180367"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180369"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679180368"><span class="hs-identifier hs-var">cant</span></a></span><span>
</span><span id="line-549"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-type">SuspendedSpec</span></a></span><span> </span><span id="local-6989586621679180365"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180365"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679180364"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180364"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-type">SuspendedSpec</span></a></span><span> </span><span id="local-6989586621679180357"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180357"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span id="local-6989586621679180356"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180356"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Spec fn a
</span><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-var">SuspendedSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180365"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180364"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a x. (Rename a, Typeable x) =&gt; Var x -&gt; Var x -&gt; a -&gt; a
</span><a href="Constrained.Core.html#rename"><span class="hs-identifier hs-var">rename</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180357"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180365"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180356"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-type">SuspendedSpec</span></a></span><span> </span><span id="local-6989586621679180348"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180348"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679180347"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180347"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span id="local-6989586621679180346"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679180346"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Spec fn a
</span><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-var">SuspendedSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180348"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). BaseUniverse fn =&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#optimisePred"><span class="hs-identifier hs-var">optimisePred</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180347"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Spec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#satisfies"><span class="hs-identifier hs-var">satisfies</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; Var a -&gt; Term fn a
</span><a href="Constrained.Base.html#V"><span class="hs-identifier hs-var">V</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180348"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679180346"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-551"></span><span>  </span><span id="local-6989586621679180343"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679180343"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-type">SuspendedSpec</span></a></span><span> </span><span id="local-6989586621679180336"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180336"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679180335"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180335"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Spec fn a
</span><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-var">SuspendedSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180336"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). BaseUniverse fn =&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#optimisePred"><span class="hs-identifier hs-var">optimisePred</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180335"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Spec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#satisfies"><span class="hs-identifier hs-var">satisfies</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; Var a -&gt; Term fn a
</span><a href="Constrained.Base.html#V"><span class="hs-identifier hs-var">V</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180336"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679180343"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-552"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span id="local-6989586621679180333"><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180333"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679180332"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679180332"><span class="hs-identifier hs-var">cant</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span id="local-6989586621679180324"><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180324"><span class="hs-identifier hs-var">s'</span></a></span></span><span> </span><span id="local-6989586621679180323"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679180323"><span class="hs-identifier hs-var">cant'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#combineSpec"><span class="hs-identifier hs-var">combineSpec</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180333"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180324"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-553"></span><span>    </span><span class="hs-comment">-- NOTE: This might look like an unnecessary case, but doing</span><span>
</span><span id="line-554"></span><span>    </span><span class="hs-comment">-- it like this avoids looping.</span><span>
</span><span id="line-555"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span id="local-6989586621679180317"><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180317"><span class="hs-identifier hs-var">s''</span></a></span></span><span> </span><span id="local-6989586621679180316"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679180316"><span class="hs-identifier hs-var">cant''</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180317"><span class="hs-identifier hs-var">s''</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679180332"><span class="hs-identifier hs-var">cant</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679180323"><span class="hs-identifier hs-var">cant'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679180316"><span class="hs-identifier hs-var">cant''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-556"></span><span>    </span><span id="local-6989586621679180315"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679180315"><span class="hs-identifier hs-var">s''</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679180315"><span class="hs-identifier hs-var">s''</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (f :: * -&gt; *).
(HasSpec fn a, Foldable f) =&gt;
f a -&gt; Spec fn a
</span><a href="Constrained.Base.html#notMemberSpec"><span class="hs-identifier hs-var">notMemberSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679180332"><span class="hs-identifier hs-var">cant</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679180323"><span class="hs-identifier hs-var">cant'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span>
</span><span id="line-558"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679180307"><span id="local-6989586621679180309"><span id="local-6989586621679183219"><span id="local-6989586621679183220"><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183220"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183219"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183220"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183219"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-559"></span><span>  </span><span id="local-6989586621679180306"><span class="annot"><span class="annottext">mempty :: Spec fn a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span>
</span><span id="line-560"></span><span>
</span><span id="line-561"></span><span id="local-6989586621679183215"><span id="local-6989586621679183216"><span class="annot"><a href="Constrained.Base.html#equalSpec"><span class="hs-identifier hs-type">equalSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679183216"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183215"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183216"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-562"></span><span id="equalSpec"><span class="annot"><span class="annottext">equalSpec :: forall a (fn :: [*] -&gt; * -&gt; *). a -&gt; Spec fn a
</span><a href="Constrained.Base.html#equalSpec"><span class="hs-identifier hs-var hs-var">equalSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-var">MemberSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-563"></span><span>
</span><span id="line-564"></span><span class="annot"><a href="Constrained.Base.html#notEqualSpec"><span class="hs-identifier hs-type">notEqualSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183212"><span class="annot"><a href="#local-6989586621679183212"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679183211"><span class="annot"><a href="#local-6989586621679183211"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183212"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183211"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679183211"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183212"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183211"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-565"></span><span id="notEqualSpec"><span class="annot"><span class="annottext">notEqualSpec :: forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#notEqualSpec"><span class="hs-identifier hs-var hs-var">notEqualSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; TypeSpec fn a
</span><a href="Constrained.Base.html#emptySpec"><span class="hs-identifier hs-var">emptySpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679183212"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679183211"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span class="annot"><a href="Constrained.Base.html#notMemberSpec"><span class="hs-identifier hs-type">notMemberSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183223"><span class="annot"><a href="#local-6989586621679183223"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679183222"><span class="annot"><a href="#local-6989586621679183222"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679183221"><span class="annot"><a href="#local-6989586621679183221"><span class="hs-identifier hs-type">f</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183223"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183222"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Foldable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183221"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679183221"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183222"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183223"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183222"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-568"></span><span id="notMemberSpec"><span class="annot"><span class="annottext">notMemberSpec :: forall (fn :: [*] -&gt; * -&gt; *) a (f :: * -&gt; *).
(HasSpec fn a, Foldable f) =&gt;
f a -&gt; Spec fn a
</span><a href="Constrained.Base.html#notMemberSpec"><span class="hs-identifier hs-var hs-var">notMemberSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; TypeSpec fn a
</span><a href="Constrained.Base.html#emptySpec"><span class="hs-identifier hs-var">emptySpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679183223"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679183222"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">toList</span></a></span><span>
</span><span id="line-569"></span><span>
</span><span id="line-570"></span><span id="local-6989586621679183202"><span id="local-6989586621679183203"><span class="annot"><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-type">typeSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183203"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183202"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183203"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183202"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183203"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183202"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-571"></span><span id="typeSpec"><span class="annot"><span class="annottext">typeSpec :: forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var hs-var">typeSpec</span></a></span></span><span> </span><span id="local-6989586621679180285"><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180285"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180285"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-572"></span><span>
</span><span id="line-573"></span><span class="hs-comment">-- The HasSpec Class ------------------------------------------------------</span><span>
</span><span id="line-574"></span><span>
</span><span id="line-575"></span><span class="hs-comment">-- | This class provides the interface that allows you to extend the language</span><span>
</span><span id="line-576"></span><span class="hs-comment">-- to handle a new type. In the case of types that have a generic representation</span><span>
</span><span id="line-577"></span><span class="hs-comment">-- (via `HasSimpleRep`) that already has an instance of `HasSpec` it is sufficient</span><span>
</span><span id="line-578"></span><span class="hs-comment">-- to provide an empty instance. However, for types that are used together with</span><span>
</span><span id="line-579"></span><span class="hs-comment">-- specific functions in the function universe `fn` it may be necessary to provide</span><span>
</span><span id="line-580"></span><span class="hs-comment">-- a specific implementation of `HasSpec`. This is typically necessary when the `TypeSpec`</span><span>
</span><span id="line-581"></span><span class="hs-comment">-- for the generic representation does not permit an implementation of `propagateSpecFun`</span><span>
</span><span id="line-582"></span><span class="hs-comment">-- for some function.</span><span>
</span><span id="line-583"></span><span class="hs-comment">--</span><span>
</span><span id="line-584"></span><span class="hs-comment">-- The basic types provided in the language, `Set`, `[]`, `Map`, `Int`, `Word64`,</span><span>
</span><span id="line-585"></span><span class="hs-comment">-- `(,)`, `Either`, etc. have instances of this class (technically `(,)` and `Either` have</span><span>
</span><span id="line-586"></span><span class="hs-comment">-- instances derived from the instances for their generic `Prod` and `Sum` implementations).</span><span>
</span><span id="line-587"></span><span class="hs-keyword">class</span><span>
</span><span id="line-588"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-589"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-590"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-591"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-592"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-593"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-594"></span><span>  </span><span id="HasSpec"><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-var">HasSpec</span></a></span></span><span> </span><span id="local-6989586621679183489"><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679183488"><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-595"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-596"></span><span>  </span><span class="hs-comment">-- | The `TypeSpec fn a` is the type-specific `Spec fn a`.</span><span>
</span><span id="line-597"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="TypeSpec"><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679183489"><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679183488"><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="TypeSpec"><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span></span><span> </span><span id="local-6989586621679180283"><span id="local-6989586621679180284"><span class="annot"><a href="#local-6989586621679180284"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180283"><span class="hs-identifier hs-type">a</span></a></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180284"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180283"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-600"></span><span>
</span><span id="line-601"></span><span>  </span><span class="hs-comment">-- `TypeSpec` behaves sort-of like a monoid with a neutral</span><span>
</span><span id="line-602"></span><span>  </span><span class="hs-comment">-- enement `emptySpec` and a `combineSpec` for combining</span><span>
</span><span id="line-603"></span><span>  </span><span class="hs-comment">-- two `TypeSpec fn a`. However, in order to provide flexibilty</span><span>
</span><span id="line-604"></span><span>  </span><span class="hs-comment">-- `combineSpec` takes two `TypeSpec` and provide a `Spec`. This</span><span>
</span><span id="line-605"></span><span>  </span><span class="hs-comment">-- avoids e.g. having to have a separate implementation of `ErrorSpec`</span><span>
</span><span id="line-606"></span><span>  </span><span class="hs-comment">-- and `MemberSpec` in `TypeSpec`.</span><span>
</span><span id="line-607"></span><span>
</span><span id="line-608"></span><span>  </span><span id="emptySpec"><span class="annot"><a href="Constrained.Base.html#emptySpec"><span class="hs-identifier hs-type">emptySpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-609"></span><span>  </span><span id="combineSpec"><span class="annot"><a href="Constrained.Base.html#combineSpec"><span class="hs-identifier hs-type">combineSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-610"></span><span>
</span><span id="line-611"></span><span>  </span><span class="hs-comment">-- | Generate a value that satisfies the `TypeSpec`.</span><span>
</span><span id="line-612"></span><span>  </span><span class="hs-comment">-- The key property for this generator is soundness:</span><span>
</span><span id="line-613"></span><span>  </span><span class="hs-comment">--  &#8704; a &#8712; genFromTypeSpec spec. a `conformsTo` spec</span><span>
</span><span id="line-614"></span><span>  </span><span id="genFromTypeSpec"><span class="annot"><a href="Constrained.Base.html#genFromTypeSpec"><span class="hs-identifier hs-type">genFromTypeSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679183189"><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.GenT.html#MonadGenError"><span class="hs-identifier hs-type">MonadGenError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183189"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.GenT.html#GenT"><span class="hs-identifier hs-type">GenT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183189"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-615"></span><span>
</span><span id="line-616"></span><span>  </span><span class="hs-comment">-- | Check conformance to the spec.</span><span>
</span><span id="line-617"></span><span>  </span><span id="conformsTo"><span class="annot"><a href="Constrained.Base.html#conformsTo"><span class="hs-identifier hs-type">conformsTo</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-618"></span><span>
</span><span id="line-619"></span><span>  </span><span class="hs-comment">-- | Convert a spec to predicates:</span><span>
</span><span id="line-620"></span><span>  </span><span class="hs-comment">-- The key property here is:</span><span>
</span><span id="line-621"></span><span>  </span><span class="hs-comment">--   &#8704; a. a `conformsTo` spec == a `conformsTo` constrained (\t -&gt; toPreds t spec)</span><span>
</span><span id="line-622"></span><span>  </span><span id="toPreds"><span class="annot"><a href="Constrained.Base.html#toPreds"><span class="hs-identifier hs-type">toPreds</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-623"></span><span>
</span><span id="line-624"></span><span>  </span><span class="hs-comment">-- | Prerequisites for the instance that are sometimes necessary</span><span>
</span><span id="line-625"></span><span>  </span><span class="hs-comment">-- when working with e.g. `Spec`s or functions in the universe.</span><span>
</span><span id="line-626"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Prerequisites"><span class="annot"><a href="Constrained.Base.html#Prerequisites"><span class="hs-identifier hs-var">Prerequisites</span></a></span></span><span> </span><span id="local-6989586621679183489"><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679183488"><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Constraint</span></a></span><span>
</span><span id="line-627"></span><span>
</span><span id="line-628"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Prerequisites"><span class="annot"><a href="Constrained.Base.html#Prerequisites"><span class="hs-identifier hs-var">Prerequisites</span></a></span></span><span> </span><span id="local-6989586621679180279"><span id="local-6989586621679180280"><span class="annot"><a href="#local-6989586621679180280"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679180279"><span class="hs-identifier hs-type">a</span></a></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-629"></span><span>
</span><span id="line-630"></span><span>  </span><span class="hs-comment">-- | Materialize the `Prerequisites` dictionary. It should not be necessary to</span><span>
</span><span id="line-631"></span><span>  </span><span class="hs-comment">-- implement this function manually.</span><span>
</span><span id="line-632"></span><span>  </span><span id="prerequisites"><span class="annot"><a href="Constrained.Base.html#prerequisites"><span class="hs-identifier hs-type">prerequisites</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Core.html#Evidence"><span class="hs-identifier hs-type">Evidence</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Prerequisites"><span class="hs-identifier hs-type">Prerequisites</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-633"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="prerequisites"><span class="annot"><a href="Constrained.Base.html#prerequisites"><span class="hs-identifier hs-type">prerequisites</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#Prerequisites"><span class="hs-identifier hs-type">Prerequisites</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Core.html#Evidence"><span class="hs-identifier hs-type">Evidence</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Prerequisites"><span class="hs-identifier hs-type">Prerequisites</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-634"></span><span>  </span><span id="local-6989586621679180276"><span class="annot"><a href="Constrained.Base.html#prerequisites"><span class="hs-identifier hs-var hs-var">prerequisites</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (c :: Constraint). c =&gt; Evidence c
</span><a href="Constrained.Core.html#Evidence"><span class="hs-identifier hs-var">Evidence</span></a></span></span><span>
</span><span id="line-635"></span><span>
</span><span id="line-636"></span><span>  </span><span class="hs-comment">{- NOTE: Below follows default implementations for the the functions in this
     class.  They are meant to provide an implementation of `HasSpec fn a` when
     `HasSimpleRep a` and `HasSpec fn (SimpleRep a)`. For example, for a
     newtype wrapper like `newtype Foo = Foo Word64` we can define `SimpleRep
     Foo = Word64` with the requisite instance for `HasSimpleRep` (all of which
     is derived from `Generic Foo`) and the instance for `HasSpec fn Foo` is
     essentially the same as the instance for `Word64`. This is achieved by
     ensuring that `TypeSpec fn Foo = TypeSpec fn Word64` (c.f. the default
     implementation of `TypeSpec` above). To this end, the implementations
     below simply convert the relevant things between `SimpleRep a` and `a`.
     For example, in the implementation of `combineSpec s s'` we treat `s` and
     `s'` (which have type `TypeSpec fn a`) as `TypeSpec fn (SimpleRep a)`,
     combine them, and go from the resulting `Spec fn (SimpleRep a)` to `Spec
     fn a` using `fromSimpleRepSpec`.
   -}</span><span>
</span><span id="line-651"></span><span>
</span><span id="line-652"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="emptySpec"><span class="annot"><a href="Constrained.Base.html#emptySpec"><span class="hs-identifier hs-type">emptySpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-653"></span><span>  </span><span id="local-6989586621679180272"><span class="annot"><a href="Constrained.Base.html#emptySpec"><span class="hs-identifier hs-var hs-var">emptySpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; TypeSpec fn a
</span><a href="Constrained.Base.html#emptySpec"><span class="hs-identifier hs-var">emptySpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-654"></span><span>
</span><span id="line-655"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="combineSpec"><span class="annot"><a href="Constrained.Base.html#combineSpec"><span class="hs-identifier hs-type">combineSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-656"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSimpleRep"><span class="hs-identifier hs-type">HasSimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-657"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-658"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-659"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-660"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-661"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-662"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-663"></span><span>  </span><span id="local-6989586621679180267"><span class="annot"><a href="Constrained.Base.html#combineSpec"><span class="hs-identifier hs-var hs-var">combineSpec</span></a></span><span> </span><span id="local-6989586621679180257"><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180257"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679180256"><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180256"><span class="hs-identifier hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, HasSimpleRep a,
 TypeSpec fn a ~ TypeSpec fn (SimpleRep a)) =&gt;
Spec fn (SimpleRep a) -&gt; Spec fn a
</span><a href="Constrained.Base.html#fromSimpleRepSpec"><span class="hs-identifier hs-var">fromSimpleRepSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#combineSpec"><span class="hs-identifier hs-var">combineSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180257"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180256"><span class="hs-identifier hs-var">s'</span></a></span></span><span>
</span><span id="line-664"></span><span>
</span><span id="line-665"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="genFromTypeSpec"><span class="annot"><a href="Constrained.Base.html#genFromTypeSpec"><span class="hs-identifier hs-type">genFromTypeSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-666"></span><span>    </span><span id="local-6989586621679183194"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSimpleRep"><span class="hs-identifier hs-type">HasSimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-667"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-668"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-669"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-670"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.GenT.html#MonadGenError"><span class="hs-identifier hs-type">MonadGenError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183194"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-671"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-672"></span><span>    </span><span class="annot"><a href="Constrained.GenT.html#GenT"><span class="hs-identifier hs-type">GenT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183194"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-673"></span><span>  </span><span id="local-6989586621679180254"><span class="annot"><a href="Constrained.Base.html#genFromTypeSpec"><span class="hs-identifier hs-var hs-var">genFromTypeSpec</span></a></span><span> </span><span id="local-6989586621679180237"><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180237"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasSimpleRep a =&gt; SimpleRep a -&gt; a
</span><a href="Constrained.Base.html#fromSimpleRep"><span class="hs-identifier hs-var">fromSimpleRep</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (m :: * -&gt; *).
(HasSpec fn a, HasCallStack, MonadGenError m) =&gt;
TypeSpec fn a -&gt; GenT m a
</span><a href="Constrained.Base.html#genFromTypeSpec"><span class="hs-identifier hs-var">genFromTypeSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180237"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-674"></span><span>
</span><span id="line-675"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="conformsTo"><span class="annot"><a href="Constrained.Base.html#conformsTo"><span class="hs-identifier hs-type">conformsTo</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-676"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSimpleRep"><span class="hs-identifier hs-type">HasSimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-677"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-678"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-679"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-680"></span><span>    </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-681"></span><span>    </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-682"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-683"></span><span>    </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-684"></span><span>  </span><span id="local-6989586621679180235"><span id="local-6989586621679180225"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180225"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#conformsTo"><span class="hs-operator hs-var hs-var">`conformsTo`</span></a></span><span> </span><span id="local-6989586621679180224"><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180224"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn a, HasCallStack) =&gt;
a -&gt; TypeSpec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsTo"><span class="hs-identifier hs-var">conformsTo</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HasSimpleRep a =&gt; a -&gt; SimpleRep a
</span><a href="Constrained.Base.html#toSimpleRep"><span class="hs-identifier hs-var">toSimpleRep</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180225"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180224"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-685"></span><span>
</span><span id="line-686"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="toPreds"><span class="annot"><a href="Constrained.Base.html#toPreds"><span class="hs-identifier hs-type">toPreds</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-687"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-688"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-689"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSimpleRep"><span class="hs-identifier hs-type">HasSimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-690"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-691"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-692"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183488"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-693"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183489"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-694"></span><span>  </span><span id="local-6989586621679180222"><span class="annot"><a href="Constrained.Base.html#toPreds"><span class="hs-identifier hs-var hs-var">toPreds</span></a></span><span> </span><span id="local-6989586621679180211"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679180211"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679180210"><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180210"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; TypeSpec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#toPreds"><span class="hs-identifier hs-var">toPreds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, HasSpec fn (SimpleRep a), HasSimpleRep a,
 TypeSpec fn a ~ TypeSpec fn (SimpleRep a)) =&gt;
Term fn a -&gt; Term fn (SimpleRep a)
</span><a href="Constrained.Base.html#toGeneric_"><span class="hs-identifier hs-var">toGeneric_</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679180211"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180210"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-695"></span><span>
</span><span id="line-696"></span><span class="hs-keyword">data</span><span> </span><span id="WithHasSpec"><span class="annot"><a href="Constrained.Base.html#WithHasSpec"><span class="hs-identifier hs-var">WithHasSpec</span></a></span></span><span> </span><span id="local-6989586621679180208"><span class="annot"><a href="#local-6989586621679180208"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679180207"><span class="annot"><a href="#local-6989586621679180207"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679180206"><span class="annot"><a href="#local-6989586621679180206"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-697"></span><span>  </span><span id="local-6989586621679183464"><span id="local-6989586621679183465"><span id="local-6989586621679183466"><span id="WithHasSpec"><span class="annot"><a href="Constrained.Base.html#WithHasSpec"><span class="hs-identifier hs-var">WithHasSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183466"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183465"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679183464"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183465"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#WithHasSpec"><span class="hs-identifier hs-type">WithHasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183466"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183464"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183465"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-698"></span><span>
</span><span id="line-699"></span><span class="hs-comment">-- The Forallable class ---------------------------------------------------</span><span>
</span><span id="line-700"></span><span>
</span><span id="line-701"></span><span class="hs-keyword">class</span><span> </span><span id="Forallable"><span class="annot"><a href="Constrained.Base.html#Forallable"><span class="hs-identifier hs-var">Forallable</span></a></span></span><span> </span><span id="local-6989586621679183303"><span class="annot"><a href="#local-6989586621679183303"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679183302"><span class="annot"><a href="#local-6989586621679183302"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679183303"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679183302"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-702"></span><span>  </span><span id="forAllSpec"><span class="annot"><a href="Constrained.Base.html#forAllSpec"><span class="hs-identifier hs-type">forAllSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679183184"><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183184"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183303"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183184"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183302"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183184"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183184"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183302"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183184"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183303"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-703"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="forAllSpec"><span class="annot"><a href="Constrained.Base.html#forAllSpec"><span class="hs-identifier hs-type">forAllSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-704"></span><span>    </span><span id="local-6989586621679183186"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183186"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183303"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-705"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183186"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183302"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-706"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSimpleRep"><span class="hs-identifier hs-type">HasSimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183303"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-707"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183186"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183303"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183186"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183303"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-708"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#Forallable"><span class="hs-identifier hs-type">Forallable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183303"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679183302"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-709"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183186"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183303"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-710"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-711"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183186"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183302"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-712"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183186"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183303"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-713"></span><span>  </span><span id="local-6989586621679180203"><span class="annot"><a href="Constrained.Base.html#forAllSpec"><span class="hs-identifier hs-var hs-var">forAllSpec</span></a></span><span> </span><span id="local-6989586621679180186"><span class="annot"><span class="annottext">Spec fn e
</span><a href="#local-6989586621679180186"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, HasSimpleRep a,
 TypeSpec fn a ~ TypeSpec fn (SimpleRep a)) =&gt;
Spec fn (SimpleRep a) -&gt; Spec fn a
</span><a href="Constrained.Base.html#fromSimpleRepSpec"><span class="hs-identifier hs-var">fromSimpleRepSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall t e (fn :: [*] -&gt; * -&gt; *).
(Forallable t e, HasSpec fn t, HasSpec fn e, BaseUniverse fn) =&gt;
Spec fn e -&gt; Spec fn t
</span><a href="Constrained.Base.html#forAllSpec"><span class="hs-identifier hs-var">forAllSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183303"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679183302"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn e
</span><a href="#local-6989586621679180186"><span class="hs-identifier hs-var">es</span></a></span></span><span>
</span><span id="line-714"></span><span>
</span><span id="line-715"></span><span>  </span><span id="forAllToList"><span class="annot"><a href="Constrained.Base.html#forAllToList"><span class="hs-identifier hs-type">forAllToList</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679183303"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679183302"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-716"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="forAllToList"><span class="annot"><a href="Constrained.Base.html#forAllToList"><span class="hs-identifier hs-type">forAllToList</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-717"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSimpleRep"><span class="hs-identifier hs-type">HasSimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183303"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-718"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#Forallable"><span class="hs-identifier hs-type">Forallable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183303"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679183302"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-719"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-720"></span><span>    </span><span class="annot"><a href="#local-6989586621679183303"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-721"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679183302"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-722"></span><span>  </span><span id="local-6989586621679180185"><span class="annot"><a href="Constrained.Base.html#forAllToList"><span class="hs-identifier hs-var hs-var">forAllToList</span></a></span><span> </span><span id="local-6989586621679180180"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679180180"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t e. Forallable t e =&gt; t -&gt; [e]
</span><a href="Constrained.Base.html#forAllToList"><span class="hs-identifier hs-var">forAllToList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HasSimpleRep a =&gt; a -&gt; SimpleRep a
</span><a href="Constrained.Base.html#toSimpleRep"><span class="hs-identifier hs-var">toSimpleRep</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679180180"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-723"></span><span>
</span><span id="line-724"></span><span class="hs-comment">-- The HasGenHint class ---------------------------------------------------</span><span>
</span><span id="line-725"></span><span>
</span><span id="line-726"></span><span class="hs-comment">-- | Hints are things that only affect generation, and not validation. For instance, parameters to</span><span>
</span><span id="line-727"></span><span class="hs-comment">--   control distribution of generated values.</span><span>
</span><span id="line-728"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183183"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183182"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Hint"><span class="hs-identifier hs-type">Hint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183182"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="HasGenHint"><span class="annot"><a href="Constrained.Base.html#HasGenHint"><span class="hs-identifier hs-var">HasGenHint</span></a></span></span><span> </span><span id="local-6989586621679183183"><span class="annot"><a href="#local-6989586621679183183"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679183182"><span class="annot"><a href="#local-6989586621679183182"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-729"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Hint"><span class="annot"><a href="Constrained.Base.html#Hint"><span class="hs-identifier hs-var">Hint</span></a></span></span><span> </span><span id="local-6989586621679183182"><span class="annot"><a href="#local-6989586621679183182"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-730"></span><span>  </span><span id="giveHint"><span class="annot"><a href="Constrained.Base.html#giveHint"><span class="hs-identifier hs-type">giveHint</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#Hint"><span class="hs-identifier hs-type">Hint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183182"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183183"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183182"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-731"></span><span>
</span><span id="line-732"></span><span class="hs-comment">-- Semantics of specs -----------------------------------------------------</span><span>
</span><span id="line-733"></span><span>
</span><span id="line-734"></span><span class="annot"><a href="Constrained.Base.html#conformsToSpecM"><span class="hs-identifier hs-type">conformsToSpecM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183180"><span class="annot"><a href="#local-6989586621679183180"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679183179"><span class="annot"><a href="#local-6989586621679183179"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679183178"><span class="annot"><a href="#local-6989586621679183178"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183180"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183179"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.GenT.html#MonadGenError"><span class="hs-identifier hs-type">MonadGenError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183178"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Alternative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183178"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679183179"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183180"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183179"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679183178"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-735"></span><span id="conformsToSpecM"><span class="annot"><span class="annottext">conformsToSpecM :: forall (fn :: [*] -&gt; * -&gt; *) a (m :: * -&gt; *).
(HasSpec fn a, MonadGenError m, Alternative m) =&gt;
a -&gt; Spec fn a -&gt; m ()
</span><a href="Constrained.Base.html#conformsToSpecM"><span class="hs-identifier hs-var hs-var">conformsToSpecM</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-736"></span><span class="annot"><a href="Constrained.Base.html#conformsToSpecM"><span class="hs-identifier hs-var">conformsToSpecM</span></a></span><span> </span><span id="local-6989586621679180147"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180147"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span id="local-6989586621679180146"><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679180146"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a -&gt; m a
</span><a href="Constrained.GenT.html#explain"><span class="hs-identifier hs-var">explain</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180147"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; not an element of &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679180146"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">elem</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180147"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679180146"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-737"></span><span class="annot"><a href="Constrained.Base.html#conformsToSpecM"><span class="hs-identifier hs-var">conformsToSpecM</span></a></span><span> </span><span id="local-6989586621679180144"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180144"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span id="local-6989586621679180136"><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180136"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679180135"><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679180135"><span class="hs-identifier hs-var">cant</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">notElem</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180144"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679180135"><span class="hs-identifier hs-var">cant</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn a, HasCallStack) =&gt;
a -&gt; TypeSpec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsTo"><span class="hs-identifier hs-var">conformsTo</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679183180"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180144"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180136"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-738"></span><span class="annot"><a href="Constrained.Base.html#conformsToSpecM"><span class="hs-identifier hs-var">conformsToSpecM</span></a></span><span> </span><span id="local-6989586621679180133"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180133"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-type">SuspendedSpec</span></a></span><span> </span><span id="local-6989586621679180125"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180125"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679180124"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180124"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (m :: * -&gt; *).
(FunctionLike fn, MonadGenError m) =&gt;
Env -&gt; Pred fn -&gt; m Bool
</span><a href="Constrained.Base.html#checkPred"><span class="hs-identifier hs-var">checkPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Typeable a, Show a) =&gt; Var a -&gt; a -&gt; Env
</span><a href="Constrained.Env.html#singletonEnv"><span class="hs-identifier hs-var">singletonEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180125"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180133"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180124"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-739"></span><span class="annot"><a href="Constrained.Base.html#conformsToSpecM"><span class="hs-identifier hs-var">conformsToSpecM</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span id="local-6989586621679180121"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679180121"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a -&gt; m a
</span><a href="Constrained.GenT.html#explain"><span class="hs-identifier hs-var">explain</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679180121"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-740"></span><span>
</span><span id="line-741"></span><span class="annot"><a href="Constrained.Base.html#conformsToSpecProp"><span class="hs-identifier hs-type">conformsToSpecProp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183165"><span class="annot"><a href="#local-6989586621679183165"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679183164"><span class="annot"><a href="#local-6989586621679183164"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183165"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183164"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679183164"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183165"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183164"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-a65fd1c4eb4ae76375c6e3f3845a1ba912285f018239b330ae730fef533366f9/share/doc/html/src"><span class="hs-identifier hs-type">Property</span></a></span><span>
</span><span id="line-742"></span><span id="conformsToSpecProp"><span class="annot"><span class="annottext">conformsToSpecProp :: forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Property
</span><a href="Constrained.Base.html#conformsToSpecProp"><span class="hs-identifier hs-var hs-var">conformsToSpecProp</span></a></span></span><span> </span><span id="local-6989586621679180112"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180112"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679180111"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679180111"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall p. Testable p =&gt; GE p -&gt; Property
</span><a href="Constrained.GenT.html#fromGEProp"><span class="hs-identifier hs-var">fromGEProp</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (m :: * -&gt; *).
(HasSpec fn a, MonadGenError m, Alternative m) =&gt;
a -&gt; Spec fn a -&gt; m ()
</span><a href="Constrained.Base.html#conformsToSpecM"><span class="hs-identifier hs-var">conformsToSpecM</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180112"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679180111"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-743"></span><span>
</span><span id="line-744"></span><span class="annot"><a href="Constrained.Base.html#conformsToSpec"><span class="hs-identifier hs-type">conformsToSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183251"><span class="annot"><a href="#local-6989586621679183251"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679183250"><span class="annot"><a href="#local-6989586621679183250"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183251"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183250"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679183250"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183251"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183250"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-745"></span><span id="conformsToSpec"><span class="annot"><span class="annottext">conformsToSpec :: forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-identifier hs-var hs-var">conformsToSpec</span></a></span></span><span> </span><span id="local-6989586621679180105"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180105"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679180104"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679180104"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. GE a -&gt; Bool
</span><a href="Constrained.GenT.html#isOk"><span class="hs-identifier hs-var">isOk</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (m :: * -&gt; *).
(HasSpec fn a, MonadGenError m, Alternative m) =&gt;
a -&gt; Spec fn a -&gt; m ()
</span><a href="Constrained.Base.html#conformsToSpecM"><span class="hs-identifier hs-var">conformsToSpecM</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180105"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679180104"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-746"></span><span>
</span><span id="line-747"></span><span class="annot"><a href="Constrained.Base.html#satisfies"><span class="hs-identifier hs-type">satisfies</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183228"><span class="annot"><a href="#local-6989586621679183228"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679183227"><span class="annot"><a href="#local-6989586621679183227"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183228"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183227"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183228"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183227"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183228"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183227"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183228"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-748"></span><span id="satisfies"><span class="annot"><span class="annottext">satisfies :: forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Spec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#satisfies"><span class="hs-identifier hs-var hs-var">satisfies</span></a></span></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span>
</span><span id="line-749"></span><span class="annot"><a href="Constrained.Base.html#satisfies"><span class="hs-identifier hs-var">satisfies</span></a></span><span> </span><span id="local-6989586621679180092"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679180092"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span id="local-6989586621679180091"><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679180091"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
[String] -&gt; Term fn Bool -&gt; Pred fn
</span><a href="Constrained.Base.html#Assert"><span class="hs-identifier hs-var">Assert</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679180092"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; `elem` &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679180091"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
HasSpec fn a =&gt;
Term fn a -&gt; Term fn [a] -&gt; Term fn Bool
</span><a href="Constrained.Base.html#elem_"><span class="hs-identifier hs-var">elem_</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679180092"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679180091"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-750"></span><span class="annot"><a href="Constrained.Base.html#satisfies"><span class="hs-identifier hs-var">satisfies</span></a></span><span> </span><span id="local-6989586621679180089"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679180089"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-type">SuspendedSpec</span></a></span><span> </span><span id="local-6989586621679180086"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180086"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679180085"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180085"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#Subst"><span class="hs-identifier hs-var">Subst</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180086"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679180089"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180085"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-751"></span><span class="annot"><a href="Constrained.Base.html#satisfies"><span class="hs-identifier hs-var">satisfies</span></a></span><span> </span><span id="local-6989586621679180084"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679180084"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span id="local-6989586621679180071"><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180071"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679180070"><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679180070"><span class="hs-identifier hs-var">cant</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-752"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679180070"><span class="hs-identifier hs-var">cant</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; TypeSpec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#toPreds"><span class="hs-identifier hs-var">toPreds</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679180084"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180071"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-753"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
[String] -&gt; Term fn Bool -&gt; Pred fn
</span><a href="Constrained.Base.html#Assert"><span class="hs-identifier hs-var">Assert</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679180084"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; `notElem` &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679180070"><span class="hs-identifier hs-var">cant</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
Term fn Bool -&gt; Term fn Bool
</span><a href="Constrained.Base.html#not_"><span class="hs-identifier hs-var">not_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
HasSpec fn a =&gt;
Term fn a -&gt; Term fn [a] -&gt; Term fn Bool
</span><a href="Constrained.Base.html#elem_"><span class="hs-identifier hs-var">elem_</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679180084"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679180070"><span class="hs-identifier hs-var">cant</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; TypeSpec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#toPreds"><span class="hs-identifier hs-var">toPreds</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679180084"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180071"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-754"></span><span class="annot"><a href="Constrained.Base.html#satisfies"><span class="hs-identifier hs-var">satisfies</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span id="local-6989586621679180067"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679180067"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). [String] -&gt; Pred fn
</span><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-var">FalsePred</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679180067"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-755"></span><span>
</span><span id="line-756"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-757"></span><span class="hs-comment">-- Generating things</span><span>
</span><span id="line-758"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-759"></span><span>
</span><span id="line-760"></span><span class="hs-comment">-- Generating things from specs -------------------------------------------</span><span>
</span><span id="line-761"></span><span>
</span><span id="line-762"></span><span class="hs-comment">-- | Generate a value that satisfies the spec. This function can fail if the</span><span>
</span><span id="line-763"></span><span class="hs-comment">-- spec is inconsistent, there is a dependency error, or if the underlying</span><span>
</span><span id="line-764"></span><span class="hs-comment">-- generators are not flexible enough.</span><span>
</span><span id="line-765"></span><span class="annot"><a href="Constrained.Base.html#genFromSpec"><span class="hs-identifier hs-type">genFromSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183146"><span class="annot"><a href="#local-6989586621679183146"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679183145"><span class="annot"><a href="#local-6989586621679183145"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679183144"><span class="annot"><a href="#local-6989586621679183144"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183146"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183145"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.GenT.html#MonadGenError"><span class="hs-identifier hs-type">MonadGenError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183144"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183146"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183145"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.GenT.html#GenT"><span class="hs-identifier hs-type">GenT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183144"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183145"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-766"></span><span id="genFromSpec"><span class="annot"><span class="annottext">genFromSpec :: forall (fn :: [*] -&gt; * -&gt; *) a (m :: * -&gt; *).
(HasCallStack, HasSpec fn a, MonadGenError m) =&gt;
Spec fn a -&gt; GenT m a
</span><a href="Constrained.Base.html#genFromSpec"><span class="hs-identifier hs-var hs-var">genFromSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (m :: * -&gt; *).
(HasCallStack, HasSpec fn a, MonadGenError m) =&gt;
Spec fn a -&gt; GenT m a
</span><a href="Constrained.Base.html#genFromSpec"><span class="hs-identifier hs-var">genFromSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679183146"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; TypeSpec fn a
</span><a href="Constrained.Base.html#emptySpec"><span class="hs-identifier hs-var">emptySpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679183146"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679183145"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-767"></span><span class="annot"><a href="Constrained.Base.html#genFromSpec"><span class="hs-identifier hs-var">genFromSpec</span></a></span><span> </span><span id="local-6989586621679180036"><span class="annot"><span class="annottext">spec :: Spec fn a
</span><a href="#local-6989586621679180036"><span class="hs-identifier hs-var">spec</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span id="local-6989586621679180035"><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679180035"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-768"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679180035"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a
</span><a href="Constrained.GenT.html#genError"><span class="hs-identifier hs-var">genError</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;MemberSpec {}&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-769"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a -&gt; m a
</span><a href="Constrained.GenT.html#explain"><span class="hs-identifier hs-var">explain</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genFromSpec &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679180036"><span class="hs-identifier hs-var">spec</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Applicative m =&gt; Gen a -&gt; GenT m a
</span><a href="Constrained.GenT.html#pureGen"><span class="hs-identifier hs-var">pureGen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-a65fd1c4eb4ae76375c6e3f3845a1ba912285f018239b330ae730fef533366f9/share/doc/html/src"><span class="hs-identifier hs-var">elements</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679180035"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-770"></span><span class="annot"><a href="Constrained.Base.html#genFromSpec"><span class="hs-identifier hs-var">genFromSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-type">SuspendedSpec</span></a></span><span> </span><span id="local-6989586621679180024"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180024"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679180023"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180023"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-771"></span><span>  </span><span id="local-6989586621679180022"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679180022"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *).
(MonadGenError m, BaseUniverse fn) =&gt;
Pred fn -&gt; GenT m Env
</span><a href="Constrained.Base.html#genFromPreds"><span class="hs-identifier hs-var">genFromPreds</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679180023"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-772"></span><span>  </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(Typeable a, MonadGenError m) =&gt;
Env -&gt; Var a -&gt; m a
</span><a href="Constrained.Env.html#findEnv"><span class="hs-identifier hs-var">findEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679180022"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679180024"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-773"></span><span class="annot"><a href="Constrained.Base.html#genFromSpec"><span class="hs-identifier hs-var">genFromSpec</span></a></span><span> </span><span id="local-6989586621679180020"><span class="annot"><span class="annottext">ts :: Spec fn a
</span><a href="#local-6989586621679180020"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span id="local-6989586621679180002"><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180002"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679180001"><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679180001"><span class="hs-identifier hs-var">cant</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-774"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a -&gt; m a
</span><a href="Constrained.GenT.html#explain"><span class="hs-identifier hs-var">explain</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genFromSpec&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;    &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (proxy :: k -&gt; *) (a :: k).
Typeable a =&gt;
proxy a -&gt; TypeRep
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">typeRep</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679180001"><span class="hs-identifier hs-var">cant</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;    &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679180020"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-775"></span><span>    </span><span class="hs-comment">-- TODO: we could consider giving `cant` as an argument to `genFromTypeSpec` if this</span><span>
</span><span id="line-776"></span><span>    </span><span class="hs-comment">-- starts giving us trouble.</span><span>
</span><span id="line-777"></span><span>    </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (m :: * -&gt; *).
(HasSpec fn a, HasCallStack, MonadGenError m) =&gt;
TypeSpec fn a -&gt; GenT m a
</span><a href="Constrained.Base.html#genFromTypeSpec"><span class="hs-identifier hs-var">genFromTypeSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679183146"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679180002"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
MonadGenError m =&gt;
GenT m a -&gt; (a -&gt; Bool) -&gt; GenT m a
</span><a href="Constrained.GenT.html#suchThatT"><span class="hs-operator hs-var">`suchThatT`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`notElem`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679180001"><span class="hs-identifier hs-var">cant</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-778"></span><span class="annot"><a href="Constrained.Base.html#genFromSpec"><span class="hs-identifier hs-var">genFromSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span id="local-6989586621679179998"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679179998"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a
</span><a href="Constrained.GenT.html#genError"><span class="hs-identifier hs-var">genError</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679179998"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-779"></span><span>
</span><span id="line-780"></span><span class="hs-comment">-- | A version of `genFromSpec` that simply errors if the generator fails</span><span>
</span><span id="line-781"></span><span class="annot"><a href="Constrained.Base.html#genFromSpec_"><span class="hs-identifier hs-type">genFromSpec_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183126"><span class="annot"><a href="#local-6989586621679183126"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679183125"><span class="annot"><a href="#local-6989586621679183125"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183126"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183125"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183126"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183125"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-a65fd1c4eb4ae76375c6e3f3845a1ba912285f018239b330ae730fef533366f9/share/doc/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183125"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-782"></span><span id="genFromSpec_"><span class="annot"><span class="annottext">genFromSpec_ :: forall (fn :: [*] -&gt; * -&gt; *) a.
(HasCallStack, HasSpec fn a) =&gt;
Spec fn a -&gt; Gen a
</span><a href="Constrained.Base.html#genFromSpec_"><span class="hs-identifier hs-var hs-var">genFromSpec_</span></a></span></span><span> </span><span id="local-6989586621679179984"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679179984"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-783"></span><span>  </span><span id="local-6989586621679179983"><span class="annot"><span class="annottext">GE a
</span><a href="#local-6989586621679179983"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. GenT m a -&gt; Gen (m a)
</span><a href="Constrained.GenT.html#strictGen"><span class="hs-identifier hs-var">strictGen</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (m :: * -&gt; *).
(HasCallStack, HasSpec fn a, MonadGenError m) =&gt;
Spec fn a -&gt; GenT m a
</span><a href="Constrained.Base.html#genFromSpec"><span class="hs-identifier hs-var">genFromSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679179984"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-784"></span><span>  </span><span class="annot"><span class="annottext">forall a. GE a -&gt; a
</span><a href="Constrained.GenT.html#errorGE"><span class="hs-identifier hs-var">errorGE</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">GE a
</span><a href="#local-6989586621679179983"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-785"></span><span>
</span><span id="line-786"></span><span id="local-6989586621679183117"><span id="local-6989586621679183118"><span id="local-6989586621679183119"><span id="local-6989586621679183120"><span class="annot"><a href="Constrained.Base.html#genInverse"><span class="hs-identifier hs-type">genInverse</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-787"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.GenT.html#MonadGenError"><span class="hs-identifier hs-type">MonadGenError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183120"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-788"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183119"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183118"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-789"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183117"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-790"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#Functions"><span class="hs-identifier hs-type">Functions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183119"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183119"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-791"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-792"></span><span>  </span><span class="annot"><a href="#local-6989586621679183119"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679183118"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679183117"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-793"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183119"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183118"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-794"></span><span>  </span><span class="annot"><a href="#local-6989586621679183117"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-795"></span><span>  </span><span class="annot"><a href="Constrained.GenT.html#GenT"><span class="hs-identifier hs-type">GenT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183120"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183118"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span><span>
</span><span id="line-796"></span><span id="genInverse"><span class="annot"><span class="annottext">genInverse :: forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *) a b.
(MonadGenError m, HasSpec fn a, Show b, Functions fn fn) =&gt;
fn '[a] b -&gt; Spec fn a -&gt; b -&gt; GenT m a
</span><a href="Constrained.Base.html#genInverse"><span class="hs-identifier hs-var hs-var">genInverse</span></a></span></span><span> </span><span id="local-6989586621679179935"><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679179935"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679179934"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679179934"><span class="hs-identifier hs-var">argS</span></a></span></span><span> </span><span id="local-6989586621679179933"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679179933"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-797"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679179932"><span class="annot"><span class="annottext">argSpec' :: Spec fn a
</span><a href="#local-6989586621679179932"><span class="hs-identifier hs-var hs-var">argSpec'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679179934"><span class="hs-identifier hs-var">argS</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: [*] -&gt; * -&gt; *) (fn :: [*] -&gt; * -&gt; *) (as :: [*]) a b.
(Functions f fn, TypeList as, Typeable as, HasSpec fn a,
 All (HasSpec fn) as) =&gt;
f as b -&gt; ListCtx Value as (HOLE a) -&gt; Spec fn b -&gt; Spec fn a
</span><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var">propagateSpecFun</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679179935"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (c :: * -&gt; *) a (f :: * -&gt; *). c a -&gt; ListCtx f '[a] c
</span><a href="Constrained.List.html#NilCtx"><span class="hs-identifier hs-var">NilCtx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). a -&gt; Spec fn a
</span><a href="Constrained.Base.html#equalSpec"><span class="hs-identifier hs-var">equalSpec</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679179933"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-798"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a -&gt; m a
</span><a href="Constrained.GenT.html#explain"><span class="hs-identifier hs-var">explain</span></a></span><span>
</span><span id="line-799"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genInverse&quot;</span></span><span>
</span><span id="line-800"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  f = &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679179935"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-801"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any
</span><span class="hs-string">&quot;  argS =&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679179934"><span class="hs-identifier hs-var">argS</span></a></span><span>
</span><span id="line-802"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  x = &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679179933"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-803"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any
</span><span class="hs-string">&quot;  argSpec' =&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679179932"><span class="hs-identifier hs-var">argSpec'</span></a></span><span>
</span><span id="line-804"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-805"></span><span>        </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (m :: * -&gt; *).
(HasCallStack, HasSpec fn a, MonadGenError m) =&gt;
Spec fn a -&gt; GenT m a
</span><a href="Constrained.Base.html#genFromSpec"><span class="hs-identifier hs-var">genFromSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679179932"><span class="hs-identifier hs-var">argSpec'</span></a></span><span>
</span><span id="line-806"></span><span>
</span><span id="line-807"></span><span class="hs-comment">-- Generating things from predicates --------------------------------------</span><span>
</span><span id="line-808"></span><span>
</span><span id="line-809"></span><span class="hs-comment">-- | Flatten nested `Let`, `Exists`, and `Block` in a `Pred fn`. `Let` and</span><span>
</span><span id="line-810"></span><span class="hs-comment">-- `Exists` bound variables become free in the result.</span><span>
</span><span id="line-811"></span><span class="annot"><a href="Constrained.Base.html#flattenPred"><span class="hs-identifier hs-type">flattenPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183096"><span class="annot"><a href="#local-6989586621679183096"><span class="hs-identifier hs-type">fn</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183096"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183096"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183096"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-812"></span><span id="flattenPred"><span class="annot"><span class="annottext">flattenPred :: forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
Pred fn -&gt; [Pred fn]
</span><a href="Constrained.Base.html#flattenPred"><span class="hs-identifier hs-var hs-var">flattenPred</span></a></span></span><span> </span><span id="local-6989586621679179919"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179919"><span class="hs-identifier hs-var">pIn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Int -&gt; [Pred fn] -&gt; [Pred fn]
</span><a href="#local-6989586621679179918"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) t. HasVariables fn t =&gt; t -&gt; Set Int
</span><a href="Constrained.Base.html#freeVarNames"><span class="hs-identifier hs-var">freeVarNames</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179919"><span class="hs-identifier hs-var">pIn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179919"><span class="hs-identifier hs-var">pIn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-813"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-814"></span><span>    </span><span id="local-6989586621679179918"><span class="annot"><span class="annottext">go :: Set Int -&gt; [Pred fn] -&gt; [Pred fn]
</span><a href="#local-6989586621679179918"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">Set Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-815"></span><span>    </span><span class="annot"><a href="#local-6989586621679179918"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679179916"><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679179916"><span class="hs-identifier hs-var">fvs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679179915"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179915"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679179914"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679179914"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179915"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-816"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span id="local-6989586621679179913"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679179913"><span class="hs-identifier hs-var">ps'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Int -&gt; [Pred fn] -&gt; [Pred fn]
</span><a href="#local-6989586621679179918"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679179916"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679179913"><span class="hs-identifier hs-var">ps'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679179914"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-817"></span><span>      </span><span class="hs-comment">-- NOTE: the order of the arguments to `==.` here are important.</span><span>
</span><span id="line-818"></span><span>      </span><span class="hs-comment">-- The whole point of `Let` is that it allows us to solve all of `t`</span><span>
</span><span id="line-819"></span><span>      </span><span class="hs-comment">-- before we solve the variables in `t`.</span><span>
</span><span id="line-820"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span id="local-6989586621679179912"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179912"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679179911"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679179911"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a.
Set Int
-&gt; Binder fn a
-&gt; [Pred fn]
-&gt; (HasSpec fn a =&gt; Var a -&gt; [Pred fn] -&gt; [Pred fn])
-&gt; [Pred fn]
</span><a href="#local-6989586621679179910"><span class="hs-identifier hs-var">goBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679179916"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679179911"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679179914"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679179900"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179900"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
p -&gt; Pred fn
</span><a href="Constrained.Base.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179912"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Term fn a -&gt; Term fn Bool
</span><a href="Constrained.Base.html#%3D%3D."><span class="hs-operator hs-var">==.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; Var a -&gt; Term fn a
</span><a href="Constrained.Base.html#V"><span class="hs-identifier hs-var">V</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179900"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-821"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#Exists"><span class="hs-identifier hs-type">Exists</span></a></span><span> </span><span class="annot"><span class="annottext">(forall b. Term fn b -&gt; b) -&gt; GE a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679179897"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679179897"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a.
Set Int
-&gt; Binder fn a
-&gt; [Pred fn]
-&gt; (HasSpec fn a =&gt; Var a -&gt; [Pred fn] -&gt; [Pred fn])
-&gt; [Pred fn]
</span><a href="#local-6989586621679179910"><span class="hs-identifier hs-var">goBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679179916"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679179897"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679179914"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-822"></span><span>      </span><span class="annot"><span class="annottext">Pred fn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179915"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Set Int -&gt; [Pred fn] -&gt; [Pred fn]
</span><a href="#local-6989586621679179918"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) t. HasVariables fn t =&gt; t -&gt; Set Int
</span><a href="Constrained.Base.html#freeVarNames"><span class="hs-identifier hs-var">freeVarNames</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179915"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679179916"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679179914"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-823"></span><span>
</span><span id="line-824"></span><span>    </span><span id="local-6989586621679183088"><span class="annot"><a href="#local-6989586621679179910"><span class="hs-identifier hs-type">goBinder</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-825"></span><span>      </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-826"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183096"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183088"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-827"></span><span>      </span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183096"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-828"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183096"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183088"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183088"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183096"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183096"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-829"></span><span>      </span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183096"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-830"></span><span>    </span><span id="local-6989586621679179910"><span class="annot"><span class="annottext">goBinder :: forall a.
Set Int
-&gt; Binder fn a
-&gt; [Pred fn]
-&gt; (HasSpec fn a =&gt; Var a -&gt; [Pred fn] -&gt; [Pred fn])
-&gt; [Pred fn]
</span><a href="#local-6989586621679179910"><span class="hs-identifier hs-var hs-var">goBinder</span></a></span></span><span> </span><span id="local-6989586621679179894"><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679179894"><span class="hs-identifier hs-var">fvs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679179887"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179887"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679179886"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179886"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679179885"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679179885"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679179884"><span class="annot"><span class="annottext">HasSpec fn a =&gt; Var a -&gt; [Pred fn] -&gt; [Pred fn]
</span><a href="#local-6989586621679179884"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasSpec fn a =&gt; Var a -&gt; [Pred fn] -&gt; [Pred fn]
</span><a href="#local-6989586621679179884"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179883"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Set Int -&gt; [Pred fn] -&gt; [Pred fn]
</span><a href="#local-6989586621679179918"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.insert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Var a -&gt; Int
</span><a href="Constrained.Core.html#nameOf"><span class="hs-identifier hs-var">nameOf</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179883"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679179894"><span class="hs-identifier hs-var">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179880"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679179885"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-831"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-832"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679179883"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179883"><span class="hs-identifier hs-var">x'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679179880"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179880"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a t.
(Typeable a, Rename t) =&gt;
Var a -&gt; t -&gt; Set Int -&gt; (Var a, t)
</span><a href="Constrained.Core.html#freshen"><span class="hs-identifier hs-var">freshen</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179887"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179886"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679179894"><span class="hs-identifier hs-var">fvs</span></a></span><span>
</span><span id="line-833"></span><span>
</span><span id="line-834"></span><span class="annot"><a href="Constrained.Base.html#computeDependencies"><span class="hs-identifier hs-type">computeDependencies</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183074"><span class="annot"><a href="#local-6989586621679183074"><span class="hs-identifier hs-type">fn</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.Base.html#Hints"><span class="hs-identifier hs-type">Hints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183074"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183074"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#DependGraph"><span class="hs-identifier hs-type">DependGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183074"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-835"></span><span id="computeDependencies"><span class="annot"><span class="annottext">computeDependencies :: forall (fn :: [*] -&gt; * -&gt; *). Hints fn -&gt; Pred fn -&gt; Hints fn
</span><a href="Constrained.Base.html#computeDependencies"><span class="hs-identifier hs-var hs-var">computeDependencies</span></a></span></span><span> </span><span id="local-6989586621679179871"><span class="annot"><span class="annottext">DependGraph fn
</span><a href="#local-6989586621679179871"><span class="hs-identifier hs-var">hints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-836"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: [*] -&gt; * -&gt; *). Hints f -&gt; Hints f -&gt; Hints f
</span><a href="Constrained.Base.html#respecting"><span class="hs-identifier hs-var">respecting</span></a></span><span> </span><span class="annot"><span class="annottext">DependGraph fn
</span><a href="#local-6989586621679179871"><span class="hs-identifier hs-var">hints</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-837"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span id="local-6989586621679179867"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179867"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679179866"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179866"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679179865"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179865"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Hints fn -&gt; Pred fn -&gt; Hints fn
</span><a href="Constrained.Base.html#computeDependencies"><span class="hs-identifier hs-var">computeDependencies</span></a></span><span> </span><span class="annot"><span class="annottext">DependGraph fn
</span><a href="#local-6989586621679179871"><span class="hs-identifier hs-var">hints</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#substitutePred"><span class="hs-identifier hs-var">substitutePred</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179867"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179866"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179865"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-838"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Assert"><span class="hs-identifier hs-type">Assert</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679179863"><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679179863"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; DependGraph fn
</span><a href="Constrained.Base.html#computeTermDependencies"><span class="hs-identifier hs-var">computeTermDependencies</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679179863"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-839"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Reify"><span class="hs-identifier hs-type">Reify</span></a></span><span> </span><span id="local-6989586621679179853"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179853"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679179852"><span class="annot"><span class="annottext">Binder fn b
</span><a href="#local-6989586621679179852"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-840"></span><span>      </span><span class="annot"><span class="annottext">Binder fn b
</span><a href="#local-6989586621679179852"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) t t'.
(HasVariables fn t, HasVariables fn t') =&gt;
t -&gt; t' -&gt; DependGraph fn
</span><a href="Constrained.Base.html#irreflexiveDependencyOn"><span class="hs-operator hs-var">`irreflexiveDependencyOn`</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179853"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-841"></span><span>        </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Hints fn -&gt; Binder fn a -&gt; Hints fn
</span><a href="Constrained.Base.html#computeBinderDependencies"><span class="hs-identifier hs-var">computeBinderDependencies</span></a></span><span> </span><span class="annot"><span class="annottext">DependGraph fn
</span><a href="#local-6989586621679179871"><span class="hs-identifier hs-var">hints</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn b
</span><a href="#local-6989586621679179852"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-842"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#ForAll"><span class="hs-identifier hs-type">ForAll</span></a></span><span> </span><span id="local-6989586621679179843"><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679179843"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span id="local-6989586621679179842"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679179842"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-843"></span><span>      </span><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679179843"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) t t'.
(HasVariables fn t, HasVariables fn t') =&gt;
t -&gt; t' -&gt; DependGraph fn
</span><a href="Constrained.Base.html#irreflexiveDependencyOn"><span class="hs-operator hs-var">`irreflexiveDependencyOn`</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679179842"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-844"></span><span>        </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Hints fn -&gt; Binder fn a -&gt; Hints fn
</span><a href="Constrained.Base.html#computeBinderDependencies"><span class="hs-identifier hs-var">computeBinderDependencies</span></a></span><span> </span><span class="annot"><span class="annottext">DependGraph fn
</span><a href="#local-6989586621679179871"><span class="hs-identifier hs-var">hints</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679179842"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-845"></span><span>    </span><span id="local-6989586621679179837"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179837"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#DependsOn"><span class="hs-operator hs-type">`DependsOn`</span></a></span><span> </span><span id="local-6989586621679179836"><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679179836"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179837"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) t t'.
(HasVariables fn t, HasVariables fn t') =&gt;
t -&gt; t' -&gt; DependGraph fn
</span><a href="Constrained.Base.html#irreflexiveDependencyOn"><span class="hs-operator hs-var">`irreflexiveDependencyOn`</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679179836"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-846"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Case"><span class="hs-identifier hs-type">Case</span></a></span><span> </span><span id="local-6989586621679179829"><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679179829"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679179828"><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679179828"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-847"></span><span>      </span><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679179829"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) t t'.
(HasVariables fn t, HasVariables fn t') =&gt;
t -&gt; t' -&gt; DependGraph fn
</span><a href="Constrained.Base.html#irreflexiveDependencyOn"><span class="hs-operator hs-var">`irreflexiveDependencyOn`</span></a></span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679179828"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-848"></span><span>        </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} b (f :: k -&gt; *) (as :: [k]).
Monoid b =&gt;
(forall (a :: k). f a -&gt; b) -&gt; List f as -&gt; b
</span><a href="Constrained.List.html#foldMapList"><span class="hs-identifier hs-var">foldMapList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Hints fn -&gt; Binder fn a -&gt; Hints fn
</span><a href="Constrained.Base.html#computeBinderDependencies"><span class="hs-identifier hs-var">computeBinderDependencies</span></a></span><span> </span><span class="annot"><span class="annottext">DependGraph fn
</span><a href="#local-6989586621679179871"><span class="hs-identifier hs-var">hints</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679179828"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-849"></span><span>    </span><span class="annot"><span class="annottext">Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-850"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-type">FalsePred</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-851"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span id="local-6989586621679179826"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679179826"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Hints fn -&gt; Pred fn -&gt; Hints fn
</span><a href="Constrained.Base.html#computeDependencies"><span class="hs-identifier hs-var">computeDependencies</span></a></span><span> </span><span class="annot"><span class="annottext">DependGraph fn
</span><a href="#local-6989586621679179871"><span class="hs-identifier hs-var">hints</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679179826"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-852"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Exists"><span class="hs-identifier hs-type">Exists</span></a></span><span> </span><span class="annot"><span class="annottext">(forall b. Term fn b -&gt; b) -&gt; GE a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679179824"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679179824"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Hints fn -&gt; Binder fn a -&gt; Hints fn
</span><a href="Constrained.Base.html#computeBinderDependencies"><span class="hs-identifier hs-var">computeBinderDependencies</span></a></span><span> </span><span class="annot"><span class="annottext">DependGraph fn
</span><a href="#local-6989586621679179871"><span class="hs-identifier hs-var">hints</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679179824"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-853"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span id="local-6989586621679179821"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179821"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679179820"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679179820"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) t.
HasVariables fn t =&gt;
t -&gt; DependGraph fn
</span><a href="Constrained.Base.html#noDependencies"><span class="hs-identifier hs-var">noDependencies</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179821"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Hints fn -&gt; Binder fn a -&gt; Hints fn
</span><a href="Constrained.Base.html#computeBinderDependencies"><span class="hs-identifier hs-var">computeBinderDependencies</span></a></span><span> </span><span class="annot"><span class="annottext">DependGraph fn
</span><a href="#local-6989586621679179871"><span class="hs-identifier hs-var">hints</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679179820"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-854"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#GenHint"><span class="hs-identifier hs-type">GenHint</span></a></span><span> </span><span class="annot"><span class="annottext">Hint a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679179816"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179816"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) t.
HasVariables fn t =&gt;
t -&gt; DependGraph fn
</span><a href="Constrained.Base.html#noDependencies"><span class="hs-identifier hs-var">noDependencies</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179816"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-855"></span><span>
</span><span id="line-856"></span><span class="hs-comment">-- | Linearize a predicate, turning it into a list of variables to solve and</span><span>
</span><span id="line-857"></span><span class="hs-comment">-- their defining constraints such that each variable can be solved independently.</span><span>
</span><span id="line-858"></span><span id="local-6989586621679183032"><span class="annot"><a href="Constrained.Base.html#prepareLinearization"><span class="hs-identifier hs-type">prepareLinearization</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183032"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183032"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.GenT.html#GE"><span class="hs-identifier hs-type">GE</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183032"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183032"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-859"></span><span id="prepareLinearization"><span class="annot"><span class="annottext">prepareLinearization :: forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
Pred fn -&gt; GE [(Name fn, [Pred fn])]
</span><a href="Constrained.Base.html#prepareLinearization"><span class="hs-identifier hs-var hs-var">prepareLinearization</span></a></span></span><span> </span><span id="local-6989586621679179806"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179806"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-860"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679179805"><span class="annot"><span class="annottext">preds :: [Pred fn]
</span><a href="#local-6989586621679179805"><span class="hs-identifier hs-var hs-var">preds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
Pred fn -&gt; [Pred fn]
</span><a href="Constrained.Base.html#flattenPred"><span class="hs-identifier hs-var">flattenPred</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179806"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-861"></span><span>      </span><span id="local-6989586621679179804"><span class="annot"><span class="annottext">hints :: Hints fn
</span><a href="#local-6989586621679179804"><span class="hs-identifier hs-var hs-var">hints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). [Pred fn] -&gt; Hints fn
</span><a href="Constrained.Base.html#computeHints"><span class="hs-identifier hs-var">computeHints</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679179805"><span class="hs-identifier hs-var">preds</span></a></span><span>
</span><span id="line-862"></span><span>      </span><span id="local-6989586621679179802"><span class="annot"><span class="annottext">graph :: Hints fn
</span><a href="#local-6989586621679179802"><span class="hs-identifier hs-var hs-var">graph</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall node. Ord node =&gt; Graph node -&gt; Graph node
</span><a href="Constrained.Graph.html#transitiveClosure"><span class="hs-identifier hs-var">transitiveClosure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Hints fn
</span><a href="#local-6989586621679179804"><span class="hs-identifier hs-var">hints</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Hints fn -&gt; Pred fn -&gt; Hints fn
</span><a href="Constrained.Base.html#computeDependencies"><span class="hs-identifier hs-var">computeDependencies</span></a></span><span> </span><span class="annot"><span class="annottext">Hints fn
</span><a href="#local-6989586621679179804"><span class="hs-identifier hs-var">hints</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679179805"><span class="hs-identifier hs-var">preds</span></a></span><span>
</span><span id="line-863"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *).
(MonadGenError m, BaseUniverse fn) =&gt;
[Pred fn] -&gt; DependGraph fn -&gt; m [(Name fn, [Pred fn])]
</span><a href="Constrained.Base.html#linearize"><span class="hs-identifier hs-var">linearize</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679179805"><span class="hs-identifier hs-var">preds</span></a></span><span> </span><span class="annot"><span class="annottext">Hints fn
</span><a href="#local-6989586621679179802"><span class="hs-identifier hs-var">graph</span></a></span><span>
</span><span id="line-864"></span><span>
</span><span id="line-865"></span><span class="hs-comment">-- | Generate a satisfying `Env` for a `p : Pred fn`. The `Env` contains values for</span><span>
</span><span id="line-866"></span><span class="hs-comment">-- all the free variables in `flattenPred p`.</span><span>
</span><span id="line-867"></span><span id="local-6989586621679183133"><span id="local-6989586621679183134"><span class="annot"><a href="Constrained.Base.html#genFromPreds"><span class="hs-identifier hs-type">genFromPreds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.GenT.html#MonadGenError"><span class="hs-identifier hs-type">MonadGenError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183134"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183133"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183133"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.GenT.html#GenT"><span class="hs-identifier hs-type">GenT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183134"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Constrained.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span></span></span><span>
</span><span id="line-868"></span><span id="genFromPreds"><span class="annot"><span class="annottext">genFromPreds :: forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *).
(MonadGenError m, BaseUniverse fn) =&gt;
Pred fn -&gt; GenT m Env
</span><a href="Constrained.Base.html#genFromPreds"><span class="hs-identifier hs-var hs-var">genFromPreds</span></a></span></span><span> </span><span id="local-6989586621679179789"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179789"><span class="hs-identifier hs-var">preds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-869"></span><span>  </span><span class="hs-comment">-- NOTE: this is just lazy enough that the work of flattening, computing dependencies,</span><span>
</span><span id="line-870"></span><span>  </span><span class="hs-comment">-- and linearizing is memoized in properties that use `genFromPreds`.</span><span>
</span><span id="line-871"></span><span>  </span><span id="local-6989586621679179788"><span class="annot"><span class="annottext">[(Name fn, [Pred fn])]
</span><a href="#local-6989586621679179788"><span class="hs-identifier hs-var">linear</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r. MonadGenError m =&gt; GE r -&gt; m r
</span><a href="Constrained.GenT.html#runGE"><span class="hs-identifier hs-var">runGE</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
Pred fn -&gt; GE [(Name fn, [Pred fn])]
</span><a href="Constrained.Base.html#prepareLinearization"><span class="hs-identifier hs-var">prepareLinearization</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179789"><span class="hs-identifier hs-var">preds</span></a></span><span>
</span><span id="line-872"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *).
(MonadGenError m, BaseUniverse fn) =&gt;
Env -&gt; [(Name fn, [Pred fn])] -&gt; GenT m Env
</span><a href="#local-6989586621679179787"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">[(Name fn, [Pred fn])]
</span><a href="#local-6989586621679179788"><span class="hs-identifier hs-var">linear</span></a></span><span>
</span><span id="line-873"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-874"></span><span>    </span><span id="local-6989586621679183023"><span id="local-6989586621679183024"><span class="annot"><a href="#local-6989586621679179787"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.GenT.html#MonadGenError"><span class="hs-identifier hs-type">MonadGenError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183024"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183023"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183023"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183023"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.GenT.html#GenT"><span class="hs-identifier hs-type">GenT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183024"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Constrained.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span></span></span><span>
</span><span id="line-875"></span><span>    </span><span id="local-6989586621679179787"><span class="annot"><span class="annottext">go :: forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *).
(MonadGenError m, BaseUniverse fn) =&gt;
Env -&gt; [(Name fn, [Pred fn])] -&gt; GenT m Env
</span><a href="#local-6989586621679179787"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679179781"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679179781"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679179781"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-876"></span><span>    </span><span class="annot"><a href="#local-6989586621679179787"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679179780"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679179780"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span id="local-6989586621679179758"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179758"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679179757"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679179757"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679179756"><span class="annot"><span class="annottext">[(Name fn, [Pred fn])]
</span><a href="#local-6989586621679179756"><span class="hs-identifier hs-var">nps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-877"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679179755"><span class="annot"><span class="annottext">spec :: Spec fn a
</span><a href="#local-6989586621679179755"><span class="hs-identifier hs-var hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn a, HasCallStack) =&gt;
Var a -&gt; Pred fn -&gt; Spec fn a
</span><a href="Constrained.Base.html#computeSpec"><span class="hs-identifier hs-var">computeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179758"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
Env -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#substPred"><span class="hs-identifier hs-var">substPred</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679179780"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679179757"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-878"></span><span>      </span><span id="local-6989586621679179752"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679179752"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (m :: * -&gt; *).
(HasCallStack, HasSpec fn a, MonadGenError m) =&gt;
Spec fn a -&gt; GenT m a
</span><a href="Constrained.Base.html#genFromSpec"><span class="hs-identifier hs-var">genFromSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679179755"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-879"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *).
(MonadGenError m, BaseUniverse fn) =&gt;
Env -&gt; [(Name fn, [Pred fn])] -&gt; GenT m Env
</span><a href="#local-6989586621679179787"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Typeable a, Show a) =&gt; Var a -&gt; a -&gt; Env -&gt; Env
</span><a href="Constrained.Env.html#extendEnv"><span class="hs-identifier hs-var">extendEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179758"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679179752"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679179780"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Name fn, [Pred fn])]
</span><a href="#local-6989586621679179756"><span class="hs-identifier hs-var">nps</span></a></span><span>
</span><span id="line-880"></span><span>
</span><span id="line-881"></span><span class="hs-comment">-- TODO: here we can compute both the explicit hints (i.e. constraints that</span><span>
</span><span id="line-882"></span><span class="hs-comment">-- define the order of two variables) and any whole-program smarts.</span><span>
</span><span id="line-883"></span><span class="annot"><a href="Constrained.Base.html#computeHints"><span class="hs-identifier hs-type">computeHints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183030"><span class="annot"><a href="#local-6989586621679183030"><span class="hs-identifier hs-type">fn</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183030"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Hints"><span class="hs-identifier hs-type">Hints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183030"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-884"></span><span id="computeHints"><span class="annot"><span class="annottext">computeHints :: forall (fn :: [*] -&gt; * -&gt; *). [Pred fn] -&gt; Hints fn
</span><a href="Constrained.Base.html#computeHints"><span class="hs-identifier hs-var hs-var">computeHints</span></a></span></span><span> </span><span id="local-6989586621679179748"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679179748"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-885"></span><span>  </span><span class="annot"><span class="annottext">forall node. Ord node =&gt; Graph node -&gt; Graph node
</span><a href="Constrained.Graph.html#transitiveClosure"><span class="hs-identifier hs-var">transitiveClosure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179746"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) t t'.
(HasVariables fn t, HasVariables fn t') =&gt;
t -&gt; t' -&gt; DependGraph fn
</span><a href="Constrained.Base.html#irreflexiveDependencyOn"><span class="hs-operator hs-var">`irreflexiveDependencyOn`</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679179743"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.Base.html#DependsOn"><span class="hs-identifier hs-type">DependsOn</span></a></span><span> </span><span id="local-6989586621679179746"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179746"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679179743"><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679179743"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679179748"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-886"></span><span>
</span><span id="line-887"></span><span id="local-6989586621679183052"><span id="local-6989586621679183053"><span class="annot"><a href="Constrained.Base.html#computeBinderDependencies"><span class="hs-identifier hs-type">computeBinderDependencies</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#Hints"><span class="hs-identifier hs-type">Hints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183053"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183053"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183052"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#DependGraph"><span class="hs-identifier hs-type">DependGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183053"><span class="hs-identifier hs-type">fn</span></a></span></span></span><span>
</span><span id="line-888"></span><span id="computeBinderDependencies"><span class="annot"><span class="annottext">computeBinderDependencies :: forall (fn :: [*] -&gt; * -&gt; *) a. Hints fn -&gt; Binder fn a -&gt; Hints fn
</span><a href="Constrained.Base.html#computeBinderDependencies"><span class="hs-identifier hs-var hs-var">computeBinderDependencies</span></a></span></span><span> </span><span id="local-6989586621679179740"><span class="annot"><span class="annottext">Hints fn
</span><a href="#local-6989586621679179740"><span class="hs-identifier hs-var">hints</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679179736"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179736"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679179735"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179735"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-889"></span><span>  </span><span class="annot"><span class="annottext">forall node. Ord node =&gt; node -&gt; Graph node -&gt; Graph node
</span><a href="Constrained.Graph.html#deleteNode"><span class="hs-identifier hs-var">deleteNode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; Var a -&gt; Name fn
</span><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-var">Name</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179736"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Hints fn -&gt; Pred fn -&gt; Hints fn
</span><a href="Constrained.Base.html#computeDependencies"><span class="hs-identifier hs-var">computeDependencies</span></a></span><span> </span><span class="annot"><span class="annottext">Hints fn
</span><a href="#local-6989586621679179740"><span class="hs-identifier hs-var">hints</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179735"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-890"></span><span>
</span><span id="line-891"></span><span id="local-6989586621679183064"><span id="local-6989586621679183065"><span class="annot"><a href="Constrained.Base.html#computeTermDependencies"><span class="hs-identifier hs-type">computeTermDependencies</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183065"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183064"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#DependGraph"><span class="hs-identifier hs-type">DependGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183065"><span class="hs-identifier hs-type">fn</span></a></span></span></span><span>
</span><span id="line-892"></span><span id="computeTermDependencies"><span class="annot"><span class="annottext">computeTermDependencies :: forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; DependGraph fn
</span><a href="Constrained.Base.html#computeTermDependencies"><span class="hs-identifier hs-var hs-var">computeTermDependencies</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="annot"><span class="annottext">fn as a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679179727"><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679179727"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (as :: [*]).
List (Term fn) as -&gt; DependGraph fn
</span><a href="#local-6989586621679179726"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679179727"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-893"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-894"></span><span>    </span><span id="local-6989586621679183003"><span id="local-6989586621679183004"><span class="annot"><a href="#local-6989586621679179726"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.List.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183004"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679183003"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#DependGraph"><span class="hs-identifier hs-type">DependGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183004"><span class="hs-identifier hs-type">fn</span></a></span></span></span><span>
</span><span id="line-895"></span><span>    </span><span id="local-6989586621679179726"><span class="annot"><span class="annottext">go :: forall (fn :: [*] -&gt; * -&gt; *) (as :: [*]).
List (Term fn) as -&gt; DependGraph fn
</span><a href="#local-6989586621679179726"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-896"></span><span>    </span><span class="annot"><a href="#local-6989586621679179726"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679179712"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179712"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679179711"><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679179711"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-897"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679179710"><span class="annot"><span class="annottext">gr :: DependGraph fn
</span><a href="#local-6989586621679179710"><span class="hs-identifier hs-var hs-var">gr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (as :: [*]).
List (Term fn) as -&gt; DependGraph fn
</span><a href="#local-6989586621679179726"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679179711"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-898"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179712"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) t t'.
(HasVariables fn t, HasVariables fn t') =&gt;
t -&gt; t' -&gt; DependGraph fn
</span><a href="Constrained.Base.html#irreflexiveDependencyOn"><span class="hs-operator hs-var">`irreflexiveDependencyOn`</span></a></span><span> </span><span class="annot"><span class="annottext">forall node. Ord node =&gt; Graph node -&gt; Set node
</span><a href="Constrained.Graph.html#nodes"><span class="hs-identifier hs-var">nodes</span></a></span><span> </span><span class="annot"><span class="annottext">DependGraph fn
</span><a href="#local-6989586621679179710"><span class="hs-identifier hs-var">gr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; DependGraph fn
</span><a href="Constrained.Base.html#computeTermDependencies"><span class="hs-identifier hs-var">computeTermDependencies</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179712"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">DependGraph fn
</span><a href="#local-6989586621679179710"><span class="hs-identifier hs-var">gr</span></a></span><span>
</span><span id="line-899"></span><span class="annot"><a href="Constrained.Base.html#computeTermDependencies"><span class="hs-identifier hs-var">computeTermDependencies</span></a></span><span> </span><span id="local-6989586621679179708"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179708"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) t.
HasVariables fn t =&gt;
t -&gt; DependGraph fn
</span><a href="Constrained.Base.html#noDependencies"><span class="hs-identifier hs-var">noDependencies</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179708"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-900"></span><span>
</span><span id="line-901"></span><span class="hs-comment">-- Consider: A + B = C + D</span><span>
</span><span id="line-902"></span><span class="hs-comment">-- We want to fail if A and B are independent.</span><span>
</span><span id="line-903"></span><span class="hs-comment">-- Consider: A + B = A + C, A &lt;- B</span><span>
</span><span id="line-904"></span><span class="hs-comment">-- Here we want to consider this constraint defining for A</span><span>
</span><span id="line-905"></span><span id="local-6989586621679183027"><span id="local-6989586621679183028"><span class="annot"><a href="Constrained.Base.html#linearize"><span class="hs-identifier hs-type">linearize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.GenT.html#MonadGenError"><span class="hs-identifier hs-type">MonadGenError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183028"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183027"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183027"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#DependGraph"><span class="hs-identifier hs-type">DependGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183027"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679183028"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183027"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183027"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-906"></span><span id="linearize"><span class="annot"><span class="annottext">linearize :: forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *).
(MonadGenError m, BaseUniverse fn) =&gt;
[Pred fn] -&gt; DependGraph fn -&gt; m [(Name fn, [Pred fn])]
</span><a href="Constrained.Base.html#linearize"><span class="hs-identifier hs-var hs-var">linearize</span></a></span></span><span> </span><span id="local-6989586621679179659"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679179659"><span class="hs-identifier hs-var">preds</span></a></span></span><span> </span><span id="local-6989586621679179658"><span class="annot"><span class="annottext">DependGraph fn
</span><a href="#local-6989586621679179658"><span class="hs-identifier hs-var">graph</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-907"></span><span>  </span><span id="local-6989586621679179657"><span class="annot"><span class="annottext">[Name fn]
</span><a href="#local-6989586621679179657"><span class="hs-identifier hs-var">sorted</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall node. Ord node =&gt; Graph node -&gt; Either [node] [node]
</span><a href="Constrained.Graph.html#topsort"><span class="hs-identifier hs-var">topsort</span></a></span><span> </span><span class="annot"><span class="annottext">DependGraph fn
</span><a href="#local-6989586621679179658"><span class="hs-identifier hs-var">graph</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-908"></span><span>    </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679179655"><span class="annot"><span class="annottext">[Name fn]
</span><a href="#local-6989586621679179655"><span class="hs-identifier hs-var">cycle</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a
</span><a href="Constrained.GenT.html#fatalError"><span class="hs-identifier hs-var">fatalError</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;dependency cycle in graph&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">[Name fn]
</span><a href="#local-6989586621679179655"><span class="hs-identifier hs-var">cycle</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">DependGraph fn
</span><a href="#local-6989586621679179658"><span class="hs-identifier hs-var">graph</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-909"></span><span>    </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679179654"><span class="annot"><span class="annottext">[Name fn]
</span><a href="#local-6989586621679179654"><span class="hs-identifier hs-var">sorted</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">[Name fn]
</span><a href="#local-6989586621679179654"><span class="hs-identifier hs-var">sorted</span></a></span><span>
</span><span id="line-910"></span><span>  </span><span class="annot"><span class="annottext">[Name fn] -&gt; [(Set (Name fn), Pred fn)] -&gt; m [(Name fn, [Pred fn])]
</span><a href="#local-6989586621679179653"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Name fn]
</span><a href="#local-6989586621679179657"><span class="hs-identifier hs-var">sorted</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; Set (Name fn)
</span><a href="Constrained.Base.html#freeVarSet"><span class="hs-identifier hs-var">freeVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179651"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179651"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679179651"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179651"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="annot"><span class="annottext">forall {fn :: [*] -&gt; * -&gt; *}. Pred fn -&gt; Bool
</span><a href="#local-6989586621679179650"><span class="hs-identifier hs-var">isRelevantPred</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679179659"><span class="hs-identifier hs-var">preds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-911"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-912"></span><span>    </span><span id="local-6989586621679179650"><span class="annot"><span class="annottext">isRelevantPred :: Pred fn -&gt; Bool
</span><a href="#local-6989586621679179650"><span class="hs-identifier hs-var hs-var">isRelevantPred</span></a></span></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-913"></span><span>    </span><span class="annot"><a href="#local-6989586621679179650"><span class="hs-identifier hs-var">isRelevantPred</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#DependsOn"><span class="hs-identifier hs-type">DependsOn</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-914"></span><span>    </span><span class="annot"><a href="#local-6989586621679179650"><span class="hs-identifier hs-var">isRelevantPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Assert"><span class="hs-identifier hs-type">Assert</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-915"></span><span>    </span><span class="annot"><a href="#local-6989586621679179650"><span class="hs-identifier hs-var">isRelevantPred</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-916"></span><span>
</span><span id="line-917"></span><span>    </span><span id="local-6989586621679179653"><span class="annot"><span class="annottext">go :: [Name fn] -&gt; [(Set (Name fn), Pred fn)] -&gt; m [(Name fn, [Pred fn])]
</span><a href="#local-6989586621679179653"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-918"></span><span>    </span><span class="annot"><a href="#local-6989586621679179653"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679179645"><span class="annot"><span class="annottext">[(Set (Name fn), Pred fn)]
</span><a href="#local-6989586621679179645"><span class="hs-identifier hs-var">ps</span></a></span></span><span>
</span><span id="line-919"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[(Set (Name fn), Pred fn)]
</span><a href="#local-6989586621679179645"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-920"></span><span>          </span><span id="local-6989586621679179644"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679179644"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (t :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *).
(MonadGenError m, Traversable t, FunctionLike fn) =&gt;
Env -&gt; t (Pred fn) -&gt; m Bool
</span><a href="Constrained.Base.html#checkPreds"><span class="hs-identifier hs-var">checkPreds</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[(Set (Name fn), Pred fn)]
</span><a href="#local-6989586621679179645"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-921"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679179644"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-922"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-923"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a
</span><a href="Constrained.GenT.html#genError"><span class="hs-identifier hs-var">genError</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Linearize const False&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-924"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a
</span><a href="Constrained.GenT.html#fatalError"><span class="hs-identifier hs-var">fatalError</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Dependency error in `linearize`: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">DependGraph fn
</span><a href="#local-6989586621679179658"><span class="hs-identifier hs-var">graph</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mappend</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Set (Name fn), Pred fn)]
</span><a href="#local-6989586621679179645"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-925"></span><span>    </span><span class="annot"><a href="#local-6989586621679179653"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679179643"><span class="annot"><span class="annottext">Name fn
</span><a href="#local-6989586621679179643"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679179642"><span class="annot"><span class="annottext">[Name fn]
</span><a href="#local-6989586621679179642"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679179641"><span class="annot"><span class="annottext">[(Set (Name fn), Pred fn)]
</span><a href="#local-6989586621679179641"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-926"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679179640"><span class="annot"><span class="annottext">[(Set (Name fn), Pred fn)]
</span><a href="#local-6989586621679179640"><span class="hs-identifier hs-var">nps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679179639"><span class="annot"><span class="annottext">[(Set (Name fn), Pred fn)]
</span><a href="#local-6989586621679179639"><span class="hs-identifier hs-var">ops</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">partition</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name fn -&gt; Set (Name fn) -&gt; Bool
</span><a href="#local-6989586621679179638"><span class="hs-identifier hs-var">isLastVariable</span></a></span><span> </span><span class="annot"><span class="annottext">Name fn
</span><a href="#local-6989586621679179643"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Set (Name fn), Pred fn)]
</span><a href="#local-6989586621679179641"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-927"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name fn
</span><a href="#local-6989586621679179643"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[(Set (Name fn), Pred fn)]
</span><a href="#local-6989586621679179640"><span class="hs-identifier hs-var">nps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Name fn] -&gt; [(Set (Name fn), Pred fn)] -&gt; m [(Name fn, [Pred fn])]
</span><a href="#local-6989586621679179653"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Name fn]
</span><a href="#local-6989586621679179642"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="annot"><span class="annottext">[(Set (Name fn), Pred fn)]
</span><a href="#local-6989586621679179639"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-928"></span><span>
</span><span id="line-929"></span><span>    </span><span id="local-6989586621679179638"><span class="annot"><span class="annottext">isLastVariable :: Name fn -&gt; Set (Name fn) -&gt; Bool
</span><a href="#local-6989586621679179638"><span class="hs-identifier hs-var hs-var">isLastVariable</span></a></span></span><span> </span><span id="local-6989586621679179637"><span class="annot"><span class="annottext">Name fn
</span><a href="#local-6989586621679179637"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679179636"><span class="annot"><span class="annottext">Set (Name fn)
</span><a href="#local-6989586621679179636"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name fn
</span><a href="#local-6989586621679179637"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-operator hs-var">`Set.member`</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Name fn)
</span><a href="#local-6989586621679179636"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: [*] -&gt; * -&gt; *).
Name f -&gt; Set (Name f) -&gt; DependGraph f -&gt; Bool
</span><a href="Constrained.Base.html#solvableFrom"><span class="hs-identifier hs-var">solvableFrom</span></a></span><span> </span><span class="annot"><span class="annottext">Name fn
</span><a href="#local-6989586621679179637"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.delete</span></a></span><span> </span><span class="annot"><span class="annottext">Name fn
</span><a href="#local-6989586621679179637"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Name fn)
</span><a href="#local-6989586621679179636"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DependGraph fn
</span><a href="#local-6989586621679179658"><span class="hs-identifier hs-var">graph</span></a></span><span>
</span><span id="line-930"></span><span>
</span><span id="line-931"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-932"></span><span class="hs-comment">-- Computing specs</span><span>
</span><span id="line-933"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-934"></span><span>
</span><span id="line-935"></span><span class="hs-comment">-- | Precondition: the `Pred fn` defines the `Var a`</span><span>
</span><span id="line-936"></span><span class="annot"><a href="Constrained.Base.html#computeSpec"><span class="hs-identifier hs-type">computeSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183018"><span class="annot"><a href="#local-6989586621679183018"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679183017"><span class="annot"><a href="#local-6989586621679183017"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183018"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183017"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183017"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183018"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183018"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183017"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-937"></span><span id="computeSpec"><span class="annot"><span class="annottext">computeSpec :: forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn a, HasCallStack) =&gt;
Var a -&gt; Pred fn -&gt; Spec fn a
</span><a href="Constrained.Base.html#computeSpec"><span class="hs-identifier hs-var hs-var">computeSpec</span></a></span></span><span> </span><span id="local-6989586621679179615"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179615"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679179614"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179614"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ([String] -&gt; a) -&gt; GE a -&gt; a
</span><a href="Constrained.GenT.html#fromGE"><span class="hs-identifier hs-var">fromGE</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). BaseUniverse fn =&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#simplifyPred"><span class="hs-identifier hs-var">simplifyPred</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179614"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-938"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#GenHint"><span class="hs-identifier hs-type">GenHint</span></a></span><span> </span><span id="local-6989586621679179603"><span class="annot"><span class="annottext">Hint a
</span><a href="#local-6989586621679179603"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679179602"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179602"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) v a.
HasSpec fn v =&gt;
Spec fn a -&gt; Ctx fn v a -&gt; Spec fn v
</span><a href="Constrained.Base.html#propagateSpec"><span class="hs-identifier hs-var">propagateSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasGenHint fn a =&gt;
Hint a -&gt; Spec fn a
</span><a href="Constrained.Base.html#giveHint"><span class="hs-identifier hs-var">giveHint</span></a></span><span> </span><span class="annot"><span class="annottext">Hint a
</span><a href="#local-6989586621679179603"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *) v a.
(BaseUniverse fn, Typeable v, MonadGenError m, HasCallStack) =&gt;
Var v -&gt; Term fn a -&gt; m (Ctx fn v a)
</span><a href="Constrained.Base.html#toCtx"><span class="hs-identifier hs-var">toCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179615"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179602"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-comment">-- NOTE: this implies you do need to actually propagate hints, e.g. propagate depth control in a `tail` or `cdr` like function</span><span>
</span><span id="line-939"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span id="local-6989586621679179594"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179594"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679179593"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179593"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679179592"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179592"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn a, HasCallStack) =&gt;
Var a -&gt; Pred fn -&gt; Spec fn a
</span><a href="Constrained.Base.html#computeSpec"><span class="hs-identifier hs-var">computeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179615"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#substitutePred"><span class="hs-identifier hs-var">substitutePred</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179594"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179593"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179592"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- NOTE: this is impossible as it should have gone away already</span><span>
</span><span id="line-940"></span><span>  </span><span class="annot"><span class="annottext">Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-941"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-type">FalsePred</span></a></span><span> </span><span id="local-6989586621679179591"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679179591"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a
</span><a href="Constrained.GenT.html#genError"><span class="hs-identifier hs-var">genError</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679179591"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-942"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span id="local-6989586621679179590"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679179590"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn a, HasCallStack) =&gt;
Var a -&gt; Pred fn -&gt; Spec fn a
</span><a href="Constrained.Base.html#computeSpec"><span class="hs-identifier hs-var">computeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179615"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679179590"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-943"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span id="local-6989586621679179587"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179587"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679179586"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679179586"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Spec fn a
</span><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-var">SuspendedSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179615"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179587"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679179586"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-944"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Exists"><span class="hs-identifier hs-type">Exists</span></a></span><span> </span><span id="local-6989586621679179583"><span class="annot"><span class="annottext">(forall b. Term fn b -&gt; b) -&gt; GE a
</span><a href="#local-6989586621679179583"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679179582"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679179582"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Spec fn a
</span><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-var">SuspendedSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179615"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
((forall b. Term fn b -&gt; b) -&gt; GE a) -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Exists"><span class="hs-identifier hs-var">Exists</span></a></span><span> </span><span class="annot"><span class="annottext">(forall b. Term fn b -&gt; b) -&gt; GE a
</span><a href="#local-6989586621679179583"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679179582"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-945"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Assert"><span class="hs-identifier hs-type">Assert</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-946"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Assert"><span class="hs-identifier hs-type">Assert</span></a></span><span> </span><span id="local-6989586621679179576"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679179576"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a
</span><a href="Constrained.GenT.html#genError"><span class="hs-identifier hs-var">genError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679179576"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Assert False&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-947"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Assert"><span class="hs-identifier hs-type">Assert</span></a></span><span> </span><span id="local-6989586621679179560"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679179560"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679179559"><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679179559"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a -&gt; m a
</span><a href="Constrained.GenT.html#explain"><span class="hs-identifier hs-var">explain</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679179560"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) v a.
HasSpec fn v =&gt;
Spec fn a -&gt; Ctx fn v a -&gt; Spec fn v
</span><a href="Constrained.Base.html#propagateSpec"><span class="hs-identifier hs-var">propagateSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). a -&gt; Spec fn a
</span><a href="Constrained.Base.html#equalSpec"><span class="hs-identifier hs-var">equalSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *) v a.
(BaseUniverse fn, Typeable v, MonadGenError m, HasCallStack) =&gt;
Var v -&gt; Term fn a -&gt; m (Ctx fn v a)
</span><a href="Constrained.Base.html#toCtx"><span class="hs-identifier hs-var">toCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179615"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679179559"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-948"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#ForAll"><span class="hs-identifier hs-type">ForAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679179547"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679179547"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679179546"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679179546"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679179545"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679179545"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn a, HasCallStack) =&gt;
Var a -&gt; Pred fn -&gt; Spec fn a
</span><a href="Constrained.Base.html#computeSpec"><span class="hs-identifier hs-var">computeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179615"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#unBind"><span class="hs-identifier hs-var">unBind</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679179545"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679179546"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t e. Forallable t e =&gt; t -&gt; [e]
</span><a href="Constrained.Base.html#forAllToList"><span class="hs-identifier hs-var">forAllToList</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679179547"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-949"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#ForAll"><span class="hs-identifier hs-type">ForAll</span></a></span><span> </span><span id="local-6989586621679179529"><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679179529"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679179528"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679179528"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) v a.
HasSpec fn v =&gt;
Spec fn a -&gt; Ctx fn v a -&gt; Spec fn v
</span><a href="Constrained.Base.html#propagateSpec"><span class="hs-identifier hs-var">propagateSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t e (fn :: [*] -&gt; * -&gt; *).
(Forallable t e, HasSpec fn t, HasSpec fn e, BaseUniverse fn) =&gt;
Spec fn e -&gt; Spec fn t
</span><a href="Constrained.Base.html#forAllSpec"><span class="hs-identifier hs-var">forAllSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Binder fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#computeSpecBinder"><span class="hs-identifier hs-var">computeSpecBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679179528"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *) v a.
(BaseUniverse fn, Typeable v, MonadGenError m, HasCallStack) =&gt;
Var v -&gt; Term fn a -&gt; m (Ctx fn v a)
</span><a href="Constrained.Base.html#toCtx"><span class="hs-identifier hs-var">toCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179615"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679179529"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-950"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Case"><span class="hs-identifier hs-type">Case</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679179523"><span class="annot"><span class="annottext">SumOver as
</span><a href="#local-6989586621679179523"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679179522"><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679179522"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (as :: [*]) (fn :: [*] -&gt; * -&gt; *) r.
SumOver as
-&gt; List (Binder fn) as
-&gt; (forall a. HasSpec fn a =&gt; Var a -&gt; a -&gt; Pred fn -&gt; r)
-&gt; r
</span><a href="Constrained.Base.html#runCaseOn"><span class="hs-identifier hs-var">runCaseOn</span></a></span><span> </span><span class="annot"><span class="annottext">SumOver as
</span><a href="#local-6989586621679179523"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679179522"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679179512"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179512"><span class="hs-identifier hs-var">va</span></a></span></span><span> </span><span id="local-6989586621679179511"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679179511"><span class="hs-identifier hs-var">vaVal</span></a></span></span><span> </span><span id="local-6989586621679179510"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179510"><span class="hs-identifier hs-var">psa</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn a, HasCallStack) =&gt;
Var a -&gt; Pred fn -&gt; Spec fn a
</span><a href="Constrained.Base.html#computeSpec"><span class="hs-identifier hs-var">computeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179615"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
Env -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#substPred"><span class="hs-identifier hs-var">substPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Typeable a, Show a) =&gt; Var a -&gt; a -&gt; Env
</span><a href="Constrained.Env.html#singletonEnv"><span class="hs-identifier hs-var">singletonEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179512"><span class="hs-identifier hs-var">va</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679179511"><span class="hs-identifier hs-var">vaVal</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179510"><span class="hs-identifier hs-var">psa</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-951"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Case"><span class="hs-identifier hs-type">Case</span></a></span><span> </span><span id="local-6989586621679179500"><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679179500"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679179499"><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679179499"><span class="hs-identifier hs-var">branches</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-952"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679179498"><span class="annot"><span class="annottext">branchSpecs :: List (Spec fn) as
</span><a href="#local-6989586621679179498"><span class="hs-identifier hs-var hs-var">branchSpecs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (as :: [k]).
(forall (a :: k). f a -&gt; g a) -&gt; List f as -&gt; List g as
</span><a href="Constrained.List.html#mapList"><span class="hs-identifier hs-var">mapList</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Binder fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#computeSpecBinder"><span class="hs-identifier hs-var">computeSpecBinder</span></a></span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679179499"><span class="hs-identifier hs-var">branches</span></a></span><span>
</span><span id="line-953"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) v a.
HasSpec fn v =&gt;
Spec fn a -&gt; Ctx fn v a -&gt; Spec fn v
</span><a href="Constrained.Base.html#propagateSpec"><span class="hs-identifier hs-var">propagateSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (as :: [*]).
HasSpec fn (SumOver as) =&gt;
List (Spec fn) as -&gt; Spec fn (SumOver as)
</span><a href="Constrained.Base.html#caseSpec"><span class="hs-identifier hs-var">caseSpec</span></a></span><span> </span><span class="annot"><span class="annottext">List (Spec fn) as
</span><a href="#local-6989586621679179498"><span class="hs-identifier hs-var">branchSpecs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *) v a.
(BaseUniverse fn, Typeable v, MonadGenError m, HasCallStack) =&gt;
Var v -&gt; Term fn a -&gt; m (Ctx fn v a)
</span><a href="Constrained.Base.html#toCtx"><span class="hs-identifier hs-var">toCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179615"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679179500"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-954"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Reify"><span class="hs-identifier hs-type">Reify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679179490"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679179490"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679179489"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679179489"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679179480"><span class="annot"><span class="annottext">Var b
</span><a href="#local-6989586621679179480"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679179479"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179479"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-955"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn a, HasCallStack) =&gt;
Var a -&gt; Pred fn -&gt; Spec fn a
</span><a href="Constrained.Base.html#computeSpec"><span class="hs-identifier hs-var">computeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179615"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
Env -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#substPred"><span class="hs-identifier hs-var">substPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Typeable a, Show a) =&gt; Var a -&gt; a -&gt; Env
</span><a href="Constrained.Env.html#singletonEnv"><span class="hs-identifier hs-var">singletonEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var b
</span><a href="#local-6989586621679179480"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679179489"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679179490"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179479"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-956"></span><span>  </span><span class="hs-comment">-- Impossible cases that should be ruled out by the dependency analysis and linearizer</span><span>
</span><span id="line-957"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#DependsOn"><span class="hs-identifier hs-type">DependsOn</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a
</span><a href="Constrained.GenT.html#fatalError"><span class="hs-identifier hs-var">fatalError</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The impossible happened in computeSpec: DependsOn&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-958"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Reify"><span class="hs-identifier hs-type">Reify</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a
</span><a href="Constrained.GenT.html#fatalError"><span class="hs-identifier hs-var">fatalError</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The impossible happened in computeSpec: Reify&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179615"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179614"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-959"></span><span>
</span><span id="line-960"></span><span id="local-6989586621679182955"><span id="local-6989586621679182956"><span class="annot"><a href="Constrained.Base.html#computeSpecBinder"><span class="hs-identifier hs-type">computeSpecBinder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182956"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182955"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182956"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182955"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-961"></span><span id="computeSpecBinder"><span class="annot"><span class="annottext">computeSpecBinder :: forall (fn :: [*] -&gt; * -&gt; *) a. Binder fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#computeSpecBinder"><span class="hs-identifier hs-var hs-var">computeSpecBinder</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679179462"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179462"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679179461"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179461"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn a, HasCallStack) =&gt;
Var a -&gt; Pred fn -&gt; Spec fn a
</span><a href="Constrained.Base.html#computeSpec"><span class="hs-identifier hs-var">computeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179462"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179461"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-962"></span><span>
</span><span id="line-963"></span><span class="annot"><a href="Constrained.Base.html#caseSpec"><span class="hs-identifier hs-type">caseSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-964"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182946"><span class="annot"><a href="#local-6989586621679182946"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679182945"><span class="annot"><a href="#local-6989586621679182945"><span class="hs-keyword hs-type">as</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-965"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182946"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#SumOver"><span class="hs-identifier hs-type">SumOver</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182945"><span class="hs-keyword hs-type">as</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-966"></span><span>  </span><span class="annot"><a href="Constrained.List.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182946"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679182945"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-967"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182946"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#SumOver"><span class="hs-identifier hs-type">SumOver</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182945"><span class="hs-keyword hs-type">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-968"></span><span id="caseSpec"><span class="annot"><span class="annottext">caseSpec :: forall (fn :: [*] -&gt; * -&gt; *) (as :: [*]).
HasSpec fn (SumOver as) =&gt;
List (Spec fn) as -&gt; Spec fn (SumOver as)
</span><a href="Constrained.Base.html#caseSpec"><span class="hs-identifier hs-var hs-var">caseSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">List (Spec fn) as
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The impossible happened in caseSpec&quot;</span></span><span>
</span><span id="line-969"></span><span class="annot"><a href="Constrained.Base.html#caseSpec"><span class="hs-identifier hs-var">caseSpec</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679179453"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679179453"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">List (Spec fn) as
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679179453"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-970"></span><span class="annot"><a href="Constrained.Base.html#caseSpec"><span class="hs-identifier hs-var">caseSpec</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679179449"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679179449"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679179448"><span class="annot"><span class="annottext">ss :: List (Spec fn) as
</span><a href="#local-6989586621679179448"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Spec fn a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">List (Spec fn) as
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-971"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Evidence (Prerequisites fn (SumOver as))
</span><a href="Constrained.Core.html#Evidence"><span class="hs-identifier hs-var">Evidence</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Evidence (Prerequisites fn a)
</span><a href="Constrained.Base.html#prerequisites"><span class="hs-identifier hs-var">prerequisites</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182946"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#SumOver"><span class="hs-identifier hs-type">SumOver</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182945"><span class="hs-keyword hs-type">as</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
Spec fn a -&gt; Spec fn b -&gt; SumSpec fn a b
</span><a href="Constrained.Base.html#SumSpec"><span class="hs-identifier hs-var">SumSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679179449"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (as :: [*]).
HasSpec fn (SumOver as) =&gt;
List (Spec fn) as -&gt; Spec fn (SumOver as)
</span><a href="Constrained.Base.html#caseSpec"><span class="hs-identifier hs-var">caseSpec</span></a></span><span> </span><span class="annot"><span class="annottext">List (Spec fn) as
</span><a href="#local-6989586621679179448"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-972"></span><span>
</span><span id="line-973"></span><span class="annot"><a href="Constrained.Base.html#propagateSpec"><span class="hs-identifier hs-type">propagateSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-974"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182970"><span class="annot"><a href="#local-6989586621679182970"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679182969"><span class="annot"><a href="#local-6989586621679182969"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679182968"><span class="annot"><a href="#local-6989586621679182968"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-975"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182970"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182969"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-976"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182970"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182968"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-977"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Ctx"><span class="hs-identifier hs-type">Ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182970"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182969"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182968"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-978"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182970"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182969"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-979"></span><span id="propagateSpec"><span class="annot"><span class="annottext">propagateSpec :: forall (fn :: [*] -&gt; * -&gt; *) v a.
HasSpec fn v =&gt;
Spec fn a -&gt; Ctx fn v a -&gt; Spec fn v
</span><a href="Constrained.Base.html#propagateSpec"><span class="hs-identifier hs-var hs-var">propagateSpec</span></a></span></span><span> </span><span id="local-6989586621679179435"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679179435"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-980"></span><span>  </span><span class="annot"><span class="annottext">Ctx fn v a
</span><a href="Constrained.Base.html#CtxHOLE"><span class="hs-identifier hs-var">CtxHOLE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679179435"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-981"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#CtxApp"><span class="hs-identifier hs-type">CtxApp</span></a></span><span> </span><span id="local-6989586621679179428"><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679179428"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.List.html#ListCtx"><span class="hs-identifier hs-type">ListCtx</span></a></span><span> </span><span id="local-6989586621679179422"><span class="annot"><span class="annottext">List Value as
</span><a href="#local-6989586621679179422"><span class="hs-identifier hs-var">pre</span></a></span></span><span> </span><span id="local-6989586621679179421"><span class="annot"><span class="annottext">Ctx fn v a
</span><a href="#local-6989586621679179421"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679179420"><span class="annot"><span class="annottext">List Value as'
</span><a href="#local-6989586621679179420"><span class="hs-identifier hs-var">suf</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-982"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Evidence (HasSpec fn a)
</span><a href="Constrained.Core.html#Evidence"><span class="hs-identifier hs-var">Evidence</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) v a.
Ctx fn v a -&gt; Evidence (HasSpec fn a)
</span><a href="Constrained.Base.html#ctxHasSpec"><span class="hs-identifier hs-var">ctxHasSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx fn v a
</span><a href="#local-6989586621679179421"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) v a.
HasSpec fn v =&gt;
Spec fn a -&gt; Ctx fn v a -&gt; Spec fn v
</span><a href="Constrained.Base.html#propagateSpec"><span class="hs-identifier hs-var">propagateSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: [*] -&gt; * -&gt; *) (fn :: [*] -&gt; * -&gt; *) (as :: [*]) a b.
(Functions f fn, TypeList as, Typeable as, HasSpec fn a,
 All (HasSpec fn) as) =&gt;
f as b -&gt; ListCtx Value as (HOLE a) -&gt; Spec fn b -&gt; Spec fn a
</span><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var">propagateSpecFun</span></a></span><span> </span><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679179428"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (as'' :: [*]) (f :: * -&gt; *) (c :: * -&gt; *) (as :: [*]) a
       (as' :: [*]).
(as'' ~ Append as (a : as')) =&gt;
List f as -&gt; c a -&gt; List f as' -&gt; ListCtx f as'' c
</span><a href="Constrained.List.html#ListCtx"><span class="hs-identifier hs-var">ListCtx</span></a></span><span> </span><span class="annot"><span class="annottext">List Value as
</span><a href="#local-6989586621679179422"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="annot"><span class="annottext">List Value as'
</span><a href="#local-6989586621679179420"><span class="hs-identifier hs-var">suf</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679179435"><span class="hs-identifier hs-var">spec</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ctx fn v a
</span><a href="#local-6989586621679179421"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-983"></span><span>
</span><span id="line-984"></span><span id="local-6989586621679182915"><span id="local-6989586621679182916"><span id="local-6989586621679182917"><span class="annot"><a href="Constrained.Base.html#ctxHasSpec"><span class="hs-identifier hs-type">ctxHasSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#Ctx"><span class="hs-identifier hs-type">Ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182917"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182916"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182915"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Core.html#Evidence"><span class="hs-identifier hs-type">Evidence</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182917"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182915"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-985"></span><span id="ctxHasSpec"><span class="annot"><span class="annottext">ctxHasSpec :: forall (fn :: [*] -&gt; * -&gt; *) v a.
Ctx fn v a -&gt; Evidence (HasSpec fn a)
</span><a href="Constrained.Base.html#ctxHasSpec"><span class="hs-identifier hs-var hs-var">ctxHasSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">Ctx fn v a
</span><a href="Constrained.Base.html#CtxHOLE"><span class="hs-identifier hs-var">CtxHOLE</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (c :: Constraint). c =&gt; Evidence c
</span><a href="Constrained.Core.html#Evidence"><span class="hs-identifier hs-var">Evidence</span></a></span><span>
</span><span id="line-986"></span><span class="annot"><a href="Constrained.Base.html#ctxHasSpec"><span class="hs-identifier hs-var">ctxHasSpec</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#CtxApp"><span class="hs-identifier hs-type">CtxApp</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (c :: Constraint). c =&gt; Evidence c
</span><a href="Constrained.Core.html#Evidence"><span class="hs-identifier hs-var">Evidence</span></a></span><span>
</span><span id="line-987"></span><span>
</span><span id="line-988"></span><span class="hs-keyword">class</span><span>
</span><span id="line-989"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183510"><span class="annot"><a href="#local-6989586621679183510"><span class="hs-keyword hs-type">as</span></a></span></span><span> </span><span id="local-6989586621679183509"><span class="annot"><a href="#local-6989586621679183509"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679183487"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183510"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183509"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-990"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183508"><span class="annot"><a href="#local-6989586621679183508"><span class="hs-keyword hs-type">as</span></a></span></span><span> </span><span id="local-6989586621679183507"><span class="annot"><a href="#local-6989586621679183507"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679183487"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183508"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183507"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-991"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183487"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-992"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Univ.html#FunctionLike"><span class="hs-identifier hs-type">FunctionLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183487"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-993"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-994"></span><span>  </span><span id="Functions"><span class="annot"><a href="Constrained.Base.html#Functions"><span class="hs-identifier hs-var">Functions</span></a></span></span><span> </span><span id="local-6989586621679183487"><span class="annot"><a href="#local-6989586621679183487"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679183486"><span class="annot"><a href="#local-6989586621679183486"><span class="hs-identifier hs-type">fn</span></a></span></span><span>
</span><span id="line-995"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-996"></span><span>  </span><span id="propagateSpecFun"><span class="annot"><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-type">propagateSpecFun</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-997"></span><span>    </span><span id="local-6989586621679183105"><span id="local-6989586621679183106"><span id="local-6989586621679183107"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.List.html#TypeList"><span class="hs-identifier hs-type">TypeList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183107"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-998"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183107"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-999"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183486"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183106"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1000"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.List.html#All"><span class="hs-identifier hs-type">All</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183486"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679183107"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-1001"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1002"></span><span>    </span><span class="annot"><a href="#local-6989586621679183487"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183107"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183105"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1003"></span><span>    </span><span class="annot"><a href="Constrained.List.html#ListCtx"><span class="hs-identifier hs-type">ListCtx</span></a></span><span> </span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183107"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-type">HOLE</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183106"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1004"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183486"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183105"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1005"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183486"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183106"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-1006"></span><span>
</span><span id="line-1007"></span><span>  </span><span id="rewriteRules"><span class="annot"><a href="Constrained.Base.html#rewriteRules"><span class="hs-identifier hs-type">rewriteRules</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1008"></span><span>    </span><span id="local-6989586621679182903"><span id="local-6989586621679182904"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.List.html#TypeList"><span class="hs-identifier hs-type">TypeList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182904"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-1009"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182904"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-1010"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183486"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182903"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-1011"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.List.html#All"><span class="hs-identifier hs-type">All</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183486"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679182904"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-1012"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1013"></span><span>    </span><span class="annot"><a href="#local-6989586621679183487"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182904"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182903"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1014"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Base.html#RewriteRule"><span class="hs-identifier hs-type">RewriteRule</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183486"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182903"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-1015"></span><span>  </span><span id="local-6989586621679179400"><span class="annot"><a href="Constrained.Base.html#rewriteRules"><span class="hs-identifier hs-var hs-var">rewriteRules</span></a></span><span> </span><span class="annot"><span class="annottext">f as b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span><span>
</span><span id="line-1016"></span><span>
</span><span id="line-1017"></span><span>  </span><span id="mapTypeSpec"><span class="annot"><a href="Constrained.Base.html#mapTypeSpec"><span class="hs-identifier hs-type">mapTypeSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1018"></span><span>    </span><span id="local-6989586621679182893"><span id="local-6989586621679182894"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183486"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182894"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1019"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183486"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182893"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-1020"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1021"></span><span>    </span><span class="annot"><a href="#local-6989586621679183487"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182894"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679182893"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1022"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183486"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182894"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1023"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183486"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182893"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-1024"></span><span>
</span><span id="line-1025"></span><span class="annot"><a href="Constrained.Base.html#mapSpec"><span class="hs-identifier hs-type">mapSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1026"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182900"><span class="annot"><a href="#local-6989586621679182900"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679182899"><span class="annot"><a href="#local-6989586621679182899"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679182898"><span class="annot"><a href="#local-6989586621679182898"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-1027"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182900"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182899"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1028"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182900"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182898"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-1029"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1030"></span><span>  </span><span class="annot"><a href="#local-6989586621679182900"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182899"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679182898"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1031"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182900"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182899"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1032"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182900"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182898"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-1033"></span><span id="mapSpec"><span class="annot"><span class="annottext">mapSpec :: forall (fn :: [*] -&gt; * -&gt; *) a b.
(HasSpec fn a, HasSpec fn b) =&gt;
fn '[a] b -&gt; Spec fn a -&gt; Spec fn b
</span><a href="Constrained.Base.html#mapSpec"><span class="hs-identifier hs-var hs-var">mapSpec</span></a></span></span><span> </span><span id="local-6989586621679179382"><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679179382"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: [*] -&gt; * -&gt; *) (fn :: [*] -&gt; * -&gt; *) a b.
(Functions f fn, HasSpec fn a, HasSpec fn b) =&gt;
f '[a] b -&gt; TypeSpec fn a -&gt; Spec fn b
</span><a href="Constrained.Base.html#mapTypeSpec"><span class="hs-identifier hs-var">mapTypeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679179382"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; TypeSpec fn a
</span><a href="Constrained.Base.html#emptySpec"><span class="hs-identifier hs-var">emptySpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182900"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182899"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1034"></span><span class="annot"><a href="Constrained.Base.html#mapSpec"><span class="hs-identifier hs-var">mapSpec</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span id="local-6989586621679179381"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679179381"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679179381"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-1035"></span><span class="annot"><a href="Constrained.Base.html#mapSpec"><span class="hs-identifier hs-var">mapSpec</span></a></span><span> </span><span id="local-6989586621679179380"><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679179380"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span id="local-6989586621679179379"><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679179379"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-var">MemberSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (as :: [*]) b.
FunctionLike fn =&gt;
fn as b -&gt; FunTy as b
</span><a href="Constrained.Univ.html#sem"><span class="hs-identifier hs-var">sem</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679179380"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679179379"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-1036"></span><span class="annot"><a href="Constrained.Base.html#mapSpec"><span class="hs-identifier hs-var">mapSpec</span></a></span><span> </span><span id="local-6989586621679179378"><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679179378"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-type">SuspendedSpec</span></a></span><span> </span><span id="local-6989586621679179342"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179342"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679179341"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179341"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1037"></span><span>  </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) p.
(IsPred p fn, HasSpec fn a) =&gt;
(Term fn a -&gt; p) -&gt; Spec fn a
</span><a href="Constrained.Base.html#constrained"><span class="hs-identifier hs-var">constrained</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679179339"><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679179339"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1038"></span><span>    </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
((forall b. Term fn b -&gt; b) -&gt; GE a) -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Exists"><span class="hs-identifier hs-var">Exists</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">forall b. Term fn b -&gt; b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a
</span><a href="Constrained.GenT.html#fatalError"><span class="hs-identifier hs-var">fatalError</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mapSpec&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179342"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
p -&gt; Pred fn
</span><a href="Constrained.Base.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679179339"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Term fn a -&gt; Term fn Bool
</span><a href="Constrained.Base.html#%3D%3D."><span class="hs-operator hs-var">==.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679179378"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; Var a -&gt; Term fn a
</span><a href="Constrained.Base.html#V"><span class="hs-identifier hs-var">V</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179342"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179341"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1039"></span><span class="annot"><a href="Constrained.Base.html#mapSpec"><span class="hs-identifier hs-var">mapSpec</span></a></span><span> </span><span id="local-6989586621679179338"><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679179338"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span id="local-6989586621679179329"><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679179329"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span id="local-6989586621679179328"><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679179328"><span class="hs-identifier hs-var">cant</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: [*] -&gt; * -&gt; *) (fn :: [*] -&gt; * -&gt; *) a b.
(Functions f fn, HasSpec fn a, HasSpec fn b) =&gt;
f '[a] b -&gt; TypeSpec fn a -&gt; Spec fn b
</span><a href="Constrained.Base.html#mapTypeSpec"><span class="hs-identifier hs-var">mapTypeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679179338"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679179329"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (f :: * -&gt; *).
(HasSpec fn a, Foldable f) =&gt;
f a -&gt; Spec fn a
</span><a href="Constrained.Base.html#notMemberSpec"><span class="hs-identifier hs-var">notMemberSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (as :: [*]) b.
FunctionLike fn =&gt;
fn as b -&gt; FunTy as b
</span><a href="Constrained.Univ.html#sem"><span class="hs-identifier hs-var">sem</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679179338"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679179328"><span class="hs-identifier hs-var">cant</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1040"></span><span>
</span><span id="line-1041"></span><span class="hs-comment">-- | If the `Spec fn Bool` doesn't constrain the boolean you will get a `TrueSpec` out.</span><span>
</span><span id="line-1042"></span><span id="local-6989586621679182885"><span id="local-6989586621679182886"><span class="annot"><a href="Constrained.Base.html#caseBoolSpec"><span class="hs-identifier hs-type">caseBoolSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182886"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182885"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182886"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182886"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182885"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182886"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182885"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-1043"></span><span id="caseBoolSpec"><span class="annot"><span class="annottext">caseBoolSpec :: forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Spec fn Bool -&gt; (Bool -&gt; Spec fn a) -&gt; Spec fn a
</span><a href="Constrained.Base.html#caseBoolSpec"><span class="hs-identifier hs-var hs-var">caseBoolSpec</span></a></span></span><span> </span><span id="local-6989586621679179324"><span class="annot"><span class="annottext">Spec fn Bool
</span><a href="#local-6989586621679179324"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span id="local-6989586621679179323"><span class="annot"><span class="annottext">Bool -&gt; Spec fn a
</span><a href="#local-6989586621679179323"><span class="hs-identifier hs-var">cont</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall {fn :: [*] -&gt; * -&gt; *}. Spec fn Bool -&gt; [Bool]
</span><a href="#local-6989586621679179322"><span class="hs-identifier hs-var">possibleValues</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn Bool
</span><a href="#local-6989586621679179324"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1044"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;No possible values in caseBoolSpec&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-1045"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679179321"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679179321"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Spec fn a
</span><a href="#local-6989586621679179323"><span class="hs-identifier hs-var">cont</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679179321"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1046"></span><span>  </span><span class="annot"><span class="annottext">[Bool]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-1047"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1048"></span><span>    </span><span id="local-6989586621679179322"><span class="annot"><span class="annottext">possibleValues :: Spec fn Bool -&gt; [Bool]
</span><a href="#local-6989586621679179322"><span class="hs-identifier hs-var hs-var">possibleValues</span></a></span></span><span> </span><span class="annot"><span class="annottext">Spec fn Bool
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1049"></span><span>    </span><span class="annot"><a href="#local-6989586621679179322"><span class="hs-identifier hs-var">possibleValues</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679179316"><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679179316"><span class="hs-identifier hs-var">cant</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`notElem`</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679179316"><span class="hs-identifier hs-var">cant</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1050"></span><span>    </span><span class="annot"><a href="#local-6989586621679179322"><span class="hs-identifier hs-var">possibleValues</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span id="local-6989586621679179315"><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679179315"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679179315"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1051"></span><span>    </span><span class="annot"><a href="#local-6989586621679179322"><span class="hs-identifier hs-var">possibleValues</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1052"></span><span>    </span><span class="annot"><a href="#local-6989586621679179322"><span class="hs-identifier hs-var">possibleValues</span></a></span><span> </span><span id="local-6989586621679179314"><span class="annot"><span class="annottext">s :: Spec fn Bool
</span><a href="#local-6989586621679179314"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-type">SuspendedSpec</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-identifier hs-var">conformsToSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn Bool
</span><a href="#local-6989586621679179314"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1053"></span><span>
</span><span id="line-1054"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-1055"></span><span class="hs-comment">-- Dependency Graphs</span><span>
</span><span id="line-1056"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-1057"></span><span>
</span><span id="line-1058"></span><span class="hs-keyword">type</span><span> </span><span id="DependGraph"><span class="annot"><a href="Constrained.Base.html#DependGraph"><span class="hs-identifier hs-var">DependGraph</span></a></span></span><span> </span><span id="local-6989586621679179311"><span class="annot"><a href="#local-6989586621679179311"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Graph.html#Graph"><span class="hs-identifier hs-type">Graph.Graph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679179311"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1059"></span><span>
</span><span id="line-1060"></span><span id="local-6989586621679182880"><span id="local-6989586621679182881"><span class="annot"><a href="Constrained.Base.html#dependency"><span class="hs-keyword hs-type">dependency</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasVariables"><span class="hs-identifier hs-type">HasVariables</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182881"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182880"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182881"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679182880"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#DependGraph"><span class="hs-identifier hs-type">DependGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182881"><span class="hs-identifier hs-type">fn</span></a></span></span></span><span>
</span><span id="line-1061"></span><span id="dependency"><span class="annot"><span class="annottext">dependency :: forall (fn :: [*] -&gt; * -&gt; *) t.
HasVariables fn t =&gt;
Name fn -&gt; t -&gt; DependGraph fn
</span><a href="Constrained.Base.html#dependency"><span class="hs-keyword hs-var hs-var">dependency</span></a></span></span><span> </span><span id="local-6989586621679179306"><span class="annot"><span class="annottext">Name fn
</span><a href="#local-6989586621679179306"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; Set (Name fn)
</span><a href="Constrained.Base.html#freeVarSet"><span class="hs-identifier hs-var">freeVarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679179305"><span class="annot"><span class="annottext">Set (Name fn)
</span><a href="#local-6989586621679179305"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall node. Ord node =&gt; node -&gt; Set node -&gt; Graph node
</span><a href="Constrained.Graph.html#dependency"><span class="hs-identifier hs-var">Graph.dependency</span></a></span><span> </span><span class="annot"><span class="annottext">Name fn
</span><a href="#local-6989586621679179306"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Name fn)
</span><a href="#local-6989586621679179305"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1062"></span><span>
</span><span id="line-1063"></span><span class="annot"><a href="Constrained.Base.html#irreflexiveDependencyOn"><span class="hs-identifier hs-type">irreflexiveDependencyOn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183056"><span class="annot"><a href="#local-6989586621679183056"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679183055"><span class="annot"><a href="#local-6989586621679183055"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679183054"><span class="annot"><a href="#local-6989586621679183054"><span class="hs-identifier hs-type">t'</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasVariables"><span class="hs-identifier hs-type">HasVariables</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183056"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183055"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasVariables"><span class="hs-identifier hs-type">HasVariables</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183056"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183054"><span class="hs-identifier hs-type">t'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679183055"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679183054"><span class="hs-identifier hs-type">t'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#DependGraph"><span class="hs-identifier hs-type">DependGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183056"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-1064"></span><span id="irreflexiveDependencyOn"><span class="annot"><span class="annottext">irreflexiveDependencyOn :: forall (fn :: [*] -&gt; * -&gt; *) t t'.
(HasVariables fn t, HasVariables fn t') =&gt;
t -&gt; t' -&gt; DependGraph fn
</span><a href="Constrained.Base.html#irreflexiveDependencyOn"><span class="hs-identifier hs-var hs-var">irreflexiveDependencyOn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; Set (Name fn)
</span><a href="Constrained.Base.html#freeVarSet"><span class="hs-identifier hs-var">freeVarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679179299"><span class="annot"><span class="annottext">Set (Name fn)
</span><a href="#local-6989586621679179299"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; Set (Name fn)
</span><a href="Constrained.Base.html#freeVarSet"><span class="hs-identifier hs-var">freeVarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679179298"><span class="annot"><span class="annottext">Set (Name fn)
</span><a href="#local-6989586621679179298"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall node. Ord node =&gt; Set node -&gt; Set node -&gt; Graph node
</span><a href="Constrained.Graph.html#irreflexiveDependencyOn"><span class="hs-identifier hs-var">Graph.irreflexiveDependencyOn</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Name fn)
</span><a href="#local-6989586621679179299"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Name fn)
</span><a href="#local-6989586621679179298"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-1065"></span><span>
</span><span id="line-1066"></span><span id="local-6989586621679183034"><span id="local-6989586621679183035"><span class="annot"><a href="Constrained.Base.html#noDependencies"><span class="hs-identifier hs-type">noDependencies</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasVariables"><span class="hs-identifier hs-type">HasVariables</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183035"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183034"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679183034"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#DependGraph"><span class="hs-identifier hs-type">DependGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183035"><span class="hs-identifier hs-type">fn</span></a></span></span></span><span>
</span><span id="line-1067"></span><span id="noDependencies"><span class="annot"><span class="annottext">noDependencies :: forall (fn :: [*] -&gt; * -&gt; *) t.
HasVariables fn t =&gt;
t -&gt; DependGraph fn
</span><a href="Constrained.Base.html#noDependencies"><span class="hs-identifier hs-var hs-var">noDependencies</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; Set (Name fn)
</span><a href="Constrained.Base.html#freeVarSet"><span class="hs-identifier hs-var">freeVarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679179294"><span class="annot"><span class="annottext">Set (Name fn)
</span><a href="#local-6989586621679179294"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall node. Ord node =&gt; Set node -&gt; Graph node
</span><a href="Constrained.Graph.html#noDependencies"><span class="hs-identifier hs-var">Graph.noDependencies</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Name fn)
</span><a href="#local-6989586621679179294"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1068"></span><span>
</span><span id="line-1069"></span><span class="hs-keyword">type</span><span> </span><span id="Hints"><span class="annot"><a href="Constrained.Base.html#Hints"><span class="hs-identifier hs-var">Hints</span></a></span></span><span> </span><span id="local-6989586621679179293"><span class="annot"><a href="#local-6989586621679179293"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#DependGraph"><span class="hs-identifier hs-type">DependGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679179293"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-1070"></span><span>
</span><span id="line-1071"></span><span id="local-6989586621679183067"><span class="annot"><a href="Constrained.Base.html#respecting"><span class="hs-identifier hs-type">respecting</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#Hints"><span class="hs-identifier hs-type">Hints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183067"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#DependGraph"><span class="hs-identifier hs-type">DependGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183067"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#DependGraph"><span class="hs-identifier hs-type">DependGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183067"><span class="hs-identifier hs-type">f</span></a></span></span><span>
</span><span id="line-1072"></span><span id="respecting"><span class="annot"><span class="annottext">respecting :: forall (f :: [*] -&gt; * -&gt; *). Hints f -&gt; Hints f -&gt; Hints f
</span><a href="Constrained.Base.html#respecting"><span class="hs-identifier hs-var hs-var">respecting</span></a></span></span><span> </span><span id="local-6989586621679179291"><span class="annot"><span class="annottext">Hints f
</span><a href="#local-6989586621679179291"><span class="hs-identifier hs-var">hints</span></a></span></span><span> </span><span id="local-6989586621679179290"><span class="annot"><span class="annottext">Hints f
</span><a href="#local-6989586621679179290"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hints f
</span><a href="#local-6989586621679179290"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">forall node. Ord node =&gt; Graph node -&gt; Graph node -&gt; Graph node
</span><a href="Constrained.Graph.html#subtractGraph"><span class="hs-operator hs-var">`subtractGraph`</span></a></span><span> </span><span class="annot"><span class="annottext">forall node. Graph node -&gt; Graph node
</span><a href="Constrained.Graph.html#opGraph"><span class="hs-identifier hs-var">opGraph</span></a></span><span> </span><span class="annot"><span class="annottext">Hints f
</span><a href="#local-6989586621679179291"><span class="hs-identifier hs-var">hints</span></a></span><span>
</span><span id="line-1073"></span><span>
</span><span id="line-1074"></span><span id="local-6989586621679182974"><span class="annot"><a href="Constrained.Base.html#solvableFrom"><span class="hs-identifier hs-type">solvableFrom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182974"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182974"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#DependGraph"><span class="hs-identifier hs-type">DependGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182974"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-1075"></span><span id="solvableFrom"><span class="annot"><span class="annottext">solvableFrom :: forall (f :: [*] -&gt; * -&gt; *).
Name f -&gt; Set (Name f) -&gt; DependGraph f -&gt; Bool
</span><a href="Constrained.Base.html#solvableFrom"><span class="hs-identifier hs-var hs-var">solvableFrom</span></a></span></span><span> </span><span id="local-6989586621679179284"><span class="annot"><span class="annottext">Name f
</span><a href="#local-6989586621679179284"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679179283"><span class="annot"><span class="annottext">Set (Name f)
</span><a href="#local-6989586621679179283"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679179282"><span class="annot"><span class="annottext">DependGraph f
</span><a href="#local-6989586621679179282"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1076"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679179281"><span class="annot"><span class="annottext">less :: Set (Name f)
</span><a href="#local-6989586621679179281"><span class="hs-identifier hs-var hs-var">less</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall node. Ord node =&gt; node -&gt; Graph node -&gt; Set node
</span><a href="Constrained.Graph.html#dependencies"><span class="hs-identifier hs-var">dependencies</span></a></span><span> </span><span class="annot"><span class="annottext">Name f
</span><a href="#local-6989586621679179284"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">DependGraph f
</span><a href="#local-6989586621679179282"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-1077"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Set (Name f)
</span><a href="#local-6989586621679179283"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-operator hs-var">`Set.isSubsetOf`</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Name f)
</span><a href="#local-6989586621679179281"><span class="hs-identifier hs-var">less</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name f
</span><a href="#local-6989586621679179284"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-operator hs-var">`Set.member`</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Name f)
</span><a href="#local-6989586621679179281"><span class="hs-identifier hs-var">less</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1078"></span><span>
</span><span id="line-1079"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-1080"></span><span class="hs-comment">-- Free variables and variable names</span><span>
</span><span id="line-1081"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-1082"></span><span>
</span><span id="line-1083"></span><span class="annot"><a href="Constrained.Base.html#freeVarNames"><span class="hs-identifier hs-type">freeVarNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183091"><span class="annot"><a href="#local-6989586621679183091"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679183090"><span class="annot"><a href="#local-6989586621679183090"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasVariables"><span class="hs-identifier hs-type">HasVariables</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183091"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183090"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679183090"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-1084"></span><span id="freeVarNames"><span class="annot"><span class="annottext">freeVarNames :: forall (fn :: [*] -&gt; * -&gt; *) t. HasVariables fn t =&gt; t -&gt; Set Int
</span><a href="Constrained.Base.html#freeVarNames"><span class="hs-identifier hs-var hs-var">freeVarNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. Ord b =&gt; (a -&gt; b) -&gt; Set a -&gt; Set b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span id="local-6989586621679179272"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179272"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Var a -&gt; Int
</span><a href="Constrained.Core.html#nameOf"><span class="hs-identifier hs-var">nameOf</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179272"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; Set (Name fn)
</span><a href="Constrained.Base.html#freeVarSet"><span class="hs-identifier hs-var">freeVarSet</span></a></span><span>
</span><span id="line-1085"></span><span>
</span><span id="line-1086"></span><span class="hs-keyword">data</span><span> </span><span id="Name"><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-var">Name</span></a></span></span><span> </span><span id="local-6989586621679179271"><span class="annot"><a href="#local-6989586621679179271"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1087"></span><span>  </span><span id="local-6989586621679179270"><span id="local-6989586621679183008"><span id="Name"><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-var">Name</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183008"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679179270"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679179270"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183008"><span class="hs-identifier hs-type">fn</span></a></span></span></span><span>
</span><span id="line-1088"></span><span>
</span><span id="line-1089"></span><span id="local-6989586621679179264"><span id="local-6989586621679179266"><span id="local-6989586621679179268"><span id="local-6989586621679182987"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182987"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-1090"></span><span>
</span><span id="line-1091"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679179261"><span id="local-6989586621679182858"><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182858"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1092"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span id="local-6989586621679179258"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179258"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679179257"><span class="annot"><span class="annottext">== :: Name fn -&gt; Name fn -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span id="local-6989586621679179250"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179250"><span class="hs-identifier hs-var">v'</span></a></span></span><span>
</span><span id="line-1093"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679179249"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179249"><span class="hs-identifier hs-var">v''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. (Typeable a, Typeable b) =&gt; a -&gt; Maybe b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">cast</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179258"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179250"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179249"><span class="hs-identifier hs-var">v''</span></a></span><span>
</span><span id="line-1094"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-1095"></span><span>
</span><span id="line-1096"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679179233"><span id="local-6989586621679179235"><span id="local-6989586621679179237"><span id="local-6989586621679179239"><span id="local-6989586621679179241"><span id="local-6989586621679179243"><span id="local-6989586621679183068"><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183068"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1097"></span><span>  </span><span id="local-6989586621679179231"><span class="annot"><span class="annottext">compare :: Name fn -&gt; Name fn -&gt; Ordering
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">compare</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span id="local-6989586621679179227"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179227"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span id="local-6989586621679179215"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179215"><span class="hs-identifier hs-var">v'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1098"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679179214"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179214"><span class="hs-identifier hs-var">v''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. (Typeable a, Typeable b) =&gt; a -&gt; Maybe b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">cast</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179227"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179214"><span class="hs-identifier hs-var">v''</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179215"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-1099"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (proxy :: k -&gt; *) (a :: k).
Typeable a =&gt;
proxy a -&gt; TypeRep
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">typeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179227"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (proxy :: k -&gt; *) (a :: k).
Typeable a =&gt;
proxy a -&gt; TypeRep
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">typeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179215"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1100"></span><span>
</span><span id="line-1101"></span><span class="hs-keyword">newtype</span><span> </span><span id="FreeVars"><span class="annot"><a href="Constrained.Base.html#FreeVars"><span class="hs-identifier hs-var">FreeVars</span></a></span></span><span> </span><span id="local-6989586621679182850"><span class="annot"><a href="#local-6989586621679182850"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FreeVars"><span class="annot"><a href="Constrained.Base.html#FreeVars"><span class="hs-identifier hs-var">FreeVars</span></a></span></span><span> </span><span class="hs-special">{</span><span id="unFreeVars"><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). FreeVars fn -&gt; Map (Name fn) Int
</span><a href="Constrained.Base.html#unFreeVars"><span class="hs-identifier hs-var hs-var">unFreeVars</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182850"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1102"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679179201"><span id="local-6989586621679179203"><span id="local-6989586621679179210"><span class="annot"><span class="annottext">Int -&gt; FreeVars fn -&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall (fn :: [*] -&gt; * -&gt; *). Int -&gt; FreeVars fn -&gt; ShowS
forall (fn :: [*] -&gt; * -&gt; *). [FreeVars fn] -&gt; ShowS
forall (fn :: [*] -&gt; * -&gt; *). FreeVars fn -&gt; String
showList :: [FreeVars fn] -&gt; ShowS
$cshowList :: forall (fn :: [*] -&gt; * -&gt; *). [FreeVars fn] -&gt; ShowS
show :: FreeVars fn -&gt; String
$cshow :: forall (fn :: [*] -&gt; * -&gt; *). FreeVars fn -&gt; String
showsPrec :: Int -&gt; FreeVars fn -&gt; ShowS
$cshowsPrec :: forall (fn :: [*] -&gt; * -&gt; *). Int -&gt; FreeVars fn -&gt; ShowS
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-1103"></span><span>
</span><span id="line-1104"></span><span id="local-6989586621679182845"><span class="annot"><a href="Constrained.Base.html#restrictedTo"><span class="hs-identifier hs-type">restrictedTo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182845"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182845"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182845"><span class="hs-identifier hs-type">fn</span></a></span></span><span>
</span><span id="line-1105"></span><span id="restrictedTo"><span class="annot"><span class="annottext">restrictedTo :: forall (fn :: [*] -&gt; * -&gt; *).
FreeVars fn -&gt; Set (Name fn) -&gt; FreeVars fn
</span><a href="Constrained.Base.html#restrictedTo"><span class="hs-identifier hs-var hs-var">restrictedTo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span> </span><span id="local-6989586621679179197"><span class="annot"><span class="annottext">Map (Name fn) Int
</span><a href="#local-6989586621679179197"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679179196"><span class="annot"><span class="annottext">Set (Name fn)
</span><a href="#local-6989586621679179196"><span class="hs-identifier hs-var">nms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Map (Name fn) Int -&gt; FreeVars fn
</span><a href="Constrained.Base.html#FreeVars"><span class="hs-identifier hs-var">FreeVars</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.restrictKeys</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Name fn) Int
</span><a href="#local-6989586621679179197"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Name fn)
</span><a href="#local-6989586621679179196"><span class="hs-identifier hs-var">nms</span></a></span><span>
</span><span id="line-1106"></span><span>
</span><span id="line-1107"></span><span id="local-6989586621679182841"><span class="annot"><a href="Constrained.Base.html#memberOf"><span class="hs-identifier hs-type">memberOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182841"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182841"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-1108"></span><span id="memberOf"><span class="annot"><span class="annottext">memberOf :: forall (fn :: [*] -&gt; * -&gt; *). Name fn -&gt; FreeVars fn -&gt; Bool
</span><a href="Constrained.Base.html#memberOf"><span class="hs-identifier hs-var hs-var">memberOf</span></a></span></span><span> </span><span id="local-6989586621679179192"><span class="annot"><span class="annottext">Name fn
</span><a href="#local-6989586621679179192"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span> </span><span id="local-6989586621679179191"><span class="annot"><span class="annottext">Map (Name fn) Int
</span><a href="#local-6989586621679179191"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.member</span></a></span><span> </span><span class="annot"><span class="annottext">Name fn
</span><a href="#local-6989586621679179192"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Name fn) Int
</span><a href="#local-6989586621679179191"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1109"></span><span>
</span><span id="line-1110"></span><span id="local-6989586621679182837"><span class="annot"><a href="Constrained.Base.html#count"><span class="hs-identifier hs-type">count</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182837"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182837"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span></span><span>
</span><span id="line-1111"></span><span id="count"><span class="annot"><span class="annottext">count :: forall (fn :: [*] -&gt; * -&gt; *). Name fn -&gt; FreeVars fn -&gt; Int
</span><a href="Constrained.Base.html#count"><span class="hs-identifier hs-var hs-var">count</span></a></span></span><span> </span><span id="local-6989586621679179186"><span class="annot"><span class="annottext">Name fn
</span><a href="#local-6989586621679179186"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span> </span><span id="local-6989586621679179185"><span class="annot"><span class="annottext">Map (Name fn) Int
</span><a href="#local-6989586621679179185"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Name fn
</span><a href="#local-6989586621679179186"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Name fn) Int
</span><a href="#local-6989586621679179185"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1112"></span><span>
</span><span id="line-1113"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679179178"><span id="local-6989586621679179180"><span id="local-6989586621679182832"><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182832"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1114"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span> </span><span id="local-6989586621679179175"><span class="annot"><span class="annottext">Map (Name fn) Int
</span><a href="#local-6989586621679179175"><span class="hs-identifier hs-var">fv</span></a></span></span><span> </span><span id="local-6989586621679179174"><span class="annot"><span class="annottext">&lt;&gt; :: FreeVars fn -&gt; FreeVars fn -&gt; FreeVars fn
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span> </span><span id="local-6989586621679179173"><span class="annot"><span class="annottext">Map (Name fn) Int
</span><a href="#local-6989586621679179173"><span class="hs-identifier hs-var">fv'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Map (Name fn) Int -&gt; FreeVars fn
</span><a href="Constrained.Base.html#FreeVars"><span class="hs-identifier hs-var">FreeVars</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.unionWith</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">(+)</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Name fn) Int
</span><a href="#local-6989586621679179175"><span class="hs-identifier hs-var">fv</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Name fn) Int
</span><a href="#local-6989586621679179173"><span class="hs-identifier hs-var">fv'</span></a></span><span>
</span><span id="line-1115"></span><span>
</span><span id="line-1116"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679179164"><span id="local-6989586621679179166"><span id="local-6989586621679182828"><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182828"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1117"></span><span>  </span><span id="local-6989586621679179160"><span class="annot"><span class="annottext">mempty :: FreeVars fn
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Map (Name fn) Int -&gt; FreeVars fn
</span><a href="Constrained.Base.html#FreeVars"><span class="hs-identifier hs-var">FreeVars</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-1118"></span><span>
</span><span id="line-1119"></span><span id="local-6989586621679182825"><span class="annot"><a href="Constrained.Base.html#freeVar"><span class="hs-identifier hs-type">freeVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182825"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182825"><span class="hs-identifier hs-type">fn</span></a></span></span><span>
</span><span id="line-1120"></span><span id="freeVar"><span class="annot"><span class="annottext">freeVar :: forall (fn :: [*] -&gt; * -&gt; *). Name fn -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVar"><span class="hs-identifier hs-var hs-var">freeVar</span></a></span></span><span> </span><span id="local-6989586621679179157"><span class="annot"><span class="annottext">Name fn
</span><a href="#local-6989586621679179157"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Map (Name fn) Int -&gt; FreeVars fn
</span><a href="Constrained.Base.html#FreeVars"><span class="hs-identifier hs-var">FreeVars</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. k -&gt; a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Name fn
</span><a href="#local-6989586621679179157"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1121"></span><span>
</span><span id="line-1122"></span><span id="local-6989586621679182820"><span id="local-6989586621679182821"><span class="annot"><a href="Constrained.Base.html#without"><span class="hs-identifier hs-type">without</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Foldable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182821"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182820"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679182821"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182820"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182820"><span class="hs-identifier hs-type">fn</span></a></span></span></span><span>
</span><span id="line-1123"></span><span id="without"><span class="annot"><span class="annottext">without :: forall (t :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *).
Foldable t =&gt;
FreeVars fn -&gt; t (Name fn) -&gt; FreeVars fn
</span><a href="Constrained.Base.html#without"><span class="hs-identifier hs-var hs-var">without</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span> </span><span id="local-6989586621679179150"><span class="annot"><span class="annottext">Map (Name fn) Int
</span><a href="#local-6989586621679179150"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679179149"><span class="annot"><span class="annottext">t (Name fn)
</span><a href="#local-6989586621679179149"><span class="hs-identifier hs-var">remove</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Map (Name fn) Int -&gt; FreeVars fn
</span><a href="Constrained.Base.html#FreeVars"><span class="hs-identifier hs-var">FreeVars</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.delete</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Name fn) Int
</span><a href="#local-6989586621679179150"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">t (Name fn)
</span><a href="#local-6989586621679179149"><span class="hs-identifier hs-var">remove</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1124"></span><span>
</span><span id="line-1125"></span><span class="hs-keyword">class</span><span> </span><span id="HasVariables"><span class="annot"><a href="Constrained.Base.html#HasVariables"><span class="hs-identifier hs-var">HasVariables</span></a></span></span><span> </span><span id="local-6989586621679182809"><span class="annot"><a href="#local-6989586621679182809"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679182808"><span class="annot"><a href="#local-6989586621679182808"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679182808"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679182809"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1126"></span><span>  </span><span id="freeVars"><span class="annot"><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-type">freeVars</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679182808"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182809"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-1127"></span><span>
</span><span id="line-1128"></span><span id="local-6989586621679182984"><span id="local-6989586621679182985"><span class="annot"><a href="Constrained.Base.html#freeVarSet"><span class="hs-identifier hs-type">freeVarSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasVariables"><span class="hs-identifier hs-type">HasVariables</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182985"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182984"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679182984"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182985"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1129"></span><span id="freeVarSet"><span class="annot"><span class="annottext">freeVarSet :: forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; Set (Name fn)
</span><a href="Constrained.Base.html#freeVarSet"><span class="hs-identifier hs-var hs-var">freeVarSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Map.keysSet</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). FreeVars fn -&gt; Map (Name fn) Int
</span><a href="Constrained.Base.html#unFreeVars"><span class="hs-identifier hs-var">unFreeVars</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span>
</span><span id="line-1130"></span><span>
</span><span id="line-1131"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182802"><span id="local-6989586621679182803"><span id="local-6989586621679182804"><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasVariables"><span class="hs-identifier hs-type">HasVariables</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182804"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182803"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasVariables"><span class="hs-identifier hs-type">HasVariables</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182804"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182802"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasVariables"><span class="hs-identifier hs-type">HasVariables</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182804"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182803"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679182802"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1132"></span><span>  </span><span id="local-6989586621679179134"><span class="annot"><span class="annottext">freeVars :: (a, b) -&gt; FreeVars f
</span><a href="#local-6989586621679179134"><span class="hs-identifier hs-var hs-var hs-var hs-var">freeVars</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679179133"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679179133"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679179132"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679179132"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679179133"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679179132"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1133"></span><span>
</span><span id="line-1134"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182798"><span id="local-6989586621679182799"><span class="annot"><a href="Constrained.Base.html#HasVariables"><span class="hs-identifier hs-type">HasVariables</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182799"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.List.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182799"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679182798"><span class="hs-keyword hs-type">as</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1135"></span><span>  </span><span id="local-6989586621679179129"><span class="annot"><span class="annottext">freeVars :: List (Term fn) as -&gt; FreeVars fn
</span><a href="#local-6989586621679179129"><span class="hs-identifier hs-var hs-var hs-var hs-var">freeVars</span></a></span></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-1136"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679179122"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179122"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679179121"><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679179121"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179122"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679179121"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1137"></span><span>
</span><span id="line-1138"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182996"><span class="annot"><a href="Constrained.Base.html#HasVariables"><span class="hs-identifier hs-type">HasVariables</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182996"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182996"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1139"></span><span>  </span><span id="local-6989586621679179119"><span class="annot"><span class="annottext">freeVars :: Name f -&gt; FreeVars f
</span><a href="#local-6989586621679179119"><span class="hs-identifier hs-var hs-var hs-var hs-var">freeVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Name fn -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVar"><span class="hs-identifier hs-var">freeVar</span></a></span><span>
</span><span id="line-1140"></span><span>
</span><span id="line-1141"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679183057"><span id="local-6989586621679183058"><span class="annot"><a href="Constrained.Base.html#HasVariables"><span class="hs-identifier hs-type">HasVariables</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183058"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183058"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183057"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1142"></span><span>  </span><span id="local-6989586621679179117"><span class="annot"><span class="annottext">freeVars :: Term fn a -&gt; FreeVars fn
</span><a href="#local-6989586621679179117"><span class="hs-identifier hs-var hs-var hs-var hs-var">freeVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1143"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-1144"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span id="local-6989586621679179112"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179112"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Name fn -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVar"><span class="hs-identifier hs-var">freeVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; Var a -&gt; Name fn
</span><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-var">Name</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179112"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1145"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="annot"><span class="annottext">fn as a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679179105"><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679179105"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679179105"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-1146"></span><span>
</span><span id="line-1147"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679183092"><span class="annot"><a href="Constrained.Base.html#HasVariables"><span class="hs-identifier hs-type">HasVariables</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183092"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183092"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1148"></span><span>  </span><span id="local-6989586621679179098"><span class="annot"><span class="annottext">freeVars :: Pred fn -&gt; FreeVars fn
</span><a href="#local-6989586621679179098"><span class="hs-identifier hs-var hs-var hs-var hs-var">freeVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1149"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#GenHint"><span class="hs-identifier hs-type">GenHint</span></a></span><span> </span><span class="annot"><span class="annottext">Hint a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679179095"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179095"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179095"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1150"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span id="local-6989586621679179088"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179088"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679179087"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179087"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679179086"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179086"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179087"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179086"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *).
Foldable t =&gt;
FreeVars fn -&gt; t (Name fn) -&gt; FreeVars fn
</span><a href="Constrained.Base.html#without"><span class="hs-operator hs-var">`without`</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; Var a -&gt; Name fn
</span><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-var">Name</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179088"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1151"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span id="local-6989586621679179085"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679179085"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679179085"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-1152"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span id="local-6989586621679179081"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179081"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679179080"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679179080"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179081"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679179080"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1153"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Exists"><span class="hs-identifier hs-type">Exists</span></a></span><span> </span><span class="annot"><span class="annottext">(forall b. Term fn b -&gt; b) -&gt; GE a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679179078"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679179078"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679179078"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1154"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Assert"><span class="hs-identifier hs-type">Assert</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679179075"><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679179075"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679179075"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1155"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Reify"><span class="hs-identifier hs-type">Reify</span></a></span><span> </span><span id="local-6989586621679179069"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179069"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679179068"><span class="annot"><span class="annottext">Binder fn b
</span><a href="#local-6989586621679179068"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179069"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn b
</span><a href="#local-6989586621679179068"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1156"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#DependsOn"><span class="hs-identifier hs-type">DependsOn</span></a></span><span> </span><span id="local-6989586621679179062"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179062"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679179061"><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679179061"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179062"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679179061"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1157"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#ForAll"><span class="hs-identifier hs-type">ForAll</span></a></span><span> </span><span id="local-6989586621679179054"><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679179054"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span id="local-6989586621679179053"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679179053"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679179054"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679179053"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1158"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Case"><span class="hs-identifier hs-type">Case</span></a></span><span> </span><span id="local-6989586621679179048"><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679179048"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679179047"><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679179047"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679179048"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679179047"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-1159"></span><span>    </span><span class="annot"><span class="annottext">Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-1160"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-type">FalsePred</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-1161"></span><span>
</span><span id="line-1162"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679183059"><span id="local-6989586621679183060"><span class="annot"><a href="Constrained.Base.html#HasVariables"><span class="hs-identifier hs-type">HasVariables</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183060"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183060"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183059"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1163"></span><span>  </span><span id="local-6989586621679179045"><span class="annot"><span class="annottext">freeVars :: Binder fn a -&gt; FreeVars fn
</span><a href="#local-6989586621679179045"><span class="hs-identifier hs-var hs-var hs-var hs-var">freeVars</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679179040"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179040"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679179039"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179039"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679179039"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *).
Foldable t =&gt;
FreeVars fn -&gt; t (Name fn) -&gt; FreeVars fn
</span><a href="Constrained.Base.html#without"><span class="hs-operator hs-var">`without`</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; Var a -&gt; Name fn
</span><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-var">Name</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679179040"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1164"></span><span>
</span><span id="line-1165"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679183045"><span id="local-6989586621679183046"><span class="annot"><a href="Constrained.Base.html#HasVariables"><span class="hs-identifier hs-type">HasVariables</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183046"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.List.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183046"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679183045"><span class="hs-keyword hs-type">as</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1166"></span><span>  </span><span id="local-6989586621679179037"><span class="annot"><span class="annottext">freeVars :: List (Binder fn) as -&gt; FreeVars fn
</span><a href="#local-6989586621679179037"><span class="hs-identifier hs-var hs-var hs-var hs-var">freeVars</span></a></span></span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-1167"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679179030"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679179030"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679179029"><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679179029"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679179030"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679179029"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-1168"></span><span>
</span><span id="line-1169"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-pragma">{-# OVERLAPPABLE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span id="local-6989586621679182768"><span id="local-6989586621679182769"><span id="local-6989586621679182770"><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Foldable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182770"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasVariables"><span class="hs-identifier hs-type">HasVariables</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182769"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182768"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasVariables"><span class="hs-identifier hs-type">HasVariables</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182769"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182770"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182768"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1170"></span><span>  </span><span id="local-6989586621679179021"><span class="annot"><span class="annottext">freeVars :: t a -&gt; FreeVars f
</span><a href="#local-6989586621679179021"><span class="hs-identifier hs-var hs-var hs-var hs-var">freeVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span>
</span><span id="line-1171"></span><span>
</span><span id="line-1172"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182997"><span id="local-6989586621679182998"><span class="annot"><a href="Constrained.Base.html#HasVariables"><span class="hs-identifier hs-type">HasVariables</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182998"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182997"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasVariables"><span class="hs-identifier hs-type">HasVariables</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182998"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182997"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1173"></span><span>  </span><span id="local-6989586621679179015"><span class="annot"><span class="annottext">freeVars :: Set a -&gt; FreeVars f
</span><a href="#local-6989586621679179015"><span class="hs-identifier hs-var hs-var hs-var hs-var">freeVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span>
</span><span id="line-1174"></span><span>
</span><span id="line-1175"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-1176"></span><span class="hs-comment">-- Substitutions</span><span>
</span><span id="line-1177"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-1178"></span><span>
</span><span id="line-1179"></span><span class="hs-keyword">type</span><span> </span><span id="Subst"><span class="annot"><a href="Constrained.Base.html#Subst"><span class="hs-identifier hs-var">Subst</span></a></span></span><span> </span><span id="local-6989586621679179014"><span class="annot"><a href="#local-6989586621679179014"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Base.html#SubstEntry"><span class="hs-identifier hs-type">SubstEntry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679179014"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1180"></span><span>
</span><span id="line-1181"></span><span class="hs-keyword">data</span><span> </span><span id="SubstEntry"><span class="annot"><a href="Constrained.Base.html#SubstEntry"><span class="hs-identifier hs-var">SubstEntry</span></a></span></span><span> </span><span id="local-6989586621679179013"><span class="annot"><a href="#local-6989586621679179013"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1182"></span><span>  </span><span id="local-6989586621679179012"><span id="local-6989586621679182734"><span id="%3A%3D"><span class="annot"><a href="Constrained.Base.html#%3A%3D"><span class="hs-operator hs-var">(:=)</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182734"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679179012"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679179012"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182734"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679179012"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#SubstEntry"><span class="hs-identifier hs-type">SubstEntry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182734"><span class="hs-identifier hs-type">fn</span></a></span></span></span><span>
</span><span id="line-1183"></span><span>
</span><span id="line-1184"></span><span class="annot"><a href="Constrained.Base.html#backwardsSubstitution"><span class="hs-identifier hs-type">backwardsSubstitution</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182765"><span class="annot"><a href="#local-6989586621679182765"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679182764"><span class="annot"><a href="#local-6989586621679182764"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182765"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182764"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182765"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182765"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182764"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182765"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182764"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1185"></span><span id="backwardsSubstitution"><span class="annot"><span class="annottext">backwardsSubstitution :: forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#backwardsSubstitution"><span class="hs-identifier hs-var hs-var">backwardsSubstitution</span></a></span></span><span> </span><span id="local-6989586621679179002"><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679179002"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span id="local-6989586621679179001"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179001"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1186"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Subst fn -&gt; Term fn a -&gt; Maybe (Var a)
</span><a href="#local-6989586621679179000"><span class="hs-identifier hs-var">findMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679179002"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179001"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1187"></span><span>    </span><span class="hs-comment">-- TODO: what about multiple matches??</span><span>
</span><span id="line-1188"></span><span>    </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679178999"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178999"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; Var a -&gt; Term fn a
</span><a href="Constrained.Base.html#V"><span class="hs-identifier hs-var">V</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178999"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1189"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Var a)
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679179001"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1190"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679178996"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679178996"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679178996"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1191"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span id="local-6989586621679178993"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178993"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; Var a -&gt; Term fn a
</span><a href="Constrained.Base.html#V"><span class="hs-identifier hs-var">V</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178993"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1192"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span id="local-6989586621679178981"><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679178981"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679178980"><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679178980"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (a :: [*]) (fn :: [*] -&gt; * -&gt; *) b.
(Typeable a, TypeList a, All (HasSpec fn) a, HasSpec fn b,
 BaseUniverse fn) =&gt;
fn a b -&gt; List (Term fn) a -&gt; Term fn b
</span><a href="Constrained.Base.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679178981"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (c :: k -&gt; Constraint) (as :: [k]) (f :: k -&gt; *)
       (g :: k -&gt; *).
All c as =&gt;
(forall (a :: k). c a =&gt; f a -&gt; g a) -&gt; List f as -&gt; List g as
</span><a href="Constrained.List.html#mapListC"><span class="hs-identifier hs-var">mapListC</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182765"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#backwardsSubstitution"><span class="hs-identifier hs-var">backwardsSubstitution</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679179002"><span class="hs-identifier hs-var">sub</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679178980"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1193"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1194"></span><span>    </span><span class="annot"><a href="#local-6989586621679179000"><span class="hs-identifier hs-type">findMatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182765"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182765"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182764"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182764"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1195"></span><span>    </span><span id="local-6989586621679179000"><span class="annot"><span class="annottext">findMatch :: Subst fn -&gt; Term fn a -&gt; Maybe (Var a)
</span><a href="#local-6989586621679179000"><span class="hs-identifier hs-var hs-var">findMatch</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1196"></span><span>    </span><span class="annot"><a href="#local-6989586621679179000"><span class="hs-identifier hs-var">findMatch</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679178962"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178962"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A%3D"><span class="hs-operator hs-type">:=</span></a></span><span> </span><span id="local-6989586621679178961"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178961"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679178960"><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679178960"><span class="hs-identifier hs-var">sub</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679178959"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178959"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-1197"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679178958"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178958"><span class="hs-identifier hs-var">x'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679178957"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178957"><span class="hs-identifier hs-var">t''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. (Typeable a, Typeable b) =&gt; a -&gt; Maybe b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">cast</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178962"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178961"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1198"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178959"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178957"><span class="hs-identifier hs-var">t''</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1199"></span><span>          </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178958"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-1200"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Subst fn -&gt; Term fn a -&gt; Maybe (Var a)
</span><a href="#local-6989586621679179000"><span class="hs-identifier hs-var">findMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679178960"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178959"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1201"></span><span>
</span><span id="line-1202"></span><span class="annot"><a href="Constrained.Base.html#substituteTerm"><span class="hs-identifier hs-type">substituteTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182754"><span class="annot"><a href="#local-6989586621679182754"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679182753"><span class="annot"><a href="#local-6989586621679182753"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.Base.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182754"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182754"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182753"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182754"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182753"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1203"></span><span id="substituteTerm"><span class="annot"><span class="annottext">substituteTerm :: forall (fn :: [*] -&gt; * -&gt; *) a. Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substituteTerm"><span class="hs-identifier hs-var hs-var">substituteTerm</span></a></span></span><span> </span><span id="local-6989586621679178955"><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679178955"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1204"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679178952"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679178952"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679178952"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1205"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span id="local-6989586621679178949"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178949"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HasSpec fn a =&gt; Subst fn -&gt; Var a -&gt; Term fn a
</span><a href="#local-6989586621679178948"><span class="hs-identifier hs-var">substVar</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679178955"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178949"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1206"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span id="local-6989586621679178931"><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679178931"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (as :: [k]).
(forall (a :: k). f a -&gt; g a) -&gt; List f as -&gt; List g as
</span><a href="Constrained.List.html#mapList"><span class="hs-identifier hs-var">mapList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substituteTerm"><span class="hs-identifier hs-var">substituteTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679178955"><span class="hs-identifier hs-var">sub</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679178930"><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679178930"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1207"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (as :: [*]).
List (Term fn) as -&gt; Maybe (List Value as)
</span><a href="Constrained.Base.html#fromLits"><span class="hs-identifier hs-var">fromLits</span></a></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679178930"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1208"></span><span>      </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679178928"><span class="annot"><span class="annottext">List Value as
</span><a href="#local-6989586621679178928"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (ts :: [*]) (f :: * -&gt; *) r.
TypeList ts =&gt;
(forall a. f a -&gt; a) -&gt; FunTy ts r -&gt; List f ts -&gt; r
</span><a href="Constrained.List.html#uncurryList_"><span class="hs-identifier hs-var">uncurryList_</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Value a -&gt; a
</span><a href="Constrained.Core.html#unValue"><span class="hs-identifier hs-var">unValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (as :: [*]) b.
FunctionLike fn =&gt;
fn as b -&gt; FunTy as b
</span><a href="Constrained.Univ.html#sem"><span class="hs-identifier hs-var">sem</span></a></span><span> </span><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679178931"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List Value as
</span><a href="#local-6989586621679178928"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1209"></span><span>      </span><span class="annot"><span class="annottext">Maybe (List Value as)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (a :: [*]) (fn :: [*] -&gt; * -&gt; *) b.
(Typeable a, TypeList a, All (HasSpec fn) a, HasSpec fn b,
 BaseUniverse fn) =&gt;
fn a b -&gt; List (Term fn) a -&gt; Term fn b
</span><a href="Constrained.Base.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679178931"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679178930"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-1210"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1211"></span><span>    </span><span class="annot"><a href="#local-6989586621679178948"><span class="hs-identifier hs-type">substVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182754"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182753"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182754"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182753"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182754"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182753"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1212"></span><span>    </span><span id="local-6989586621679178948"><span class="annot"><span class="annottext">substVar :: HasSpec fn a =&gt; Subst fn -&gt; Var a -&gt; Term fn a
</span><a href="#local-6989586621679178948"><span class="hs-identifier hs-var hs-var">substVar</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679178923"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178923"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; Var a -&gt; Term fn a
</span><a href="Constrained.Base.html#V"><span class="hs-identifier hs-var">V</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178923"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1213"></span><span>    </span><span class="annot"><a href="#local-6989586621679178948"><span class="hs-identifier hs-var">substVar</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679178917"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178917"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A%3D"><span class="hs-operator hs-type">:=</span></a></span><span> </span><span id="local-6989586621679178916"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178916"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679178915"><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679178915"><span class="hs-identifier hs-var">sub</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679178914"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178914"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-1214"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a :~: a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Refl</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a a'.
(Typeable a, Typeable a') =&gt;
Var a -&gt; Var a' -&gt; Maybe (a :~: a')
</span><a href="Constrained.Core.html#eqVar"><span class="hs-identifier hs-var">eqVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178914"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178917"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178916"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1215"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasSpec fn a =&gt; Subst fn -&gt; Var a -&gt; Term fn a
</span><a href="#local-6989586621679178948"><span class="hs-identifier hs-var">substVar</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679178915"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178914"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1216"></span><span>
</span><span id="line-1217"></span><span id="local-6989586621679182743"><span id="local-6989586621679182744"><span id="local-6989586621679182745"><span class="annot"><a href="Constrained.Base.html#substituteBinder"><span class="hs-identifier hs-type">substituteBinder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182745"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182744"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182744"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182745"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182744"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182745"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182743"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182745"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182743"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-1218"></span><span id="substituteBinder"><span class="annot"><span class="annottext">substituteBinder :: forall (fn :: [*] -&gt; * -&gt; *) a b.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; Binder fn b -&gt; Binder fn b
</span><a href="Constrained.Base.html#substituteBinder"><span class="hs-identifier hs-var hs-var">substituteBinder</span></a></span></span><span> </span><span id="local-6989586621679178910"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178910"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679178909"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178909"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679178896"><span class="annot"><span class="annottext">Var b
</span><a href="#local-6989586621679178896"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679178895"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178895"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var b
</span><a href="#local-6989586621679178894"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#substitutePred"><span class="hs-identifier hs-var">substitutePred</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178910"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178909"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178893"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-1219"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1220"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679178894"><span class="annot"><span class="annottext">Var b
</span><a href="#local-6989586621679178894"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679178893"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178893"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a t.
(Typeable a, Rename t) =&gt;
Var a -&gt; t -&gt; Set Int -&gt; (Var a, t)
</span><a href="Constrained.Core.html#freshen"><span class="hs-identifier hs-var">freshen</span></a></span><span> </span><span class="annot"><span class="annottext">Var b
</span><a href="#local-6989586621679178896"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178895"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Var a -&gt; Int
</span><a href="Constrained.Core.html#nameOf"><span class="hs-identifier hs-var">nameOf</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178910"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) t. HasVariables fn t =&gt; t -&gt; Set Int
</span><a href="Constrained.Base.html#freeVarNames"><span class="hs-identifier hs-var">freeVarNames</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178909"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.delete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Var a -&gt; Int
</span><a href="Constrained.Core.html#nameOf"><span class="hs-identifier hs-var">nameOf</span></a></span><span> </span><span class="annot"><span class="annottext">Var b
</span><a href="#local-6989586621679178896"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) t. HasVariables fn t =&gt; t -&gt; Set Int
</span><a href="Constrained.Base.html#freeVarNames"><span class="hs-identifier hs-var">freeVarNames</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178895"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1221"></span><span>
</span><span id="line-1222"></span><span id="local-6989586621679183319"><span id="local-6989586621679183320"><span class="annot"><a href="Constrained.Base.html#substitutePred"><span class="hs-identifier hs-type">substitutePred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183320"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183319"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183319"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183320"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183319"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183320"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183320"><span class="hs-identifier hs-type">fn</span></a></span></span></span><span>
</span><span id="line-1223"></span><span id="substitutePred"><span class="annot"><span class="annottext">substitutePred :: forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#substitutePred"><span class="hs-identifier hs-var hs-var">substitutePred</span></a></span></span><span> </span><span id="local-6989586621679178885"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178885"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679178884"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178884"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1224"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#GenHint"><span class="hs-identifier hs-type">GenHint</span></a></span><span> </span><span id="local-6989586621679178880"><span class="annot"><span class="annottext">Hint a
</span><a href="#local-6989586621679178880"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679178879"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178879"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasGenHint fn a =&gt;
Hint a -&gt; Term fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#GenHint"><span class="hs-identifier hs-var">GenHint</span></a></span><span> </span><span class="annot"><span class="annottext">Hint a
</span><a href="#local-6989586621679178880"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substituteTerm"><span class="hs-identifier hs-var">substituteTerm</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178885"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; SubstEntry fn
</span><a href="Constrained.Base.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178884"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178879"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1225"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span id="local-6989586621679178875"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178875"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679178874"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178874"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679178873"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178873"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#substitutePred"><span class="hs-identifier hs-var">substitutePred</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178885"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178884"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#substitutePred"><span class="hs-identifier hs-var">substitutePred</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178875"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178874"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178873"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1226"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Assert"><span class="hs-identifier hs-type">Assert</span></a></span><span> </span><span id="local-6989586621679178869"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679178869"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679178868"><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679178868"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
[String] -&gt; Term fn Bool -&gt; Pred fn
</span><a href="Constrained.Base.html#Assert"><span class="hs-identifier hs-var">Assert</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679178869"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substituteTerm"><span class="hs-identifier hs-var">substituteTerm</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178885"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; SubstEntry fn
</span><a href="Constrained.Base.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178884"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679178868"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1227"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span id="local-6989586621679178867"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178867"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#substitutePred"><span class="hs-identifier hs-var">substitutePred</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178885"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178884"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178867"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1228"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Exists"><span class="hs-identifier hs-type">Exists</span></a></span><span> </span><span id="local-6989586621679178865"><span class="annot"><span class="annottext">(forall b. Term fn b -&gt; b) -&gt; GE a
</span><a href="#local-6989586621679178865"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679178864"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178864"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
((forall b. Term fn b -&gt; b) -&gt; GE a) -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Exists"><span class="hs-identifier hs-var">Exists</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679178863"><span class="annot"><span class="annottext">forall b. Term fn b -&gt; b
</span><a href="#local-6989586621679178863"><span class="hs-identifier hs-var">eval</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(forall b. Term fn b -&gt; b) -&gt; GE a
</span><a href="#local-6989586621679178865"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b. Term fn b -&gt; b
</span><a href="#local-6989586621679178863"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substituteTerm"><span class="hs-identifier hs-var">substituteTerm</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178885"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; SubstEntry fn
</span><a href="Constrained.Base.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178884"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; Binder fn b -&gt; Binder fn b
</span><a href="Constrained.Base.html#substituteBinder"><span class="hs-identifier hs-var">substituteBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178885"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178884"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178864"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1229"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span id="local-6989586621679178859"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178859"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679178858"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178858"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substituteTerm"><span class="hs-identifier hs-var">substituteTerm</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178885"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; SubstEntry fn
</span><a href="Constrained.Base.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178884"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178859"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; Binder fn b -&gt; Binder fn b
</span><a href="Constrained.Base.html#substituteBinder"><span class="hs-identifier hs-var">substituteBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178885"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178884"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178858"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1230"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#ForAll"><span class="hs-identifier hs-type">ForAll</span></a></span><span> </span><span id="local-6989586621679178849"><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679178849"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679178848"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178848"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a a (fn :: [*] -&gt; * -&gt; *).
(Forallable a a, HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#ForAll"><span class="hs-identifier hs-var">ForAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substituteTerm"><span class="hs-identifier hs-var">substituteTerm</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178885"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; SubstEntry fn
</span><a href="Constrained.Base.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178884"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679178849"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; Binder fn b -&gt; Binder fn b
</span><a href="Constrained.Base.html#substituteBinder"><span class="hs-identifier hs-var">substituteBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178885"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178884"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178848"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1231"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Case"><span class="hs-identifier hs-type">Case</span></a></span><span> </span><span id="local-6989586621679178844"><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679178844"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679178843"><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679178843"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (a :: [*]).
HasSpec fn (SumOver a) =&gt;
Term fn (SumOver a) -&gt; List (Binder fn) a -&gt; Pred fn
</span><a href="Constrained.Base.html#Case"><span class="hs-identifier hs-var">Case</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substituteTerm"><span class="hs-identifier hs-var">substituteTerm</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178885"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; SubstEntry fn
</span><a href="Constrained.Base.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178884"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679178844"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (as :: [k]).
(forall (a :: k). f a -&gt; g a) -&gt; List f as -&gt; List g as
</span><a href="Constrained.List.html#mapList"><span class="hs-identifier hs-var">mapList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; Binder fn b -&gt; Binder fn b
</span><a href="Constrained.Base.html#substituteBinder"><span class="hs-identifier hs-var">substituteBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178885"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178884"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679178843"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1232"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Reify"><span class="hs-identifier hs-type">Reify</span></a></span><span> </span><span id="local-6989586621679178835"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178835"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679178834"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679178834"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679178833"><span class="annot"><span class="annottext">Binder fn b
</span><a href="#local-6989586621679178833"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a a.
(HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; (a -&gt; a) -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Reify"><span class="hs-identifier hs-var">Reify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substituteTerm"><span class="hs-identifier hs-var">substituteTerm</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178885"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; SubstEntry fn
</span><a href="Constrained.Base.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178884"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178835"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679178834"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; Binder fn b -&gt; Binder fn b
</span><a href="Constrained.Base.html#substituteBinder"><span class="hs-identifier hs-var">substituteBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178885"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178884"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn b
</span><a href="#local-6989586621679178833"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1233"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#DependsOn"><span class="hs-identifier hs-type">DependsOn</span></a></span><span> </span><span id="local-6989586621679178826"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178826"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679178825"><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679178825"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a a.
(HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; Term fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#DependsOn"><span class="hs-identifier hs-var">DependsOn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substituteTerm"><span class="hs-identifier hs-var">substituteTerm</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178885"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; SubstEntry fn
</span><a href="Constrained.Base.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178884"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178826"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substituteTerm"><span class="hs-identifier hs-var">substituteTerm</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178885"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; SubstEntry fn
</span><a href="Constrained.Base.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178884"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679178825"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1234"></span><span>  </span><span class="annot"><span class="annottext">Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span>
</span><span id="line-1235"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-type">FalsePred</span></a></span><span> </span><span id="local-6989586621679178824"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679178824"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). [String] -&gt; Pred fn
</span><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-var">FalsePred</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679178824"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1236"></span><span>
</span><span id="line-1237"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182717"><span class="annot"><a href="Constrained.Core.html#Rename"><span class="hs-identifier hs-type">Rename</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182717"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1238"></span><span>  </span><span id="local-6989586621679178819"><span class="annot"><span class="annottext">rename :: forall x. Typeable x =&gt; Var x -&gt; Var x -&gt; Name f -&gt; Name f
</span><a href="#local-6989586621679178819"><span class="hs-identifier hs-var hs-var hs-var hs-var">rename</span></a></span></span><span> </span><span id="local-6989586621679178818"><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178818"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679178817"><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178817"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span id="local-6989586621679178810"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178810"><span class="hs-identifier hs-var">v''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; Var a -&gt; Name fn
</span><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-var">Name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a x. (Rename a, Typeable x) =&gt; Var x -&gt; Var x -&gt; a -&gt; a
</span><a href="Constrained.Core.html#rename"><span class="hs-identifier hs-var">rename</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178818"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178817"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178810"><span class="hs-identifier hs-var">v''</span></a></span><span>
</span><span id="line-1239"></span><span>
</span><span id="line-1240"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182710"><span id="local-6989586621679182711"><span class="annot"><a href="Constrained.Core.html#Rename"><span class="hs-identifier hs-type">Rename</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182711"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182710"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1241"></span><span>  </span><span id="local-6989586621679178805"><span class="annot"><span class="annottext">rename :: forall x. Typeable x =&gt; Var x -&gt; Var x -&gt; Term fn a -&gt; Term fn a
</span><a href="#local-6989586621679178805"><span class="hs-identifier hs-var hs-var hs-var hs-var">rename</span></a></span></span><span> </span><span id="local-6989586621679178804"><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178804"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679178803"><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178803"><span class="hs-identifier hs-var">v'</span></a></span></span><span>
</span><span id="line-1242"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178804"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178803"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1243"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1244"></span><span>        </span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679178800"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679178800"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679178800"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1245"></span><span>        </span><span class="annot"><a href="Constrained.Base.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span id="local-6989586621679178794"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178794"><span class="hs-identifier hs-var">v''</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; Var a -&gt; Term fn a
</span><a href="Constrained.Base.html#V"><span class="hs-identifier hs-var">V</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a x. (Rename a, Typeable x) =&gt; Var x -&gt; Var x -&gt; a -&gt; a
</span><a href="Constrained.Core.html#rename"><span class="hs-identifier hs-var">rename</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178804"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178803"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178794"><span class="hs-identifier hs-var">v''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1246"></span><span>        </span><span class="annot"><a href="Constrained.Base.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span id="local-6989586621679178779"><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679178779"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679178778"><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679178778"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (a :: [*]) (fn :: [*] -&gt; * -&gt; *) b.
(Typeable a, TypeList a, All (HasSpec fn) a, HasSpec fn b,
 BaseUniverse fn) =&gt;
fn a b -&gt; List (Term fn) a -&gt; Term fn b
</span><a href="Constrained.Base.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679178779"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a x. (Rename a, Typeable x) =&gt; Var x -&gt; Var x -&gt; a -&gt; a
</span><a href="Constrained.Core.html#rename"><span class="hs-identifier hs-var">rename</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178804"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178803"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679178778"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1247"></span><span>
</span><span id="line-1248"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679183234"><span class="annot"><a href="Constrained.Core.html#Rename"><span class="hs-identifier hs-type">Rename</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183234"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1249"></span><span>  </span><span id="local-6989586621679178769"><span class="annot"><span class="annottext">rename :: forall x. Typeable x =&gt; Var x -&gt; Var x -&gt; Pred fn -&gt; Pred fn
</span><a href="#local-6989586621679178769"><span class="hs-identifier hs-var hs-var hs-var hs-var">rename</span></a></span></span><span> </span><span id="local-6989586621679178768"><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178768"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679178767"><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178767"><span class="hs-identifier hs-var">v'</span></a></span></span><span>
</span><span id="line-1250"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178768"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178767"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1251"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1252"></span><span>        </span><span class="annot"><a href="Constrained.Base.html#GenHint"><span class="hs-identifier hs-type">GenHint</span></a></span><span> </span><span id="local-6989586621679178762"><span class="annot"><span class="annottext">Hint a
</span><a href="#local-6989586621679178762"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679178761"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178761"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasGenHint fn a =&gt;
Hint a -&gt; Term fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#GenHint"><span class="hs-identifier hs-var">GenHint</span></a></span><span> </span><span class="annot"><span class="annottext">Hint a
</span><a href="#local-6989586621679178762"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a x. (Rename a, Typeable x) =&gt; Var x -&gt; Var x -&gt; a -&gt; a
</span><a href="Constrained.Core.html#rename"><span class="hs-identifier hs-var">rename</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178768"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178767"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178761"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1253"></span><span>        </span><span class="annot"><a href="Constrained.Base.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span id="local-6989586621679178756"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178756"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679178755"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178755"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679178754"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178754"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a x. (Rename a, Typeable x) =&gt; Var x -&gt; Var x -&gt; a -&gt; a
</span><a href="Constrained.Core.html#rename"><span class="hs-identifier hs-var">rename</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178768"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178767"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#substitutePred"><span class="hs-identifier hs-var">substitutePred</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178756"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178755"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178754"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1254"></span><span>        </span><span class="annot"><a href="Constrained.Base.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span id="local-6989586621679178753"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178753"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). [Pred fn] -&gt; Pred fn
</span><a href="Constrained.Base.html#Block"><span class="hs-identifier hs-var">Block</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a x. (Rename a, Typeable x) =&gt; Var x -&gt; Var x -&gt; a -&gt; a
</span><a href="Constrained.Core.html#rename"><span class="hs-identifier hs-var">rename</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178768"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178767"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178753"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1255"></span><span>        </span><span class="annot"><a href="Constrained.Base.html#Exists"><span class="hs-identifier hs-type">Exists</span></a></span><span> </span><span id="local-6989586621679178749"><span class="annot"><span class="annottext">(forall b. Term fn b -&gt; b) -&gt; GE a
</span><a href="#local-6989586621679178749"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679178748"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178748"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
((forall b. Term fn b -&gt; b) -&gt; GE a) -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Exists"><span class="hs-identifier hs-var">Exists</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679178747"><span class="annot"><span class="annottext">forall b. Term fn b -&gt; b
</span><a href="#local-6989586621679178747"><span class="hs-identifier hs-var">eval</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(forall b. Term fn b -&gt; b) -&gt; GE a
</span><a href="#local-6989586621679178749"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall b. Term fn b -&gt; b
</span><a href="#local-6989586621679178747"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a x. (Rename a, Typeable x) =&gt; Var x -&gt; Var x -&gt; a -&gt; a
</span><a href="Constrained.Core.html#rename"><span class="hs-identifier hs-var">rename</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178768"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178767"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a x. (Rename a, Typeable x) =&gt; Var x -&gt; Var x -&gt; a -&gt; a
</span><a href="Constrained.Core.html#rename"><span class="hs-identifier hs-var">rename</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178768"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178767"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178748"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1256"></span><span>        </span><span class="annot"><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span id="local-6989586621679178740"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178740"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679178739"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178739"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a x. (Rename a, Typeable x) =&gt; Var x -&gt; Var x -&gt; a -&gt; a
</span><a href="Constrained.Core.html#rename"><span class="hs-identifier hs-var">rename</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178768"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178767"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178740"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a x. (Rename a, Typeable x) =&gt; Var x -&gt; Var x -&gt; a -&gt; a
</span><a href="Constrained.Core.html#rename"><span class="hs-identifier hs-var">rename</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178768"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178767"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178739"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1257"></span><span>        </span><span class="annot"><a href="Constrained.Base.html#Reify"><span class="hs-identifier hs-type">Reify</span></a></span><span> </span><span id="local-6989586621679178730"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178730"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679178729"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679178729"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679178728"><span class="annot"><span class="annottext">Binder fn b
</span><a href="#local-6989586621679178728"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a a.
(HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; (a -&gt; a) -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Reify"><span class="hs-identifier hs-var">Reify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a x. (Rename a, Typeable x) =&gt; Var x -&gt; Var x -&gt; a -&gt; a
</span><a href="Constrained.Core.html#rename"><span class="hs-identifier hs-var">rename</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178768"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178767"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178730"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679178729"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a x. (Rename a, Typeable x) =&gt; Var x -&gt; Var x -&gt; a -&gt; a
</span><a href="Constrained.Core.html#rename"><span class="hs-identifier hs-var">rename</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178768"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178767"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn b
</span><a href="#local-6989586621679178728"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1258"></span><span>        </span><span class="annot"><a href="Constrained.Base.html#Assert"><span class="hs-identifier hs-type">Assert</span></a></span><span> </span><span id="local-6989586621679178723"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679178723"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679178722"><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679178722"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
[String] -&gt; Term fn Bool -&gt; Pred fn
</span><a href="Constrained.Base.html#Assert"><span class="hs-identifier hs-var">Assert</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679178723"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a x. (Rename a, Typeable x) =&gt; Var x -&gt; Var x -&gt; a -&gt; a
</span><a href="Constrained.Core.html#rename"><span class="hs-identifier hs-var">rename</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178768"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178767"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679178722"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1259"></span><span>        </span><span class="annot"><a href="Constrained.Base.html#DependsOn"><span class="hs-identifier hs-type">DependsOn</span></a></span><span> </span><span id="local-6989586621679178713"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178713"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679178712"><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679178712"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a a.
(HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; Term fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#DependsOn"><span class="hs-identifier hs-var">DependsOn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a x. (Rename a, Typeable x) =&gt; Var x -&gt; Var x -&gt; a -&gt; a
</span><a href="Constrained.Core.html#rename"><span class="hs-identifier hs-var">rename</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178768"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178767"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178713"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a x. (Rename a, Typeable x) =&gt; Var x -&gt; Var x -&gt; a -&gt; a
</span><a href="Constrained.Core.html#rename"><span class="hs-identifier hs-var">rename</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178768"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178767"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679178712"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1260"></span><span>        </span><span class="annot"><a href="Constrained.Base.html#ForAll"><span class="hs-identifier hs-type">ForAll</span></a></span><span> </span><span id="local-6989586621679178701"><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679178701"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span id="local-6989586621679178700"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178700"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a a (fn :: [*] -&gt; * -&gt; *).
(Forallable a a, HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#ForAll"><span class="hs-identifier hs-var">ForAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a x. (Rename a, Typeable x) =&gt; Var x -&gt; Var x -&gt; a -&gt; a
</span><a href="Constrained.Core.html#rename"><span class="hs-identifier hs-var">rename</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178768"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178767"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679178701"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a x. (Rename a, Typeable x) =&gt; Var x -&gt; Var x -&gt; a -&gt; a
</span><a href="Constrained.Core.html#rename"><span class="hs-identifier hs-var">rename</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178768"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178767"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178700"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1261"></span><span>        </span><span class="annot"><a href="Constrained.Base.html#Case"><span class="hs-identifier hs-type">Case</span></a></span><span> </span><span id="local-6989586621679178692"><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679178692"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679178691"><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679178691"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (a :: [*]).
HasSpec fn (SumOver a) =&gt;
Term fn (SumOver a) -&gt; List (Binder fn) a -&gt; Pred fn
</span><a href="Constrained.Base.html#Case"><span class="hs-identifier hs-var">Case</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a x. (Rename a, Typeable x) =&gt; Var x -&gt; Var x -&gt; a -&gt; a
</span><a href="Constrained.Core.html#rename"><span class="hs-identifier hs-var">rename</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178768"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178767"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679178692"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a x. (Rename a, Typeable x) =&gt; Var x -&gt; Var x -&gt; a -&gt; a
</span><a href="Constrained.Core.html#rename"><span class="hs-identifier hs-var">rename</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178768"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178767"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679178691"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1262"></span><span>        </span><span class="annot"><span class="annottext">Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span>
</span><span id="line-1263"></span><span>        </span><span class="annot"><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-type">FalsePred</span></a></span><span> </span><span id="local-6989586621679178690"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679178690"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). [String] -&gt; Pred fn
</span><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-var">FalsePred</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679178690"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1264"></span><span>
</span><span id="line-1265"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182696"><span id="local-6989586621679182697"><span class="annot"><a href="Constrained.Core.html#Rename"><span class="hs-identifier hs-type">Rename</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182697"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182696"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1266"></span><span>  </span><span id="local-6989586621679178687"><span class="annot"><span class="annottext">rename :: forall x.
Typeable x =&gt;
Var x -&gt; Var x -&gt; Binder fn a -&gt; Binder fn a
</span><a href="#local-6989586621679178687"><span class="hs-identifier hs-var hs-var hs-var hs-var">rename</span></a></span></span><span> </span><span id="local-6989586621679178686"><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178686"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679178685"><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178685"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679178672"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178672"><span class="hs-identifier hs-var">va</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679178671"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178671"><span class="hs-identifier hs-var">psa</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178670"><span class="hs-identifier hs-var">va'</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a x. (Rename a, Typeable x) =&gt; Var x -&gt; Var x -&gt; a -&gt; a
</span><a href="Constrained.Core.html#rename"><span class="hs-identifier hs-var">rename</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178686"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178685"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178669"><span class="hs-identifier hs-var">psa'</span></a></span><span>
</span><span id="line-1267"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-1268"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679178670"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178670"><span class="hs-identifier hs-var">va'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679178669"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178669"><span class="hs-identifier hs-var">psa'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a t.
(Typeable a, Rename t) =&gt;
Var a -&gt; t -&gt; Set Int -&gt; (Var a, t)
</span><a href="Constrained.Core.html#freshen"><span class="hs-identifier hs-var">freshen</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178672"><span class="hs-identifier hs-var">va</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178671"><span class="hs-identifier hs-var">psa</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a. Var a -&gt; Int
</span><a href="Constrained.Core.html#nameOf"><span class="hs-identifier hs-var">nameOf</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178686"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Var a -&gt; Int
</span><a href="Constrained.Core.html#nameOf"><span class="hs-identifier hs-var">nameOf</span></a></span><span> </span><span class="annot"><span class="annottext">Var x
</span><a href="#local-6989586621679178685"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.delete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Var a -&gt; Int
</span><a href="Constrained.Core.html#nameOf"><span class="hs-identifier hs-var">nameOf</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178672"><span class="hs-identifier hs-var">va</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) t. HasVariables fn t =&gt; t -&gt; Set Int
</span><a href="Constrained.Base.html#freeVarNames"><span class="hs-identifier hs-var">freeVarNames</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178671"><span class="hs-identifier hs-var">psa</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1269"></span><span>
</span><span id="line-1270"></span><span id="local-6989586621679182681"><span id="local-6989586621679182682"><span class="annot"><a href="Constrained.Base.html#substTerm"><span class="hs-identifier hs-type">substTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182682"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182681"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182682"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182681"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-1271"></span><span id="substTerm"><span class="annot"><span class="annottext">substTerm :: forall (fn :: [*] -&gt; * -&gt; *) a. Env -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substTerm"><span class="hs-identifier hs-var hs-var">substTerm</span></a></span></span><span> </span><span id="local-6989586621679178666"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679178666"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1272"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679178663"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679178663"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679178663"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1273"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span id="local-6989586621679178656"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178656"><span class="hs-identifier hs-var">v</span></a></span></span><span>
</span><span id="line-1274"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679178655"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679178655"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Typeable a =&gt; Env -&gt; Var a -&gt; Maybe a
</span><a href="Constrained.Env.html#lookupEnv"><span class="hs-identifier hs-var">lookupEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679178666"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178656"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679178655"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1275"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; Var a -&gt; Term fn a
</span><a href="Constrained.Base.html#V"><span class="hs-identifier hs-var">V</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178656"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1276"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span id="local-6989586621679178637"><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679178637"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (as :: [k]).
(forall (a :: k). f a -&gt; g a) -&gt; List f as -&gt; List g as
</span><a href="Constrained.List.html#mapList"><span class="hs-identifier hs-var">mapList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Env -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substTerm"><span class="hs-identifier hs-var">substTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679178666"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679178636"><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679178636"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1277"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (as :: [*]).
List (Term fn) as -&gt; Maybe (List Value as)
</span><a href="Constrained.Base.html#fromLits"><span class="hs-identifier hs-var">fromLits</span></a></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679178636"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1278"></span><span>      </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679178635"><span class="annot"><span class="annottext">List Value as
</span><a href="#local-6989586621679178635"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (ts :: [*]) (f :: * -&gt; *) r.
TypeList ts =&gt;
(forall a. f a -&gt; a) -&gt; FunTy ts r -&gt; List f ts -&gt; r
</span><a href="Constrained.List.html#uncurryList_"><span class="hs-identifier hs-var">uncurryList_</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Value a -&gt; a
</span><a href="Constrained.Core.html#unValue"><span class="hs-identifier hs-var">unValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (as :: [*]) b.
FunctionLike fn =&gt;
fn as b -&gt; FunTy as b
</span><a href="Constrained.Univ.html#sem"><span class="hs-identifier hs-var">sem</span></a></span><span> </span><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679178637"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List Value as
</span><a href="#local-6989586621679178635"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1279"></span><span>      </span><span class="annot"><span class="annottext">Maybe (List Value as)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (a :: [*]) (fn :: [*] -&gt; * -&gt; *) b.
(Typeable a, TypeList a, All (HasSpec fn) a, HasSpec fn b,
 BaseUniverse fn) =&gt;
fn a b -&gt; List (Term fn) a -&gt; Term fn b
</span><a href="Constrained.Base.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679178637"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679178636"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-1280"></span><span>
</span><span id="line-1281"></span><span id="local-6989586621679182675"><span id="local-6989586621679182676"><span class="annot"><a href="Constrained.Base.html#substBinder"><span class="hs-identifier hs-type">substBinder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182676"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182675"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182676"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182675"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-1282"></span><span id="substBinder"><span class="annot"><span class="annottext">substBinder :: forall (fn :: [*] -&gt; * -&gt; *) a. Env -&gt; Binder fn a -&gt; Binder fn a
</span><a href="Constrained.Base.html#substBinder"><span class="hs-identifier hs-var hs-var">substBinder</span></a></span></span><span> </span><span id="local-6989586621679178633"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679178633"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679178626"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178626"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679178625"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178625"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178626"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
Env -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#substPred"><span class="hs-identifier hs-var">substPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Typeable a =&gt; Var a -&gt; Env -&gt; Env
</span><a href="Constrained.Env.html#removeVar"><span class="hs-identifier hs-var">removeVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178626"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679178633"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178625"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1283"></span><span>
</span><span id="line-1284"></span><span id="local-6989586621679183016"><span class="annot"><a href="Constrained.Base.html#substPred"><span class="hs-identifier hs-type">substPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183016"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183016"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183016"><span class="hs-identifier hs-type">fn</span></a></span></span><span>
</span><span id="line-1285"></span><span id="substPred"><span class="annot"><span class="annottext">substPred :: forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
Env -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#substPred"><span class="hs-identifier hs-var hs-var">substPred</span></a></span></span><span> </span><span id="local-6989586621679178618"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679178618"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1286"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#GenHint"><span class="hs-identifier hs-type">GenHint</span></a></span><span> </span><span id="local-6989586621679178615"><span class="annot"><span class="annottext">Hint a
</span><a href="#local-6989586621679178615"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679178614"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178614"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasGenHint fn a =&gt;
Hint a -&gt; Term fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#GenHint"><span class="hs-identifier hs-var">GenHint</span></a></span><span> </span><span class="annot"><span class="annottext">Hint a
</span><a href="#local-6989586621679178615"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Env -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substTerm"><span class="hs-identifier hs-var">substTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679178618"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178614"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1287"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span id="local-6989586621679178610"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178610"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679178609"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178609"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679178608"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178608"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
Env -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#substPred"><span class="hs-identifier hs-var">substPred</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679178618"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#substitutePred"><span class="hs-identifier hs-var">substitutePred</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178610"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178609"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178608"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1288"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Assert"><span class="hs-identifier hs-type">Assert</span></a></span><span> </span><span id="local-6989586621679178601"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679178601"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679178600"><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679178600"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
[String] -&gt; p -&gt; Pred fn
</span><a href="Constrained.Base.html#assertExplain"><span class="hs-identifier hs-var">assertExplain</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679178601"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Env -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substTerm"><span class="hs-identifier hs-var">substTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679178618"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679178600"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1289"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Reify"><span class="hs-identifier hs-type">Reify</span></a></span><span> </span><span id="local-6989586621679178594"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178594"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679178593"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679178593"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679178592"><span class="annot"><span class="annottext">Binder fn b
</span><a href="#local-6989586621679178592"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a a.
(HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; (a -&gt; a) -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Reify"><span class="hs-identifier hs-var">Reify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Env -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substTerm"><span class="hs-identifier hs-var">substTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679178618"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178594"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679178593"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Env -&gt; Binder fn a -&gt; Binder fn a
</span><a href="Constrained.Base.html#substBinder"><span class="hs-identifier hs-var">substBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679178618"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn b
</span><a href="#local-6989586621679178592"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1290"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#ForAll"><span class="hs-identifier hs-type">ForAll</span></a></span><span> </span><span id="local-6989586621679178585"><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679178585"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span id="local-6989586621679178584"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178584"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a a (fn :: [*] -&gt; * -&gt; *).
(Forallable a a, HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#ForAll"><span class="hs-identifier hs-var">ForAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Env -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substTerm"><span class="hs-identifier hs-var">substTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679178618"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679178585"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Env -&gt; Binder fn a -&gt; Binder fn a
</span><a href="Constrained.Base.html#substBinder"><span class="hs-identifier hs-var">substBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679178618"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178584"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1291"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Case"><span class="hs-identifier hs-type">Case</span></a></span><span> </span><span id="local-6989586621679178581"><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679178581"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679178580"><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679178580"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (a :: [*]).
HasSpec fn (SumOver a) =&gt;
Term fn (SumOver a) -&gt; List (Binder fn) a -&gt; Pred fn
</span><a href="Constrained.Base.html#Case"><span class="hs-identifier hs-var">Case</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Env -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substTerm"><span class="hs-identifier hs-var">substTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679178618"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679178581"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (as :: [k]).
(forall (a :: k). f a -&gt; g a) -&gt; List f as -&gt; List g as
</span><a href="Constrained.List.html#mapList"><span class="hs-identifier hs-var">mapList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Env -&gt; Binder fn a -&gt; Binder fn a
</span><a href="Constrained.Base.html#substBinder"><span class="hs-identifier hs-var">substBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679178618"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679178580"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1292"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#DependsOn"><span class="hs-identifier hs-type">DependsOn</span></a></span><span> </span><span id="local-6989586621679178575"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178575"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679178574"><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679178574"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a a.
(HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; Term fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#DependsOn"><span class="hs-identifier hs-var">DependsOn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Env -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substTerm"><span class="hs-identifier hs-var">substTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679178618"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178575"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Env -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substTerm"><span class="hs-identifier hs-var">substTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679178618"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679178574"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1293"></span><span>  </span><span class="annot"><span class="annottext">Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span>
</span><span id="line-1294"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-type">FalsePred</span></a></span><span> </span><span id="local-6989586621679178573"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679178573"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). [String] -&gt; Pred fn
</span><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-var">FalsePred</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679178573"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1295"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span id="local-6989586621679178572"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178572"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
Env -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#substPred"><span class="hs-identifier hs-var">substPred</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679178618"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178572"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1296"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Exists"><span class="hs-identifier hs-type">Exists</span></a></span><span> </span><span id="local-6989586621679178571"><span class="annot"><span class="annottext">(forall b. Term fn b -&gt; b) -&gt; GE a
</span><a href="#local-6989586621679178571"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679178570"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178570"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
((forall b. Term fn b -&gt; b) -&gt; GE a) -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Exists"><span class="hs-identifier hs-var">Exists</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679178569"><span class="annot"><span class="annottext">forall b. Term fn b -&gt; b
</span><a href="#local-6989586621679178569"><span class="hs-identifier hs-var">eval</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(forall b. Term fn b -&gt; b) -&gt; GE a
</span><a href="#local-6989586621679178571"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall b. Term fn b -&gt; b
</span><a href="#local-6989586621679178569"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Env -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substTerm"><span class="hs-identifier hs-var">substTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679178618"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Env -&gt; Binder fn a -&gt; Binder fn a
</span><a href="Constrained.Base.html#substBinder"><span class="hs-identifier hs-var">substBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679178618"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178570"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1297"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span id="local-6989586621679178568"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178568"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679178567"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178567"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Env -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substTerm"><span class="hs-identifier hs-var">substTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679178618"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178568"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Env -&gt; Binder fn a -&gt; Binder fn a
</span><a href="Constrained.Base.html#substBinder"><span class="hs-identifier hs-var">substBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679178618"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178567"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1298"></span><span>
</span><span id="line-1299"></span><span id="local-6989586621679182959"><span id="local-6989586621679182960"><span class="annot"><a href="Constrained.Base.html#unBind"><span class="hs-identifier hs-type">unBind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679182960"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182959"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182960"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182959"><span class="hs-identifier hs-type">fn</span></a></span></span></span><span>
</span><span id="line-1300"></span><span id="unBind"><span class="annot"><span class="annottext">unBind :: forall a (fn :: [*] -&gt; * -&gt; *). a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#unBind"><span class="hs-identifier hs-var hs-var">unBind</span></a></span></span><span> </span><span id="local-6989586621679178566"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679178566"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679178558"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178558"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679178557"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178557"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
Env -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#substPred"><span class="hs-identifier hs-var">substPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Typeable a, Show a) =&gt; Var a -&gt; a -&gt; Env
</span><a href="Constrained.Env.html#singletonEnv"><span class="hs-identifier hs-var">singletonEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178558"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679178566"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178557"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1301"></span><span>
</span><span id="line-1302"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-1303"></span><span class="hs-comment">-- Rewrite rules and simplification</span><span>
</span><span id="line-1304"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-1305"></span><span>
</span><span id="line-1306"></span><span class="hs-comment">-- Simplification for preds and terms -------------------------------------</span><span>
</span><span id="line-1307"></span><span>
</span><span id="line-1308"></span><span class="annot"><a href="Constrained.Base.html#simplifyTerm"><span class="hs-identifier hs-type">simplifyTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183411"><span class="annot"><a href="#local-6989586621679183411"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679183410"><span class="annot"><a href="#local-6989586621679183410"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183411"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183411"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183410"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183411"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183410"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1309"></span><span id="simplifyTerm"><span class="annot"><span class="annottext">simplifyTerm :: forall (fn :: [*] -&gt; * -&gt; *) a.
BaseUniverse fn =&gt;
Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#simplifyTerm"><span class="hs-identifier hs-var hs-var">simplifyTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1310"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span id="local-6989586621679178551"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178551"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; Var a -&gt; Term fn a
</span><a href="Constrained.Base.html#V"><span class="hs-identifier hs-var">V</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178551"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1311"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679178548"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679178548"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679178548"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1312"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span id="local-6989586621679178521"><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679178521"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (as :: [k]).
(forall (a :: k). f a -&gt; g a) -&gt; List f as -&gt; List g as
</span><a href="Constrained.List.html#mapList"><span class="hs-identifier hs-var">mapList</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
BaseUniverse fn =&gt;
Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#simplifyTerm"><span class="hs-identifier hs-var">simplifyTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679178519"><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679178519"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1313"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679178518"><span class="annot"><span class="annottext">List Value as
</span><a href="#local-6989586621679178518"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (as :: [*]).
List (Term fn) as -&gt; Maybe (List Value as)
</span><a href="Constrained.Base.html#fromLits"><span class="hs-identifier hs-var">fromLits</span></a></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679178519"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (ts :: [*]) (f :: * -&gt; *) r.
TypeList ts =&gt;
(forall a. f a -&gt; a) -&gt; FunTy ts r -&gt; List f ts -&gt; r
</span><a href="Constrained.List.html#uncurryList_"><span class="hs-identifier hs-var">uncurryList_</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Value a -&gt; a
</span><a href="Constrained.Core.html#unValue"><span class="hs-identifier hs-var">unValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (as :: [*]) b.
FunctionLike fn =&gt;
fn as b -&gt; FunTy as b
</span><a href="Constrained.Univ.html#sem"><span class="hs-identifier hs-var">sem</span></a></span><span> </span><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679178521"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List Value as
</span><a href="#local-6989586621679178518"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-1314"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679178517"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178517"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
[RewriteRule fn a] -&gt; Term fn a -&gt; Maybe (Term fn a)
</span><a href="Constrained.Base.html#applyRewrites"><span class="hs-identifier hs-var">applyRewrites</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: [*] -&gt; * -&gt; *) (fn :: [*] -&gt; * -&gt; *) (as :: [*]) b.
(Functions f fn, TypeList as, Typeable as, HasSpec fn b,
 All (HasSpec fn) as) =&gt;
f as b -&gt; [RewriteRule fn b]
</span><a href="Constrained.Base.html#rewriteRules"><span class="hs-identifier hs-var">rewriteRules</span></a></span><span> </span><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679178521"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (a :: [*]) (fn :: [*] -&gt; * -&gt; *) b.
(Typeable a, TypeList a, All (HasSpec fn) a, HasSpec fn b,
 BaseUniverse fn) =&gt;
fn a b -&gt; List (Term fn) a -&gt; Term fn b
</span><a href="Constrained.Base.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679178521"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679178519"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
BaseUniverse fn =&gt;
Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#simplifyTerm"><span class="hs-identifier hs-var">simplifyTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178517"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1315"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (a :: [*]) (fn :: [*] -&gt; * -&gt; *) b.
(Typeable a, TypeList a, All (HasSpec fn) a, HasSpec fn b,
 BaseUniverse fn) =&gt;
fn a b -&gt; List (Term fn) a -&gt; Term fn b
</span><a href="Constrained.Base.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679178521"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679178519"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-1316"></span><span>
</span><span id="line-1317"></span><span id="local-6989586621679182748"><span id="local-6989586621679182749"><span class="annot"><a href="Constrained.Base.html#fromLits"><span class="hs-identifier hs-type">fromLits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.List.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182749"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679182748"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.List.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182748"><span class="hs-keyword hs-type">as</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1318"></span><span id="fromLits"><span class="annot"><span class="annottext">fromLits :: forall (fn :: [*] -&gt; * -&gt; *) (as :: [*]).
List (Term fn) as -&gt; Maybe (List Value as)
</span><a href="Constrained.Base.html#fromLits"><span class="hs-identifier hs-var hs-var">fromLits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} (m :: * -&gt; *) (f :: k -&gt; *) (g :: k -&gt; *) (as :: [k]).
Applicative m =&gt;
(forall (a :: k). f a -&gt; m (g a)) -&gt; List f as -&gt; m (List g as)
</span><a href="Constrained.List.html#mapMList"><span class="hs-identifier hs-var">mapMList</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Maybe (Value a)
</span><a href="Constrained.Base.html#fromLit"><span class="hs-identifier hs-var">fromLit</span></a></span><span>
</span><span id="line-1319"></span><span>
</span><span id="line-1320"></span><span id="local-6989586621679182648"><span id="local-6989586621679182649"><span class="annot"><a href="Constrained.Base.html#fromLit"><span class="hs-identifier hs-type">fromLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182649"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182648"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182648"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1321"></span><span id="fromLit"><span class="annot"><span class="annottext">fromLit :: forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Maybe (Value a)
</span><a href="Constrained.Base.html#fromLit"><span class="hs-identifier hs-var hs-var">fromLit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679178509"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679178509"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; Value a
</span><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-var">Value</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679178509"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1322"></span><span class="annot"><a href="Constrained.Base.html#fromLit"><span class="hs-identifier hs-var">fromLit</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1323"></span><span>
</span><span id="line-1324"></span><span id="local-6989586621679182644"><span id="local-6989586621679182645"><span class="annot"><a href="Constrained.Base.html#isLit"><span class="hs-identifier hs-type">isLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182645"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182644"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span><span>
</span><span id="line-1325"></span><span id="isLit"><span class="annot"><span class="annottext">isLit :: forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Bool
</span><a href="Constrained.Base.html#isLit"><span class="hs-identifier hs-var hs-var">isLit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">isJust</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Maybe (Value a)
</span><a href="Constrained.Base.html#fromLit"><span class="hs-identifier hs-var">fromLit</span></a></span><span>
</span><span id="line-1326"></span><span>
</span><span id="line-1327"></span><span id="local-6989586621679178506"><span class="annot"><a href="Constrained.Base.html#simplifyPred"><span class="hs-identifier hs-type">simplifyPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679178506"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679178506"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679178506"><span class="hs-identifier hs-type">fn</span></a></span></span><span>
</span><span id="line-1328"></span><span id="simplifyPred"><span class="annot"><span class="annottext">simplifyPred :: forall (fn :: [*] -&gt; * -&gt; *). BaseUniverse fn =&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#simplifyPred"><span class="hs-identifier hs-var hs-var">simplifyPred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1329"></span><span>  </span><span class="hs-comment">-- If the term simplifies away to a literal, that means there is no</span><span>
</span><span id="line-1330"></span><span>  </span><span class="hs-comment">-- more generation to do so we can get rid of `GenHint`</span><span>
</span><span id="line-1331"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#GenHint"><span class="hs-identifier hs-type">GenHint</span></a></span><span> </span><span id="local-6989586621679178498"><span class="annot"><span class="annottext">Hint a
</span><a href="#local-6989586621679178498"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679178497"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178497"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
BaseUniverse fn =&gt;
Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#simplifyTerm"><span class="hs-identifier hs-var">simplifyTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178497"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1332"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span>
</span><span id="line-1333"></span><span>    </span><span id="local-6989586621679178495"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178495"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasGenHint fn a =&gt;
Hint a -&gt; Term fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#GenHint"><span class="hs-identifier hs-var">GenHint</span></a></span><span> </span><span class="annot"><span class="annottext">Hint a
</span><a href="#local-6989586621679178498"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178495"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-1334"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span id="local-6989586621679178491"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178491"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679178490"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178490"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679178489"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178489"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). BaseUniverse fn =&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#simplifyPred"><span class="hs-identifier hs-var">simplifyPred</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#substitutePred"><span class="hs-identifier hs-var">substitutePred</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178491"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178490"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178489"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1335"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Assert"><span class="hs-identifier hs-type">Assert</span></a></span><span> </span><span id="local-6989586621679178481"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679178481"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679178480"><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679178480"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
[String] -&gt; p -&gt; Pred fn
</span><a href="Constrained.Base.html#assertExplain"><span class="hs-identifier hs-var">assertExplain</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679178481"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
BaseUniverse fn =&gt;
Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#simplifyTerm"><span class="hs-identifier hs-var">simplifyTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679178480"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1336"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Reify"><span class="hs-identifier hs-type">Reify</span></a></span><span> </span><span id="local-6989586621679178474"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178474"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span id="local-6989586621679178473"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679178473"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679178472"><span class="annot"><span class="annottext">Binder fn b
</span><a href="#local-6989586621679178472"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a a.
(HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; (a -&gt; a) -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#mkReify"><span class="hs-identifier hs-var">mkReify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
BaseUniverse fn =&gt;
Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#simplifyTerm"><span class="hs-identifier hs-var">simplifyTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178474"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679178473"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Binder fn a -&gt; Binder fn a
</span><a href="Constrained.Base.html#simplifyBinder"><span class="hs-identifier hs-var">simplifyBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn b
</span><a href="#local-6989586621679178472"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1337"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#ForAll"><span class="hs-identifier hs-type">ForAll</span></a></span><span> </span><span id="local-6989586621679178461"><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679178461"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span id="local-6989586621679178460"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178460"><span class="hs-identifier hs-var">b</span></a></span></span><span>
</span><span id="line-1338"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679178455"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679178455"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
BaseUniverse fn =&gt;
Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#simplifyTerm"><span class="hs-identifier hs-var">simplifyTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679178461"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#unBind"><span class="hs-operator hs-var">`unBind`</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178460"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t e. Forallable t e =&gt; t -&gt; [e]
</span><a href="Constrained.Base.html#forAllToList"><span class="hs-identifier hs-var">forAllToList</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679178455"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1339"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a a (fn :: [*] -&gt; * -&gt; *).
(Forallable a a, HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#ForAll"><span class="hs-identifier hs-var">ForAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
BaseUniverse fn =&gt;
Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#simplifyTerm"><span class="hs-identifier hs-var">simplifyTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679178461"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Binder fn a -&gt; Binder fn a
</span><a href="Constrained.Base.html#simplifyBinder"><span class="hs-identifier hs-var">simplifyBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178460"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1340"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#DependsOn"><span class="hs-identifier hs-type">DependsOn</span></a></span><span> </span><span id="local-6989586621679178450"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178450"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679178449"><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679178449"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a a.
(HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; Term fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#DependsOn"><span class="hs-identifier hs-var">DependsOn</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178450"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679178449"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1341"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Case"><span class="hs-identifier hs-type">Case</span></a></span><span> </span><span id="local-6989586621679178445"><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679178445"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679178444"><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679178444"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (a :: [*]).
HasSpec fn (SumOver a) =&gt;
Term fn (SumOver a) -&gt; List (Binder fn) a -&gt; Pred fn
</span><a href="Constrained.Base.html#mkCase"><span class="hs-identifier hs-var">mkCase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
BaseUniverse fn =&gt;
Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#simplifyTerm"><span class="hs-identifier hs-var">simplifyTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679178445"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (as :: [k]).
(forall (a :: k). f a -&gt; g a) -&gt; List f as -&gt; List g as
</span><a href="Constrained.List.html#mapList"><span class="hs-identifier hs-var">mapList</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Binder fn a -&gt; Binder fn a
</span><a href="Constrained.Base.html#simplifyBinder"><span class="hs-identifier hs-var">simplifyBinder</span></a></span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679178444"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1342"></span><span>  </span><span class="annot"><span class="annottext">Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span>
</span><span id="line-1343"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-type">FalsePred</span></a></span><span> </span><span id="local-6989586621679178442"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679178442"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). [String] -&gt; Pred fn
</span><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-var">FalsePred</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679178442"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1344"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span id="local-6989586621679178441"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178441"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
[Pred fn] -&gt; [Pred fn]
</span><a href="Constrained.Base.html#simplifyPreds"><span class="hs-identifier hs-var">simplifyPreds</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178441"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1345"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span id="local-6989586621679178438"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178438"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679178437"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178437"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
BaseUniverse fn =&gt;
Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#simplifyTerm"><span class="hs-identifier hs-var">simplifyTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178438"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Binder fn a -&gt; Binder fn a
</span><a href="Constrained.Base.html#simplifyBinder"><span class="hs-identifier hs-var">simplifyBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178437"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1346"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Exists"><span class="hs-identifier hs-type">Exists</span></a></span><span> </span><span id="local-6989586621679178436"><span class="annot"><span class="annottext">(forall b. Term fn b -&gt; b) -&gt; GE a
</span><a href="#local-6989586621679178436"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679178435"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178435"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
((forall b. Term fn b -&gt; b) -&gt; GE a) -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Exists"><span class="hs-identifier hs-var">Exists</span></a></span><span> </span><span class="annot"><span class="annottext">(forall b. Term fn b -&gt; b) -&gt; GE a
</span><a href="#local-6989586621679178436"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Binder fn a -&gt; Binder fn a
</span><a href="Constrained.Base.html#simplifyBinder"><span class="hs-identifier hs-var">simplifyBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178435"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1347"></span><span>
</span><span id="line-1348"></span><span id="local-6989586621679182628"><span class="annot"><a href="Constrained.Base.html#simplifyPreds"><span class="hs-identifier hs-type">simplifyPreds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182628"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182628"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182628"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1349"></span><span id="simplifyPreds"><span class="annot"><span class="annottext">simplifyPreds :: forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
[Pred fn] -&gt; [Pred fn]
</span><a href="Constrained.Base.html#simplifyPreds"><span class="hs-identifier hs-var hs-var">simplifyPreds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {fn :: [*] -&gt; * -&gt; *}. [Pred fn] -&gt; [Pred fn] -&gt; [Pred fn]
</span><a href="#local-6989586621679178432"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). BaseUniverse fn =&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#simplifyPred"><span class="hs-identifier hs-var">simplifyPred</span></a></span><span>
</span><span id="line-1350"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1351"></span><span>    </span><span id="local-6989586621679178432"><span class="annot"><span class="annottext">go :: [Pred fn] -&gt; [Pred fn] -&gt; [Pred fn]
</span><a href="#local-6989586621679178432"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679178431"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178431"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178431"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1352"></span><span>    </span><span class="annot"><a href="#local-6989586621679178432"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-type">FalsePred</span></a></span><span> </span><span id="local-6989586621679178429"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679178429"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). [String] -&gt; Pred fn
</span><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-var">FalsePred</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679178429"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1353"></span><span>    </span><span class="annot"><a href="#local-6989586621679178432"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679178428"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178428"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679178427"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178427"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pred fn] -&gt; [Pred fn] -&gt; [Pred fn]
</span><a href="#local-6989586621679178432"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178428"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178427"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-1354"></span><span>    </span><span class="annot"><a href="#local-6989586621679178432"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679178426"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178426"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679178425"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178425"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679178424"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178424"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pred fn] -&gt; [Pred fn] -&gt; [Pred fn]
</span><a href="#local-6989586621679178432"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178425"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178426"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178424"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-1355"></span><span>
</span><span id="line-1356"></span><span id="local-6989586621679182634"><span id="local-6989586621679182635"><span class="annot"><a href="Constrained.Base.html#simplifyBinder"><span class="hs-identifier hs-type">simplifyBinder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182635"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182634"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182635"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182634"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-1357"></span><span id="simplifyBinder"><span class="annot"><span class="annottext">simplifyBinder :: forall (fn :: [*] -&gt; * -&gt; *) a. Binder fn a -&gt; Binder fn a
</span><a href="Constrained.Base.html#simplifyBinder"><span class="hs-identifier hs-var hs-var">simplifyBinder</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679178419"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178419"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679178418"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178418"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178419"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). BaseUniverse fn =&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#simplifyPred"><span class="hs-identifier hs-var">simplifyPred</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178418"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1358"></span><span>
</span><span id="line-1359"></span><span class="hs-comment">-- Rewrite rules ----------------------------------------------------------</span><span>
</span><span id="line-1360"></span><span>
</span><span id="line-1361"></span><span class="hs-comment">-- NOTE: The `RewriteArgumentTypes` constraint that GHC complains about is not</span><span>
</span><span id="line-1362"></span><span class="hs-comment">-- in fact redundant. It's necessary to make the compiler infer types correctly.</span><span>
</span><span id="line-1363"></span><span class="annot"><a href="Constrained.Base.html#rewriteRule_"><span class="hs-identifier hs-type">rewriteRule_</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1364"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182619"><span class="annot"><a href="#local-6989586621679182619"><span class="hs-keyword hs-type">as</span></a></span></span><span> </span><span id="local-6989586621679182620"><span class="annot"><a href="#local-6989586621679182620"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679182617"><span class="annot"><a href="#local-6989586621679182617"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679182618"><span class="annot"><a href="#local-6989586621679182618"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-1365"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.List.html#All"><span class="hs-identifier hs-type">All</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182620"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679182619"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-1366"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182620"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182618"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-1367"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.List.html#TypeList"><span class="hs-identifier hs-type">TypeList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182619"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-1368"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679182617"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.List.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.List.html#MapList"><span class="hs-identifier hs-type">MapList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182620"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679182619"><span class="hs-keyword hs-type">as</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#PatternPair"><span class="hs-identifier hs-type">PatternPair</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182620"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182618"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1369"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#RewriteArgumentTypes"><span class="hs-identifier hs-type">RewriteArgumentTypes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182617"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182619"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-1370"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1371"></span><span>  </span><span class="annot"><a href="#local-6989586621679182617"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1372"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#RewriteRule"><span class="hs-identifier hs-type">RewriteRule</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182620"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182618"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-1373"></span><span id="rewriteRule_"><span class="annot"><span class="annottext">rewriteRule_ :: forall (as :: [*]) (fn :: [*] -&gt; * -&gt; *) r b.
(All (HasSpec fn) as, HasSpec fn b, TypeList as,
 r ~ FunTy (MapList (Term fn) as) (PatternPair fn b),
 RewriteArgumentTypes r ~ as) =&gt;
r -&gt; RewriteRule fn b
</span><a href="Constrained.Base.html#rewriteRule_"><span class="hs-identifier hs-var hs-var">rewriteRule_</span></a></span></span><span> </span><span id="local-6989586621679178405"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679178405"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall (as :: [*]) (fn :: [*] -&gt; * -&gt; *) b.
(TypeList as, All (HasSpec fn) as, HasSpec fn b) =&gt;
(List (Term fn) as -&gt; PatternPair fn b) -&gt; RewriteRule fn b
</span><a href="Constrained.Base.html#rewriteRuleList"><span class="hs-identifier hs-var">rewriteRuleList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (ts :: [*]) (f :: * -&gt; *) r.
TypeList ts =&gt;
FunTy (MapList f ts) r -&gt; List f ts -&gt; r
</span><a href="Constrained.List.html#uncurryList"><span class="hs-identifier hs-var">uncurryList</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182619"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679178405"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1374"></span><span>  </span><span id="local-6989586621679178402"><span class="annot"><span class="annottext">r :: RewriteRule fn b
</span><a href="#local-6989586621679178402"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#RewriteRule"><span class="hs-identifier hs-type">RewriteRule</span></a></span><span> </span><span class="annot"><span class="annottext">[Name fn]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679178388"><span class="annot"><span class="annottext">Pattern fn b
</span><a href="#local-6989586621679178388"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span class="annot"><span class="annottext">Pattern fn b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-1375"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). FreeVars fn -&gt; Map (Name fn) Int
</span><a href="Constrained.Base.html#unFreeVars"><span class="hs-identifier hs-var">unFreeVars</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern fn b
</span><a href="#local-6989586621679178388"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RewriteRule fn b
</span><a href="#local-6989586621679178402"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1376"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Rewrite rule: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">RewriteRule fn b
</span><a href="#local-6989586621679178402"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; is not linear in the left hand side.&quot;</span></span><span>
</span><span id="line-1377"></span><span>
</span><span id="line-1378"></span><span class="hs-keyword">data</span><span> </span><span id="RewriteRule"><span class="annot"><a href="Constrained.Base.html#RewriteRule"><span class="hs-identifier hs-var">RewriteRule</span></a></span></span><span> </span><span id="local-6989586621679178385"><span class="annot"><a href="#local-6989586621679178385"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679178384"><span class="annot"><a href="#local-6989586621679178384"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1379"></span><span>  </span><span id="local-6989586621679178382"><span id="local-6989586621679178383"><span id="RewriteRule"><span class="annot"><a href="Constrained.Base.html#RewriteRule"><span class="hs-identifier hs-var">RewriteRule</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679178383"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679178382"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679178383"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679178383"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679178382"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679178383"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679178382"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#RewriteRule"><span class="hs-identifier hs-type">RewriteRule</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679178383"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679178382"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-1380"></span><span>
</span><span id="line-1381"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679178377"><span id="local-6989586621679178380"><span id="local-6989586621679182602"><span id="local-6989586621679182603"><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#RewriteRule"><span class="hs-identifier hs-type">RewriteRule</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182603"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182602"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1382"></span><span>  </span><span id="local-6989586621679178376"><span class="annot"><span class="annottext">show :: RewriteRule fn a -&gt; String
</span><a href="#local-6989586621679178376"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#RewriteRule"><span class="hs-identifier hs-type">RewriteRule</span></a></span><span> </span><span class="annot"><span class="annottext">[Name fn]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679178370"><span class="annot"><span class="annottext">Pattern fn a
</span><a href="#local-6989586621679178370"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679178369"><span class="annot"><span class="annottext">Pattern fn a
</span><a href="#local-6989586621679178369"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern fn a
</span><a href="#local-6989586621679178370"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any
</span><span class="hs-string">&quot;~&gt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern fn a
</span><a href="#local-6989586621679178369"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1383"></span><span>
</span><span id="line-1384"></span><span class="hs-keyword">type</span><span> </span><span id="Pattern"><span class="annot"><a href="Constrained.Base.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span>
</span><span id="line-1385"></span><span>
</span><span id="line-1386"></span><span class="hs-keyword">type</span><span> </span><span id="PatternPair"><span class="annot"><a href="Constrained.Base.html#PatternPair"><span class="hs-identifier hs-var">PatternPair</span></a></span></span><span> </span><span id="local-6989586621679178368"><span class="annot"><a href="#local-6989586621679178368"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679178367"><span class="annot"><a href="#local-6989586621679178367"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679178368"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679178367"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679178368"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679178367"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1387"></span><span>
</span><span id="line-1388"></span><span id="local-6989586621679182596"><span id="local-6989586621679182597"><span class="annot"><a href="Constrained.Base.html#~%3E"><span class="hs-operator hs-type">(~&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182597"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182596"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182597"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182596"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#PatternPair"><span class="hs-identifier hs-type">PatternPair</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182597"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182596"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-1389"></span><span id="~%3E"><span class="annot"><span class="annottext">~&gt; :: forall (fn :: [*] -&gt; * -&gt; *) a.
Pattern fn a -&gt; Pattern fn a -&gt; PatternPair fn a
</span><a href="Constrained.Base.html#~%3E"><span class="hs-operator hs-var hs-var">(~&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-1390"></span><span>
</span><span id="line-1391"></span><span class="annot"><a href="Constrained.Base.html#matchTerm"><span class="hs-identifier hs-type">matchTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182595"><span class="annot"><a href="#local-6989586621679182595"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679182594"><span class="annot"><a href="#local-6989586621679182594"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182595"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182594"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182595"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182594"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182595"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182594"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182595"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1392"></span><span id="matchTerm"><span class="annot"><span class="annottext">matchTerm :: forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Pattern fn a -&gt; Pattern fn a -&gt; Maybe (Subst fn)
</span><a href="Constrained.Base.html#matchTerm"><span class="hs-identifier hs-var hs-var">matchTerm</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span id="local-6989586621679178354"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178354"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679178353"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178353"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178354"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; SubstEntry fn
</span><a href="Constrained.Base.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178353"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1393"></span><span class="annot"><a href="Constrained.Base.html#matchTerm"><span class="hs-identifier hs-var">matchTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679178351"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679178351"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679178344"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679178344"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679178351"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679178344"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1394"></span><span class="annot"><a href="Constrained.Base.html#matchTerm"><span class="hs-identifier hs-var">matchTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679178337"><span id="local-6989586621679178336"><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679178336"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679178337"><span class="hs-identifier hs-type">f</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679178335"><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679178335"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679178323"><span id="local-6989586621679178322"><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679178322"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679178323"><span class="hs-identifier hs-type">g</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679178321"><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679178321"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1395"></span><span>  </span><span class="annot"><span class="annottext">fn as a :~: fn as a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Refl</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {k} (a :: k) (b :: k).
(Typeable a, Typeable b) =&gt;
Maybe (a :~: b)
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">eqT</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679178337"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679178323"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-1396"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679178336"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679178322"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1397"></span><span>  </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (as :: [*]).
All (HasSpec fn) as =&gt;
List (Pattern fn) as -&gt; List (Pattern fn) as -&gt; Maybe (Subst fn)
</span><a href="Constrained.Base.html#matchTerms"><span class="hs-identifier hs-var">matchTerms</span></a></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679178335"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679178321"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-1398"></span><span class="annot"><a href="Constrained.Base.html#matchTerm"><span class="hs-identifier hs-var">matchTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1399"></span><span>
</span><span id="line-1400"></span><span class="annot"><a href="Constrained.Base.html#matchTerms"><span class="hs-identifier hs-type">matchTerms</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182587"><span class="annot"><a href="#local-6989586621679182587"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679182586"><span class="annot"><a href="#local-6989586621679182586"><span class="hs-keyword hs-type">as</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.List.html#All"><span class="hs-identifier hs-type">All</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182587"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679182586"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.List.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182587"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679182586"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.List.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182587"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679182586"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182587"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1401"></span><span id="matchTerms"><span class="annot"><span class="annottext">matchTerms :: forall (fn :: [*] -&gt; * -&gt; *) (as :: [*]).
All (HasSpec fn) as =&gt;
List (Pattern fn) as -&gt; List (Pattern fn) as -&gt; Maybe (Subst fn)
</span><a href="Constrained.Base.html#matchTerms"><span class="hs-identifier hs-var hs-var">matchTerms</span></a></span></span><span> </span><span class="annot"><span class="annottext">List (Pattern fn) as
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="annot"><span class="annottext">List (Pattern fn) as
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1402"></span><span class="annot"><a href="Constrained.Base.html#matchTerms"><span class="hs-identifier hs-var">matchTerms</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679178304"><span class="annot"><span class="annottext">Pattern fn a
</span><a href="#local-6989586621679178304"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679178303"><span class="annot"><span class="annottext">List (Pattern fn) as
</span><a href="#local-6989586621679178303"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679178291"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178291"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679178290"><span class="annot"><span class="annottext">List (Pattern fn) as
</span><a href="#local-6989586621679178290"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">(&lt;&gt;)</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Pattern fn a -&gt; Pattern fn a -&gt; Maybe (Subst fn)
</span><a href="Constrained.Base.html#matchTerm"><span class="hs-identifier hs-var">matchTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern fn a
</span><a href="#local-6989586621679178304"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178291"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (as :: [*]).
All (HasSpec fn) as =&gt;
List (Pattern fn) as -&gt; List (Pattern fn) as -&gt; Maybe (Subst fn)
</span><a href="Constrained.Base.html#matchTerms"><span class="hs-identifier hs-var">matchTerms</span></a></span><span> </span><span class="annot"><span class="annottext">List (Pattern fn) as
</span><a href="#local-6989586621679178303"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">List (Pattern fn) as
</span><a href="#local-6989586621679178290"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-1403"></span><span>
</span><span id="line-1404"></span><span class="annot"><a href="Constrained.Base.html#applyRewrite"><span class="hs-identifier hs-type">applyRewrite</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182577"><span class="annot"><a href="#local-6989586621679182577"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679182576"><span class="annot"><a href="#local-6989586621679182576"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182577"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182576"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#RewriteRule"><span class="hs-identifier hs-type">RewriteRule</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182577"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182576"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182577"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182576"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182577"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182576"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1405"></span><span id="applyRewrite"><span class="annot"><span class="annottext">applyRewrite :: forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
RewriteRule fn a -&gt; Term fn a -&gt; Maybe (Term fn a)
</span><a href="Constrained.Base.html#applyRewrite"><span class="hs-identifier hs-var hs-var">applyRewrite</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#RewriteRule"><span class="hs-identifier hs-type">RewriteRule</span></a></span><span> </span><span class="annot"><span class="annottext">[Name fn]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679178283"><span class="annot"><span class="annottext">Pattern fn a
</span><a href="#local-6989586621679178283"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679178282"><span id="local-6989586621679178281"><span class="annot"><span class="annottext">Pattern fn a
</span><a href="#local-6989586621679178281"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182577"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679178282"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679178280"><span class="annot"><span class="annottext">Pattern fn a
</span><a href="#local-6989586621679178280"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-1406"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a :~: a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Refl</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {k} (a :: k) (b :: k).
(Typeable a, Typeable b) =&gt;
Maybe (a :~: b)
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">eqT</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182576"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679178282"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1407"></span><span>      </span><span id="local-6989586621679178275"><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679178275"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Pattern fn a -&gt; Pattern fn a -&gt; Maybe (Subst fn)
</span><a href="Constrained.Base.html#matchTerm"><span class="hs-identifier hs-var">matchTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern fn a
</span><a href="#local-6989586621679178283"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern fn a
</span><a href="#local-6989586621679178280"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1408"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substituteTerm"><span class="hs-identifier hs-var">substituteTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679178275"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern fn a
</span><a href="#local-6989586621679178281"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1409"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1410"></span><span>
</span><span id="line-1411"></span><span id="local-6989586621679182650"><span id="local-6989586621679182651"><span class="annot"><a href="Constrained.Base.html#applyRewrites"><span class="hs-identifier hs-type">applyRewrites</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182651"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182650"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Base.html#RewriteRule"><span class="hs-identifier hs-type">RewriteRule</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182651"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182650"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182651"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182650"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182651"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182650"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1412"></span><span id="applyRewrites"><span class="annot"><span class="annottext">applyRewrites :: forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
[RewriteRule fn a] -&gt; Term fn a -&gt; Maybe (Term fn a)
</span><a href="Constrained.Base.html#applyRewrites"><span class="hs-identifier hs-var hs-var">applyRewrites</span></a></span></span><span> </span><span id="local-6989586621679178269"><span class="annot"><span class="annottext">[RewriteRule fn a]
</span><a href="#local-6989586621679178269"><span class="hs-identifier hs-var">rules</span></a></span></span><span> </span><span id="local-6989586621679178268"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178268"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">(&lt;|&gt;)</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
RewriteRule fn a -&gt; Term fn a -&gt; Maybe (Term fn a)
</span><a href="Constrained.Base.html#applyRewrite"><span class="hs-operator hs-var">`applyRewrite`</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178268"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[RewriteRule fn a]
</span><a href="#local-6989586621679178269"><span class="hs-identifier hs-var">rules</span></a></span><span>
</span><span id="line-1413"></span><span>
</span><span id="line-1414"></span><span id="local-6989586621679182568"><span id="local-6989586621679182569"><span class="annot"><a href="Constrained.Base.html#mkRewriteRule"><span class="hs-identifier hs-type">mkRewriteRule</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1415"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182569"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182568"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1416"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182569"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1417"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182569"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182568"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1418"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182569"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182568"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1419"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#RewriteRule"><span class="hs-identifier hs-type">RewriteRule</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182569"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182568"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-1420"></span><span id="mkRewriteRule"><span class="annot"><span class="annottext">mkRewriteRule :: forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
[Name fn] -&gt; Pattern fn a -&gt; Pattern fn a -&gt; RewriteRule fn a
</span><a href="Constrained.Base.html#mkRewriteRule"><span class="hs-identifier hs-var hs-var">mkRewriteRule</span></a></span></span><span> </span><span id="local-6989586621679178251"><span class="annot"><span class="annottext">[Name fn]
</span><a href="#local-6989586621679178251"><span class="hs-identifier hs-var">nms</span></a></span></span><span> </span><span id="local-6989586621679178250"><span class="annot"><span class="annottext">Pattern fn a
</span><a href="#local-6989586621679178250"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679178249"><span class="annot"><span class="annottext">Pattern fn a
</span><a href="#local-6989586621679178249"><span class="hs-identifier hs-var">rhs</span></a></span></span><span>
</span><span id="line-1421"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). FreeVars fn -&gt; Map (Name fn) Int
</span><a href="Constrained.Base.html#unFreeVars"><span class="hs-identifier hs-var">unFreeVars</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern fn a
</span><a href="#local-6989586621679178250"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
[Name fn] -&gt; Pattern fn a -&gt; Pattern fn a -&gt; RewriteRule fn a
</span><a href="Constrained.Base.html#RewriteRule"><span class="hs-identifier hs-var">RewriteRule</span></a></span><span> </span><span class="annot"><span class="annottext">[Name fn]
</span><a href="#local-6989586621679178251"><span class="hs-identifier hs-var">nms</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern fn a
</span><a href="#local-6989586621679178250"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern fn a
</span><a href="#local-6989586621679178249"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1422"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Rewrite-rules should be linear:\n  &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern fn a
</span><a href="#local-6989586621679178250"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n  &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern fn a
</span><a href="#local-6989586621679178249"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1423"></span><span>
</span><span id="line-1424"></span><span class="annot"><a href="Constrained.Base.html#rewriteRuleList"><span class="hs-identifier hs-type">rewriteRuleList</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1425"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182610"><span class="annot"><a href="#local-6989586621679182610"><span class="hs-keyword hs-type">as</span></a></span></span><span> </span><span id="local-6989586621679182609"><span class="annot"><a href="#local-6989586621679182609"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679182608"><span class="annot"><a href="#local-6989586621679182608"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-1426"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.List.html#TypeList"><span class="hs-identifier hs-type">TypeList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182610"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-1427"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.List.html#All"><span class="hs-identifier hs-type">All</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182609"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679182610"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-1428"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182609"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182608"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-1429"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1430"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.List.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182609"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679182610"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#PatternPair"><span class="hs-identifier hs-type">PatternPair</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182609"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182608"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1431"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#RewriteRule"><span class="hs-identifier hs-type">RewriteRule</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182609"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182608"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-1432"></span><span id="rewriteRuleList"><span class="annot"><span class="annottext">rewriteRuleList :: forall (as :: [*]) (fn :: [*] -&gt; * -&gt; *) b.
(TypeList as, All (HasSpec fn) as, HasSpec fn b) =&gt;
(List (Term fn) as -&gt; PatternPair fn b) -&gt; RewriteRule fn b
</span><a href="Constrained.Base.html#rewriteRuleList"><span class="hs-identifier hs-var hs-var">rewriteRuleList</span></a></span></span><span> </span><span id="local-6989586621679178241"><span class="annot"><span class="annottext">List (Term fn) as -&gt; PatternPair fn b
</span><a href="#local-6989586621679178241"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1433"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679178239"><span class="annot"><span class="annottext">vars :: List Var as
</span><a href="#local-6989586621679178239"><span class="hs-identifier hs-var hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (ts :: [*]) (f :: * -&gt; *).
TypeList ts =&gt;
(forall a (as :: [*]). List f as -&gt; f a) -&gt; List f ts
</span><a href="Constrained.List.html#unfoldList"><span class="hs-identifier hs-var">unfoldList</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (as :: [*]). List Var as -&gt; Var a
</span><a href="#local-6989586621679178237"><span class="hs-identifier hs-var">mkNextVar</span></a></span><span>
</span><span id="line-1434"></span><span>      </span><span class="annot"><a href="#local-6989586621679178237"><span class="hs-identifier hs-type">mkNextVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182558"><span class="annot"><a href="#local-6989586621679182558"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679182559"><span class="annot"><a href="#local-6989586621679182559"><span class="hs-keyword hs-type">as</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.List.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="Constrained.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182559"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182558"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1435"></span><span>      </span><span id="local-6989586621679178237"><span class="annot"><span class="annottext">mkNextVar :: forall a (as :: [*]). List Var as -&gt; Var a
</span><a href="#local-6989586621679178237"><span class="hs-identifier hs-var hs-var">mkNextVar</span></a></span></span><span> </span><span class="annot"><span class="annottext">List Var as
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; Var a
</span><a href="Constrained.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1436"></span><span>      </span><span class="annot"><a href="#local-6989586621679178237"><span class="hs-identifier hs-var">mkNextVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621679178230"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679178230"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">List Var as
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; Var a
</span><a href="Constrained.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679178230"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1437"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
[Name fn] -&gt; Pattern fn a -&gt; Pattern fn a -&gt; RewriteRule fn a
</span><a href="Constrained.Base.html#RewriteRule"><span class="hs-identifier hs-var">RewriteRule</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (c :: k -&gt; Constraint) (as :: [k]) b (f :: k -&gt; *).
(All c as, Monoid b) =&gt;
(forall (a :: k). c a =&gt; f a -&gt; b) -&gt; List f as -&gt; b
</span><a href="Constrained.List.html#foldMapListC"><span class="hs-identifier hs-var">foldMapListC</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182609"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; Var a -&gt; Name fn
</span><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-var">Name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List Var as
</span><a href="#local-6989586621679178239"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">List (Term fn) as -&gt; PatternPair fn b
</span><a href="#local-6989586621679178241"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (c :: k -&gt; Constraint) (as :: [k]) (f :: k -&gt; *)
       (g :: k -&gt; *).
All c as =&gt;
(forall (a :: k). c a =&gt; f a -&gt; g a) -&gt; List f as -&gt; List g as
</span><a href="Constrained.List.html#mapListC"><span class="hs-identifier hs-var">mapListC</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182609"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; Var a -&gt; Term fn a
</span><a href="Constrained.Base.html#V"><span class="hs-identifier hs-var">V</span></a></span><span> </span><span class="annot"><span class="annottext">List Var as
</span><a href="#local-6989586621679178239"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1438"></span><span>
</span><span id="line-1439"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="RewriteArgumentTypes"><span class="annot"><a href="Constrained.Base.html#RewriteArgumentTypes"><span class="hs-identifier hs-var">RewriteArgumentTypes</span></a></span></span><span> </span><span id="local-6989586621679178223"><span class="annot"><a href="#local-6989586621679178223"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1440"></span><span>  </span><span id="RewriteArgumentTypes"><span class="annot"><a href="Constrained.Base.html#RewriteArgumentTypes"><span class="hs-identifier hs-var">RewriteArgumentTypes</span></a></span></span><span> </span><span id="local-6989586621679178220"><span id="local-6989586621679178221"><span id="local-6989586621679178222"><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679178222"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679178221"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679178220"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679178221"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#RewriteArgumentTypes"><span class="hs-identifier hs-type">RewriteArgumentTypes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679178220"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-1441"></span><span>  </span><span id="RewriteArgumentTypes"><span class="annot"><a href="Constrained.Base.html#RewriteArgumentTypes"><span class="hs-identifier hs-var">RewriteArgumentTypes</span></a></span></span><span> </span><span id="local-6989586621679178219"><span class="annot"><a href="#local-6989586621679178219"><span class="hs-identifier hs-type hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1442"></span><span>
</span><span id="line-1443"></span><span class="hs-comment">-- Arcane magic -----------------------------------------------------------</span><span>
</span><span id="line-1444"></span><span>
</span><span id="line-1445"></span><span class="hs-comment">-- TODO: it might be necessary to run aggressiveInlining again after the let floating etc.</span><span>
</span><span id="line-1446"></span><span id="local-6989586621679183229"><span class="annot"><a href="Constrained.Base.html#optimisePred"><span class="hs-identifier hs-type">optimisePred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183229"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183229"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183229"><span class="hs-identifier hs-type">fn</span></a></span></span><span>
</span><span id="line-1447"></span><span id="optimisePred"><span class="annot"><span class="annottext">optimisePred :: forall (fn :: [*] -&gt; * -&gt; *). BaseUniverse fn =&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#optimisePred"><span class="hs-identifier hs-var hs-var">optimisePred</span></a></span></span><span> </span><span id="local-6989586621679178211"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178211"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1448"></span><span>  </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). BaseUniverse fn =&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#simplifyPred"><span class="hs-identifier hs-var">simplifyPred</span></a></span><span>
</span><span id="line-1449"></span><span>    </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). BaseUniverse fn =&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#letSubexpressionElimination"><span class="hs-identifier hs-var">letSubexpressionElimination</span></a></span><span>
</span><span id="line-1450"></span><span>    </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). BaseUniverse fn =&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#letFloating"><span class="hs-identifier hs-var">letFloating</span></a></span><span>
</span><span id="line-1451"></span><span>    </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
[Name fn] -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#aggressiveInlining"><span class="hs-identifier hs-var">aggressiveInlining</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.toList</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; Set (Name fn)
</span><a href="Constrained.Base.html#freeVarSet"><span class="hs-identifier hs-var">freeVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178211"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1452"></span><span>    </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). BaseUniverse fn =&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#simplifyPred"><span class="hs-identifier hs-var">simplifyPred</span></a></span><span>
</span><span id="line-1453"></span><span>    </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178211"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1454"></span><span>
</span><span id="line-1455"></span><span class="hs-comment">-- Common subexpression elimination but only on terms that are already let-bound.</span><span>
</span><span id="line-1456"></span><span id="local-6989586621679178206"><span class="annot"><a href="Constrained.Base.html#letSubexpressionElimination"><span class="hs-identifier hs-type">letSubexpressionElimination</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679178206"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679178206"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679178206"><span class="hs-identifier hs-type">fn</span></a></span></span><span>
</span><span id="line-1457"></span><span id="letSubexpressionElimination"><span class="annot"><span class="annottext">letSubexpressionElimination :: forall (fn :: [*] -&gt; * -&gt; *). BaseUniverse fn =&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#letSubexpressionElimination"><span class="hs-identifier hs-var hs-var">letSubexpressionElimination</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {fn :: [*] -&gt; * -&gt; *}. Subst fn -&gt; Pred fn -&gt; Pred fn
</span><a href="#local-6989586621679178204"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1458"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1459"></span><span>    </span><span id="local-6989586621679178201"><span class="annot"><span class="annottext">adjustSub :: Var a -&gt; [SubstEntry fn] -&gt; [SubstEntry fn]
</span><a href="#local-6989586621679178201"><span class="hs-identifier hs-var hs-var">adjustSub</span></a></span></span><span> </span><span id="local-6989586621679178200"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178200"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679178199"><span class="annot"><span class="annottext">[SubstEntry fn]
</span><a href="#local-6989586621679178199"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1460"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178198"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; SubstEntry fn
</span><a href="Constrained.Base.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178196"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679178198"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178198"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A%3D"><span class="hs-operator hs-type">:=</span></a></span><span> </span><span id="local-6989586621679178196"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178196"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[SubstEntry fn]
</span><a href="#local-6989586621679178199"><span class="hs-identifier hs-var">sub</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">isNothing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a a'.
(Typeable a, Typeable a') =&gt;
Var a -&gt; Var a' -&gt; Maybe (a :~: a')
</span><a href="Constrained.Core.html#eqVar"><span class="hs-identifier hs-var">eqVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178200"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178198"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1461"></span><span>      </span><span class="hs-comment">-- TODO: possibly freshen the binder where</span><span>
</span><span id="line-1462"></span><span>      </span><span class="hs-comment">-- `x` appears instead?</span><span>
</span><span id="line-1463"></span><span>      </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Name fn -&gt; FreeVars fn -&gt; Int
</span><a href="Constrained.Base.html#count"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; Var a -&gt; Name fn
</span><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-var">Name</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178200"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178196"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1464"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-1465"></span><span>
</span><span id="line-1466"></span><span>    </span><span id="local-6989586621679182534"><span id="local-6989586621679182535"><span class="annot"><a href="#local-6989586621679178185"><span class="hs-identifier hs-type">goBinder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182535"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182535"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182534"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182535"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182534"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-1467"></span><span>    </span><span id="local-6989586621679178185"><span class="annot"><span class="annottext">goBinder :: forall (fn :: [*] -&gt; * -&gt; *) a.
Subst fn -&gt; Binder fn a -&gt; Binder fn a
</span><a href="#local-6989586621679178185"><span class="hs-identifier hs-var hs-var">goBinder</span></a></span></span><span> </span><span id="local-6989586621679178184"><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679178184"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679178180"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178180"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679178179"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178179"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178180"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall {fn :: [*] -&gt; * -&gt; *}. Subst fn -&gt; Pred fn -&gt; Pred fn
</span><a href="#local-6989586621679178204"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {a} {fn :: [*] -&gt; * -&gt; *}.
HasSpec fn a =&gt;
Var a -&gt; [SubstEntry fn] -&gt; [SubstEntry fn]
</span><a href="#local-6989586621679178201"><span class="hs-identifier hs-var">adjustSub</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178180"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679178184"><span class="hs-identifier hs-var">sub</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178179"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1468"></span><span>
</span><span id="line-1469"></span><span>    </span><span id="local-6989586621679178204"><span class="annot"><span class="annottext">go :: Subst fn -&gt; Pred fn -&gt; Pred fn
</span><a href="#local-6989586621679178204"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679178177"><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679178177"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1470"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#GenHint"><span class="hs-identifier hs-type">GenHint</span></a></span><span> </span><span id="local-6989586621679178172"><span class="annot"><span class="annottext">Hint a
</span><a href="#local-6989586621679178172"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679178171"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178171"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasGenHint fn a =&gt;
Hint a -&gt; Term fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#GenHint"><span class="hs-identifier hs-var">GenHint</span></a></span><span> </span><span class="annot"><span class="annottext">Hint a
</span><a href="#local-6989586621679178172"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#backwardsSubstitution"><span class="hs-identifier hs-var">backwardsSubstitution</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679178177"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178171"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1471"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span id="local-6989586621679178170"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178170"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). [Pred fn] -&gt; Pred fn
</span><a href="Constrained.Base.html#Block"><span class="hs-identifier hs-var">Block</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst fn -&gt; Pred fn -&gt; Pred fn
</span><a href="#local-6989586621679178204"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679178177"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178170"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1472"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span id="local-6989586621679178169"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178169"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679178163"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178163"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679178162"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178162"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178161"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178163"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn -&gt; Pred fn -&gt; Pred fn
</span><a href="#local-6989586621679178204"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178163"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; SubstEntry fn
</span><a href="Constrained.Base.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178161"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679178160"><span class="hs-identifier hs-var">sub'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178162"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1473"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-1474"></span><span>          </span><span id="local-6989586621679178161"><span class="annot"><span class="annottext">t' :: Term fn a
</span><a href="#local-6989586621679178161"><span class="hs-identifier hs-var hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#backwardsSubstitution"><span class="hs-identifier hs-var">backwardsSubstitution</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679178177"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178169"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1475"></span><span>          </span><span id="local-6989586621679178160"><span class="annot"><span class="annottext">sub' :: Subst fn
</span><a href="#local-6989586621679178160"><span class="hs-identifier hs-var hs-var">sub'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {a} {fn :: [*] -&gt; * -&gt; *}.
HasSpec fn a =&gt;
Var a -&gt; [SubstEntry fn] -&gt; [SubstEntry fn]
</span><a href="#local-6989586621679178201"><span class="hs-identifier hs-var">adjustSub</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178163"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679178177"><span class="hs-identifier hs-var">sub</span></a></span><span>
</span><span id="line-1476"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#Exists"><span class="hs-identifier hs-type">Exists</span></a></span><span> </span><span id="local-6989586621679178159"><span class="annot"><span class="annottext">(forall b. Term fn b -&gt; b) -&gt; GE a
</span><a href="#local-6989586621679178159"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679178158"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178158"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
((forall b. Term fn b -&gt; b) -&gt; GE a) -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Exists"><span class="hs-identifier hs-var">Exists</span></a></span><span> </span><span class="annot"><span class="annottext">(forall b. Term fn b -&gt; b) -&gt; GE a
</span><a href="#local-6989586621679178159"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Subst fn -&gt; Binder fn a -&gt; Binder fn a
</span><a href="#local-6989586621679178185"><span class="hs-identifier hs-var">goBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679178177"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178158"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1477"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span id="local-6989586621679178155"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178155"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679178154"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178154"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679178153"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178153"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Subst fn -&gt; Pred fn -&gt; Pred fn
</span><a href="#local-6989586621679178204"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679178177"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#substitutePred"><span class="hs-identifier hs-var">substitutePred</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178155"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178154"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178153"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1478"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#Assert"><span class="hs-identifier hs-type">Assert</span></a></span><span> </span><span id="local-6989586621679178149"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679178149"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679178148"><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679178148"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
[String] -&gt; Term fn Bool -&gt; Pred fn
</span><a href="Constrained.Base.html#Assert"><span class="hs-identifier hs-var">Assert</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679178149"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#backwardsSubstitution"><span class="hs-identifier hs-var">backwardsSubstitution</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679178177"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679178148"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1479"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#Reify"><span class="hs-identifier hs-type">Reify</span></a></span><span> </span><span id="local-6989586621679178142"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178142"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679178141"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679178141"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679178140"><span class="annot"><span class="annottext">Binder fn b
</span><a href="#local-6989586621679178140"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a a.
(HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; (a -&gt; a) -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Reify"><span class="hs-identifier hs-var">Reify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#backwardsSubstitution"><span class="hs-identifier hs-var">backwardsSubstitution</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679178177"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178142"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679178141"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Subst fn -&gt; Binder fn a -&gt; Binder fn a
</span><a href="#local-6989586621679178185"><span class="hs-identifier hs-var">goBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679178177"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn b
</span><a href="#local-6989586621679178140"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1480"></span><span>      </span><span class="hs-comment">-- TODO: this is almost certainly not the right thing to do!</span><span>
</span><span id="line-1481"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#DependsOn"><span class="hs-identifier hs-type">DependsOn</span></a></span><span> </span><span id="local-6989586621679178129"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178129"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679178128"><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679178128"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1482"></span><span>        </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a a.
(HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; Term fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#DependsOn"><span class="hs-identifier hs-var">DependsOn</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178129"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679178128"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-1483"></span><span>          </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a a.
(HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; Term fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#DependsOn"><span class="hs-identifier hs-var">DependsOn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#backwardsSubstitution"><span class="hs-identifier hs-var">backwardsSubstitution</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679178177"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178129"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#backwardsSubstitution"><span class="hs-identifier hs-var">backwardsSubstitution</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679178177"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679178128"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1484"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#ForAll"><span class="hs-identifier hs-type">ForAll</span></a></span><span> </span><span id="local-6989586621679178120"><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679178120"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679178119"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178119"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a a (fn :: [*] -&gt; * -&gt; *).
(Forallable a a, HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#ForAll"><span class="hs-identifier hs-var">ForAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#backwardsSubstitution"><span class="hs-identifier hs-var">backwardsSubstitution</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679178177"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679178120"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Subst fn -&gt; Binder fn a -&gt; Binder fn a
</span><a href="#local-6989586621679178185"><span class="hs-identifier hs-var">goBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679178177"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679178119"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1485"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#Case"><span class="hs-identifier hs-type">Case</span></a></span><span> </span><span id="local-6989586621679178116"><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679178116"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679178115"><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679178115"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (a :: [*]).
HasSpec fn (SumOver a) =&gt;
Term fn (SumOver a) -&gt; List (Binder fn) a -&gt; Pred fn
</span><a href="Constrained.Base.html#Case"><span class="hs-identifier hs-var">Case</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679178116"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (as :: [k]).
(forall (a :: k). f a -&gt; g a) -&gt; List f as -&gt; List g as
</span><a href="Constrained.List.html#mapList"><span class="hs-identifier hs-var">mapList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Subst fn -&gt; Binder fn a -&gt; Binder fn a
</span><a href="#local-6989586621679178185"><span class="hs-identifier hs-var">goBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679178177"><span class="hs-identifier hs-var">sub</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679178115"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1486"></span><span>      </span><span class="annot"><span class="annottext">Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span>
</span><span id="line-1487"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-type">FalsePred</span></a></span><span> </span><span id="local-6989586621679178114"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679178114"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). [String] -&gt; Pred fn
</span><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-var">FalsePred</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679178114"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1488"></span><span>
</span><span id="line-1489"></span><span class="hs-comment">-- TODO: this can probably be cleaned up and generalized along with generalizing</span><span>
</span><span id="line-1490"></span><span class="hs-comment">-- to make sure we float lets in some missing cases.</span><span>
</span><span id="line-1491"></span><span id="local-6989586621679178113"><span class="annot"><a href="Constrained.Base.html#letFloating"><span class="hs-identifier hs-type">letFloating</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679178113"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679178113"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679178113"><span class="hs-identifier hs-type">fn</span></a></span></span><span>
</span><span id="line-1492"></span><span id="letFloating"><span class="annot"><span class="annottext">letFloating :: forall (fn :: [*] -&gt; * -&gt; *). BaseUniverse fn =&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#letFloating"><span class="hs-identifier hs-var hs-var">letFloating</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall {fn :: [*] -&gt; * -&gt; *}.
(Functions fn fn, Member (EqFn fn) fn, Member (SetFn fn) fn,
 Member (BoolFn fn) fn, Member (PairFn fn) fn, Member (IntFn fn) fn,
 Member (OrdFn fn) fn, Member (GenericsFn fn) fn,
 Member (ListFn fn) fn, Member (SumFn fn) fn, Member (MapFn fn) fn,
 Member (FunFn fn) fn) =&gt;
[Pred fn] -&gt; Pred fn -&gt; [Pred fn]
</span><a href="#local-6989586621679178085"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1493"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1494"></span><span>    </span><span id="local-6989586621679178084"><span class="annot"><span class="annottext">goBlock :: [Pred fn] -&gt; [Pred fn] -&gt; [Pred fn]
</span><a href="#local-6989586621679178084"><span class="hs-identifier hs-var hs-var">goBlock</span></a></span></span><span> </span><span id="local-6989586621679178083"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178083"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178083"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-1495"></span><span>    </span><span class="annot"><a href="#local-6989586621679178084"><span class="hs-identifier hs-var">goBlock</span></a></span><span> </span><span id="local-6989586621679178082"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178082"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span id="local-6989586621679178081"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178081"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679178062"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178062"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679178061"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178061"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679178060"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178060"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1496"></span><span>      </span><span class="hs-comment">-- We can do `goBlock` here because we've already done let floating</span><span>
</span><span id="line-1497"></span><span>      </span><span class="hs-comment">-- on the inner `p`</span><span>
</span><span id="line-1498"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178081"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178059"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pred fn] -&gt; [Pred fn] -&gt; [Pred fn]
</span><a href="#local-6989586621679178084"><span class="hs-identifier hs-var">goBlock</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178082"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178058"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178060"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1499"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1500"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679178059"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178059"><span class="hs-identifier hs-var">x'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679178058"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178058"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a t.
(Typeable a, Rename t) =&gt;
Var a -&gt; t -&gt; Set Int -&gt; (Var a, t)
</span><a href="Constrained.Core.html#freshen"><span class="hs-identifier hs-var">freshen</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178062"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178061"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) t. HasVariables fn t =&gt; t -&gt; Set Int
</span><a href="Constrained.Base.html#freeVarNames"><span class="hs-identifier hs-var">freeVarNames</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178060"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) t. HasVariables fn t =&gt; t -&gt; Set Int
</span><a href="Constrained.Base.html#freeVarNames"><span class="hs-identifier hs-var">freeVarNames</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178082"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.delete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Var a -&gt; Int
</span><a href="Constrained.Core.html#nameOf"><span class="hs-identifier hs-var">nameOf</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178062"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) t. HasVariables fn t =&gt; t -&gt; Set Int
</span><a href="Constrained.Base.html#freeVarNames"><span class="hs-identifier hs-var">freeVarNames</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178061"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1501"></span><span>    </span><span class="annot"><a href="#local-6989586621679178084"><span class="hs-identifier hs-var">goBlock</span></a></span><span> </span><span id="local-6989586621679178057"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178057"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span id="local-6989586621679178056"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178056"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679178055"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178055"><span class="hs-identifier hs-var">ps'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pred fn] -&gt; [Pred fn] -&gt; [Pred fn]
</span><a href="#local-6989586621679178084"><span class="hs-identifier hs-var">goBlock</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178057"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178056"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178055"><span class="hs-identifier hs-var">ps'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1502"></span><span>    </span><span class="annot"><a href="#local-6989586621679178084"><span class="hs-identifier hs-var">goBlock</span></a></span><span> </span><span id="local-6989586621679178054"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178054"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679178053"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178053"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679178052"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178052"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pred fn] -&gt; [Pred fn] -&gt; [Pred fn]
</span><a href="#local-6989586621679178084"><span class="hs-identifier hs-var">goBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178053"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178054"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178052"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-1503"></span><span>
</span><span id="line-1504"></span><span>    </span><span id="local-6989586621679182509"><span id="local-6989586621679182510"><span class="annot"><a href="#local-6989586621679178051"><span class="hs-identifier hs-type">goExists</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1505"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182510"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182509"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1506"></span><span>      </span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182510"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1507"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182510"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182509"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182510"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1508"></span><span>      </span><span class="annot"><a href="Constrained.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182509"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1509"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182510"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1510"></span><span>      </span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182510"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-1511"></span><span>    </span><span id="local-6989586621679178051"><span class="annot"><span class="annottext">goExists :: forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
[Pred fn]
-&gt; (Binder fn a -&gt; Pred fn) -&gt; Var a -&gt; Pred fn -&gt; [Pred fn]
</span><a href="#local-6989586621679178051"><span class="hs-identifier hs-var hs-var">goExists</span></a></span></span><span> </span><span id="local-6989586621679178035"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178035"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679178034"><span class="annot"><span class="annottext">Binder fn a -&gt; Pred fn
</span><a href="#local-6989586621679178034"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span id="local-6989586621679178033"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178033"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span id="local-6989586621679178032"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178032"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679178004"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178004"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679178003"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178003"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1512"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Name fn -&gt; FreeVars fn -&gt; Int
</span><a href="Constrained.Base.html#count"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; Var a -&gt; Name fn
</span><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-var">Name</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178033"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178032"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1513"></span><span>          </span><span class="hs-comment">-- freeVarNames t is not strictly necessary here (because lets don't work like in haskell)</span><span>
</span><span id="line-1514"></span><span>          </span><span class="hs-comment">-- but it makes the resulting code much easier to read as we won't invent a variable name</span><span>
</span><span id="line-1515"></span><span>          </span><span class="hs-comment">-- that shadows a variable used in the term.</span><span>
</span><span id="line-1516"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679178002"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178002"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679178001"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178001"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a t.
(Typeable a, Rename t) =&gt;
Var a -&gt; t -&gt; Set Int -&gt; (Var a, t)
</span><a href="Constrained.Core.html#freshen"><span class="hs-identifier hs-var">freshen</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178004"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178003"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.insert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Var a -&gt; Int
</span><a href="Constrained.Core.html#nameOf"><span class="hs-identifier hs-var">nameOf</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178033"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.delete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Var a -&gt; Int
</span><a href="Constrained.Core.html#nameOf"><span class="hs-identifier hs-var">nameOf</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178033"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) t. HasVariables fn t =&gt; t -&gt; Set Int
</span><a href="Constrained.Base.html#freeVarNames"><span class="hs-identifier hs-var">freeVarNames</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178003"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) t. HasVariables fn t =&gt; t -&gt; Set Int
</span><a href="Constrained.Base.html#freeVarNames"><span class="hs-identifier hs-var">freeVarNames</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178032"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1517"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall {fn :: [*] -&gt; * -&gt; *}.
(Functions fn fn, Member (EqFn fn) fn, Member (SetFn fn) fn,
 Member (BoolFn fn) fn, Member (PairFn fn) fn, Member (IntFn fn) fn,
 Member (OrdFn fn) fn, Member (GenericsFn fn) fn,
 Member (ListFn fn) fn, Member (SumFn fn) fn, Member (MapFn fn) fn,
 Member (FunFn fn) fn) =&gt;
[Pred fn] -&gt; Pred fn -&gt; [Pred fn]
</span><a href="#local-6989586621679178085"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178035"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679178032"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178002"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a -&gt; Pred fn
</span><a href="#local-6989586621679178034"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679178033"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679178001"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1518"></span><span>    </span><span class="annot"><a href="#local-6989586621679178051"><span class="hs-identifier hs-var">goExists</span></a></span><span> </span><span id="local-6989586621679178000"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178000"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679177999"><span class="annot"><span class="annottext">Binder fn a -&gt; Pred fn
</span><a href="#local-6989586621679177999"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span id="local-6989586621679177998"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177998"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679177997"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177997"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Binder fn a -&gt; Pred fn
</span><a href="#local-6989586621679177999"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177998"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177997"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679178000"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-1519"></span><span>
</span><span id="line-1520"></span><span>    </span><span id="local-6989586621679178085"><span class="annot"><span class="annottext">go :: [Pred fn] -&gt; Pred fn -&gt; [Pred fn]
</span><a href="#local-6989586621679178085"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679177971"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679177971"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1521"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span id="local-6989586621679177970"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679177970"><span class="hs-identifier hs-var">ps0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {fn :: [*] -&gt; * -&gt; *}. [Pred fn] -&gt; [Pred fn] -&gt; [Pred fn]
</span><a href="#local-6989586621679178084"><span class="hs-identifier hs-var">goBlock</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679177971"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). BaseUniverse fn =&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#letFloating"><span class="hs-identifier hs-var">letFloating</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679177970"><span class="hs-identifier hs-var">ps0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1522"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span id="local-6989586621679177969"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177969"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679177964"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177964"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679177963"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177963"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {fn :: [*] -&gt; * -&gt; *}. [Pred fn] -&gt; [Pred fn] -&gt; [Pred fn]
</span><a href="#local-6989586621679178084"><span class="hs-identifier hs-var">goBlock</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679177971"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177969"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177964"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). BaseUniverse fn =&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#letFloating"><span class="hs-identifier hs-var">letFloating</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177963"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1523"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#Exists"><span class="hs-identifier hs-type">Exists</span></a></span><span> </span><span id="local-6989586621679177962"><span class="annot"><span class="annottext">(forall b. Term fn b -&gt; b) -&gt; GE a
</span><a href="#local-6989586621679177962"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679177957"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177957"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679177956"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177956"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
[Pred fn]
-&gt; (Binder fn a -&gt; Pred fn) -&gt; Var a -&gt; Pred fn -&gt; [Pred fn]
</span><a href="#local-6989586621679178051"><span class="hs-identifier hs-var">goExists</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679177971"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
((forall b. Term fn b -&gt; b) -&gt; GE a) -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Exists"><span class="hs-identifier hs-var">Exists</span></a></span><span> </span><span class="annot"><span class="annottext">(forall b. Term fn b -&gt; b) -&gt; GE a
</span><a href="#local-6989586621679177962"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177957"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). BaseUniverse fn =&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#letFloating"><span class="hs-identifier hs-var">letFloating</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177956"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1524"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span id="local-6989586621679177953"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177953"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679177952"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177952"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679177951"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177951"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Pred fn] -&gt; Pred fn -&gt; [Pred fn]
</span><a href="#local-6989586621679178085"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679177971"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#substitutePred"><span class="hs-identifier hs-var">substitutePred</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177953"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177952"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177951"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1525"></span><span>      </span><span class="hs-comment">-- TODO: float let through reify if possible</span><span>
</span><span id="line-1526"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#Reify"><span class="hs-identifier hs-type">Reify</span></a></span><span> </span><span id="local-6989586621679177947"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177947"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679177946"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679177946"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679177940"><span class="annot"><span class="annottext">Var b
</span><a href="#local-6989586621679177940"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679177939"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177939"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a a.
(HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; (a -&gt; a) -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Reify"><span class="hs-identifier hs-var">Reify</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177947"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679177946"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var b
</span><a href="#local-6989586621679177940"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). BaseUniverse fn =&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#letFloating"><span class="hs-identifier hs-var">letFloating</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177939"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679177971"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-1527"></span><span>      </span><span class="hs-comment">-- TODO: float let through forall if possible</span><span>
</span><span id="line-1528"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#ForAll"><span class="hs-identifier hs-type">ForAll</span></a></span><span> </span><span id="local-6989586621679177934"><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679177934"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679177927"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177927"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679177926"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177926"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a a (fn :: [*] -&gt; * -&gt; *).
(Forallable a a, HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#ForAll"><span class="hs-identifier hs-var">ForAll</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679177934"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177927"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). BaseUniverse fn =&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#letFloating"><span class="hs-identifier hs-var">letFloating</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177926"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679177971"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-1529"></span><span>      </span><span class="hs-comment">-- TODO: float let through the cases if possible</span><span>
</span><span id="line-1530"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#Case"><span class="hs-identifier hs-type">Case</span></a></span><span> </span><span id="local-6989586621679177922"><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679177922"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679177921"><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679177921"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (a :: [*]).
HasSpec fn (SumOver a) =&gt;
Term fn (SumOver a) -&gt; List (Binder fn) a -&gt; Pred fn
</span><a href="Constrained.Base.html#Case"><span class="hs-identifier hs-var">Case</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679177922"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (as :: [k]).
(forall (a :: k). f a -&gt; g a) -&gt; List f as -&gt; List g as
</span><a href="Constrained.List.html#mapList"><span class="hs-identifier hs-var">mapList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679177917"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177917"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679177916"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177916"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177917"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). BaseUniverse fn =&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#letFloating"><span class="hs-identifier hs-var">letFloating</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177916"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679177921"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679177971"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-1531"></span><span>      </span><span class="hs-comment">-- Boring cases</span><span>
</span><span id="line-1532"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#Assert"><span class="hs-identifier hs-type">Assert</span></a></span><span> </span><span id="local-6989586621679177913"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679177913"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679177912"><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679177912"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
[String] -&gt; Term fn Bool -&gt; Pred fn
</span><a href="Constrained.Base.html#Assert"><span class="hs-identifier hs-var">Assert</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679177913"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679177912"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679177971"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-1533"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#GenHint"><span class="hs-identifier hs-type">GenHint</span></a></span><span> </span><span id="local-6989586621679177909"><span class="annot"><span class="annottext">Hint a
</span><a href="#local-6989586621679177909"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679177908"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177908"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasGenHint fn a =&gt;
Hint a -&gt; Term fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#GenHint"><span class="hs-identifier hs-var">GenHint</span></a></span><span> </span><span class="annot"><span class="annottext">Hint a
</span><a href="#local-6989586621679177909"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177908"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679177971"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-1534"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#DependsOn"><span class="hs-identifier hs-type">DependsOn</span></a></span><span> </span><span id="local-6989586621679177903"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177903"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679177902"><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679177902"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a a.
(HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; Term fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#DependsOn"><span class="hs-identifier hs-var">DependsOn</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177903"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679177902"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679177971"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-1535"></span><span>      </span><span class="annot"><span class="annottext">Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679177971"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-1536"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-type">FalsePred</span></a></span><span> </span><span id="local-6989586621679177901"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679177901"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). [String] -&gt; Pred fn
</span><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-var">FalsePred</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679177901"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679177971"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-1537"></span><span>
</span><span id="line-1538"></span><span id="local-6989586621679182542"><span class="annot"><a href="Constrained.Base.html#aggressiveInlining"><span class="hs-identifier hs-type">aggressiveInlining</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182542"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182542"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182542"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182542"><span class="hs-identifier hs-type">fn</span></a></span></span><span>
</span><span id="line-1539"></span><span id="aggressiveInlining"><span class="annot"><span class="annottext">aggressiveInlining :: forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
[Name fn] -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#aggressiveInlining"><span class="hs-identifier hs-var hs-var">aggressiveInlining</span></a></span></span><span> </span><span id="local-6989586621679177871"><span class="annot"><span class="annottext">[Name fn]
</span><a href="#local-6989586621679177871"><span class="hs-identifier hs-var">inlineable</span></a></span></span><span> </span><span id="local-6989586621679177870"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177870"><span class="hs-identifier hs-var">p</span></a></span></span><span>
</span><span id="line-1540"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679177869"><span class="hs-identifier hs-var">inlined</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
[Name fn] -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#aggressiveInlining"><span class="hs-identifier hs-var">aggressiveInlining</span></a></span><span> </span><span class="annot"><span class="annottext">[Name fn]
</span><a href="#local-6989586621679177871"><span class="hs-identifier hs-var">inlineable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). BaseUniverse fn =&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#simplifyPred"><span class="hs-identifier hs-var">simplifyPred</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177868"><span class="hs-identifier hs-var">pInlined</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1541"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177870"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1542"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1543"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679177868"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177868"><span class="hs-identifier hs-var">pInlined</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span id="local-6989586621679177869"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679177869"><span class="hs-identifier hs-var">inlined</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall w a. Writer w a -&gt; (a, w)
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runWriter</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {fn :: [*] -&gt; * -&gt; *}.
(Functions fn fn, Member (EqFn fn) fn, Member (SetFn fn) fn,
 Member (BoolFn fn) fn, Member (PairFn fn) fn, Member (IntFn fn) fn,
 Member (OrdFn fn) fn, Member (GenericsFn fn) fn,
 Member (ListFn fn) fn, Member (SumFn fn) fn, Member (MapFn fn) fn,
 Member (FunFn fn) fn) =&gt;
FreeVars fn
-&gt; Subst fn -&gt; Pred fn -&gt; WriterT Any Identity (Pred fn)
</span><a href="#local-6989586621679177866"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177870"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
FreeVars fn -&gt; Set (Name fn) -&gt; FreeVars fn
</span><a href="Constrained.Base.html#restrictedTo"><span class="hs-operator hs-var">`restrictedTo`</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Name fn]
</span><a href="#local-6989586621679177871"><span class="hs-identifier hs-var">inlineable</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177870"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1544"></span><span>
</span><span id="line-1545"></span><span>    </span><span id="local-6989586621679177858"><span class="annot"><span class="annottext">underBinder :: FreeVars fn -&gt; Var a -&gt; p -&gt; FreeVars fn
</span><a href="#local-6989586621679177858"><span class="hs-identifier hs-var hs-var">underBinder</span></a></span></span><span> </span><span id="local-6989586621679177857"><span class="annot"><span class="annottext">FreeVars fn
</span><a href="#local-6989586621679177857"><span class="hs-identifier hs-var">fvs</span></a></span></span><span> </span><span id="local-6989586621679177856"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177856"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679177855"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679177855"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars fn
</span><a href="#local-6989586621679177857"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *).
Foldable t =&gt;
FreeVars fn -&gt; t (Name fn) -&gt; FreeVars fn
</span><a href="Constrained.Base.html#without"><span class="hs-operator hs-var">`without`</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; Var a -&gt; Name fn
</span><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-var">Name</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177856"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679177855"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
FreeVars fn -&gt; Set (Name fn) -&gt; FreeVars fn
</span><a href="Constrained.Base.html#restrictedTo"><span class="hs-operator hs-var">`restrictedTo`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; Var a -&gt; Name fn
</span><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-var">Name</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177856"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1546"></span><span>
</span><span id="line-1547"></span><span>    </span><span id="local-6989586621679177853"><span class="annot"><span class="annottext">underBinderSub :: [SubstEntry fn] -&gt; Var a -&gt; [SubstEntry fn]
</span><a href="#local-6989586621679177853"><span class="hs-identifier hs-var hs-var">underBinderSub</span></a></span></span><span> </span><span id="local-6989586621679177852"><span class="annot"><span class="annottext">[SubstEntry fn]
</span><a href="#local-6989586621679177852"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span id="local-6989586621679177851"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177851"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1548"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177850"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; SubstEntry fn
</span><a href="Constrained.Base.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177848"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1549"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679177850"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177850"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A%3D"><span class="hs-operator hs-type">:=</span></a></span><span> </span><span id="local-6989586621679177848"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177848"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[SubstEntry fn]
</span><a href="#local-6989586621679177852"><span class="hs-identifier hs-var">sub</span></a></span><span>
</span><span id="line-1550"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">isNothing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a a'.
(Typeable a, Typeable a') =&gt;
Var a -&gt; Var a' -&gt; Maybe (a :~: a')
</span><a href="Constrained.Core.html#eqVar"><span class="hs-identifier hs-var">eqVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177851"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177850"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-1551"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-1552"></span><span>
</span><span id="line-1553"></span><span>    </span><span class="hs-comment">-- NOTE: this is safe because we only use the `Subst` when it results in a literal so there</span><span>
</span><span id="line-1554"></span><span>    </span><span class="hs-comment">-- is no risk of variable capture.</span><span>
</span><span id="line-1555"></span><span>    </span><span id="local-6989586621679182479"><span id="local-6989586621679182480"><span class="annot"><a href="#local-6989586621679177843"><span class="hs-identifier hs-type">goBinder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182480"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182480"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182480"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182479"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">Writer</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182480"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182479"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1556"></span><span>    </span><span id="local-6989586621679177843"><span class="annot"><span class="annottext">goBinder :: forall (fn :: [*] -&gt; * -&gt; *) a.
FreeVars fn -&gt; Subst fn -&gt; Binder fn a -&gt; Writer Any (Binder fn a)
</span><a href="#local-6989586621679177843"><span class="hs-identifier hs-var hs-var">goBinder</span></a></span></span><span> </span><span id="local-6989586621679177842"><span class="annot"><span class="annottext">FreeVars fn
</span><a href="#local-6989586621679177842"><span class="hs-identifier hs-var">fvs</span></a></span></span><span> </span><span id="local-6989586621679177841"><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679177841"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679177805"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177805"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679177804"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177804"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177805"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall {fn :: [*] -&gt; * -&gt; *}.
(Functions fn fn, Member (EqFn fn) fn, Member (SetFn fn) fn,
 Member (BoolFn fn) fn, Member (PairFn fn) fn, Member (IntFn fn) fn,
 Member (OrdFn fn) fn, Member (GenericsFn fn) fn,
 Member (ListFn fn) fn, Member (SumFn fn) fn, Member (MapFn fn) fn,
 Member (FunFn fn) fn) =&gt;
FreeVars fn
-&gt; Subst fn -&gt; Pred fn -&gt; WriterT Any Identity (Pred fn)
</span><a href="#local-6989586621679177866"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {fn :: [*] -&gt; * -&gt; *} {a} {p}.
(HasSpec fn a, HasVariables fn p) =&gt;
FreeVars fn -&gt; Var a -&gt; p -&gt; FreeVars fn
</span><a href="#local-6989586621679177858"><span class="hs-identifier hs-var">underBinder</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars fn
</span><a href="#local-6989586621679177842"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177805"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177804"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {a} {fn :: [*] -&gt; * -&gt; *}.
Typeable a =&gt;
[SubstEntry fn] -&gt; Var a -&gt; [SubstEntry fn]
</span><a href="#local-6989586621679177853"><span class="hs-identifier hs-var">underBinderSub</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679177841"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177805"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177804"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1557"></span><span>
</span><span id="line-1558"></span><span>    </span><span id="local-6989586621679177866"><span class="annot"><span class="annottext">go :: FreeVars fn
-&gt; Subst fn -&gt; Pred fn -&gt; WriterT Any Identity (Pred fn)
</span><a href="#local-6989586621679177866"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679177762"><span class="annot"><span class="annottext">FreeVars fn
</span><a href="#local-6989586621679177762"><span class="hs-identifier hs-var">fvs</span></a></span></span><span> </span><span id="local-6989586621679177761"><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679177761"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span id="local-6989586621679177760"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177760"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177760"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1559"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span id="local-6989586621679177757"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177757"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679177756"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177756"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679177755"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177755"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FreeVars fn
-&gt; Subst fn -&gt; Pred fn -&gt; WriterT Any Identity (Pred fn)
</span><a href="#local-6989586621679177866"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars fn
</span><a href="#local-6989586621679177762"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679177761"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#substitutePred"><span class="hs-identifier hs-var">substitutePred</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177757"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177756"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177755"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1560"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#Reify"><span class="hs-identifier hs-type">Reify</span></a></span><span> </span><span id="local-6989586621679177745"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177745"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span id="local-6989586621679177744"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679177744"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679177743"><span class="annot"><span class="annottext">Binder fn b
</span><a href="#local-6989586621679177743"><span class="hs-identifier hs-var">b</span></a></span></span><span>
</span><span id="line-1561"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Bool
</span><a href="Constrained.Base.html#isLit"><span class="hs-identifier hs-var">isLit</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177745"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1562"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679177731"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177731"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
BaseUniverse fn =&gt;
Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#simplifyTerm"><span class="hs-identifier hs-var">simplifyTerm</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substituteTerm"><span class="hs-identifier hs-var">substituteTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679177761"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177745"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1563"></span><span>            </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">tell</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1564"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a a.
(HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; (a -&gt; a) -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#mkReify"><span class="hs-identifier hs-var">mkReify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177731"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679177744"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn b
</span><a href="#local-6989586621679177743"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1565"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a a.
(HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; (a -&gt; a) -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Reify"><span class="hs-identifier hs-var">Reify</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177745"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679177744"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
FreeVars fn -&gt; Subst fn -&gt; Binder fn a -&gt; Writer Any (Binder fn a)
</span><a href="#local-6989586621679177843"><span class="hs-identifier hs-var">goBinder</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars fn
</span><a href="#local-6989586621679177762"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679177761"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn b
</span><a href="#local-6989586621679177743"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1566"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#ForAll"><span class="hs-identifier hs-type">ForAll</span></a></span><span> </span><span id="local-6989586621679177719"><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679177719"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span id="local-6989586621679177718"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679177718"><span class="hs-identifier hs-var">b</span></a></span></span><span>
</span><span id="line-1567"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Bool
</span><a href="Constrained.Base.html#isLit"><span class="hs-identifier hs-var">isLit</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679177719"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1568"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679177706"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679177706"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
BaseUniverse fn =&gt;
Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#simplifyTerm"><span class="hs-identifier hs-var">simplifyTerm</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substituteTerm"><span class="hs-identifier hs-var">substituteTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679177761"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679177719"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1569"></span><span>            </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">tell</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1570"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a a (fn :: [*] -&gt; * -&gt; *).
(Forallable a a, HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#ForAll"><span class="hs-identifier hs-var">ForAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679177706"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679177718"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1571"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a a (fn :: [*] -&gt; * -&gt; *).
(Forallable a a, HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#ForAll"><span class="hs-identifier hs-var">ForAll</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679177719"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
FreeVars fn -&gt; Subst fn -&gt; Binder fn a -&gt; Writer Any (Binder fn a)
</span><a href="#local-6989586621679177843"><span class="hs-identifier hs-var">goBinder</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars fn
</span><a href="#local-6989586621679177762"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679177761"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679177718"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1572"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#Case"><span class="hs-identifier hs-type">Case</span></a></span><span> </span><span id="local-6989586621679177696"><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679177696"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679177695"><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679177695"><span class="hs-identifier hs-var">bs</span></a></span></span><span>
</span><span id="line-1573"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Bool
</span><a href="Constrained.Base.html#isLit"><span class="hs-identifier hs-var">isLit</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679177696"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1574"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679177689"><span class="annot"><span class="annottext">SumOver as
</span><a href="#local-6989586621679177689"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
BaseUniverse fn =&gt;
Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#simplifyTerm"><span class="hs-identifier hs-var">simplifyTerm</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substituteTerm"><span class="hs-identifier hs-var">substituteTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679177761"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679177696"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1575"></span><span>            </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">tell</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1576"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (as :: [*]) (fn :: [*] -&gt; * -&gt; *) r.
SumOver as
-&gt; List (Binder fn) as
-&gt; (forall a. HasSpec fn a =&gt; Var a -&gt; a -&gt; Pred fn -&gt; r)
-&gt; r
</span><a href="Constrained.Base.html#runCaseOn"><span class="hs-identifier hs-var">runCaseOn</span></a></span><span> </span><span class="annot"><span class="annottext">SumOver as
</span><a href="#local-6989586621679177689"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679177695"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679177682"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177682"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679177681"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177681"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679177680"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177680"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
Env -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#substPred"><span class="hs-identifier hs-var">substPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Typeable a, Show a) =&gt; Var a -&gt; a -&gt; Env
</span><a href="Constrained.Env.html#singletonEnv"><span class="hs-identifier hs-var">singletonEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177682"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177681"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177680"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1577"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679177676"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177676"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679177675"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177675"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679177695"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1578"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679177663"><span class="annot"><span class="annottext">t' :: Term fn a
</span><a href="#local-6989586621679177663"><span class="hs-identifier hs-var hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
BaseUniverse fn =&gt;
Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#simplifyTerm"><span class="hs-identifier hs-var">simplifyTerm</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substituteTerm"><span class="hs-identifier hs-var">substituteTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679177761"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679177696"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1579"></span><span>            </span><span id="local-6989586621679177662"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177662"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FreeVars fn
-&gt; Subst fn -&gt; Pred fn -&gt; WriterT Any Identity (Pred fn)
</span><a href="#local-6989586621679177866"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {fn :: [*] -&gt; * -&gt; *} {a} {p}.
(HasSpec fn a, HasVariables fn p) =&gt;
FreeVars fn -&gt; Var a -&gt; p -&gt; FreeVars fn
</span><a href="#local-6989586621679177858"><span class="hs-identifier hs-var">underBinder</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars fn
</span><a href="#local-6989586621679177762"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177676"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177675"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177676"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; SubstEntry fn
</span><a href="Constrained.Base.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177663"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679177761"><span class="hs-identifier hs-var">sub</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177675"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1580"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (a :: [*]).
HasSpec fn (SumOver a) =&gt;
Term fn (SumOver a) -&gt; List (Binder fn) a -&gt; Pred fn
</span><a href="Constrained.Base.html#Case"><span class="hs-identifier hs-var">Case</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679177696"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177676"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177662"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (a :: k) (a :: [k]).
f a -&gt; List f a -&gt; List f (a : a)
</span><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *). List f '[]
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1581"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (a :: [*]).
HasSpec fn (SumOver a) =&gt;
Term fn (SumOver a) -&gt; List (Binder fn) a -&gt; Pred fn
</span><a href="Constrained.Base.html#Case"><span class="hs-identifier hs-var">Case</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679177696"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (m :: * -&gt; *) (f :: k -&gt; *) (g :: k -&gt; *) (as :: [k]).
Applicative m =&gt;
(forall (a :: k). f a -&gt; m (g a)) -&gt; List f as -&gt; m (List g as)
</span><a href="Constrained.List.html#mapMList"><span class="hs-identifier hs-var">mapMList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
FreeVars fn -&gt; Subst fn -&gt; Binder fn a -&gt; Writer Any (Binder fn a)
</span><a href="#local-6989586621679177843"><span class="hs-identifier hs-var">goBinder</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars fn
</span><a href="#local-6989586621679177762"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679177761"><span class="hs-identifier hs-var">sub</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679177695"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-1582"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span id="local-6989586621679177661"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177661"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679177633"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177633"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679177632"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177632"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1583"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679177631"><span class="annot"><span class="annottext">Name fn
</span><a href="#local-6989586621679177631"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Name fn -&gt; FreeVars fn -&gt; Int
</span><a href="Constrained.Base.html#count"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">Name fn
</span><a href="#local-6989586621679177631"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars fn
</span><a href="#local-6989586621679177762"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; Set (Name fn)
</span><a href="Constrained.Base.html#freeVarSet"><span class="hs-identifier hs-var">freeVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177661"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1584"></span><span>            </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">tell</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1585"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#substitutePred"><span class="hs-identifier hs-var">substitutePred</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177633"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177661"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177632"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1586"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Name fn -&gt; FreeVars fn -&gt; Int
</span><a href="Constrained.Base.html#count"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; Var a -&gt; Name fn
</span><a href="Constrained.Base.html#Name"><span class="hs-identifier hs-var">Name</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177633"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasVariables fn a =&gt;
a -&gt; FreeVars fn
</span><a href="Constrained.Base.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177632"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1587"></span><span>            </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">tell</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1588"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177632"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1589"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Bool
</span><a href="Constrained.Base.html#isLit"><span class="hs-identifier hs-var">isLit</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177661"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1590"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679177625"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177625"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
BaseUniverse fn =&gt;
Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#simplifyTerm"><span class="hs-identifier hs-var">simplifyTerm</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substituteTerm"><span class="hs-identifier hs-var">substituteTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679177761"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177661"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1591"></span><span>            </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">tell</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1592"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#unBind"><span class="hs-identifier hs-var">unBind</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177625"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177633"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177632"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1593"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177661"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177633"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars fn
-&gt; Subst fn -&gt; Pred fn -&gt; WriterT Any Identity (Pred fn)
</span><a href="#local-6989586621679177866"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {fn :: [*] -&gt; * -&gt; *} {a} {p}.
(HasSpec fn a, HasVariables fn p) =&gt;
FreeVars fn -&gt; Var a -&gt; p -&gt; FreeVars fn
</span><a href="#local-6989586621679177858"><span class="hs-identifier hs-var">underBinder</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars fn
</span><a href="#local-6989586621679177762"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177633"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177632"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177633"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; SubstEntry fn
</span><a href="Constrained.Base.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177661"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679177761"><span class="hs-identifier hs-var">sub</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177632"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1594"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#Exists"><span class="hs-identifier hs-type">Exists</span></a></span><span> </span><span id="local-6989586621679177622"><span class="annot"><span class="annottext">(forall b. Term fn b -&gt; b) -&gt; GE a
</span><a href="#local-6989586621679177622"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679177621"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679177621"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
((forall b. Term fn b -&gt; b) -&gt; GE a) -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Exists"><span class="hs-identifier hs-var">Exists</span></a></span><span> </span><span class="annot"><span class="annottext">(forall b. Term fn b -&gt; b) -&gt; GE a
</span><a href="#local-6989586621679177622"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
FreeVars fn -&gt; Subst fn -&gt; Binder fn a -&gt; Writer Any (Binder fn a)
</span><a href="#local-6989586621679177843"><span class="hs-identifier hs-var">goBinder</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars fn
</span><a href="#local-6989586621679177762"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679177761"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679177621"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1595"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span id="local-6989586621679177620"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679177620"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeVars fn
-&gt; Subst fn -&gt; Pred fn -&gt; WriterT Any Identity (Pred fn)
</span><a href="#local-6989586621679177866"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars fn
</span><a href="#local-6989586621679177762"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679177761"><span class="hs-identifier hs-var">sub</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679177620"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-1596"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#Assert"><span class="hs-identifier hs-type">Assert</span></a></span><span> </span><span id="local-6989586621679177614"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679177614"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679177613"><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679177613"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-1597"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Bool
</span><a href="Constrained.Base.html#isLit"><span class="hs-identifier hs-var">isLit</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679177613"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1598"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679177601"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679177601"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
BaseUniverse fn =&gt;
Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#simplifyTerm"><span class="hs-identifier hs-var">simplifyTerm</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substituteTerm"><span class="hs-identifier hs-var">substituteTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679177761"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679177613"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1599"></span><span>            </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">tell</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1600"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
[String] -&gt; p -&gt; Pred fn
</span><a href="Constrained.Base.html#assertExplain"><span class="hs-identifier hs-var">assertExplain</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679177614"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679177601"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1601"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177760"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1602"></span><span>      </span><span class="hs-comment">-- If the term turns into a literal, there is no more generation to do here</span><span>
</span><span id="line-1603"></span><span>      </span><span class="hs-comment">-- so we can ignore the `GenHint`</span><span>
</span><span id="line-1604"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#GenHint"><span class="hs-identifier hs-type">GenHint</span></a></span><span> </span><span class="annot"><span class="annottext">Hint a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679177593"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177593"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-1605"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Bool
</span><a href="Constrained.Base.html#isLit"><span class="hs-identifier hs-var">isLit</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177593"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1606"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
BaseUniverse fn =&gt;
Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#simplifyTerm"><span class="hs-identifier hs-var">simplifyTerm</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substituteTerm"><span class="hs-identifier hs-var">substituteTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679177761"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177593"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1607"></span><span>            </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">tell</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1608"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span>
</span><span id="line-1609"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177760"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1610"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#DependsOn"><span class="hs-identifier hs-type">DependsOn</span></a></span><span> </span><span id="local-6989586621679177579"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177579"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679177578"><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679177578"><span class="hs-identifier hs-var">t'</span></a></span></span><span>
</span><span id="line-1611"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Bool
</span><a href="Constrained.Base.html#isLit"><span class="hs-identifier hs-var">isLit</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177579"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1612"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
BaseUniverse fn =&gt;
Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#simplifyTerm"><span class="hs-identifier hs-var">simplifyTerm</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substituteTerm"><span class="hs-identifier hs-var">substituteTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679177761"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177579"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1613"></span><span>            </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">tell</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1614"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span>
</span><span id="line-1615"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Bool
</span><a href="Constrained.Base.html#isLit"><span class="hs-identifier hs-var">isLit</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679177578"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1616"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
BaseUniverse fn =&gt;
Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#simplifyTerm"><span class="hs-identifier hs-var">simplifyTerm</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Subst fn -&gt; Term fn a -&gt; Term fn a
</span><a href="Constrained.Base.html#substituteTerm"><span class="hs-identifier hs-var">substituteTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Subst fn
</span><a href="#local-6989586621679177761"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679177578"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1617"></span><span>            </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">tell</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1618"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span>
</span><span id="line-1619"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177760"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1620"></span><span>      </span><span class="annot"><span class="annottext">Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177760"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1621"></span><span>      </span><span class="annot"><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-type">FalsePred</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177760"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1622"></span><span>
</span><span id="line-1623"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-1624"></span><span class="hs-comment">-- Generics</span><span>
</span><span id="line-1625"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-1626"></span><span>
</span><span id="line-1627"></span><span class="hs-comment">{-
`HasSimpleRep` and `GenericsFn` are meant to allow you to express that a
type is isomorphic to some other type that has a `HasSpec` instance.

The trick is that the default instance of `HasSpec fn a` assumes
`HasSimpleRep a` and defines `TypeSpec fn a = TypeSpec fn (SimpleRep a)`.

From this it's possible to work with things of type `a` in constraints by
treating them like things of type `SimpleRep a`. This allows us to do case
matching etc. on `a` when `SimpleRep a` is a `Sum` type, for example.

Or alternatively it allows us to treat `a` as a newtype over `SimpleRep a`
when using `match`.

-}</span><span>
</span><span id="line-1642"></span><span>
</span><span id="line-1643"></span><span class="hs-keyword">class</span><span> </span><span id="HasSimpleRep"><span class="annot"><a href="Constrained.Base.html#HasSimpleRep"><span class="hs-identifier hs-var">HasSimpleRep</span></a></span></span><span> </span><span id="local-6989586621679183190"><span class="annot"><a href="#local-6989586621679183190"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1644"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="SimpleRep"><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-var">SimpleRep</span></a></span></span><span> </span><span id="local-6989586621679183190"><span class="annot"><a href="#local-6989586621679183190"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1645"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="TheSop"><span class="annot"><a href="Constrained.Base.html#TheSop"><span class="hs-identifier hs-var">TheSop</span></a></span></span><span> </span><span id="local-6989586621679183190"><span class="annot"><a href="#local-6989586621679183190"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1646"></span><span>  </span><span id="toSimpleRep"><span class="annot"><a href="Constrained.Base.html#toSimpleRep"><span class="hs-identifier hs-type">toSimpleRep</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679183190"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183190"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1647"></span><span>  </span><span id="fromSimpleRep"><span class="annot"><a href="Constrained.Base.html#fromSimpleRep"><span class="hs-identifier hs-type">fromSimpleRep</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183190"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679183190"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1648"></span><span>
</span><span id="line-1649"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="TheSop"><span class="annot"><a href="Constrained.Base.html#TheSop"><span class="hs-identifier hs-var">TheSop</span></a></span></span><span> </span><span id="local-6989586621679177566"><span class="annot"><a href="#local-6989586621679177566"><span class="hs-identifier hs-type hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#SOPOf"><span class="hs-identifier hs-type">SOPOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177566"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1650"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="SimpleRep"><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-var">SimpleRep</span></a></span></span><span> </span><span id="local-6989586621679177565"><span class="annot"><a href="#local-6989586621679177565"><span class="hs-identifier hs-type hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#SOP"><span class="hs-identifier hs-type">SOP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#TheSop"><span class="hs-identifier hs-type">TheSop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177565"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1651"></span><span>
</span><span id="line-1652"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="toSimpleRep"><span class="annot"><a href="Constrained.Base.html#toSimpleRep"><span class="hs-identifier hs-type">toSimpleRep</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1653"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Generic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183190"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1654"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#SimpleGeneric"><span class="hs-identifier hs-type">SimpleGeneric</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183190"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1655"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183190"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#SimplifyRep"><span class="hs-identifier hs-type">SimplifyRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183190"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1656"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1657"></span><span>    </span><span class="annot"><a href="#local-6989586621679183190"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1658"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183190"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1659"></span><span>  </span><span id="local-6989586621679177563"><span class="annot"><a href="Constrained.Base.html#toSimpleRep"><span class="hs-identifier hs-var hs-var">toSimpleRep</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (rep :: * -&gt; *) p.
SimpleGeneric rep =&gt;
rep p -&gt; SimplifyRep rep
</span><a href="Constrained.Base.html#toSimpleRep%27"><span class="hs-identifier hs-var">toSimpleRep'</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a x. Generic a =&gt; a -&gt; Rep a x
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">from</span></a></span></span><span>
</span><span id="line-1660"></span><span>
</span><span id="line-1661"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="fromSimpleRep"><span class="annot"><a href="Constrained.Base.html#fromSimpleRep"><span class="hs-identifier hs-type">fromSimpleRep</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1662"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Generic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183190"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1663"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#SimpleGeneric"><span class="hs-identifier hs-type">SimpleGeneric</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183190"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1664"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183190"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#SimplifyRep"><span class="hs-identifier hs-type">SimplifyRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183190"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1665"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1666"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183190"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1667"></span><span>    </span><span class="annot"><a href="#local-6989586621679183190"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1668"></span><span>  </span><span id="local-6989586621679177553"><span class="annot"><a href="Constrained.Base.html#fromSimpleRep"><span class="hs-identifier hs-var hs-var">fromSimpleRep</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a x. Generic a =&gt; Rep a x -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (rep :: * -&gt; *) p.
SimpleGeneric rep =&gt;
SimplifyRep rep -&gt; rep p
</span><a href="Constrained.Base.html#fromSimpleRep%27"><span class="hs-identifier hs-var">fromSimpleRep'</span></a></span></span><span>
</span><span id="line-1669"></span><span>
</span><span id="line-1670"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="SimplifyRep"><span class="annot"><a href="Constrained.Base.html#SimplifyRep"><span class="hs-identifier hs-var">SimplifyRep</span></a></span></span><span> </span><span id="local-6989586621679177543"><span class="annot"><a href="#local-6989586621679177543"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1671"></span><span>  </span><span id="SimplifyRep"><span class="annot"><a href="Constrained.Base.html#SimplifyRep"><span class="hs-identifier hs-var">SimplifyRep</span></a></span></span><span> </span><span id="local-6989586621679177542"><span class="annot"><a href="#local-6989586621679177542"><span class="hs-identifier hs-type hs-type">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#SOP"><span class="hs-identifier hs-type">SOP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SOPOf"><span class="hs-identifier hs-type">SOPOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177542"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1672"></span><span>
</span><span id="line-1673"></span><span class="annot"><a href="Constrained.Base.html#toGenericFn"><span class="hs-identifier hs-type">toGenericFn</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1674"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182441"><span class="annot"><a href="#local-6989586621679182441"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679182440"><span class="annot"><a href="#local-6989586621679182440"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-1675"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182441"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182440"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1676"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182441"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182440"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182441"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182440"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1677"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSimpleRep"><span class="hs-identifier hs-type">HasSimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182440"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1678"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1679"></span><span>  </span><span class="annot"><a href="#local-6989586621679182441"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182440"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182440"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1680"></span><span id="toGenericFn"><span class="annot"><span class="annottext">toGenericFn :: forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn (SimpleRep a),
 TypeSpec fn a ~ TypeSpec fn (SimpleRep a), HasSimpleRep a) =&gt;
fn '[a] (SimpleRep a)
</span><a href="Constrained.Base.html#toGenericFn"><span class="hs-identifier hs-var hs-var">toGenericFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn (SimpleRep a),
 TypeSpec fn a ~ TypeSpec fn (SimpleRep a), HasSimpleRep a) =&gt;
GenericsFn fn '[a] (SimpleRep a)
</span><a href="Constrained.Base.html#ToGeneric"><span class="hs-identifier hs-var">ToGeneric</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182441"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-1681"></span><span>
</span><span id="line-1682"></span><span class="annot"><a href="Constrained.Base.html#fromGenericFn"><span class="hs-identifier hs-type">fromGenericFn</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1683"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182432"><span class="annot"><a href="#local-6989586621679182432"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679182431"><span class="annot"><a href="#local-6989586621679182431"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-1684"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182432"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182431"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1685"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182432"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182431"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182432"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182431"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1686"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSimpleRep"><span class="hs-identifier hs-type">HasSimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182431"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1687"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1688"></span><span>  </span><span class="annot"><a href="#local-6989586621679182432"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182431"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679182431"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1689"></span><span id="fromGenericFn"><span class="annot"><span class="annottext">fromGenericFn :: forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn (SimpleRep a),
 TypeSpec fn a ~ TypeSpec fn (SimpleRep a), HasSimpleRep a) =&gt;
fn '[SimpleRep a] a
</span><a href="Constrained.Base.html#fromGenericFn"><span class="hs-identifier hs-var hs-var">fromGenericFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn (SimpleRep a),
 TypeSpec fn a ~ TypeSpec fn (SimpleRep a), HasSimpleRep a) =&gt;
GenericsFn fn '[SimpleRep a] a
</span><a href="Constrained.Base.html#FromGeneric"><span class="hs-identifier hs-var">FromGeneric</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182432"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-1690"></span><span>
</span><span id="line-1691"></span><span class="hs-keyword">data</span><span> </span><span id="GenericsFn"><span class="annot"><a href="Constrained.Base.html#GenericsFn"><span class="hs-identifier hs-var">GenericsFn</span></a></span></span><span> </span><span id="local-6989586621679177514"><span class="annot"><a href="#local-6989586621679177514"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679177513"><span class="annot"><a href="#local-6989586621679177513"><span class="hs-identifier hs-type">args</span></a></span></span><span> </span><span id="local-6989586621679177512"><span class="annot"><a href="#local-6989586621679177512"><span class="hs-identifier hs-type">res</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1692"></span><span>  </span><span id="local-6989586621679177511"><span id="local-6989586621679182433"><span id="ToGeneric"><span class="annot"><a href="Constrained.Base.html#ToGeneric"><span class="hs-identifier hs-var">ToGeneric</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1693"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182433"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177511"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1694"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182433"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177511"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182433"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177511"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1695"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSimpleRep"><span class="hs-identifier hs-type">HasSimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177511"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1696"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1697"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#GenericsFn"><span class="hs-identifier hs-type">GenericsFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182433"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679177511"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177511"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1698"></span><span>  </span><span id="local-6989586621679182427"><span id="local-6989586621679182428"><span id="FromGeneric"><span class="annot"><a href="Constrained.Base.html#FromGeneric"><span class="hs-identifier hs-var">FromGeneric</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1699"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182428"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182427"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1700"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182428"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182427"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182428"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182427"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1701"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSimpleRep"><span class="hs-identifier hs-type">HasSimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182427"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1702"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1703"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#GenericsFn"><span class="hs-identifier hs-type">GenericsFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182428"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182427"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679182427"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-1704"></span><span>
</span><span id="line-1705"></span><span id="local-6989586621679177505"><span id="local-6989586621679177507"><span id="local-6989586621679177509"><span id="local-6989586621679182424"><span id="local-6989586621679182425"><span id="local-6989586621679182426"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#GenericsFn"><span class="hs-identifier hs-type">GenericsFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182426"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182425"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182424"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-1706"></span><span id="local-6989586621679177501"><span id="local-6989586621679177503"><span id="local-6989586621679182421"><span id="local-6989586621679182422"><span id="local-6989586621679182423"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#GenericsFn"><span class="hs-identifier hs-type">GenericsFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182423"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182422"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182421"><span class="hs-identifier hs-type">res</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-1707"></span><span>
</span><span id="line-1708"></span><span class="annot"><a href="Constrained.Base.html#fromSimpleRepSpec"><span class="hs-identifier hs-type">fromSimpleRepSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1709"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183195"><span class="annot"><a href="#local-6989586621679183195"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679183196"><span class="annot"><a href="#local-6989586621679183196"><span class="hs-identifier hs-type">fn</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-1710"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183196"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183195"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSimpleRep"><span class="hs-identifier hs-type">HasSimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183195"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183196"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183195"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183196"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183195"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1711"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183196"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183195"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1712"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183196"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183195"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1713"></span><span id="fromSimpleRepSpec"><span class="annot"><span class="annottext">fromSimpleRepSpec :: forall a (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, HasSimpleRep a,
 TypeSpec fn a ~ TypeSpec fn (SimpleRep a)) =&gt;
Spec fn (SimpleRep a) -&gt; Spec fn a
</span><a href="Constrained.Base.html#fromSimpleRepSpec"><span class="hs-identifier hs-var hs-var">fromSimpleRepSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1714"></span><span>  </span><span class="annot"><span class="annottext">Spec fn (SimpleRep a)
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span>
</span><span id="line-1715"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span id="local-6989586621679177494"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679177494"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679177494"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1716"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span id="local-6989586621679177490"><span class="annot"><span class="annottext">TypeSpec fn (SimpleRep a)
</span><a href="#local-6989586621679177490"><span class="hs-identifier hs-var">s''</span></a></span></span><span> </span><span id="local-6989586621679177489"><span class="annot"><span class="annottext">OrdSet (SimpleRep a)
</span><a href="#local-6989586621679177489"><span class="hs-identifier hs-var">cant</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn (SimpleRep a)
</span><a href="#local-6989586621679177490"><span class="hs-identifier hs-var">s''</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. HasSimpleRep a =&gt; SimpleRep a -&gt; a
</span><a href="Constrained.Base.html#fromSimpleRep"><span class="hs-identifier hs-var">fromSimpleRep</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet (SimpleRep a)
</span><a href="#local-6989586621679177489"><span class="hs-identifier hs-var">cant</span></a></span><span>
</span><span id="line-1717"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span id="local-6989586621679177488"><span class="annot"><span class="annottext">OrdSet (SimpleRep a)
</span><a href="#local-6989586621679177488"><span class="hs-identifier hs-var">elems</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-var">MemberSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. HasSimpleRep a =&gt; SimpleRep a -&gt; a
</span><a href="Constrained.Base.html#fromSimpleRep"><span class="hs-identifier hs-var">fromSimpleRep</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet (SimpleRep a)
</span><a href="#local-6989586621679177488"><span class="hs-identifier hs-var">elems</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1718"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-type">SuspendedSpec</span></a></span><span> </span><span id="local-6989586621679177476"><span class="annot"><span class="annottext">Var (SimpleRep a)
</span><a href="#local-6989586621679177476"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679177475"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177475"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1719"></span><span>    </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) p.
(IsPred p fn, HasSpec fn a) =&gt;
(Term fn a -&gt; p) -&gt; Spec fn a
</span><a href="Constrained.Base.html#constrained"><span class="hs-identifier hs-var">constrained</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679177474"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177474"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1720"></span><span>      </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, HasSpec fn (SimpleRep a), HasSimpleRep a,
 TypeSpec fn a ~ TypeSpec fn (SimpleRep a)) =&gt;
Term fn a -&gt; Term fn (SimpleRep a)
</span><a href="Constrained.Base.html#toGeneric_"><span class="hs-identifier hs-var">toGeneric_</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679177474"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var (SimpleRep a)
</span><a href="#local-6989586621679177476"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177475"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1721"></span><span>
</span><span id="line-1722"></span><span class="annot"><a href="Constrained.Base.html#toSimpleRepSpec"><span class="hs-identifier hs-type">toSimpleRepSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1723"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182417"><span class="annot"><a href="#local-6989586621679182417"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679182418"><span class="annot"><a href="#local-6989586621679182418"><span class="hs-identifier hs-type">fn</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-1724"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182418"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182417"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182418"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182417"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSimpleRep"><span class="hs-identifier hs-type">HasSimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182417"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182418"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182417"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182418"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182417"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1725"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182418"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182417"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1726"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182418"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182417"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1727"></span><span id="toSimpleRepSpec"><span class="annot"><span class="annottext">toSimpleRepSpec :: forall a (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, HasSpec fn (SimpleRep a), HasSimpleRep a,
 TypeSpec fn a ~ TypeSpec fn (SimpleRep a)) =&gt;
Spec fn a -&gt; Spec fn (SimpleRep a)
</span><a href="Constrained.Base.html#toSimpleRepSpec"><span class="hs-identifier hs-var hs-var">toSimpleRepSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1728"></span><span>  </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span>
</span><span id="line-1729"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span id="local-6989586621679177465"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679177465"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679177465"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1730"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span id="local-6989586621679177461"><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679177461"><span class="hs-identifier hs-var">s''</span></a></span></span><span> </span><span id="local-6989586621679177460"><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679177460"><span class="hs-identifier hs-var">cant</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679177461"><span class="hs-identifier hs-var">s''</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. HasSimpleRep a =&gt; a -&gt; SimpleRep a
</span><a href="Constrained.Base.html#toSimpleRep"><span class="hs-identifier hs-var">toSimpleRep</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679177460"><span class="hs-identifier hs-var">cant</span></a></span><span>
</span><span id="line-1731"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span id="local-6989586621679177459"><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679177459"><span class="hs-identifier hs-var">elems</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-var">MemberSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. HasSimpleRep a =&gt; a -&gt; SimpleRep a
</span><a href="Constrained.Base.html#toSimpleRep"><span class="hs-identifier hs-var">toSimpleRep</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679177459"><span class="hs-identifier hs-var">elems</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1732"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-type">SuspendedSpec</span></a></span><span> </span><span id="local-6989586621679177447"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177447"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679177446"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177446"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1733"></span><span>    </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) p.
(IsPred p fn, HasSpec fn a) =&gt;
(Term fn a -&gt; p) -&gt; Spec fn a
</span><a href="Constrained.Base.html#constrained"><span class="hs-identifier hs-var">constrained</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679177445"><span class="annot"><span class="annottext">Term fn (SimpleRep a)
</span><a href="#local-6989586621679177445"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1734"></span><span>      </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, HasSpec fn (SimpleRep a), HasSimpleRep a,
 TypeSpec fn a ~ TypeSpec fn (SimpleRep a)) =&gt;
Term fn (SimpleRep a) -&gt; Term fn a
</span><a href="Constrained.Base.html#fromGeneric_"><span class="hs-identifier hs-var">fromGeneric_</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (SimpleRep a)
</span><a href="#local-6989586621679177445"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679177447"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679177446"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1735"></span><span>
</span><span id="line-1736"></span><span class="hs-comment">{- This part of the code base is responsible for implementing the conversion
   from a `Generic` type to a `Sum` over `Prod` representation that automatically
   gives you an instance of `HasSpec`. The user has three options for building their
   own instances of `HasSpec`, either they hand-roll an instance, they go with the
   entirely `Generic` instance, or they provide their own `SimpleRep` for their type.

   The latter may be appropriate when the type is an optimized representation:

   ```
   newtype Foo = Foo { unFoo :: MemoBytes ActualFoo }

   instance HasSimpleRep Foo where
     type SimpleRep Foo = ActualFoo
     toSimpleRep = unMemoBytes . unFoo
     fromSimpleRep = Foo . memoBytes
   ```

   This would then allow for `Foo` to be treated as a simple `newtype` over `ActualFoo`
   in constraints:

   ```
   fooSpec :: Spec fn Foo
   fooSpec = constrained $ \ foo -&gt;
     match foo $ \ actualFoo -&gt; ...
   ```
-}</span><span>
</span><span id="line-1762"></span><span>
</span><span id="line-1763"></span><span class="hs-comment">-- Building a SOP type (Sum Of Prod) --------------------------------------</span><span>
</span><span id="line-1764"></span><span>
</span><span id="line-1765"></span><span class="hs-comment">-- | A constructor name with the types of its arguments</span><span>
</span><span id="line-1766"></span><span class="hs-keyword">data</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679177443"><span class="annot"><a href="#local-6989586621679177443"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span id="%3A%3A%3A"><span class="annot"><a href="Constrained.Base.html#%3A%3A%3A"><span class="hs-operator hs-var">:::</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679177442"><span class="annot"><a href="#local-6989586621679177442"><span class="hs-identifier hs-type">ts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1767"></span><span>
</span><span id="line-1768"></span><span class="hs-comment">-- | Turn a `Rep` into a list that flattens the sum</span><span>
</span><span id="line-1769"></span><span class="hs-comment">-- structre and gives the constructors names:</span><span>
</span><span id="line-1770"></span><span class="hs-comment">--   Maybe Int -&gt; '[&quot;Nothing&quot; ::: '[()], &quot;Just&quot; ::: '[Int]]</span><span>
</span><span id="line-1771"></span><span class="hs-comment">--   Either Int Bool -&gt; '[&quot;Left&quot; ::: '[Int], &quot;Right&quot; ::: '[Bool]]</span><span>
</span><span id="line-1772"></span><span class="hs-comment">--   data Foo = Foo Int Bool | Bar Double -&gt; '[&quot;Foo&quot; ::: '[Int, Bool], &quot;Bar&quot; ::: '[Double]]</span><span>
</span><span id="line-1773"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="SOPOf"><span class="annot"><a href="Constrained.Base.html#SOPOf"><span class="hs-identifier hs-var">SOPOf</span></a></span></span><span> </span><span id="local-6989586621679177441"><span class="annot"><a href="#local-6989586621679177441"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1774"></span><span>  </span><span id="SOPOf"><span class="annot"><a href="Constrained.Base.html#SOPOf"><span class="hs-identifier hs-var">SOPOf</span></a></span></span><span> </span><span id="local-6989586621679177440"><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">D1</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="#local-6989586621679177440"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#SOPOf"><span class="hs-identifier hs-type">SOPOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177440"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-1775"></span><span>  </span><span id="SOPOf"><span class="annot"><a href="Constrained.Base.html#SOPOf"><span class="hs-identifier hs-var">SOPOf</span></a></span></span><span> </span><span id="local-6989586621679177438"><span id="local-6989586621679177439"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679177439"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-type">:+:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177438"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.List.html#Append"><span class="hs-identifier hs-type">Append</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SOPOf"><span class="hs-identifier hs-type">SOPOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177439"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SOPOf"><span class="hs-identifier hs-type">SOPOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177438"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1776"></span><span>  </span><span id="SOPOf"><span class="annot"><a href="Constrained.Base.html#SOPOf"><span class="hs-identifier hs-var">SOPOf</span></a></span></span><span> </span><span id="local-6989586621679177436"><span id="local-6989586621679177437"><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">C1</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MetaCons</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177437"><span class="hs-identifier hs-type">constr</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679177436"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679177437"><span class="hs-identifier hs-type">constr</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A%3A%3A"><span class="hs-operator hs-type">:::</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#Constr"><span class="hs-identifier hs-type">Constr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177436"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1777"></span><span>
</span><span id="line-1778"></span><span class="hs-comment">-- | Flatten a single constructor</span><span>
</span><span id="line-1779"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="Constr"><span class="annot"><a href="Constrained.Base.html#Constr"><span class="hs-identifier hs-var">Constr</span></a></span></span><span> </span><span id="local-6989586621679177435"><span class="annot"><a href="#local-6989586621679177435"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1780"></span><span>  </span><span class="hs-comment">-- TODO: Here we should put in the selector names</span><span>
</span><span id="line-1781"></span><span>  </span><span class="hs-comment">-- so that they can be re-used to create selectors more</span><span>
</span><span id="line-1782"></span><span>  </span><span class="hs-comment">-- easily than the current disgusting `Fst . Snd . Snd . Snd ...`</span><span>
</span><span id="line-1783"></span><span>  </span><span class="hs-comment">-- method.</span><span>
</span><span id="line-1784"></span><span>  </span><span id="Constr"><span class="annot"><a href="Constrained.Base.html#Constr"><span class="hs-identifier hs-var">Constr</span></a></span></span><span> </span><span id="local-6989586621679177434"><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">S1</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="#local-6989586621679177434"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#Constr"><span class="hs-identifier hs-type">Constr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177434"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-1785"></span><span>  </span><span id="Constr"><span class="annot"><a href="Constrained.Base.html#Constr"><span class="hs-identifier hs-var">Constr</span></a></span></span><span> </span><span id="local-6989586621679177433"><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">K1</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="#local-6989586621679177433"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679177433"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1786"></span><span>  </span><span id="Constr"><span class="annot"><a href="Constrained.Base.html#Constr"><span class="hs-identifier hs-var">Constr</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">U1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1787"></span><span>  </span><span id="Constr"><span class="annot"><a href="Constrained.Base.html#Constr"><span class="hs-identifier hs-var">Constr</span></a></span></span><span> </span><span id="local-6989586621679177431"><span id="local-6989586621679177432"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679177432"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-type">:*:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177431"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.List.html#Append"><span class="hs-identifier hs-type">Append</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Constr"><span class="hs-identifier hs-type">Constr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177432"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Constr"><span class="hs-identifier hs-type">Constr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177431"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1788"></span><span>
</span><span id="line-1789"></span><span class="hs-comment">-- | Turn a list from `SOPOf` into a `Sum` over</span><span>
</span><span id="line-1790"></span><span class="hs-comment">-- `Prod` representation.</span><span>
</span><span id="line-1791"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="SOP"><span class="annot"><a href="Constrained.Base.html#SOP"><span class="hs-identifier hs-var">SOP</span></a></span></span><span> </span><span id="local-6989586621679177430"><span class="annot"><a href="#local-6989586621679177430"><span class="hs-identifier hs-type">constrs</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1792"></span><span>  </span><span id="SOP"><span class="annot"><a href="Constrained.Base.html#SOP"><span class="hs-identifier hs-var">SOP</span></a></span></span><span> </span><span id="local-6989586621679177428"><span id="local-6989586621679177429"><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679177429"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A%3A%3A"><span class="hs-operator hs-type">:::</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177428"><span class="hs-identifier hs-type">prod</span></a></span><span class="hs-special">]</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Univ.html#ProdOver"><span class="hs-identifier hs-type">ProdOver</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177428"><span class="hs-identifier hs-type">prod</span></a></span><span>
</span><span id="line-1793"></span><span>  </span><span id="SOP"><span class="annot"><a href="Constrained.Base.html#SOP"><span class="hs-identifier hs-var">SOP</span></a></span></span><span> </span><span id="local-6989586621679177425"><span id="local-6989586621679177426"><span id="local-6989586621679177427"><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679177427"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A%3A%3A"><span class="hs-operator hs-type">:::</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177426"><span class="hs-identifier hs-type">prod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177425"><span class="hs-identifier hs-type">constrs</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Univ.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#ProdOver"><span class="hs-identifier hs-type">ProdOver</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177426"><span class="hs-identifier hs-type">prod</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SOP"><span class="hs-identifier hs-type">SOP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177425"><span class="hs-identifier hs-type">constrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1794"></span><span>
</span><span id="line-1795"></span><span class="hs-comment">-- Constructing a SOP -----------------------------------------------------</span><span>
</span><span id="line-1796"></span><span>
</span><span id="line-1797"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="ConstrOf"><span class="annot"><a href="Constrained.Base.html#ConstrOf"><span class="hs-identifier hs-var">ConstrOf</span></a></span></span><span> </span><span id="local-6989586621679177424"><span class="annot"><a href="#local-6989586621679177424"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span id="local-6989586621679177423"><span class="annot"><a href="#local-6989586621679177423"><span class="hs-identifier hs-type">sop</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1798"></span><span>  </span><span id="ConstrOf"><span class="annot"><a href="Constrained.Base.html#ConstrOf"><span class="hs-identifier hs-var">ConstrOf</span></a></span></span><span> </span><span id="local-6989586621679177420"><span id="local-6989586621679177421"><span id="local-6989586621679177422"><span class="annot"><a href="#local-6989586621679177422"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679177422"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A%3A%3A"><span class="hs-operator hs-type">:::</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177421"><span class="hs-identifier hs-type">constr</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177420"><span class="hs-identifier hs-type">sop</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679177421"><span class="hs-identifier hs-type">constr</span></a></span><span>
</span><span id="line-1799"></span><span>  </span><span id="ConstrOf"><span class="annot"><a href="Constrained.Base.html#ConstrOf"><span class="hs-identifier hs-var">ConstrOf</span></a></span></span><span> </span><span id="local-6989586621679177418"><span id="local-6989586621679177419"><span class="annot"><a href="#local-6989586621679177419"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177418"><span class="hs-identifier hs-type">sop</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#ConstrOf"><span class="hs-identifier hs-type">ConstrOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177419"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177418"><span class="hs-identifier hs-type">sop</span></a></span><span>
</span><span id="line-1800"></span><span>
</span><span id="line-1801"></span><span class="hs-keyword">class</span><span> </span><span id="Inject"><span class="annot"><a href="Constrained.Base.html#Inject"><span class="hs-identifier hs-var">Inject</span></a></span></span><span> </span><span id="local-6989586621679182405"><span class="annot"><a href="#local-6989586621679182405"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span id="local-6989586621679182407"><span class="annot"><a href="#local-6989586621679182407"><span class="hs-identifier hs-type">constrs</span></a></span></span><span> </span><span id="local-6989586621679182406"><span class="annot"><a href="#local-6989586621679182406"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1802"></span><span>  </span><span id="inject%27"><span class="annot"><a href="Constrained.Base.html#inject%27"><span class="hs-identifier hs-type">inject'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SOP"><span class="hs-identifier hs-type">SOP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182407"><span class="hs-identifier hs-type">constrs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679182406"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.List.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ConstrOf"><span class="hs-identifier hs-type">ConstrOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182405"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182407"><span class="hs-identifier hs-type">constrs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679182406"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-1803"></span><span>
</span><span id="line-1804"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182401"><span id="local-6989586621679182402"><span id="local-6989586621679182403"><span class="annot"><a href="Constrained.List.html#TypeList"><span class="hs-identifier hs-type">TypeList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182403"><span class="hs-identifier hs-type">prod</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Inject"><span class="hs-identifier hs-type">Inject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182402"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182402"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A%3A%3A"><span class="hs-operator hs-type">:::</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182403"><span class="hs-identifier hs-type">prod</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679182401"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1805"></span><span>  </span><span id="local-6989586621679177411"><span class="annot"><span class="annottext">inject' :: (SOP '[c ::: prod] -&gt; r) -&gt; FunTy (ConstrOf c '[c ::: prod]) r
</span><a href="#local-6989586621679177411"><span class="hs-identifier hs-var hs-var hs-var hs-var">inject'</span></a></span></span><span> </span><span id="local-6989586621679177410"><span class="annot"><span class="annottext">SOP '[c ::: prod] -&gt; r
</span><a href="#local-6989586621679177410"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (ts :: [*]) (f :: * -&gt; *) r.
TypeList ts =&gt;
(forall a. a -&gt; f a) -&gt; (List f ts -&gt; r) -&gt; FunTy ts r
</span><a href="Constrained.List.html#curryList_"><span class="hs-identifier hs-var">curryList_</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182403"><span class="hs-identifier hs-type">prod</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Identity a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Identity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (as :: [*]) r. (ProdOver as -&gt; r) -&gt; List Identity as -&gt; r
</span><a href="Constrained.Univ.html#listToProd"><span class="hs-identifier hs-var">listToProd</span></a></span><span> </span><span class="annot"><span class="annottext">SOP '[c ::: prod] -&gt; r
</span><a href="#local-6989586621679177410"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1806"></span><span>
</span><span id="line-1807"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182385"><span id="local-6989586621679182386"><span id="local-6989586621679182387"><span id="local-6989586621679182388"><span id="local-6989586621679182389"><span class="annot"><a href="Constrained.List.html#TypeList"><span class="hs-identifier hs-type">TypeList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182389"><span class="hs-identifier hs-type">prod</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Inject"><span class="hs-identifier hs-type">Inject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182388"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182388"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A%3A%3A"><span class="hs-operator hs-type">:::</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182389"><span class="hs-identifier hs-type">prod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182387"><span class="hs-identifier hs-type">prod'</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182386"><span class="hs-identifier hs-type">constrs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679182385"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1808"></span><span>  </span><span id="local-6989586621679177403"><span class="annot"><span class="annottext">inject' :: (SOP ((c ::: prod) : prod' : constrs) -&gt; r)
-&gt; FunTy (ConstrOf c ((c ::: prod) : prod' : constrs)) r
</span><a href="#local-6989586621679177403"><span class="hs-identifier hs-var hs-var hs-var hs-var">inject'</span></a></span></span><span> </span><span id="local-6989586621679177402"><span class="annot"><span class="annottext">SOP ((c ::: prod) : prod' : constrs) -&gt; r
</span><a href="#local-6989586621679177402"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (ts :: [*]) (f :: * -&gt; *) r.
TypeList ts =&gt;
(forall a. a -&gt; f a) -&gt; (List f ts -&gt; r) -&gt; FunTy ts r
</span><a href="Constrained.List.html#curryList_"><span class="hs-identifier hs-var">curryList_</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182389"><span class="hs-identifier hs-type">prod</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Identity a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Identity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (as :: [*]) r. (ProdOver as -&gt; r) -&gt; List Identity as -&gt; r
</span><a href="Constrained.Univ.html#listToProd"><span class="hs-identifier hs-var">listToProd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SOP ((c ::: prod) : prod' : constrs) -&gt; r
</span><a href="#local-6989586621679177402"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Sum a b
</span><a href="Constrained.Univ.html#SumLeft"><span class="hs-identifier hs-var">SumLeft</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SOP"><span class="hs-identifier hs-type">SOP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182387"><span class="hs-identifier hs-type">prod'</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182386"><span class="hs-identifier hs-type">constrs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1809"></span><span>
</span><span id="line-1810"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-1811"></span><span>  </span><span class="hs-pragma">{-# OVERLAPPABLE</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1812"></span><span>  </span><span id="local-6989586621679182371"><span id="local-6989586621679182372"><span id="local-6989586621679182373"><span id="local-6989586621679182374"><span id="local-6989586621679182375"><span id="local-6989586621679182376"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.List.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ConstrOf"><span class="hs-identifier hs-type">ConstrOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182376"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182375"><span class="hs-identifier hs-type">c'</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A%3A%3A"><span class="hs-operator hs-type">:::</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182374"><span class="hs-identifier hs-type">prod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182373"><span class="hs-identifier hs-type">con</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182372"><span class="hs-identifier hs-type">constrs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679182371"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.List.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ConstrOf"><span class="hs-identifier hs-type">ConstrOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182376"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182373"><span class="hs-identifier hs-type">con</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182372"><span class="hs-identifier hs-type">constrs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679182371"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-1813"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- \^ An unfortunately roundabout way of saying `c !~ c'`</span><span>
</span><span id="line-1814"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Inject"><span class="hs-identifier hs-type">Inject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182376"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182373"><span class="hs-identifier hs-type">con</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182372"><span class="hs-identifier hs-type">constrs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679182371"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-1815"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1816"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Inject"><span class="hs-identifier hs-type">Inject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182376"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182375"><span class="hs-identifier hs-type">c'</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A%3A%3A"><span class="hs-operator hs-type">:::</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182374"><span class="hs-identifier hs-type">prod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182373"><span class="hs-identifier hs-type">con</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182372"><span class="hs-identifier hs-type">constrs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679182371"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-1817"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1818"></span><span>  </span><span id="local-6989586621679177395"><span class="annot"><span class="annottext">inject' :: (SOP ((c' ::: prod) : con : constrs) -&gt; r)
-&gt; FunTy (ConstrOf c ((c' ::: prod) : con : constrs)) r
</span><a href="#local-6989586621679177395"><span class="hs-identifier hs-var hs-var hs-var hs-var">inject'</span></a></span></span><span> </span><span id="local-6989586621679177394"><span class="annot"><span class="annottext">SOP ((c' ::: prod) : con : constrs) -&gt; r
</span><a href="#local-6989586621679177394"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (c :: Symbol) (constrs :: [*]) r.
Inject c constrs r =&gt;
(SOP constrs -&gt; r) -&gt; FunTy (ConstrOf c constrs) r
</span><a href="Constrained.Base.html#inject%27"><span class="hs-identifier hs-var">inject'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182376"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182373"><span class="hs-identifier hs-type">con</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182372"><span class="hs-identifier hs-type">constrs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SOP ((c' ::: prod) : con : constrs) -&gt; r
</span><a href="#local-6989586621679177394"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Sum a b
</span><a href="Constrained.Univ.html#SumRight"><span class="hs-identifier hs-var">SumRight</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1819"></span><span>
</span><span id="line-1820"></span><span class="annot"><a href="Constrained.Base.html#inject"><span class="hs-identifier hs-type">inject</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182370"><span class="annot"><a href="#local-6989586621679182370"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span id="local-6989586621679182369"><span class="annot"><a href="#local-6989586621679182369"><span class="hs-identifier hs-type">constrs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.Base.html#Inject"><span class="hs-identifier hs-type">Inject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182370"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182369"><span class="hs-identifier hs-type">constrs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SOP"><span class="hs-identifier hs-type">SOP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182369"><span class="hs-identifier hs-type">constrs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.List.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ConstrOf"><span class="hs-identifier hs-type">ConstrOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182370"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182369"><span class="hs-identifier hs-type">constrs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SOP"><span class="hs-identifier hs-type">SOP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182369"><span class="hs-identifier hs-type">constrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1821"></span><span id="inject"><span class="annot"><span class="annottext">inject :: forall (c :: Symbol) (constrs :: [*]).
Inject c constrs (SOP constrs) =&gt;
FunTy (ConstrOf c constrs) (SOP constrs)
</span><a href="Constrained.Base.html#inject"><span class="hs-identifier hs-var hs-var">inject</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (c :: Symbol) (constrs :: [*]) r.
Inject c constrs r =&gt;
(SOP constrs -&gt; r) -&gt; FunTy (ConstrOf c constrs) r
</span><a href="Constrained.Base.html#inject%27"><span class="hs-identifier hs-var">inject'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182370"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182369"><span class="hs-identifier hs-type">constrs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1822"></span><span>
</span><span id="line-1823"></span><span class="hs-comment">-- Deconstructing a SOP ---------------------------------------------------</span><span>
</span><span id="line-1824"></span><span>
</span><span id="line-1825"></span><span class="hs-comment">-- | An `ALG constrs r` is a function that takes a way to turn every</span><span>
</span><span id="line-1826"></span><span class="hs-comment">-- constructor into an `r`:</span><span>
</span><span id="line-1827"></span><span class="hs-comment">-- ```</span><span>
</span><span id="line-1828"></span><span class="hs-comment">-- ALG (SOPOf (Rep (Either Int Bool))) r = (Int -&gt; r) -&gt; (Bool -&gt; r) -&gt; r</span><span>
</span><span id="line-1829"></span><span class="hs-comment">-- ```</span><span>
</span><span id="line-1830"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="ALG"><span class="annot"><a href="Constrained.Base.html#ALG"><span class="hs-identifier hs-var">ALG</span></a></span></span><span> </span><span id="local-6989586621679177390"><span class="annot"><a href="#local-6989586621679177390"><span class="hs-identifier hs-type">constrs</span></a></span></span><span> </span><span id="local-6989586621679177389"><span class="annot"><a href="#local-6989586621679177389"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1831"></span><span>  </span><span id="ALG"><span class="annot"><a href="Constrained.Base.html#ALG"><span class="hs-identifier hs-var">ALG</span></a></span></span><span> </span><span id="local-6989586621679177386"><span id="local-6989586621679177387"><span id="local-6989586621679177388"><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679177388"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A%3A%3A"><span class="hs-operator hs-type">:::</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177387"><span class="hs-identifier hs-type">prod</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679177386"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.List.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177387"><span class="hs-identifier hs-type">prod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177386"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679177386"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-1832"></span><span>  </span><span id="ALG"><span class="annot"><a href="Constrained.Base.html#ALG"><span class="hs-identifier hs-var">ALG</span></a></span></span><span> </span><span id="local-6989586621679177382"><span id="local-6989586621679177383"><span id="local-6989586621679177384"><span id="local-6989586621679177385"><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679177385"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A%3A%3A"><span class="hs-operator hs-type">:::</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177384"><span class="hs-identifier hs-type">prod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177383"><span class="hs-identifier hs-type">constrs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679177382"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.List.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177384"><span class="hs-identifier hs-type">prod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177382"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#ALG"><span class="hs-identifier hs-type">ALG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177383"><span class="hs-identifier hs-type">constrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177382"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-1833"></span><span>
</span><span id="line-1834"></span><span class="hs-keyword">class</span><span> </span><span id="SOPLike"><span class="annot"><a href="Constrained.Base.html#SOPLike"><span class="hs-identifier hs-var">SOPLike</span></a></span></span><span> </span><span id="local-6989586621679182366"><span class="annot"><a href="#local-6989586621679182366"><span class="hs-identifier hs-type">constrs</span></a></span></span><span> </span><span id="local-6989586621679182365"><span class="annot"><a href="#local-6989586621679182365"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1835"></span><span>  </span><span class="hs-comment">-- | Run a `SOP`</span><span>
</span><span id="line-1836"></span><span>  </span><span id="algebra"><span class="annot"><a href="Constrained.Base.html#algebra"><span class="hs-identifier hs-type">algebra</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#SOP"><span class="hs-identifier hs-type">SOP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182366"><span class="hs-identifier hs-type">constrs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#ALG"><span class="hs-identifier hs-type">ALG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182366"><span class="hs-identifier hs-type">constrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182365"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-1837"></span><span>
</span><span id="line-1838"></span><span>  </span><span class="hs-comment">-- | Ignore everything in the `SOP`</span><span>
</span><span id="line-1839"></span><span>  </span><span id="consts"><span class="annot"><a href="Constrained.Base.html#consts"><span class="hs-identifier hs-type">consts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679182365"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#ALG"><span class="hs-identifier hs-type">ALG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182366"><span class="hs-identifier hs-type">constrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182365"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-1840"></span><span>
</span><span id="line-1841"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182357"><span id="local-6989586621679182358"><span id="local-6989586621679182359"><span class="annot"><a href="Constrained.List.html#TypeList"><span class="hs-identifier hs-type">TypeList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182359"><span class="hs-identifier hs-type">prod</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#SOPLike"><span class="hs-identifier hs-type">SOPLike</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182358"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A%3A%3A"><span class="hs-operator hs-type">:::</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182359"><span class="hs-identifier hs-type">prod</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679182357"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1842"></span><span>  </span><span id="local-6989586621679177372"><span class="annot"><span class="annottext">algebra :: SOP '[c ::: prod] -&gt; ALG '[c ::: prod] r
</span><a href="#local-6989586621679177372"><span class="hs-identifier hs-var hs-var hs-var hs-var">algebra</span></a></span></span><span> </span><span id="local-6989586621679177371"><span class="annot"><span class="annottext">SOP '[c ::: prod]
</span><a href="#local-6989586621679177371"><span class="hs-identifier hs-var">prod</span></a></span></span><span> </span><span id="local-6989586621679177370"><span class="annot"><span class="annottext">FunTy prod r
</span><a href="#local-6989586621679177370"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (ts :: [*]) (f :: * -&gt; *) r.
TypeList ts =&gt;
(forall a. f a -&gt; a) -&gt; FunTy ts r -&gt; List f ts -&gt; r
</span><a href="Constrained.List.html#uncurryList_"><span class="hs-identifier hs-var">uncurryList_</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182359"><span class="hs-identifier hs-type">prod</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Identity a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">runIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">FunTy prod r
</span><a href="#local-6989586621679177370"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (as :: [*]). TypeList as =&gt; ProdOver as -&gt; List Identity as
</span><a href="Constrained.Univ.html#prodToList"><span class="hs-identifier hs-var">prodToList</span></a></span><span> </span><span class="annot"><span class="annottext">SOP '[c ::: prod]
</span><a href="#local-6989586621679177371"><span class="hs-identifier hs-var">prod</span></a></span><span>
</span><span id="line-1843"></span><span>  </span><span id="local-6989586621679177368"><span class="annot"><span class="annottext">consts :: r -&gt; ALG '[c ::: prod] r
</span><a href="#local-6989586621679177368"><span class="hs-identifier hs-var hs-var hs-var hs-var">consts</span></a></span></span><span> </span><span id="local-6989586621679177367"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679177367"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">FunTy prod r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679177367"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1844"></span><span>
</span><span id="line-1845"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182346"><span id="local-6989586621679182347"><span id="local-6989586621679182348"><span id="local-6989586621679182349"><span id="local-6989586621679182350"><span class="hs-special">(</span><span class="annot"><a href="Constrained.List.html#TypeList"><span class="hs-identifier hs-type">TypeList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182350"><span class="hs-identifier hs-type">prod</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#SOPLike"><span class="hs-identifier hs-type">SOPLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182349"><span class="hs-identifier hs-type">con</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182348"><span class="hs-identifier hs-type">cases</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679182347"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#SOPLike"><span class="hs-identifier hs-type">SOPLike</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182346"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A%3A%3A"><span class="hs-operator hs-type">:::</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182350"><span class="hs-identifier hs-type">prod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182349"><span class="hs-identifier hs-type">con</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182348"><span class="hs-identifier hs-type">cases</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679182347"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1846"></span><span>  </span><span id="local-6989586621679177358"><span class="annot"><span class="annottext">algebra :: SOP ((c ::: prod) : con : cases)
-&gt; ALG ((c ::: prod) : con : cases) r
</span><a href="#local-6989586621679177358"><span class="hs-identifier hs-var hs-var hs-var hs-var">algebra</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#SumLeft"><span class="hs-identifier hs-type">SumLeft</span></a></span><span> </span><span id="local-6989586621679177357"><span class="annot"><span class="annottext">ProdOver prod
</span><a href="#local-6989586621679177357"><span class="hs-identifier hs-var">prod</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679177356"><span class="annot"><span class="annottext">FunTy prod r
</span><a href="#local-6989586621679177356"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (constrs :: [*]) r. SOPLike constrs r =&gt; r -&gt; ALG constrs r
</span><a href="Constrained.Base.html#consts"><span class="hs-identifier hs-var">consts</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182349"><span class="hs-identifier hs-type">con</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182348"><span class="hs-identifier hs-type">cases</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182347"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (constrs :: [*]) r.
SOPLike constrs r =&gt;
SOP constrs -&gt; ALG constrs r
</span><a href="Constrained.Base.html#algebra"><span class="hs-identifier hs-var">algebra</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182346"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A%3A%3A"><span class="hs-operator hs-type">:::</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182350"><span class="hs-identifier hs-type">prod</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">ProdOver prod
</span><a href="#local-6989586621679177357"><span class="hs-identifier hs-var">prod</span></a></span><span> </span><span class="annot"><span class="annottext">FunTy prod r
</span><a href="#local-6989586621679177356"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1847"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#algebra"><span class="hs-identifier hs-var">algebra</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#SumRight"><span class="hs-identifier hs-type">SumRight</span></a></span><span> </span><span id="local-6989586621679177355"><span class="annot"><span class="annottext">SOP (con : cases)
</span><a href="#local-6989586621679177355"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FunTy prod r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (constrs :: [*]) r.
SOPLike constrs r =&gt;
SOP constrs -&gt; ALG constrs r
</span><a href="Constrained.Base.html#algebra"><span class="hs-identifier hs-var">algebra</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182349"><span class="hs-identifier hs-type">con</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182348"><span class="hs-identifier hs-type">cases</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182347"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="annottext">SOP (con : cases)
</span><a href="#local-6989586621679177355"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-1848"></span><span>
</span><span id="line-1849"></span><span>  </span><span id="local-6989586621679177353"><span class="annot"><span class="annottext">consts :: r -&gt; ALG ((c ::: prod) : con : cases) r
</span><a href="#local-6989586621679177353"><span class="hs-identifier hs-var hs-var hs-var hs-var">consts</span></a></span></span><span> </span><span id="local-6989586621679177352"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679177352"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">FunTy prod r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (constrs :: [*]) r. SOPLike constrs r =&gt; r -&gt; ALG constrs r
</span><a href="Constrained.Base.html#consts"><span class="hs-identifier hs-var">consts</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182349"><span class="hs-identifier hs-type">con</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182348"><span class="hs-identifier hs-type">cases</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679177352"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1850"></span><span>
</span><span id="line-1851"></span><span class="hs-comment">-- The individual constructor level ---------------------------------------</span><span>
</span><span id="line-1852"></span><span>
</span><span id="line-1853"></span><span class="hs-keyword">class</span><span> </span><span id="SimpleConstructor"><span class="annot"><a href="Constrained.Base.html#SimpleConstructor"><span class="hs-identifier hs-var">SimpleConstructor</span></a></span></span><span> </span><span id="local-6989586621679182345"><span class="annot"><a href="#local-6989586621679182345"><span class="hs-identifier hs-type">rep</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1854"></span><span>  </span><span id="toSimpleCon%27"><span class="annot"><a href="Constrained.Base.html#toSimpleCon%27"><span class="hs-identifier hs-type">toSimpleCon'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679182344"><span class="annot"><a href="#local-6989586621679182345"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182344"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Univ.html#ProdOver"><span class="hs-identifier hs-type">ProdOver</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Constr"><span class="hs-identifier hs-type">Constr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182345"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1855"></span><span>  </span><span id="fromSimpleCon%27"><span class="annot"><a href="Constrained.Base.html#fromSimpleCon%27"><span class="hs-identifier hs-type">fromSimpleCon'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679182342"><span class="annot"><a href="Constrained.Univ.html#ProdOver"><span class="hs-identifier hs-type">ProdOver</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Constr"><span class="hs-identifier hs-type">Constr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182345"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679182345"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182342"><span class="hs-identifier hs-type">p</span></a></span></span><span>
</span><span id="line-1856"></span><span>
</span><span id="line-1857"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-1858"></span><span>  </span><span id="local-6989586621679182337"><span id="local-6989586621679182338"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#SimpleConstructor"><span class="hs-identifier hs-type">SimpleConstructor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182338"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-1859"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#SimpleConstructor"><span class="hs-identifier hs-type">SimpleConstructor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182337"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-1860"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.List.html#TypeList"><span class="hs-identifier hs-type">TypeList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Constr"><span class="hs-identifier hs-type">Constr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182338"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1861"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.List.html#TypeList"><span class="hs-identifier hs-type">TypeList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Constr"><span class="hs-identifier hs-type">Constr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182337"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1862"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1863"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#SimpleConstructor"><span class="hs-identifier hs-type">SimpleConstructor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182338"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-type">:*:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182337"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1864"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1865"></span><span>  </span><span id="local-6989586621679177337"><span class="annot"><span class="annottext">toSimpleCon' :: forall p. (:*:) f g p -&gt; ProdOver (Constr (f :*: g))
</span><a href="#local-6989586621679177337"><span class="hs-identifier hs-var hs-var hs-var hs-var">toSimpleCon'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679177336"><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679177336"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-type">:*:</span></a></span><span> </span><span id="local-6989586621679177334"><span class="annot"><span class="annottext">g p
</span><a href="#local-6989586621679177334"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (xs :: [*]) (ys :: [*]).
(TypeList xs, TypeList ys) =&gt;
ProdOver xs -&gt; ProdOver ys -&gt; ProdOver (Append xs ys)
</span><a href="Constrained.Univ.html#appendProd"><span class="hs-identifier hs-var">appendProd</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Constr"><span class="hs-identifier hs-type">Constr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182338"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Constr"><span class="hs-identifier hs-type">Constr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182337"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (rep :: * -&gt; *) p.
SimpleConstructor rep =&gt;
rep p -&gt; ProdOver (Constr rep)
</span><a href="Constrained.Base.html#toSimpleCon%27"><span class="hs-identifier hs-var">toSimpleCon'</span></a></span><span> </span><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679177336"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (rep :: * -&gt; *) p.
SimpleConstructor rep =&gt;
rep p -&gt; ProdOver (Constr rep)
</span><a href="Constrained.Base.html#toSimpleCon%27"><span class="hs-identifier hs-var">toSimpleCon'</span></a></span><span> </span><span class="annot"><span class="annottext">g p
</span><a href="#local-6989586621679177334"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1866"></span><span>  </span><span id="local-6989586621679177328"><span class="annot"><span class="annottext">fromSimpleCon' :: forall p. ProdOver (Constr (f :*: g)) -&gt; (:*:) f g p
</span><a href="#local-6989586621679177328"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromSimpleCon'</span></a></span></span><span> </span><span id="local-6989586621679177327"><span class="annot"><span class="annottext">ProdOver (Constr (f :*: g))
</span><a href="#local-6989586621679177327"><span class="hs-identifier hs-var">constr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1867"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Constrained.Univ.html#Prod"><span class="hs-identifier hs-type">Prod</span></a></span><span> </span><span id="local-6989586621679177325"><span class="annot"><span class="annottext">ProdOver (Constr f)
</span><a href="#local-6989586621679177325"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679177324"><span class="annot"><span class="annottext">ProdOver (Constr g)
</span><a href="#local-6989586621679177324"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (xs :: [*]) (ys :: [*]).
(TypeList xs, TypeList ys) =&gt;
ProdOver (Append xs ys) -&gt; Prod (ProdOver xs) (ProdOver ys)
</span><a href="Constrained.Univ.html#splitProd"><span class="hs-identifier hs-var">splitProd</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Constr"><span class="hs-identifier hs-type">Constr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182338"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Constr"><span class="hs-identifier hs-type">Constr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182337"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ProdOver (Constr (f :*: g))
</span><a href="#local-6989586621679177327"><span class="hs-identifier hs-var">constr</span></a></span><span>
</span><span id="line-1868"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (rep :: * -&gt; *) p.
SimpleConstructor rep =&gt;
ProdOver (Constr rep) -&gt; rep p
</span><a href="Constrained.Base.html#fromSimpleCon%27"><span class="hs-identifier hs-var">fromSimpleCon'</span></a></span><span> </span><span class="annot"><span class="annottext">ProdOver (Constr f)
</span><a href="#local-6989586621679177325"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k).
f p -&gt; g p -&gt; (:*:) f g p
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">:*:</span></a></span><span> </span><span class="annot"><span class="annottext">forall (rep :: * -&gt; *) p.
SimpleConstructor rep =&gt;
ProdOver (Constr rep) -&gt; rep p
</span><a href="Constrained.Base.html#fromSimpleCon%27"><span class="hs-identifier hs-var">fromSimpleCon'</span></a></span><span> </span><span class="annot"><span class="annottext">ProdOver (Constr g)
</span><a href="#local-6989586621679177324"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1869"></span><span>
</span><span id="line-1870"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182321"><span id="local-6989586621679182322"><span class="annot"><a href="Constrained.Base.html#SimpleConstructor"><span class="hs-identifier hs-type">SimpleConstructor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182322"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#SimpleConstructor"><span class="hs-identifier hs-type">SimpleConstructor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">S1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182321"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182322"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1871"></span><span>  </span><span id="local-6989586621679177317"><span class="annot"><span class="annottext">toSimpleCon' :: forall p. S1 s f p -&gt; ProdOver (Constr (S1 s f))
</span><a href="#local-6989586621679177317"><span class="hs-identifier hs-var hs-var hs-var hs-var">toSimpleCon'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">M1</span></a></span><span> </span><span id="local-6989586621679177315"><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679177315"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (rep :: * -&gt; *) p.
SimpleConstructor rep =&gt;
rep p -&gt; ProdOver (Constr rep)
</span><a href="Constrained.Base.html#toSimpleCon%27"><span class="hs-identifier hs-var">toSimpleCon'</span></a></span><span> </span><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679177315"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1872"></span><span>  </span><span id="local-6989586621679177313"><span class="annot"><span class="annottext">fromSimpleCon' :: forall p. ProdOver (Constr (S1 s f)) -&gt; S1 s f p
</span><a href="#local-6989586621679177313"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromSimpleCon'</span></a></span></span><span> </span><span id="local-6989586621679177312"><span class="annot"><span class="annottext">ProdOver (Constr (S1 s f))
</span><a href="#local-6989586621679177312"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k i (c :: Meta) (f :: k -&gt; *) (p :: k). f p -&gt; M1 i c f p
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">M1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (rep :: * -&gt; *) p.
SimpleConstructor rep =&gt;
ProdOver (Constr rep) -&gt; rep p
</span><a href="Constrained.Base.html#fromSimpleCon%27"><span class="hs-identifier hs-var">fromSimpleCon'</span></a></span><span> </span><span class="annot"><span class="annottext">ProdOver (Constr (S1 s f))
</span><a href="#local-6989586621679177312"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1873"></span><span>
</span><span id="line-1874"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182311"><span id="local-6989586621679182312"><span class="annot"><a href="Constrained.Base.html#SimpleConstructor"><span class="hs-identifier hs-type">SimpleConstructor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">K1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182312"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182311"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1875"></span><span>  </span><span id="local-6989586621679177308"><span class="annot"><span class="annottext">toSimpleCon' :: forall p. K1 i k p -&gt; ProdOver (Constr (K1 i k))
</span><a href="#local-6989586621679177308"><span class="hs-identifier hs-var hs-var hs-var hs-var">toSimpleCon'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">K1</span></a></span><span> </span><span id="local-6989586621679177306"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679177306"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679177306"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1876"></span><span>  </span><span id="local-6989586621679177305"><span class="annot"><span class="annottext">fromSimpleCon' :: forall p. ProdOver (Constr (K1 i k)) -&gt; K1 i k p
</span><a href="#local-6989586621679177305"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromSimpleCon'</span></a></span></span><span> </span><span id="local-6989586621679177304"><span class="annot"><span class="annottext">ProdOver (Constr (K1 i k))
</span><a href="#local-6989586621679177304"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k i c (p :: k). c -&gt; K1 i c p
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">K1</span></a></span><span> </span><span class="annot"><span class="annottext">ProdOver (Constr (K1 i k))
</span><a href="#local-6989586621679177304"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1877"></span><span>
</span><span id="line-1878"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Constrained.Base.html#SimpleConstructor"><span class="hs-identifier hs-type">SimpleConstructor</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">U1</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1879"></span><span>  </span><span id="local-6989586621679177300"><span class="annot"><span class="annottext">toSimpleCon' :: forall p. U1 p -&gt; ProdOver (Constr U1)
</span><a href="#local-6989586621679177300"><span class="hs-identifier hs-var hs-var hs-var hs-var">toSimpleCon'</span></a></span></span><span> </span><span class="annot"><span class="annottext">U1 p
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">U1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1880"></span><span>  </span><span id="local-6989586621679177298"><span class="annot"><span class="annottext">fromSimpleCon' :: forall p. ProdOver (Constr U1) -&gt; U1 p
</span><a href="#local-6989586621679177298"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromSimpleCon'</span></a></span></span><span> </span><span class="annot"><span class="annottext">ProdOver (Constr U1)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k (p :: k). U1 p
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">U1</span></a></span><span>
</span><span id="line-1881"></span><span>
</span><span id="line-1882"></span><span class="hs-comment">-- The sum type level -----------------------------------------------------</span><span>
</span><span id="line-1883"></span><span>
</span><span id="line-1884"></span><span class="hs-comment">-- | Construct and deconstruct cases in a `SOP`</span><span>
</span><span id="line-1885"></span><span class="hs-keyword">class</span><span> </span><span id="SopList"><span class="annot"><a href="Constrained.Base.html#SopList"><span class="hs-identifier hs-var">SopList</span></a></span></span><span> </span><span id="local-6989586621679182302"><span class="annot"><a href="#local-6989586621679182302"><span class="hs-identifier hs-type">xs</span></a></span></span><span> </span><span id="local-6989586621679182301"><span class="annot"><a href="#local-6989586621679182301"><span class="hs-identifier hs-type">ys</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1886"></span><span>  </span><span id="injectSOPLeft"><span class="annot"><a href="Constrained.Base.html#injectSOPLeft"><span class="hs-identifier hs-type">injectSOPLeft</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#SOP"><span class="hs-identifier hs-type">SOP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182302"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#SOP"><span class="hs-identifier hs-type">SOP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.List.html#Append"><span class="hs-identifier hs-type">Append</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182302"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182301"><span class="hs-identifier hs-type">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1887"></span><span>  </span><span id="injectSOPRight"><span class="annot"><a href="Constrained.Base.html#injectSOPRight"><span class="hs-identifier hs-type">injectSOPRight</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#SOP"><span class="hs-identifier hs-type">SOP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182301"><span class="hs-identifier hs-type">ys</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#SOP"><span class="hs-identifier hs-type">SOP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.List.html#Append"><span class="hs-identifier hs-type">Append</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182302"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182301"><span class="hs-identifier hs-type">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1888"></span><span>  </span><span id="caseSOP"><span class="annot"><a href="Constrained.Base.html#caseSOP"><span class="hs-identifier hs-type">caseSOP</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#SOP"><span class="hs-identifier hs-type">SOP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.List.html#Append"><span class="hs-identifier hs-type">Append</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182302"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182301"><span class="hs-identifier hs-type">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Univ.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SOP"><span class="hs-identifier hs-type">SOP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182302"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SOP"><span class="hs-identifier hs-type">SOP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182301"><span class="hs-identifier hs-type">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1889"></span><span>
</span><span id="line-1890"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182292"><span id="local-6989586621679182293"><span id="local-6989586621679182294"><span id="local-6989586621679182295"><span class="annot"><a href="Constrained.Base.html#SopList"><span class="hs-identifier hs-type">SopList</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182295"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A%3A%3A"><span class="hs-operator hs-type">:::</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182294"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182293"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182292"><span class="hs-identifier hs-type">ys</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1891"></span><span>  </span><span id="local-6989586621679177289"><span class="annot"><span class="annottext">injectSOPLeft :: SOP '[c ::: x] -&gt; SOP (Append '[c ::: x] (y : ys))
</span><a href="#local-6989586621679177289"><span class="hs-identifier hs-var hs-var hs-var hs-var">injectSOPLeft</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Sum a b
</span><a href="Constrained.Univ.html#SumLeft"><span class="hs-identifier hs-var">SumLeft</span></a></span><span>
</span><span id="line-1892"></span><span>  </span><span id="local-6989586621679177288"><span class="annot"><span class="annottext">injectSOPRight :: SOP (y : ys) -&gt; SOP (Append '[c ::: x] (y : ys))
</span><a href="#local-6989586621679177288"><span class="hs-identifier hs-var hs-var hs-var hs-var">injectSOPRight</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Sum a b
</span><a href="Constrained.Univ.html#SumRight"><span class="hs-identifier hs-var">SumRight</span></a></span><span>
</span><span id="line-1893"></span><span>  </span><span id="local-6989586621679177287"><span class="annot"><span class="annottext">caseSOP :: SOP (Append '[c ::: x] (y : ys))
-&gt; Sum (SOP '[c ::: x]) (SOP (y : ys))
</span><a href="#local-6989586621679177287"><span class="hs-identifier hs-var hs-var hs-var hs-var">caseSOP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1894"></span><span>
</span><span id="line-1895"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182280"><span id="local-6989586621679182281"><span id="local-6989586621679182282"><span id="local-6989586621679182283"><span id="local-6989586621679182284"><span id="local-6989586621679182285"><span class="annot"><a href="Constrained.Base.html#SopList"><span class="hs-identifier hs-type">SopList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182285"><span class="hs-identifier hs-type">x'</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182284"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182283"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182282"><span class="hs-identifier hs-type">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#SopList"><span class="hs-identifier hs-type">SopList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182281"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A%3A%3A"><span class="hs-operator hs-type">:::</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182280"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182285"><span class="hs-identifier hs-type">x'</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182284"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182283"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182282"><span class="hs-identifier hs-type">ys</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1896"></span><span>  </span><span id="local-6989586621679177280"><span class="annot"><span class="annottext">injectSOPLeft :: SOP ((c ::: x) : x' : xs)
-&gt; SOP (Append ((c ::: x) : x' : xs) (y : ys))
</span><a href="#local-6989586621679177280"><span class="hs-identifier hs-var hs-var hs-var hs-var">injectSOPLeft</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#SumLeft"><span class="hs-identifier hs-type">SumLeft</span></a></span><span> </span><span id="local-6989586621679177279"><span class="annot"><span class="annottext">ProdOver x
</span><a href="#local-6989586621679177279"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Sum a b
</span><a href="Constrained.Univ.html#SumLeft"><span class="hs-identifier hs-var">SumLeft</span></a></span><span> </span><span class="annot"><span class="annottext">ProdOver x
</span><a href="#local-6989586621679177279"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1897"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#injectSOPLeft"><span class="hs-identifier hs-var">injectSOPLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#SumRight"><span class="hs-identifier hs-type">SumRight</span></a></span><span> </span><span id="local-6989586621679177278"><span class="annot"><span class="annottext">SOP (x' : xs)
</span><a href="#local-6989586621679177278"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Sum a b
</span><a href="Constrained.Univ.html#SumRight"><span class="hs-identifier hs-var">SumRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (xs :: [*]) (ys :: [*]).
SopList xs ys =&gt;
SOP xs -&gt; SOP (Append xs ys)
</span><a href="Constrained.Base.html#injectSOPLeft"><span class="hs-identifier hs-var">injectSOPLeft</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182285"><span class="hs-identifier hs-type">x'</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182284"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182283"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182282"><span class="hs-identifier hs-type">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SOP (x' : xs)
</span><a href="#local-6989586621679177278"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1898"></span><span>
</span><span id="line-1899"></span><span>  </span><span id="local-6989586621679177276"><span class="annot"><span class="annottext">injectSOPRight :: SOP (y : ys) -&gt; SOP (Append ((c ::: x) : x' : xs) (y : ys))
</span><a href="#local-6989586621679177276"><span class="hs-identifier hs-var hs-var hs-var hs-var">injectSOPRight</span></a></span></span><span> </span><span id="local-6989586621679177275"><span class="annot"><span class="annottext">SOP (y : ys)
</span><a href="#local-6989586621679177275"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Sum a b
</span><a href="Constrained.Univ.html#SumRight"><span class="hs-identifier hs-var">SumRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (xs :: [*]) (ys :: [*]).
SopList xs ys =&gt;
SOP ys -&gt; SOP (Append xs ys)
</span><a href="Constrained.Base.html#injectSOPRight"><span class="hs-identifier hs-var">injectSOPRight</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182285"><span class="hs-identifier hs-type">x'</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182284"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182283"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182282"><span class="hs-identifier hs-type">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SOP (y : ys)
</span><a href="#local-6989586621679177275"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1900"></span><span>
</span><span id="line-1901"></span><span>  </span><span id="local-6989586621679177273"><span class="annot"><span class="annottext">caseSOP :: SOP (Append ((c ::: x) : x' : xs) (y : ys))
-&gt; Sum (SOP ((c ::: x) : x' : xs)) (SOP (y : ys))
</span><a href="#local-6989586621679177273"><span class="hs-identifier hs-var hs-var hs-var hs-var">caseSOP</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#SumLeft"><span class="hs-identifier hs-type">SumLeft</span></a></span><span> </span><span id="local-6989586621679177272"><span class="annot"><span class="annottext">ProdOver x
</span><a href="#local-6989586621679177272"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Sum a b
</span><a href="Constrained.Univ.html#SumLeft"><span class="hs-identifier hs-var">SumLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; Sum a b
</span><a href="Constrained.Univ.html#SumLeft"><span class="hs-identifier hs-var">SumLeft</span></a></span><span> </span><span class="annot"><span class="annottext">ProdOver x
</span><a href="#local-6989586621679177272"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1902"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#caseSOP"><span class="hs-identifier hs-var">caseSOP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#SumRight"><span class="hs-identifier hs-type">SumRight</span></a></span><span> </span><span id="local-6989586621679177271"><span class="annot"><span class="annottext">SOP (x' : Append xs (y : ys))
</span><a href="#local-6989586621679177271"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall (xs :: [*]) (ys :: [*]).
SopList xs ys =&gt;
SOP (Append xs ys) -&gt; Sum (SOP xs) (SOP ys)
</span><a href="Constrained.Base.html#caseSOP"><span class="hs-identifier hs-var">caseSOP</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182285"><span class="hs-identifier hs-type">x'</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182284"><span class="hs-identifier hs-type">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182283"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182282"><span class="hs-identifier hs-type">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SOP (x' : Append xs (y : ys))
</span><a href="#local-6989586621679177271"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1903"></span><span>    </span><span class="annot"><a href="Constrained.Univ.html#SumLeft"><span class="hs-identifier hs-type">SumLeft</span></a></span><span> </span><span id="local-6989586621679177270"><span class="annot"><span class="annottext">SOP (x' : xs)
</span><a href="#local-6989586621679177270"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Sum a b
</span><a href="Constrained.Univ.html#SumLeft"><span class="hs-identifier hs-var">SumLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. b -&gt; Sum a b
</span><a href="Constrained.Univ.html#SumRight"><span class="hs-identifier hs-var">SumRight</span></a></span><span> </span><span class="annot"><span class="annottext">SOP (x' : xs)
</span><a href="#local-6989586621679177270"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1904"></span><span>    </span><span class="annot"><a href="Constrained.Univ.html#SumRight"><span class="hs-identifier hs-type">SumRight</span></a></span><span> </span><span id="local-6989586621679177269"><span class="annot"><span class="annottext">SOP (y : ys)
</span><a href="#local-6989586621679177269"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Sum a b
</span><a href="Constrained.Univ.html#SumRight"><span class="hs-identifier hs-var">SumRight</span></a></span><span> </span><span class="annot"><span class="annottext">SOP (y : ys)
</span><a href="#local-6989586621679177269"><span class="hs-identifier hs-var">b'</span></a></span><span>
</span><span id="line-1905"></span><span>
</span><span id="line-1906"></span><span class="hs-keyword">class</span><span> </span><span id="SimpleGeneric"><span class="annot"><a href="Constrained.Base.html#SimpleGeneric"><span class="hs-identifier hs-var">SimpleGeneric</span></a></span></span><span> </span><span id="local-6989586621679182447"><span class="annot"><a href="#local-6989586621679182447"><span class="hs-identifier hs-type">rep</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1907"></span><span>  </span><span id="toSimpleRep%27"><span class="annot"><a href="Constrained.Base.html#toSimpleRep%27"><span class="hs-identifier hs-type">toSimpleRep'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679182446"><span class="annot"><a href="#local-6989586621679182447"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182446"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#SimplifyRep"><span class="hs-identifier hs-type">SimplifyRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182447"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-1908"></span><span>  </span><span id="fromSimpleRep%27"><span class="annot"><a href="Constrained.Base.html#fromSimpleRep%27"><span class="hs-identifier hs-type">fromSimpleRep'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679182442"><span class="annot"><a href="Constrained.Base.html#SimplifyRep"><span class="hs-identifier hs-type">SimplifyRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182447"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679182447"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182442"><span class="hs-identifier hs-type">p</span></a></span></span><span>
</span><span id="line-1909"></span><span>
</span><span id="line-1910"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182276"><span id="local-6989586621679182277"><span class="annot"><a href="Constrained.Base.html#SimpleGeneric"><span class="hs-identifier hs-type">SimpleGeneric</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182277"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#SimpleGeneric"><span class="hs-identifier hs-type">SimpleGeneric</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">D1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182276"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182277"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1911"></span><span>  </span><span id="local-6989586621679177262"><span class="annot"><span class="annottext">toSimpleRep' :: forall p. D1 d f p -&gt; SimplifyRep (D1 d f)
</span><a href="#local-6989586621679177262"><span class="hs-identifier hs-var hs-var hs-var hs-var">toSimpleRep'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">M1</span></a></span><span> </span><span id="local-6989586621679177261"><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679177261"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (rep :: * -&gt; *) p.
SimpleGeneric rep =&gt;
rep p -&gt; SimplifyRep rep
</span><a href="Constrained.Base.html#toSimpleRep%27"><span class="hs-identifier hs-var">toSimpleRep'</span></a></span><span> </span><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679177261"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1912"></span><span>  </span><span id="local-6989586621679177259"><span class="annot"><span class="annottext">fromSimpleRep' :: forall p. SimplifyRep (D1 d f) -&gt; D1 d f p
</span><a href="#local-6989586621679177259"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromSimpleRep'</span></a></span></span><span> </span><span id="local-6989586621679177258"><span class="annot"><span class="annottext">SimplifyRep (D1 d f)
</span><a href="#local-6989586621679177258"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k i (c :: Meta) (f :: k -&gt; *) (p :: k). f p -&gt; M1 i c f p
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">M1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (rep :: * -&gt; *) p.
SimpleGeneric rep =&gt;
SimplifyRep rep -&gt; rep p
</span><a href="Constrained.Base.html#fromSimpleRep%27"><span class="hs-identifier hs-var">fromSimpleRep'</span></a></span><span> </span><span class="annot"><span class="annottext">SimplifyRep (D1 d f)
</span><a href="#local-6989586621679177258"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1913"></span><span>
</span><span id="line-1914"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-1915"></span><span>  </span><span id="local-6989586621679182271"><span id="local-6989586621679182272"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#SimpleGeneric"><span class="hs-identifier hs-type">SimpleGeneric</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182272"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-1916"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#SimpleGeneric"><span class="hs-identifier hs-type">SimpleGeneric</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182271"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-1917"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#SopList"><span class="hs-identifier hs-type">SopList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SOPOf"><span class="hs-identifier hs-type">SOPOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182272"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SOPOf"><span class="hs-identifier hs-type">SOPOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182271"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1918"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1919"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#SimpleGeneric"><span class="hs-identifier hs-type">SimpleGeneric</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182272"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-type">:+:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182271"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1920"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1921"></span><span>  </span><span id="local-6989586621679177247"><span class="annot"><span class="annottext">toSimpleRep' :: forall p. (:+:) f g p -&gt; SimplifyRep (f :+: g)
</span><a href="#local-6989586621679177247"><span class="hs-identifier hs-var hs-var hs-var hs-var">toSimpleRep'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">L1</span></a></span><span> </span><span id="local-6989586621679177245"><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679177245"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (xs :: [*]) (ys :: [*]).
SopList xs ys =&gt;
SOP xs -&gt; SOP (Append xs ys)
</span><a href="Constrained.Base.html#injectSOPLeft"><span class="hs-identifier hs-var">injectSOPLeft</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SOPOf"><span class="hs-identifier hs-type">SOPOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182272"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SOPOf"><span class="hs-identifier hs-type">SOPOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182271"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (rep :: * -&gt; *) p.
SimpleGeneric rep =&gt;
rep p -&gt; SimplifyRep rep
</span><a href="Constrained.Base.html#toSimpleRep%27"><span class="hs-identifier hs-var">toSimpleRep'</span></a></span><span> </span><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679177245"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1922"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#toSimpleRep%27"><span class="hs-identifier hs-var">toSimpleRep'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">R1</span></a></span><span> </span><span id="local-6989586621679177243"><span class="annot"><span class="annottext">g p
</span><a href="#local-6989586621679177243"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (xs :: [*]) (ys :: [*]).
SopList xs ys =&gt;
SOP ys -&gt; SOP (Append xs ys)
</span><a href="Constrained.Base.html#injectSOPRight"><span class="hs-identifier hs-var">injectSOPRight</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SOPOf"><span class="hs-identifier hs-type">SOPOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182272"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SOPOf"><span class="hs-identifier hs-type">SOPOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182271"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (rep :: * -&gt; *) p.
SimpleGeneric rep =&gt;
rep p -&gt; SimplifyRep rep
</span><a href="Constrained.Base.html#toSimpleRep%27"><span class="hs-identifier hs-var">toSimpleRep'</span></a></span><span> </span><span class="annot"><span class="annottext">g p
</span><a href="#local-6989586621679177243"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-1923"></span><span>  </span><span id="local-6989586621679177239"><span class="annot"><span class="annottext">fromSimpleRep' :: forall p. SimplifyRep (f :+: g) -&gt; (:+:) f g p
</span><a href="#local-6989586621679177239"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromSimpleRep'</span></a></span></span><span> </span><span id="local-6989586621679177238"><span class="annot"><span class="annottext">SimplifyRep (f :+: g)
</span><a href="#local-6989586621679177238"><span class="hs-identifier hs-var">sop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1924"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall (xs :: [*]) (ys :: [*]).
SopList xs ys =&gt;
SOP (Append xs ys) -&gt; Sum (SOP xs) (SOP ys)
</span><a href="Constrained.Base.html#caseSOP"><span class="hs-identifier hs-var">caseSOP</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SOPOf"><span class="hs-identifier hs-type">SOPOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182272"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SOPOf"><span class="hs-identifier hs-type">SOPOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182271"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SimplifyRep (f :+: g)
</span><a href="#local-6989586621679177238"><span class="hs-identifier hs-var">sop</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1925"></span><span>      </span><span class="annot"><a href="Constrained.Univ.html#SumLeft"><span class="hs-identifier hs-type">SumLeft</span></a></span><span> </span><span id="local-6989586621679177237"><span class="annot"><span class="annottext">SOP (SOPOf f)
</span><a href="#local-6989586621679177237"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k). f p -&gt; (:+:) f g p
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">L1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (rep :: * -&gt; *) p.
SimpleGeneric rep =&gt;
SimplifyRep rep -&gt; rep p
</span><a href="Constrained.Base.html#fromSimpleRep%27"><span class="hs-identifier hs-var">fromSimpleRep'</span></a></span><span> </span><span class="annot"><span class="annottext">SOP (SOPOf f)
</span><a href="#local-6989586621679177237"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1926"></span><span>      </span><span class="annot"><a href="Constrained.Univ.html#SumRight"><span class="hs-identifier hs-type">SumRight</span></a></span><span> </span><span id="local-6989586621679177236"><span class="annot"><span class="annottext">SOP (SOPOf g)
</span><a href="#local-6989586621679177236"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k). g p -&gt; (:+:) f g p
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">R1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (rep :: * -&gt; *) p.
SimpleGeneric rep =&gt;
SimplifyRep rep -&gt; rep p
</span><a href="Constrained.Base.html#fromSimpleRep%27"><span class="hs-identifier hs-var">fromSimpleRep'</span></a></span><span> </span><span class="annot"><span class="annottext">SOP (SOPOf g)
</span><a href="#local-6989586621679177236"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1927"></span><span>
</span><span id="line-1928"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182256"><span id="local-6989586621679182257"><span id="local-6989586621679182258"><span id="local-6989586621679182259"><span class="annot"><a href="Constrained.Base.html#SimpleConstructor"><span class="hs-identifier hs-type">SimpleConstructor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182259"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#SimpleGeneric"><span class="hs-identifier hs-type">SimpleGeneric</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">C1</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MetaCons</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182258"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182257"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182256"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679182259"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1929"></span><span>  </span><span id="local-6989586621679177230"><span class="annot"><span class="annottext">toSimpleRep' :: forall p.
C1 ('MetaCons c a b) f p -&gt; SimplifyRep (C1 ('MetaCons c a b) f)
</span><a href="#local-6989586621679177230"><span class="hs-identifier hs-var hs-var hs-var hs-var">toSimpleRep'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">M1</span></a></span><span> </span><span id="local-6989586621679177229"><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679177229"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (rep :: * -&gt; *) p.
SimpleConstructor rep =&gt;
rep p -&gt; ProdOver (Constr rep)
</span><a href="Constrained.Base.html#toSimpleCon%27"><span class="hs-identifier hs-var">toSimpleCon'</span></a></span><span> </span><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679177229"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1930"></span><span>  </span><span id="local-6989586621679177227"><span class="annot"><span class="annottext">fromSimpleRep' :: forall p.
SimplifyRep (C1 ('MetaCons c a b) f) -&gt; C1 ('MetaCons c a b) f p
</span><a href="#local-6989586621679177227"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromSimpleRep'</span></a></span></span><span> </span><span id="local-6989586621679177226"><span class="annot"><span class="annottext">SimplifyRep (C1 ('MetaCons c a b) f)
</span><a href="#local-6989586621679177226"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k i (c :: Meta) (f :: k -&gt; *) (p :: k). f p -&gt; M1 i c f p
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">M1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (rep :: * -&gt; *) p.
SimpleConstructor rep =&gt;
ProdOver (Constr rep) -&gt; rep p
</span><a href="Constrained.Base.html#fromSimpleCon%27"><span class="hs-identifier hs-var">fromSimpleCon'</span></a></span><span> </span><span class="annot"><span class="annottext">SimplifyRep (C1 ('MetaCons c a b) f)
</span><a href="#local-6989586621679177226"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1931"></span><span>
</span><span id="line-1932"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-1933"></span><span class="hs-comment">-- Sums and folds</span><span>
</span><span id="line-1934"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-1935"></span><span>
</span><span id="line-1936"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182254"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182253"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="Foldy"><span class="annot"><a href="Constrained.Base.html#Foldy"><span class="hs-identifier hs-var">Foldy</span></a></span></span><span> </span><span id="local-6989586621679182254"><span class="annot"><a href="#local-6989586621679182254"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679182253"><span class="annot"><a href="#local-6989586621679182253"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1937"></span><span>  </span><span id="genList"><span class="annot"><a href="Constrained.Base.html#genList"><span class="hs-identifier hs-type">genList</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679182148"><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182254"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.GenT.html#MonadGenError"><span class="hs-identifier hs-type">MonadGenError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182148"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182254"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182253"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182254"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182253"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.GenT.html#GenT"><span class="hs-identifier hs-type">GenT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182148"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182253"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1938"></span><span>  </span><span id="theAddFn"><span class="annot"><a href="Constrained.Base.html#theAddFn"><span class="hs-identifier hs-type">theAddFn</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679182254"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182253"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679182253"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679182253"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1939"></span><span>  </span><span id="theZero"><span class="annot"><a href="Constrained.Base.html#theZero"><span class="hs-identifier hs-type">theZero</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679182253"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1940"></span><span>
</span><span id="line-1941"></span><span class="annot"><a href="Constrained.Base.html#adds"><span class="hs-identifier hs-type">adds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182252"><span class="annot"><a href="#local-6989586621679182252"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679182251"><span class="annot"><a href="#local-6989586621679182251"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.Base.html#Foldy"><span class="hs-identifier hs-type">Foldy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182252"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182251"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182251"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679182251"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1942"></span><span id="adds"><span class="annot"><span class="annottext">adds :: forall (fn :: [*] -&gt; * -&gt; *) a. Foldy fn a =&gt; [a] -&gt; a
</span><a href="Constrained.Base.html#adds"><span class="hs-identifier hs-var hs-var">adds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (as :: [*]) b.
FunctionLike fn =&gt;
fn as b -&gt; FunTy as b
</span><a href="Constrained.Univ.html#sem"><span class="hs-identifier hs-var">sem</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Foldy fn a =&gt; fn '[a, a] a
</span><a href="Constrained.Base.html#theAddFn"><span class="hs-identifier hs-var">theAddFn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182252"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Foldy fn a =&gt; a
</span><a href="Constrained.Base.html#theZero"><span class="hs-identifier hs-var">theZero</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182252"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1943"></span><span>
</span><span id="line-1944"></span><span class="hs-keyword">data</span><span> </span><span id="FoldSpec"><span class="annot"><a href="Constrained.Base.html#FoldSpec"><span class="hs-identifier hs-var">FoldSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679177211"><span class="annot"><a href="#local-6989586621679177211"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679177210"><span class="annot"><a href="#local-6989586621679177210"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1945"></span><span>  </span><span id="local-6989586621679181984"><span id="local-6989586621679181985"><span id="NoFold"><span class="annot"><a href="Constrained.Base.html#NoFold"><span class="hs-identifier hs-var">NoFold</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#FoldSpec"><span class="hs-identifier hs-type">FoldSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181985"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181984"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-1946"></span><span>  </span><span id="FoldSpec"><span class="annot"><a href="Constrained.Base.html#FoldSpec"><span class="hs-identifier hs-var">FoldSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1947"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679177207"><span class="annot"><a href="#local-6989586621679177207"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679182240"><span class="annot"><a href="#local-6989586621679182240"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679182239"><span class="annot"><a href="#local-6989586621679182239"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-1948"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182240"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182239"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1949"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182240"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177207"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-1950"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#Foldy"><span class="hs-identifier hs-type">Foldy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182240"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177207"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-1951"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Univ.html#Member"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ListFn"><span class="hs-identifier hs-type">ListFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182240"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679182240"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-1952"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182240"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-1953"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1954"></span><span>    </span><span class="annot"><a href="#local-6989586621679182240"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182239"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679177207"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1955"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182240"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177207"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1956"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#FoldSpec"><span class="hs-identifier hs-type">FoldSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182240"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182239"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1957"></span><span>
</span><span id="line-1958"></span><span id="local-6989586621679182246"><span id="local-6989586621679182247"><span id="local-6989586621679182248"><span class="annot"><a href="Constrained.Base.html#combineFoldSpec"><span class="hs-identifier hs-type">combineFoldSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.GenT.html#MonadGenError"><span class="hs-identifier hs-type">MonadGenError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182248"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#FoldSpec"><span class="hs-identifier hs-type">FoldSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182247"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182246"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#FoldSpec"><span class="hs-identifier hs-type">FoldSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182247"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182246"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679182248"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#FoldSpec"><span class="hs-identifier hs-type">FoldSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182247"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182246"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1959"></span><span id="combineFoldSpec"><span class="annot"><span class="annottext">combineFoldSpec :: forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *) a.
MonadGenError m =&gt;
FoldSpec fn a -&gt; FoldSpec fn a -&gt; m (FoldSpec fn a)
</span><a href="Constrained.Base.html#combineFoldSpec"><span class="hs-identifier hs-var hs-var">combineFoldSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">FoldSpec fn a
</span><a href="Constrained.Base.html#NoFold"><span class="hs-identifier hs-var">NoFold</span></a></span><span> </span><span id="local-6989586621679177200"><span class="annot"><span class="annottext">FoldSpec fn a
</span><a href="#local-6989586621679177200"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">FoldSpec fn a
</span><a href="#local-6989586621679177200"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1960"></span><span class="annot"><a href="Constrained.Base.html#combineFoldSpec"><span class="hs-identifier hs-var">combineFoldSpec</span></a></span><span> </span><span id="local-6989586621679177199"><span class="annot"><span class="annottext">FoldSpec fn a
</span><a href="#local-6989586621679177199"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">FoldSpec fn a
</span><a href="Constrained.Base.html#NoFold"><span class="hs-identifier hs-var">NoFold</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">FoldSpec fn a
</span><a href="#local-6989586621679177199"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1961"></span><span class="annot"><a href="Constrained.Base.html#combineFoldSpec"><span class="hs-identifier hs-var">combineFoldSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#FoldSpec"><span class="hs-identifier hs-type">FoldSpec</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679177184"><span id="local-6989586621679177185"><span id="local-6989586621679177186"><span id="local-6989586621679177183"><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679177183"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679177186"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177185"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177184"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679177182"><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679177182"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#FoldSpec"><span class="hs-identifier hs-type">FoldSpec</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679177163"><span id="local-6989586621679177164"><span id="local-6989586621679177165"><span id="local-6989586621679177162"><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679177162"><span class="hs-identifier hs-var">f'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679177165"><span class="hs-identifier hs-type">fn'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177164"><span class="hs-identifier hs-type">as'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177163"><span class="hs-identifier hs-type">b'</span></a></span></span></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679177161"><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679177161"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1962"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><span class="annottext">b :~: b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Refl</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {k} (a :: k) (b :: k).
(Typeable a, Typeable b) =&gt;
Maybe (a :~: b)
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">eqT</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679177184"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679177163"><span class="hs-identifier hs-type">b'</span></a></span><span>
</span><span id="line-1963"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><span class="annottext">fn :~: fn
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Refl</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {k} (a :: k) (b :: k).
(Typeable a, Typeable b) =&gt;
Maybe (a :~: b)
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">eqT</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679177186"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679177165"><span class="hs-identifier hs-type">fn'</span></a></span><span>
</span><span id="line-1964"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679177183"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679177162"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1965"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn a, HasSpec fn a, Foldy fn a, Member (ListFn fn) fn,
 BaseUniverse fn) =&gt;
fn '[a] a -&gt; Spec fn a -&gt; FoldSpec fn a
</span><a href="Constrained.Base.html#FoldSpec"><span class="hs-identifier hs-var">FoldSpec</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679177183"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679177182"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679177161"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1966"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a
</span><a href="Constrained.GenT.html#genError"><span class="hs-identifier hs-var">genError</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Can't combine fold specs on different functions&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679177183"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679177162"><span class="hs-identifier hs-var">f'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1967"></span><span>
</span><span id="line-1968"></span><span class="annot"><a href="Constrained.Base.html#conformsToFoldSpec"><span class="hs-identifier hs-type">conformsToFoldSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182237"><span class="annot"><a href="#local-6989586621679182237"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679182238"><span class="annot"><a href="#local-6989586621679182238"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182238"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#FoldSpec"><span class="hs-identifier hs-type">FoldSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182237"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182238"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-1969"></span><span id="conformsToFoldSpec"><span class="annot"><span class="annottext">conformsToFoldSpec :: forall (fn :: [*] -&gt; * -&gt; *) a. [a] -&gt; FoldSpec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToFoldSpec"><span class="hs-identifier hs-var hs-var">conformsToFoldSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FoldSpec fn a
</span><a href="Constrained.Base.html#NoFold"><span class="hs-identifier hs-var">NoFold</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1970"></span><span class="annot"><a href="Constrained.Base.html#conformsToFoldSpec"><span class="hs-identifier hs-var">conformsToFoldSpec</span></a></span><span> </span><span id="local-6989586621679177147"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679177147"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#FoldSpec"><span class="hs-identifier hs-type">FoldSpec</span></a></span><span> </span><span id="local-6989586621679177136"><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679177136"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679177135"><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679177135"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Foldy fn a =&gt; [a] -&gt; a
</span><a href="Constrained.Base.html#adds"><span class="hs-identifier hs-var">adds</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182237"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (as :: [*]) b.
FunctionLike fn =&gt;
fn as b -&gt; FunTy as b
</span><a href="Constrained.Univ.html#sem"><span class="hs-identifier hs-var">sem</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679177136"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679177147"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-operator hs-var">`conformsToSpec`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679177135"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1971"></span><span>
</span><span id="line-1972"></span><span class="annot"><a href="Constrained.Base.html#toPredsFoldSpec"><span class="hs-identifier hs-type">toPredsFoldSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182233"><span class="annot"><a href="#local-6989586621679182233"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679182232"><span class="annot"><a href="#local-6989586621679182232"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182233"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182233"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182232"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#FoldSpec"><span class="hs-identifier hs-type">FoldSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182233"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182232"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182233"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-1973"></span><span id="toPredsFoldSpec"><span class="annot"><span class="annottext">toPredsFoldSpec :: forall (fn :: [*] -&gt; * -&gt; *) a.
BaseUniverse fn =&gt;
Term fn [a] -&gt; FoldSpec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#toPredsFoldSpec"><span class="hs-identifier hs-var hs-var">toPredsFoldSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">Term fn [a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FoldSpec fn a
</span><a href="Constrained.Base.html#NoFold"><span class="hs-identifier hs-var">NoFold</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span>
</span><span id="line-1974"></span><span class="annot"><a href="Constrained.Base.html#toPredsFoldSpec"><span class="hs-identifier hs-var">toPredsFoldSpec</span></a></span><span> </span><span id="local-6989586621679177129"><span class="annot"><span class="annottext">Term fn [a]
</span><a href="#local-6989586621679177129"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#FoldSpec"><span class="hs-identifier hs-type">FoldSpec</span></a></span><span> </span><span id="local-6989586621679177099"><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679177099"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679177098"><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679177098"><span class="hs-identifier hs-var">sspec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1975"></span><span>  </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Spec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#satisfies"><span class="hs-identifier hs-var">satisfies</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
(HasSpec fn a, Foldy fn b, Show (fn '[a] b), Eq (fn '[a] b)) =&gt;
fn '[a] b -&gt; fn '[[a]] b
</span><a href="Constrained.Base.html#foldMapFn"><span class="hs-identifier hs-var">foldMapFn</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679177099"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term fn [a]
</span><a href="#local-6989586621679177129"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679177098"><span class="hs-identifier hs-var">sspec</span></a></span><span>
</span><span id="line-1976"></span><span>
</span><span id="line-1977"></span><span class="hs-comment">-- | Note: potentially infinite list</span><span>
</span><span id="line-1978"></span><span id="local-6989586621679182223"><span class="annot"><a href="Constrained.Base.html#enumerateInterval"><span class="hs-identifier hs-type">enumerateInterval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Enum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182223"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Num</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182223"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182223"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#MaybeBounded"><span class="hs-identifier hs-type">MaybeBounded</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182223"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182223"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182223"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1979"></span><span id="enumerateInterval"><span class="annot"><span class="annottext">enumerateInterval :: forall a.
(Enum a, Num a, Ord a, MaybeBounded a) =&gt;
NumSpec a -&gt; [a]
</span><a href="Constrained.Base.html#enumerateInterval"><span class="hs-identifier hs-var hs-var">enumerateInterval</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#NumSpecInterval"><span class="hs-identifier hs-type">NumSpecInterval</span></a></span><span> </span><span id="local-6989586621679177074"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679177074"><span class="hs-identifier hs-var">lo</span></a></span></span><span> </span><span id="local-6989586621679177073"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679177073"><span class="hs-identifier hs-var">hi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1980"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679177074"><span class="hs-identifier hs-var">lo</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. MaybeBounded a =&gt; Maybe a
</span><a href="Constrained.Base.html#lowerBound"><span class="hs-identifier hs-var">lowerBound</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679177073"><span class="hs-identifier hs-var">hi</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. MaybeBounded a =&gt; Maybe a
</span><a href="Constrained.Base.html#upperBound"><span class="hs-identifier hs-var">upperBound</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1981"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679177070"><span class="hs-identifier hs-var">interleave</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-1982"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679177069"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177069"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177069"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177069"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-1983"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679177068"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177068"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177068"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-1984"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679177067"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177067"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679177066"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177066"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177067"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177066"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1985"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1986"></span><span>    </span><span id="local-6989586621679177070"><span class="annot"><span class="annottext">interleave :: [a] -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679177070"><span class="hs-identifier hs-var hs-var">interleave</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679177065"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679177065"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679177065"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-1987"></span><span>    </span><span class="annot"><a href="#local-6989586621679177070"><span class="hs-identifier hs-var">interleave</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679177064"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177064"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679177063"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679177063"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679177062"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679177062"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177064"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679177070"><span class="hs-identifier hs-var">interleave</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679177062"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679177063"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1988"></span><span>
</span><span id="line-1989"></span><span id="local-6989586621679182218"><span id="local-6989586621679182219"><span class="annot"><a href="Constrained.Base.html#isEmptyNumSpec"><span class="hs-identifier hs-type">isEmptyNumSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182219"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182218"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182218"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182218"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Enum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182218"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Num</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182218"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#MaybeBounded"><span class="hs-identifier hs-type">MaybeBounded</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182218"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182219"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182218"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span><span>
</span><span id="line-1990"></span><span id="isEmptyNumSpec"><span class="annot"><span class="annottext">isEmptyNumSpec :: forall (fn :: [*] -&gt; * -&gt; *) a.
(TypeSpec fn a ~ NumSpec a, Ord a, Enum a, Num a,
 MaybeBounded a) =&gt;
Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#isEmptyNumSpec"><span class="hs-identifier hs-var hs-var">isEmptyNumSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1991"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1992"></span><span>  </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-1993"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span id="local-6989586621679177052"><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679177052"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679177052"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-1994"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-type">SuspendedSpec</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-1995"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span id="local-6989586621679177043"><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679177043"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679177042"><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679177042"><span class="hs-identifier hs-var">cant</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a.
(Enum a, Num a, Ord a, MaybeBounded a) =&gt;
NumSpec a -&gt; [a]
</span><a href="Constrained.Base.html#enumerateInterval"><span class="hs-identifier hs-var">enumerateInterval</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679177043"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">\\</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679177042"><span class="hs-identifier hs-var">cant</span></a></span><span>
</span><span id="line-1996"></span><span>
</span><span id="line-1997"></span><span id="local-6989586621679182214"><span id="local-6989586621679182215"><span class="annot"><a href="Constrained.Base.html#knownUpperBound"><span class="hs-identifier hs-type">knownUpperBound</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182215"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182214"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182214"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182214"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Enum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182214"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Num</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182214"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#MaybeBounded"><span class="hs-identifier hs-type">MaybeBounded</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182214"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182215"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182214"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182214"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-1998"></span><span id="knownUpperBound"><span class="annot"><span class="annottext">knownUpperBound :: forall (fn :: [*] -&gt; * -&gt; *) a.
(TypeSpec fn a ~ NumSpec a, Ord a, Enum a, Num a,
 MaybeBounded a) =&gt;
Spec fn a -&gt; Maybe a
</span><a href="Constrained.Base.html#knownUpperBound"><span class="hs-identifier hs-var hs-var">knownUpperBound</span></a></span></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. MaybeBounded a =&gt; Maybe a
</span><a href="Constrained.Base.html#upperBound"><span class="hs-identifier hs-var">upperBound</span></a></span><span>
</span><span id="line-1999"></span><span class="annot"><a href="Constrained.Base.html#knownUpperBound"><span class="hs-identifier hs-var">knownUpperBound</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2000"></span><span class="annot"><a href="Constrained.Base.html#knownUpperBound"><span class="hs-identifier hs-var">knownUpperBound</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span id="local-6989586621679177030"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679177030"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maximum</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679177030"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-2001"></span><span class="annot"><a href="Constrained.Base.html#knownUpperBound"><span class="hs-identifier hs-var">knownUpperBound</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2002"></span><span class="annot"><a href="Constrained.Base.html#knownUpperBound"><span class="hs-identifier hs-var">knownUpperBound</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-type">SuspendedSpec</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. MaybeBounded a =&gt; Maybe a
</span><a href="Constrained.Base.html#upperBound"><span class="hs-identifier hs-var">upperBound</span></a></span><span>
</span><span id="line-2003"></span><span class="annot"><a href="Constrained.Base.html#knownUpperBound"><span class="hs-identifier hs-var">knownUpperBound</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#NumSpecInterval"><span class="hs-identifier hs-type">NumSpecInterval</span></a></span><span> </span><span id="local-6989586621679177008"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679177008"><span class="hs-identifier hs-var">lo</span></a></span></span><span> </span><span id="local-6989586621679177007"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679177007"><span class="hs-identifier hs-var">hi</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679177006"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679177006"><span class="hs-identifier hs-var">cant</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Maybe a -&gt; Maybe a
</span><a href="#local-6989586621679177005"><span class="hs-identifier hs-var">upper</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679177008"><span class="hs-identifier hs-var">lo</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. MaybeBounded a =&gt; Maybe a
</span><a href="Constrained.Base.html#lowerBound"><span class="hs-identifier hs-var">lowerBound</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679177007"><span class="hs-identifier hs-var">hi</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. MaybeBounded a =&gt; Maybe a
</span><a href="Constrained.Base.html#upperBound"><span class="hs-identifier hs-var">upperBound</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2004"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2005"></span><span>    </span><span id="local-6989586621679177005"><span class="annot"><span class="annottext">upper :: Maybe a -&gt; Maybe a -&gt; Maybe a
</span><a href="#local-6989586621679177005"><span class="hs-identifier hs-var hs-var">upper</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2006"></span><span>    </span><span class="annot"><a href="#local-6989586621679177005"><span class="hs-identifier hs-var">upper</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679177004"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177004"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">listToMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177004"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177004"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">\\</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679177006"><span class="hs-identifier hs-var">cant</span></a></span><span>
</span><span id="line-2007"></span><span>    </span><span class="annot"><a href="#local-6989586621679177005"><span class="hs-identifier hs-var">upper</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679177002"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177002"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679177001"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177001"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2008"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177002"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177001"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177002"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177002"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`notElem`</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679177006"><span class="hs-identifier hs-var">cant</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2009"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">listToMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177001"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177001"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679177002"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">\\</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679177006"><span class="hs-identifier hs-var">cant</span></a></span><span>
</span><span id="line-2010"></span><span>
</span><span id="line-2011"></span><span id="local-6989586621679176999"><span id="local-6989586621679177000"><span class="annot"><a href="Constrained.Base.html#knownLowerBound"><span class="hs-identifier hs-type">knownLowerBound</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177000"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679176999"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679176999"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679176999"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Enum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679176999"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Num</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679176999"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#MaybeBounded"><span class="hs-identifier hs-type">MaybeBounded</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679176999"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679177000"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679176999"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679176999"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-2012"></span><span id="knownLowerBound"><span class="annot"><span class="annottext">knownLowerBound :: forall (fn :: [*] -&gt; * -&gt; *) a.
(TypeSpec fn a ~ NumSpec a, Ord a, Enum a, Num a,
 MaybeBounded a) =&gt;
Spec fn a -&gt; Maybe a
</span><a href="Constrained.Base.html#knownLowerBound"><span class="hs-identifier hs-var hs-var">knownLowerBound</span></a></span></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. MaybeBounded a =&gt; Maybe a
</span><a href="Constrained.Base.html#lowerBound"><span class="hs-identifier hs-var">lowerBound</span></a></span><span>
</span><span id="line-2013"></span><span class="annot"><a href="Constrained.Base.html#knownLowerBound"><span class="hs-identifier hs-var">knownLowerBound</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2014"></span><span class="annot"><a href="Constrained.Base.html#knownLowerBound"><span class="hs-identifier hs-var">knownLowerBound</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span id="local-6989586621679176987"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679176987"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">minimum</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679176987"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-2015"></span><span class="annot"><a href="Constrained.Base.html#knownLowerBound"><span class="hs-identifier hs-var">knownLowerBound</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2016"></span><span class="annot"><a href="Constrained.Base.html#knownLowerBound"><span class="hs-identifier hs-var">knownLowerBound</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-type">SuspendedSpec</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. MaybeBounded a =&gt; Maybe a
</span><a href="Constrained.Base.html#lowerBound"><span class="hs-identifier hs-var">lowerBound</span></a></span><span>
</span><span id="line-2017"></span><span class="annot"><a href="Constrained.Base.html#knownLowerBound"><span class="hs-identifier hs-var">knownLowerBound</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#NumSpecInterval"><span class="hs-identifier hs-type">NumSpecInterval</span></a></span><span> </span><span id="local-6989586621679176965"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679176965"><span class="hs-identifier hs-var">lo</span></a></span></span><span> </span><span id="local-6989586621679176964"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679176964"><span class="hs-identifier hs-var">hi</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679176963"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679176963"><span class="hs-identifier hs-var">cant</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2018"></span><span>  </span><span class="annot"><span class="annottext">Maybe a -&gt; Maybe a -&gt; Maybe a
</span><a href="#local-6989586621679176962"><span class="hs-identifier hs-var">lower</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679176965"><span class="hs-identifier hs-var">lo</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. MaybeBounded a =&gt; Maybe a
</span><a href="Constrained.Base.html#lowerBound"><span class="hs-identifier hs-var">lowerBound</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679176964"><span class="hs-identifier hs-var">hi</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. MaybeBounded a =&gt; Maybe a
</span><a href="Constrained.Base.html#upperBound"><span class="hs-identifier hs-var">upperBound</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2019"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2020"></span><span>    </span><span id="local-6989586621679176962"><span class="annot"><span class="annottext">lower :: Maybe a -&gt; Maybe a -&gt; Maybe a
</span><a href="#local-6989586621679176962"><span class="hs-identifier hs-var hs-var">lower</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2021"></span><span>    </span><span class="annot"><a href="#local-6989586621679176962"><span class="hs-identifier hs-var">lower</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679176961"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176961"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">listToMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176961"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176961"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">\\</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679176963"><span class="hs-identifier hs-var">cant</span></a></span><span>
</span><span id="line-2022"></span><span>    </span><span class="annot"><a href="#local-6989586621679176962"><span class="hs-identifier hs-var">lower</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679176960"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176960"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679176959"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176959"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2023"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176960"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176959"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176960"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176960"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`notElem`</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679176963"><span class="hs-identifier hs-var">cant</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2024"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">listToMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176960"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176960"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176959"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">\\</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679176963"><span class="hs-identifier hs-var">cant</span></a></span><span>
</span><span id="line-2025"></span><span>
</span><span id="line-2026"></span><span class="annot"><a href="Constrained.Base.html#narrowByFuelAndSize"><span class="hs-identifier hs-type">narrowByFuelAndSize</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-2027"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182206"><span class="annot"><a href="#local-6989586621679182206"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679182207"><span class="annot"><a href="#local-6989586621679182207"><span class="hs-identifier hs-type">fn</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-2028"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182207"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-2029"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182207"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182206"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182206"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2030"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182207"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182206"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2031"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-a65fd1c4eb4ae76375c6e3f3845a1ba912285f018239b330ae730fef533366f9/share/doc/html/src"><span class="hs-identifier hs-type">Arbitrary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182206"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2032"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182206"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2033"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182206"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2034"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/random-1.2.1.1-97d351bf97dd57637441798736e25556058018a1de673671ce7fdce6e47d0d77/share/doc/html/src"><span class="hs-identifier hs-type">Random</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182206"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2035"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#MaybeBounded"><span class="hs-identifier hs-type">MaybeBounded</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182206"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2036"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-2037"></span><span>  </span><span class="hs-comment">-- | Fuel</span><span>
</span><span id="line-2038"></span><span>  </span><span class="annot"><a href="#local-6989586621679182206"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2039"></span><span>  </span><span class="hs-comment">-- | Size</span><span>
</span><span id="line-2040"></span><span>  </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2041"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182207"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182206"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182207"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182206"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2042"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182207"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182206"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182207"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182206"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2043"></span><span id="narrowByFuelAndSize"><span class="annot"><span class="annottext">narrowByFuelAndSize :: forall a (fn :: [*] -&gt; * -&gt; *).
(BaseUniverse fn, TypeSpec fn a ~ NumSpec a, HasSpec fn a,
 Arbitrary a, Integral a, Ord a, Random a, MaybeBounded a) =&gt;
a -&gt; Int -&gt; (Spec fn a, Spec fn a) -&gt; (Spec fn a, Spec fn a)
</span><a href="Constrained.Base.html#narrowByFuelAndSize"><span class="hs-identifier hs-var hs-var">narrowByFuelAndSize</span></a></span></span><span> </span><span id="local-6989586621679176754"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176754"><span class="hs-identifier hs-var">fuel</span></a></span></span><span> </span><span id="local-6989586621679176753"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679176753"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621679176752"><span class="annot"><span class="annottext">(Spec fn a, Spec fn a)
</span><a href="#local-6989586621679176752"><span class="hs-identifier hs-var">specs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2044"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; (Spec fn a, Spec fn a) -&gt; (Spec fn a, Spec fn a)
</span><a href="#local-6989586621679176751"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1000</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(BaseUniverse fn, TypeSpec fn a ~ NumSpec a, HasSpec fn a,
 Arbitrary a, Integral a, Ord a, Random a, MaybeBounded a) =&gt;
(Spec fn a, Spec fn a) -&gt; (Spec fn a, Spec fn a)
</span><a href="Constrained.Base.html#narrowFoldSpecs"><span class="hs-identifier hs-var">narrowFoldSpecs</span></a></span><span> </span><span class="annot"><span class="annottext">(Spec fn a, Spec fn a)
</span><a href="#local-6989586621679176752"><span class="hs-identifier hs-var">specs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2045"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2046"></span><span>    </span><span id="local-6989586621679176751"><span class="annot"><span class="annottext">loop :: Int -&gt; (Spec fn a, Spec fn a) -&gt; (Spec fn a, Spec fn a)
</span><a href="#local-6989586621679176751"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621679176749"><span class="annot"><span class="annottext">(Spec fn a, Spec fn a)
</span><a href="#local-6989586621679176749"><span class="hs-identifier hs-var">specs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2047"></span><span>      </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-2048"></span><span>        </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">unlines</span></a></span><span>
</span><span id="line-2049"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;narrowByFuelAndSize loops:&quot;</span></span><span>
</span><span id="line-2050"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  fuel = &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176754"><span class="hs-identifier hs-var">fuel</span></a></span><span>
</span><span id="line-2051"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  size = &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679176753"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-2052"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  specs = &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(Spec fn a, Spec fn a)
</span><a href="#local-6989586621679176749"><span class="hs-identifier hs-var">specs</span></a></span><span>
</span><span id="line-2053"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  narrowFoldSpecs spec = &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(BaseUniverse fn, TypeSpec fn a ~ NumSpec a, HasSpec fn a,
 Arbitrary a, Integral a, Ord a, Random a, MaybeBounded a) =&gt;
(Spec fn a, Spec fn a) -&gt; (Spec fn a, Spec fn a)
</span><a href="Constrained.Base.html#narrowFoldSpecs"><span class="hs-identifier hs-var">narrowFoldSpecs</span></a></span><span> </span><span class="annot"><span class="annottext">(Spec fn a, Spec fn a)
</span><a href="#local-6989586621679176749"><span class="hs-identifier hs-var">specs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2054"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  go (narrowFoldSpecs specs) = &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Spec fn a, Spec fn a) -&gt; Maybe (Spec fn a, Spec fn a)
</span><a href="#local-6989586621679176747"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(BaseUniverse fn, TypeSpec fn a ~ NumSpec a, HasSpec fn a,
 Arbitrary a, Integral a, Ord a, Random a, MaybeBounded a) =&gt;
(Spec fn a, Spec fn a) -&gt; (Spec fn a, Spec fn a)
</span><a href="Constrained.Base.html#narrowFoldSpecs"><span class="hs-identifier hs-var">narrowFoldSpecs</span></a></span><span> </span><span class="annot"><span class="annottext">(Spec fn a, Spec fn a)
</span><a href="#local-6989586621679176749"><span class="hs-identifier hs-var">specs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2055"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-2056"></span><span>    </span><span class="annot"><a href="#local-6989586621679176751"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span id="local-6989586621679176746"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679176746"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679176745"><span class="annot"><span class="annottext">(Spec fn a, Spec fn a)
</span><a href="#local-6989586621679176745"><span class="hs-identifier hs-var">specs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Spec fn a, Spec fn a) -&gt; Maybe (Spec fn a, Spec fn a)
</span><a href="#local-6989586621679176747"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(Spec fn a, Spec fn a)
</span><a href="#local-6989586621679176745"><span class="hs-identifier hs-var">specs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2057"></span><span>      </span><span class="annot"><span class="annottext">Maybe (Spec fn a, Spec fn a)
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Spec fn a, Spec fn a)
</span><a href="#local-6989586621679176745"><span class="hs-identifier hs-var">specs</span></a></span><span>
</span><span id="line-2058"></span><span>      </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679176744"><span class="annot"><span class="annottext">(Spec fn a, Spec fn a)
</span><a href="#local-6989586621679176744"><span class="hs-identifier hs-var">specs'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Spec fn a, Spec fn a) -&gt; (Spec fn a, Spec fn a)
</span><a href="#local-6989586621679176751"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679176746"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(BaseUniverse fn, TypeSpec fn a ~ NumSpec a, HasSpec fn a,
 Arbitrary a, Integral a, Ord a, Random a, MaybeBounded a) =&gt;
(Spec fn a, Spec fn a) -&gt; (Spec fn a, Spec fn a)
</span><a href="Constrained.Base.html#narrowFoldSpecs"><span class="hs-identifier hs-var">narrowFoldSpecs</span></a></span><span> </span><span class="annot"><span class="annottext">(Spec fn a, Spec fn a)
</span><a href="#local-6989586621679176744"><span class="hs-identifier hs-var">specs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2059"></span><span>
</span><span id="line-2060"></span><span>    </span><span id="local-6989586621679176727"><span class="annot"><span class="annottext">canReach :: t -&gt; t -&gt; t -&gt; Bool
</span><a href="#local-6989586621679176727"><span class="hs-identifier hs-var hs-var">canReach</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621679176726"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679176726"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679176726"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2061"></span><span>    </span><span class="annot"><a href="#local-6989586621679176727"><span class="hs-identifier hs-var">canReach</span></a></span><span> </span><span id="local-6989586621679176725"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679176725"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679176724"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679176724"><span class="hs-identifier hs-var">fuel</span></a></span></span><span> </span><span id="local-6989586621679176723"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679176723"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-2062"></span><span>      </span><span class="hs-comment">-- You can reach it in one step</span><span>
</span><span id="line-2063"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679176723"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679176725"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679176724"><span class="hs-identifier hs-var">fuel</span></a></span><span>
</span><span id="line-2064"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t -&gt; Bool
</span><a href="#local-6989586621679176727"><span class="hs-identifier hs-var">canReach</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679176725"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679176724"><span class="hs-identifier hs-var">fuel</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679176723"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679176725"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2065"></span><span>
</span><span id="line-2066"></span><span>    </span><span class="hs-comment">-- Precondition:</span><span>
</span><span id="line-2067"></span><span>    </span><span class="hs-comment">--   a is negative</span><span>
</span><span id="line-2068"></span><span>    </span><span class="hs-comment">--   the type has more negative numbers than positive ones</span><span>
</span><span id="line-2069"></span><span>    </span><span id="local-6989586621679176714"><span class="annot"><span class="annottext">safeNegate :: p -&gt; p
</span><a href="#local-6989586621679176714"><span class="hs-identifier hs-var hs-var">safeNegate</span></a></span></span><span> </span><span id="local-6989586621679176713"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679176713"><span class="hs-identifier hs-var">a</span></a></span></span><span>
</span><span id="line-2070"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679176712"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679176712"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. MaybeBounded a =&gt; Maybe a
</span><a href="Constrained.Base.html#upperBound"><span class="hs-identifier hs-var">upperBound</span></a></span><span>
</span><span id="line-2071"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679176713"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">negate</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679176712"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2072"></span><span>          </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679176712"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-2073"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">negate</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679176713"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-2074"></span><span>
</span><span id="line-2075"></span><span>    </span><span id="local-6989586621679176701"><span class="annot"><span class="annottext">divCeil :: p -&gt; p -&gt; p
</span><a href="#local-6989586621679176701"><span class="hs-identifier hs-var hs-var">divCeil</span></a></span></span><span> </span><span id="local-6989586621679176700"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679176700"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679176699"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679176699"><span class="hs-identifier hs-var">b</span></a></span></span><span>
</span><span id="line-2076"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679176699"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679176697"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679176700"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679176697"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2077"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679176697"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-2078"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-2079"></span><span>        </span><span id="local-6989586621679176697"><span class="annot"><span class="annottext">d :: p
</span><a href="#local-6989586621679176697"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679176700"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679176699"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-2080"></span><span>
</span><span id="line-2081"></span><span>    </span><span id="local-6989586621679176747"><span class="annot"><span class="annottext">go :: (Spec fn a, Spec fn a) -&gt; Maybe (Spec fn a, Spec fn a)
</span><a href="#local-6989586621679176747"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679176695"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176695"><span class="hs-identifier hs-var">elemS</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679176694"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176694"><span class="hs-identifier hs-var">foldS</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2082"></span><span>      </span><span class="hs-comment">-- There is nothing we can do</span><span>
</span><span id="line-2083"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176754"><span class="hs-identifier hs-var">fuel</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2084"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679176753"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2085"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-operator hs-var">`conformsToSpec`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176695"><span class="hs-identifier hs-var">elemS</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2086"></span><span>          </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176695"><span class="hs-identifier hs-var">elemS</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#notEqualSpec"><span class="hs-identifier hs-var">notEqualSpec</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176694"><span class="hs-identifier hs-var">foldS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2087"></span><span>      </span><span class="hs-comment">-- The lower bound on the number of elements is too low</span><span>
</span><span id="line-2088"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679176693"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176693"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(TypeSpec fn a ~ NumSpec a, Ord a, Enum a, Num a,
 MaybeBounded a) =&gt;
Spec fn a -&gt; Maybe a
</span><a href="Constrained.Base.html#knownLowerBound"><span class="hs-identifier hs-var">knownLowerBound</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176695"><span class="hs-identifier hs-var">elemS</span></a></span><span>
</span><span id="line-2089"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176693"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2090"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679176691"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176691"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(TypeSpec fn a ~ NumSpec a, Ord a, Enum a, Num a,
 MaybeBounded a) =&gt;
Spec fn a -&gt; Maybe a
</span><a href="Constrained.Base.html#knownLowerBound"><span class="hs-identifier hs-var">knownLowerBound</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176694"><span class="hs-identifier hs-var">foldS</span></a></span><span>
</span><span id="line-2091"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176691"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2092"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679176690"><span class="annot"><span class="annottext">c :: a
</span><a href="#local-6989586621679176690"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679176701"><span class="hs-identifier hs-var">divCeil</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176691"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176754"><span class="hs-identifier hs-var">fuel</span></a></span><span>
</span><span id="line-2093"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176693"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176690"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2094"></span><span>          </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176695"><span class="hs-identifier hs-var">elemS</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. OrdLike fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#geqSpec"><span class="hs-identifier hs-var">geqSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182207"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176690"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176694"><span class="hs-identifier hs-var">foldS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2095"></span><span>      </span><span class="hs-comment">-- The upper bound on the number of elements is too high</span><span>
</span><span id="line-2096"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679176688"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176688"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(TypeSpec fn a ~ NumSpec a, Ord a, Enum a, Num a,
 MaybeBounded a) =&gt;
Spec fn a -&gt; Maybe a
</span><a href="Constrained.Base.html#knownUpperBound"><span class="hs-identifier hs-var">knownUpperBound</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176695"><span class="hs-identifier hs-var">elemS</span></a></span><span>
</span><span id="line-2097"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176688"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2098"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679176687"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176687"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(TypeSpec fn a ~ NumSpec a, Ord a, Enum a, Num a,
 MaybeBounded a) =&gt;
Spec fn a -&gt; Maybe a
</span><a href="Constrained.Base.html#knownUpperBound"><span class="hs-identifier hs-var">knownUpperBound</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176694"><span class="hs-identifier hs-var">foldS</span></a></span><span>
</span><span id="line-2099"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176687"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2100"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679176686"><span class="annot"><span class="annottext">c :: a
</span><a href="#local-6989586621679176686"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679176701"><span class="hs-identifier hs-var">divCeil</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {p}. (MaybeBounded p, Ord p, Num p) =&gt; p -&gt; p
</span><a href="#local-6989586621679176714"><span class="hs-identifier hs-var">safeNegate</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176687"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176754"><span class="hs-identifier hs-var">fuel</span></a></span><span>
</span><span id="line-2101"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">negate</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176686"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176688"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2102"></span><span>          </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176695"><span class="hs-identifier hs-var">elemS</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. OrdLike fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#leqSpec"><span class="hs-identifier hs-var">leqSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182207"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176686"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176694"><span class="hs-identifier hs-var">foldS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2103"></span><span>      </span><span class="hs-comment">-- It's time to stop generating negative numbers</span><span>
</span><span id="line-2104"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679176684"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176684"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(TypeSpec fn a ~ NumSpec a, Ord a, Enum a, Num a,
 MaybeBounded a) =&gt;
Spec fn a -&gt; Maybe a
</span><a href="Constrained.Base.html#knownLowerBound"><span class="hs-identifier hs-var">knownLowerBound</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176694"><span class="hs-identifier hs-var">foldS</span></a></span><span>
</span><span id="line-2105"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176684"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2106"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679176683"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176683"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(TypeSpec fn a ~ NumSpec a, Ord a, Enum a, Num a,
 MaybeBounded a) =&gt;
Spec fn a -&gt; Maybe a
</span><a href="Constrained.Base.html#knownUpperBound"><span class="hs-identifier hs-var">knownUpperBound</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176695"><span class="hs-identifier hs-var">elemS</span></a></span><span>
</span><span id="line-2107"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176683"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2108"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {t} {t}. (Num t, Num t, Ord t, Ord t) =&gt; t -&gt; t -&gt; t -&gt; Bool
</span><a href="#local-6989586621679176727"><span class="hs-identifier hs-var">canReach</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176683"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176754"><span class="hs-identifier hs-var">fuel</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176684"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-2109"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(TypeSpec fn a ~ NumSpec a, Ord a, Enum a, Num a,
 MaybeBounded a) =&gt;
Spec fn a -&gt; Maybe a
</span><a href="Constrained.Base.html#knownLowerBound"><span class="hs-identifier hs-var">knownLowerBound</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176695"><span class="hs-identifier hs-var">elemS</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2110"></span><span>          </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176695"><span class="hs-identifier hs-var">elemS</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. OrdLike fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#gtSpec"><span class="hs-identifier hs-var">gtSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182207"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176694"><span class="hs-identifier hs-var">foldS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2111"></span><span>      </span><span class="hs-comment">-- It's time to stop generating positive numbers</span><span>
</span><span id="line-2112"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679176680"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176680"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(TypeSpec fn a ~ NumSpec a, Ord a, Enum a, Num a,
 MaybeBounded a) =&gt;
Spec fn a -&gt; Maybe a
</span><a href="Constrained.Base.html#knownUpperBound"><span class="hs-identifier hs-var">knownUpperBound</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176694"><span class="hs-identifier hs-var">foldS</span></a></span><span>
</span><span id="line-2113"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176680"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2114"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679176679"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176679"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(TypeSpec fn a ~ NumSpec a, Ord a, Enum a, Num a,
 MaybeBounded a) =&gt;
Spec fn a -&gt; Maybe a
</span><a href="Constrained.Base.html#knownLowerBound"><span class="hs-identifier hs-var">knownLowerBound</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176695"><span class="hs-identifier hs-var">elemS</span></a></span><span>
</span><span id="line-2115"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176679"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2116"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {t} {t}. (Num t, Num t, Ord t, Ord t) =&gt; t -&gt; t -&gt; t -&gt; Bool
</span><a href="#local-6989586621679176727"><span class="hs-identifier hs-var">canReach</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {p}. (MaybeBounded p, Ord p, Num p) =&gt; p -&gt; p
</span><a href="#local-6989586621679176714"><span class="hs-identifier hs-var">safeNegate</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176679"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176754"><span class="hs-identifier hs-var">fuel</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {p}. (MaybeBounded p, Ord p, Num p) =&gt; p -&gt; p
</span><a href="#local-6989586621679176714"><span class="hs-identifier hs-var">safeNegate</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176680"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2117"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(TypeSpec fn a ~ NumSpec a, Ord a, Enum a, Num a,
 MaybeBounded a) =&gt;
Spec fn a -&gt; Maybe a
</span><a href="Constrained.Base.html#knownLowerBound"><span class="hs-identifier hs-var">knownLowerBound</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176695"><span class="hs-identifier hs-var">elemS</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2118"></span><span>          </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176695"><span class="hs-identifier hs-var">elemS</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. OrdLike fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#gtSpec"><span class="hs-identifier hs-var">gtSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182207"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176694"><span class="hs-identifier hs-var">foldS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2119"></span><span>      </span><span class="hs-comment">-- We HAVE to set the lower bound to the lower</span><span>
</span><span id="line-2120"></span><span>      </span><span class="hs-comment">-- bound on the sum</span><span>
</span><span id="line-2121"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679176678"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176678"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(TypeSpec fn a ~ NumSpec a, Ord a, Enum a, Num a,
 MaybeBounded a) =&gt;
Spec fn a -&gt; Maybe a
</span><a href="Constrained.Base.html#knownLowerBound"><span class="hs-identifier hs-var">knownLowerBound</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176694"><span class="hs-identifier hs-var">foldS</span></a></span><span>
</span><span id="line-2122"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176754"><span class="hs-identifier hs-var">fuel</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2123"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176678"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-operator hs-var">`conformsToSpec`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176695"><span class="hs-identifier hs-var">elemS</span></a></span><span>
</span><span id="line-2124"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176678"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(TypeSpec fn a ~ NumSpec a, Ord a, Enum a, Num a,
 MaybeBounded a) =&gt;
Spec fn a -&gt; Maybe a
</span><a href="Constrained.Base.html#knownLowerBound"><span class="hs-identifier hs-var">knownLowerBound</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176695"><span class="hs-identifier hs-var">elemS</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2125"></span><span>          </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176695"><span class="hs-identifier hs-var">elemS</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. OrdLike fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#geqSpec"><span class="hs-identifier hs-var">geqSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182207"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176678"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176694"><span class="hs-identifier hs-var">foldS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2126"></span><span>      </span><span class="hs-comment">-- There is nothing we need to do</span><span>
</span><span id="line-2127"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2128"></span><span>
</span><span id="line-2129"></span><span class="annot"><a href="Constrained.Base.html#narrowFoldSpecs"><span class="hs-identifier hs-type">narrowFoldSpecs</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-2130"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182196"><span class="annot"><a href="#local-6989586621679182196"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679182197"><span class="annot"><a href="#local-6989586621679182197"><span class="hs-identifier hs-type">fn</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-2131"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182197"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-2132"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182197"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182196"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182196"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2133"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182197"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182196"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2134"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-a65fd1c4eb4ae76375c6e3f3845a1ba912285f018239b330ae730fef533366f9/share/doc/html/src"><span class="hs-identifier hs-type">Arbitrary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182196"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2135"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182196"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2136"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182196"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2137"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/random-1.2.1.1-97d351bf97dd57637441798736e25556058018a1de673671ce7fdce6e47d0d77/share/doc/html/src"><span class="hs-identifier hs-type">Random</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182196"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2138"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#MaybeBounded"><span class="hs-identifier hs-type">MaybeBounded</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182196"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2139"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-2140"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182197"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182196"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182197"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182196"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2141"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182197"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182196"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182197"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182196"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2142"></span><span id="narrowFoldSpecs"><span class="annot"><span class="annottext">narrowFoldSpecs :: forall a (fn :: [*] -&gt; * -&gt; *).
(BaseUniverse fn, TypeSpec fn a ~ NumSpec a, HasSpec fn a,
 Arbitrary a, Integral a, Ord a, Random a, MaybeBounded a) =&gt;
(Spec fn a, Spec fn a) -&gt; (Spec fn a, Spec fn a)
</span><a href="Constrained.Base.html#narrowFoldSpecs"><span class="hs-identifier hs-var hs-var">narrowFoldSpecs</span></a></span></span><span> </span><span id="local-6989586621679176648"><span class="annot"><span class="annottext">(Spec fn a, Spec fn a)
</span><a href="#local-6989586621679176648"><span class="hs-identifier hs-var">specs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">(Spec fn a, Spec fn a)
</span><a href="#local-6989586621679176648"><span class="hs-identifier hs-var">specs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(BaseUniverse fn, TypeSpec fn a ~ NumSpec a, HasSpec fn a,
 Arbitrary a, Integral a, Ord a, Random a, MaybeBounded a) =&gt;
(Spec fn a, Spec fn a) -&gt; (Spec fn a, Spec fn a)
</span><a href="Constrained.Base.html#narrowFoldSpecs"><span class="hs-identifier hs-var">narrowFoldSpecs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {fn :: [*] -&gt; * -&gt; *} {a} {fn :: [*] -&gt; * -&gt; *}.
(TypeSpec fn a ~ NumSpec a, TypeSpec fn a ~ NumSpec a, Ord a,
 Enum a, Num a, MaybeBounded a, HasSpec fn a, HasSpec fn a) =&gt;
(Spec fn a, Spec fn a) -&gt; Maybe (Spec fn a, Spec fn a)
</span><a href="#local-6989586621679176647"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(Spec fn a, Spec fn a)
</span><a href="#local-6989586621679176648"><span class="hs-identifier hs-var">specs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2143"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2144"></span><span>    </span><span class="hs-comment">-- Note: make sure there is some progress when returning Just or this will loop forever</span><span>
</span><span id="line-2145"></span><span>    </span><span id="local-6989586621679176647"><span class="annot"><span class="annottext">go :: (Spec fn a, Spec fn a) -&gt; Maybe (Spec fn a, Spec fn a)
</span><a href="#local-6989586621679176647"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679176552"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176552"><span class="hs-identifier hs-var">elemS</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679176551"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176551"><span class="hs-identifier hs-var">foldS</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176552"><span class="hs-identifier hs-var">elemS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176551"><span class="hs-identifier hs-var">foldS</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2146"></span><span>      </span><span class="hs-comment">-- Empty foldSpec</span><span>
</span><span id="line-2147"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Spec fn a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2148"></span><span>      </span><span class="annot"><span class="annottext">(Spec fn a, Spec fn a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(TypeSpec fn a ~ NumSpec a, Ord a, Enum a, Num a,
 MaybeBounded a) =&gt;
Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#isEmptyNumSpec"><span class="hs-identifier hs-var">isEmptyNumSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176551"><span class="hs-identifier hs-var">foldS</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176552"><span class="hs-identifier hs-var">elemS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Empty foldSpec:&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176551"><span class="hs-identifier hs-var">foldS</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2149"></span><span>      </span><span class="hs-comment">-- Empty elemSpec</span><span>
</span><span id="line-2150"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2151"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-2152"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-operator hs-var">`conformsToSpec`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176551"><span class="hs-identifier hs-var">foldS</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176552"><span class="hs-identifier hs-var">elemS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-var">MemberSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2153"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2154"></span><span>            </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span>
</span><span id="line-2155"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176552"><span class="hs-identifier hs-var">elemS</span></a></span><span>
</span><span id="line-2156"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span>
</span><span id="line-2157"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Empty elemSpec and non-zero foldSpec&quot;</span></span><span>
</span><span id="line-2158"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. Int -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any
</span><span class="hs-string">&quot;elemSpec =&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="Constrained.Base.html#%2F%3E"><span class="hs-operator hs-var">/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176552"><span class="hs-identifier hs-var">elemS</span></a></span><span>
</span><span id="line-2159"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. Int -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any
</span><span class="hs-string">&quot;foldSpec =&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="Constrained.Base.html#%2F%3E"><span class="hs-operator hs-var">/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176551"><span class="hs-identifier hs-var">foldS</span></a></span><span>
</span><span id="line-2160"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-2161"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-2162"></span><span>      </span><span class="hs-comment">-- We can reduce the size of the `elemS` interval when it is</span><span>
</span><span id="line-2163"></span><span>      </span><span class="hs-comment">-- `[l, u]` or `[l, &#8734;)` given that `0 &lt;= l` and we have</span><span>
</span><span id="line-2164"></span><span>      </span><span class="hs-comment">-- an upper bound on the sum - we can't pick things bigger than the</span><span>
</span><span id="line-2165"></span><span>      </span><span class="hs-comment">-- upper bound.</span><span>
</span><span id="line-2166"></span><span>      </span><span class="annot"><span class="annottext">(Spec fn a, Spec fn a)
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-2167"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679176548"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176548"><span class="hs-identifier hs-var">lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(TypeSpec fn a ~ NumSpec a, Ord a, Enum a, Num a,
 MaybeBounded a) =&gt;
Spec fn a -&gt; Maybe a
</span><a href="Constrained.Base.html#knownLowerBound"><span class="hs-identifier hs-var">knownLowerBound</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176552"><span class="hs-identifier hs-var">elemS</span></a></span><span>
</span><span id="line-2168"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176548"><span class="hs-identifier hs-var">lo</span></a></span><span>
</span><span id="line-2169"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679176547"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176547"><span class="hs-identifier hs-var">hi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(TypeSpec fn a ~ NumSpec a, Ord a, Enum a, Num a,
 MaybeBounded a) =&gt;
Spec fn a -&gt; Maybe a
</span><a href="Constrained.Base.html#knownUpperBound"><span class="hs-identifier hs-var">knownUpperBound</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176551"><span class="hs-identifier hs-var">foldS</span></a></span><span>
</span><span id="line-2170"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- Check that we will actually be making the set smaller</span><span>
</span><span id="line-2171"></span><span>          </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176547"><span class="hs-identifier hs-var">hi</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(TypeSpec fn a ~ NumSpec a, Ord a, Enum a, Num a,
 MaybeBounded a) =&gt;
Spec fn a -&gt; Maybe a
</span><a href="Constrained.Base.html#knownUpperBound"><span class="hs-identifier hs-var">knownUpperBound</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176552"><span class="hs-identifier hs-var">elemS</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2172"></span><span>            </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176552"><span class="hs-identifier hs-var">elemS</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall n. Maybe n -&gt; Maybe n -&gt; NumSpec n
</span><a href="Constrained.Base.html#NumSpecInterval"><span class="hs-identifier hs-var">NumSpecInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176548"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176547"><span class="hs-identifier hs-var">hi</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176551"><span class="hs-identifier hs-var">foldS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2173"></span><span>      </span><span class="hs-comment">-- We can reduce the size of the foldS set by bumping the lower bound when</span><span>
</span><span id="line-2174"></span><span>      </span><span class="hs-comment">-- there is a positive lower bound on the elemS, we can't generate things smaller</span><span>
</span><span id="line-2175"></span><span>      </span><span class="hs-comment">-- than the lower bound on `elemS`.</span><span>
</span><span id="line-2176"></span><span>      </span><span class="annot"><span class="annottext">(Spec fn a, Spec fn a)
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-2177"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679176546"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176546"><span class="hs-identifier hs-var">lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(TypeSpec fn a ~ NumSpec a, Ord a, Enum a, Num a,
 MaybeBounded a) =&gt;
Spec fn a -&gt; Maybe a
</span><a href="Constrained.Base.html#knownLowerBound"><span class="hs-identifier hs-var">knownLowerBound</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176552"><span class="hs-identifier hs-var">elemS</span></a></span><span>
</span><span id="line-2178"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176546"><span class="hs-identifier hs-var">lo</span></a></span><span>
</span><span id="line-2179"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-operator hs-var">`conformsToSpec`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176551"><span class="hs-identifier hs-var">foldS</span></a></span><span>
</span><span id="line-2180"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- Check that we will actually be making the set smaller</span><span>
</span><span id="line-2181"></span><span>          </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176546"><span class="hs-identifier hs-var">lo</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(TypeSpec fn a ~ NumSpec a, Ord a, Enum a, Num a,
 MaybeBounded a) =&gt;
Spec fn a -&gt; Maybe a
</span><a href="Constrained.Base.html#knownLowerBound"><span class="hs-identifier hs-var">knownLowerBound</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176551"><span class="hs-identifier hs-var">foldS</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2182"></span><span>            </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176552"><span class="hs-identifier hs-var">elemS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176551"><span class="hs-identifier hs-var">foldS</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall n. Maybe n -&gt; Maybe n -&gt; NumSpec n
</span><a href="Constrained.Base.html#NumSpecInterval"><span class="hs-identifier hs-var">NumSpecInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176546"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2183"></span><span>      </span><span class="hs-comment">-- NOTE: this is far from sufficient, but it's good enough of an approximation</span><span>
</span><span id="line-2184"></span><span>      </span><span class="hs-comment">-- to avoid the worst failures.</span><span>
</span><span id="line-2185"></span><span>      </span><span class="annot"><span class="annottext">(Spec fn a, Spec fn a)
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-2186"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679176545"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176545"><span class="hs-identifier hs-var">lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(TypeSpec fn a ~ NumSpec a, Ord a, Enum a, Num a,
 MaybeBounded a) =&gt;
Spec fn a -&gt; Maybe a
</span><a href="Constrained.Base.html#knownLowerBound"><span class="hs-identifier hs-var">knownLowerBound</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176552"><span class="hs-identifier hs-var">elemS</span></a></span><span>
</span><span id="line-2187"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679176544"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176544"><span class="hs-identifier hs-var">loS</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(TypeSpec fn a ~ NumSpec a, Ord a, Enum a, Num a,
 MaybeBounded a) =&gt;
Spec fn a -&gt; Maybe a
</span><a href="Constrained.Base.html#knownLowerBound"><span class="hs-identifier hs-var">knownLowerBound</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176551"><span class="hs-identifier hs-var">foldS</span></a></span><span>
</span><span id="line-2188"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679176543"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176543"><span class="hs-identifier hs-var">hi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(TypeSpec fn a ~ NumSpec a, Ord a, Enum a, Num a,
 MaybeBounded a) =&gt;
Spec fn a -&gt; Maybe a
</span><a href="Constrained.Base.html#knownUpperBound"><span class="hs-identifier hs-var">knownUpperBound</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176552"><span class="hs-identifier hs-var">elemS</span></a></span><span>
</span><span id="line-2189"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679176542"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176542"><span class="hs-identifier hs-var">hiS</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(TypeSpec fn a ~ NumSpec a, Ord a, Enum a, Num a,
 MaybeBounded a) =&gt;
Spec fn a -&gt; Maybe a
</span><a href="Constrained.Base.html#knownUpperBound"><span class="hs-identifier hs-var">knownUpperBound</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176551"><span class="hs-identifier hs-var">foldS</span></a></span><span>
</span><span id="line-2190"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176543"><span class="hs-identifier hs-var">hi</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176544"><span class="hs-identifier hs-var">loS</span></a></span><span>
</span><span id="line-2191"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176545"><span class="hs-identifier hs-var">lo</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176542"><span class="hs-identifier hs-var">hiS</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176545"><span class="hs-identifier hs-var">lo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2192"></span><span>            </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Can't solve diophantine equation&quot;</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Can't solve diophantine equation&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2193"></span><span>      </span><span class="annot"><span class="annottext">(Spec fn a, Spec fn a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2194"></span><span>
</span><span id="line-2195"></span><span class="annot"><a href="Constrained.Base.html#genNumList"><span class="hs-identifier hs-type">genNumList</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-2196"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182178"><span class="annot"><a href="#local-6989586621679182178"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679182180"><span class="annot"><a href="#local-6989586621679182180"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679182179"><span class="annot"><a href="#local-6989586621679182179"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-2197"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182180"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-2198"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.GenT.html#MonadGenError"><span class="hs-identifier hs-type">MonadGenError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182179"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-2199"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182180"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182178"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182178"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2200"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182180"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182178"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2201"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-a65fd1c4eb4ae76375c6e3f3845a1ba912285f018239b330ae730fef533366f9/share/doc/html/src"><span class="hs-identifier hs-type">Arbitrary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182178"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2202"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182178"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2203"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182178"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2204"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/random-1.2.1.1-97d351bf97dd57637441798736e25556058018a1de673671ce7fdce6e47d0d77/share/doc/html/src"><span class="hs-identifier hs-type">Random</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182178"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2205"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#MaybeBounded"><span class="hs-identifier hs-type">MaybeBounded</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182178"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2206"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#Foldy"><span class="hs-identifier hs-type">Foldy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182180"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182178"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2207"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-2208"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182180"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182178"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2209"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182180"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182178"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2210"></span><span>  </span><span class="annot"><a href="Constrained.GenT.html#GenT"><span class="hs-identifier hs-type">GenT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182179"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182178"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2211"></span><span id="genNumList"><span class="annot"><span class="annottext">genNumList :: forall a (fn :: [*] -&gt; * -&gt; *) (m :: * -&gt; *).
(BaseUniverse fn, MonadGenError m, TypeSpec fn a ~ NumSpec a,
 HasSpec fn a, Arbitrary a, Integral a, Ord a, Random a,
 MaybeBounded a, Foldy fn a) =&gt;
Spec fn a -&gt; Spec fn a -&gt; GenT m [a]
</span><a href="Constrained.Base.html#genNumList"><span class="hs-identifier hs-var hs-var">genNumList</span></a></span></span><span> </span><span id="local-6989586621679176484"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176484"><span class="hs-identifier hs-var">elemSIn</span></a></span></span><span> </span><span id="local-6989586621679176483"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176483"><span class="hs-identifier hs-var">foldSIn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2212"></span><span>  </span><span id="local-6989586621679176482"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176482"><span class="hs-identifier hs-var">normElemS</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Spec fn a -&gt; GenT m (Spec fn a)
</span><a href="#local-6989586621679176481"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176484"><span class="hs-identifier hs-var">elemSIn</span></a></span><span>
</span><span id="line-2213"></span><span>  </span><span id="local-6989586621679176480"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176480"><span class="hs-identifier hs-var">normFoldS</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Spec fn a -&gt; GenT m (Spec fn a)
</span><a href="#local-6989586621679176481"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176483"><span class="hs-identifier hs-var">foldSIn</span></a></span><span>
</span><span id="line-2214"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a -&gt; m a
</span><a href="Constrained.GenT.html#explain"><span class="hs-identifier hs-var">explain</span></a></span><span>
</span><span id="line-2215"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Can't generate list of ints with fold constraint&quot;</span></span><span>
</span><span id="line-2216"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any
</span><span class="hs-string">&quot;  elemSpec =&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176484"><span class="hs-identifier hs-var">elemSIn</span></a></span><span>
</span><span id="line-2217"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any
</span><span class="hs-string">&quot;  normElemSpec =&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176482"><span class="hs-identifier hs-var">normElemS</span></a></span><span>
</span><span id="line-2218"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any
</span><span class="hs-string">&quot;  foldSpec =&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176483"><span class="hs-identifier hs-var">foldSIn</span></a></span><span>
</span><span id="line-2219"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-2220"></span><span>    </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m' :: * -&gt; *).
MonadGenError m' =&gt;
(Spec fn a, Spec fn a) -&gt; Int -&gt; [a] -&gt; GenT m' [a]
</span><a href="#local-6989586621679176479"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(BaseUniverse fn, TypeSpec fn a ~ NumSpec a, HasSpec fn a,
 Arbitrary a, Integral a, Ord a, Random a, MaybeBounded a) =&gt;
(Spec fn a, Spec fn a) -&gt; (Spec fn a, Spec fn a)
</span><a href="Constrained.Base.html#narrowFoldSpecs"><span class="hs-identifier hs-var">narrowFoldSpecs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176482"><span class="hs-identifier hs-var">normElemS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176480"><span class="hs-identifier hs-var">normFoldS</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">50</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Applicative m =&gt; Gen a -&gt; GenT m a
</span><a href="Constrained.GenT.html#pureGen"><span class="hs-identifier hs-var">pureGen</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Gen [a]
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-a65fd1c4eb4ae76375c6e3f3845a1ba912285f018239b330ae730fef533366f9/share/doc/html/src"><span class="hs-identifier hs-var">shuffle</span></a></span><span>
</span><span id="line-2221"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2222"></span><span>    </span><span id="local-6989586621679176481"><span class="annot"><span class="annottext">normalize :: Spec fn a -&gt; GenT m (Spec fn a)
</span><a href="#local-6989586621679176481"><span class="hs-identifier hs-var hs-var">normalize</span></a></span></span><span> </span><span id="local-6989586621679176477"><span class="annot"><span class="annottext">spec :: Spec fn a
</span><a href="#local-6989586621679176477"><span class="hs-identifier hs-var">spec</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-type">SuspendedSpec</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2223"></span><span>      </span><span id="local-6989586621679176466"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679176466"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Monad m =&gt; GenT m Int
</span><a href="Constrained.GenT.html#sizeT"><span class="hs-identifier hs-var">sizeT</span></a></span><span>
</span><span id="line-2224"></span><span>      </span><span id="local-6989586621679176464"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176464"><span class="hs-identifier hs-var">spec'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {t} {m :: * -&gt; *} {fn :: [*] -&gt; * -&gt; *} {a}
       {fn :: [*] -&gt; * -&gt; *}.
(Num t, MonadGenError m, HasSpec fn a, Ord a, Eq t) =&gt;
Int -&gt; t -&gt; Set a -&gt; Spec fn a -&gt; GenT m (Spec fn a)
</span><a href="#local-6989586621679176463"><span class="hs-identifier hs-var">buildMemberSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679176466"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176477"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-2225"></span><span>      </span><span class="annot"><span class="annottext">Spec fn a -&gt; GenT m (Spec fn a)
</span><a href="#local-6989586621679176481"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176464"><span class="hs-identifier hs-var">spec'</span></a></span><span>
</span><span id="line-2226"></span><span>    </span><span class="annot"><a href="#local-6989586621679176481"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span id="local-6989586621679176462"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176462"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2227"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-2228"></span><span>        </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. OrdLike fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#geqSpec"><span class="hs-identifier hs-var">geqSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182180"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. MaybeBounded a =&gt; Maybe a
</span><a href="Constrained.Base.html#lowerBound"><span class="hs-identifier hs-var">lowerBound</span></a></span><span>
</span><span id="line-2229"></span><span>          </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. OrdLike fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#leqSpec"><span class="hs-identifier hs-var">leqSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182180"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. MaybeBounded a =&gt; Maybe a
</span><a href="Constrained.Base.html#upperBound"><span class="hs-identifier hs-var">upperBound</span></a></span><span>
</span><span id="line-2230"></span><span>          </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176462"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-2231"></span><span>
</span><span id="line-2232"></span><span>    </span><span id="local-6989586621679176463"><span class="annot"><span class="annottext">buildMemberSpec :: Int -&gt; t -&gt; Set a -&gt; Spec fn a -&gt; GenT m (Spec fn a)
</span><a href="#local-6989586621679176463"><span class="hs-identifier hs-var hs-var">buildMemberSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621679176433"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679176433"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-var">MemberSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679176433"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2233"></span><span>    </span><span class="annot"><a href="#local-6989586621679176463"><span class="hs-identifier hs-var">buildMemberSpec</span></a></span><span> </span><span id="local-6989586621679176432"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679176432"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span id="local-6989586621679176431"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679176431"><span class="hs-identifier hs-var">fuel</span></a></span></span><span> </span><span id="local-6989586621679176430"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679176430"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679176429"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176429"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2234"></span><span>      </span><span id="local-6989586621679176428"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679176428"><span class="hs-identifier hs-var">me</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. (Int -&gt; Int) -&gt; GenT m a -&gt; GenT m a
</span><a href="Constrained.GenT.html#scaleT"><span class="hs-identifier hs-var">scaleT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679176432"><span class="hs-identifier hs-var">sz</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
MonadGenError m =&gt;
GenT GE a -&gt; GenT m (Maybe a)
</span><a href="Constrained.GenT.html#tryGen"><span class="hs-identifier hs-var">tryGen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (m :: * -&gt; *).
(HasCallStack, HasSpec fn a, MonadGenError m) =&gt;
Spec fn a -&gt; GenT m a
</span><a href="Constrained.Base.html#genFromSpec"><span class="hs-identifier hs-var">genFromSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176429"><span class="hs-identifier hs-var">spec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2235"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679176425"><span class="annot"><span class="annottext">sz' :: Int
</span><a href="#local-6989586621679176425"><span class="hs-identifier hs-var hs-var">sz'</span></a></span></span><span>
</span><span id="line-2236"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679176432"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679176432"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-2237"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">isNothing</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679176428"><span class="hs-identifier hs-var">me</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679176432"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2238"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679176432"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-2239"></span><span>      </span><span class="annot"><span class="annottext">Int -&gt; t -&gt; Set a -&gt; Spec fn a -&gt; GenT m (Spec fn a)
</span><a href="#local-6989586621679176463"><span class="hs-identifier hs-var">buildMemberSpec</span></a></span><span>
</span><span id="line-2240"></span><span>        </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679176425"><span class="hs-identifier hs-var">sz'</span></a></span><span>
</span><span id="line-2241"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679176431"><span class="hs-identifier hs-var">fuel</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-2242"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679176430"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679176430"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679176428"><span class="hs-identifier hs-var">me</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2243"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176429"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#notEqualSpec"><span class="hs-identifier hs-var">notEqualSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679176428"><span class="hs-identifier hs-var">me</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2244"></span><span>
</span><span id="line-2245"></span><span>    </span><span class="annot"><a href="#local-6989586621679176479"><span class="hs-identifier hs-type">gen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182174"><span class="annot"><a href="#local-6989586621679182174"><span class="hs-identifier hs-type">m'</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.GenT.html#MonadGenError"><span class="hs-identifier hs-type">MonadGenError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182174"><span class="hs-identifier hs-type">m'</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182180"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182178"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182180"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182178"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182178"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.GenT.html#GenT"><span class="hs-identifier hs-type">GenT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182174"><span class="hs-identifier hs-type">m'</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182178"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2246"></span><span>    </span><span id="local-6989586621679176479"><span class="annot"><span class="annottext">gen :: forall (m' :: * -&gt; *).
MonadGenError m' =&gt;
(Spec fn a, Spec fn a) -&gt; Int -&gt; [a] -&gt; GenT m' [a]
</span><a href="#local-6989586621679176479"><span class="hs-identifier hs-var hs-var">gen</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679176394"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176394"><span class="hs-identifier hs-var">elemS</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679176393"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176393"><span class="hs-identifier hs-var">foldS</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679176392"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679176392"><span class="hs-identifier hs-var">fuel</span></a></span></span><span> </span><span id="local-6989586621679176391"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679176391"><span class="hs-identifier hs-var">lst</span></a></span></span><span>
</span><span id="line-2247"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679176392"><span class="hs-identifier hs-var">fuel</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2248"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-operator hs-var">`conformsToSpec`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176393"><span class="hs-identifier hs-var">foldS</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2249"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a
</span><a href="Constrained.GenT.html#genError"><span class="hs-identifier hs-var">genError</span></a></span><span>
</span><span id="line-2250"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Ran out of fuel in genNumList&quot;</span></span><span>
</span><span id="line-2251"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc Any
</span><span class="hs-string">&quot;elemSpec =&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176484"><span class="hs-identifier hs-var">elemSIn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2252"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  foldSpec = &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176483"><span class="hs-identifier hs-var">foldSIn</span></a></span><span>
</span><span id="line-2253"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  lst = &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679176391"><span class="hs-identifier hs-var">lst</span></a></span><span>
</span><span id="line-2254"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-2255"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span id="local-6989586621679176390"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679176390"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176393"><span class="hs-identifier hs-var">foldS</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a
</span><a href="Constrained.GenT.html#genError"><span class="hs-identifier hs-var">genError</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679176390"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-2256"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176394"><span class="hs-identifier hs-var">elemS</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679176391"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="hs-comment">-- At this point we know that foldS admits 0 (also this should be redundant)</span><span>
</span><span id="line-2257"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-operator hs-var">`conformsToSpec`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176393"><span class="hs-identifier hs-var">foldS</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadGenError m =&gt; [GenT GE a] -&gt; GenT m a
</span><a href="Constrained.GenT.html#oneofT"><span class="hs-identifier hs-var">oneofT</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679176391"><span class="hs-identifier hs-var">lst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (m'' :: * -&gt; *). MonadGenError m'' =&gt; GenT m'' [a]
</span><a href="#local-6989586621679176388"><span class="hs-identifier hs-var">nonemptyList</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Constrained.GenT.html#GE"><span class="hs-identifier hs-type">GE</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- TODO: distribution</span><span>
</span><span id="line-2258"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m'' :: * -&gt; *). MonadGenError m'' =&gt; GenT m'' [a]
</span><a href="#local-6989586621679176388"><span class="hs-identifier hs-var">nonemptyList</span></a></span><span>
</span><span id="line-2259"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-2260"></span><span>        </span><span id="local-6989586621679176362"><span class="annot"><span class="annottext">isUnsat :: (Spec fn a, Spec fn a) -&gt; Bool
</span><a href="#local-6989586621679176362"><span class="hs-identifier hs-var hs-var">isUnsat</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679176361"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176361"><span class="hs-identifier hs-var">elemS</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679176360"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176360"><span class="hs-identifier hs-var">foldS</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(TypeSpec fn a ~ NumSpec a, Ord a, Enum a, Num a,
 MaybeBounded a) =&gt;
Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#isEmptyNumSpec"><span class="hs-identifier hs-var">isEmptyNumSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176360"><span class="hs-identifier hs-var">foldS</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-operator hs-var">`conformsToSpec`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176360"><span class="hs-identifier hs-var">foldS</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(TypeSpec fn a ~ NumSpec a, Ord a, Enum a, Num a,
 MaybeBounded a) =&gt;
Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#isEmptyNumSpec"><span class="hs-identifier hs-var">isEmptyNumSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176361"><span class="hs-identifier hs-var">elemS</span></a></span><span>
</span><span id="line-2261"></span><span>        </span><span class="annot"><a href="#local-6989586621679176388"><span class="hs-identifier hs-type">nonemptyList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182157"><span class="annot"><a href="#local-6989586621679182157"><span class="hs-identifier hs-type">m''</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.GenT.html#MonadGenError"><span class="hs-identifier hs-type">MonadGenError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182157"><span class="hs-identifier hs-type">m''</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.GenT.html#GenT"><span class="hs-identifier hs-type">GenT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182157"><span class="hs-identifier hs-type">m''</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182178"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2262"></span><span>        </span><span id="local-6989586621679176388"><span class="annot"><span class="annottext">nonemptyList :: forall (m'' :: * -&gt; *). MonadGenError m'' =&gt; GenT m'' [a]
</span><a href="#local-6989586621679176388"><span class="hs-identifier hs-var hs-var">nonemptyList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2263"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679176287"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176287"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679176286"><span class="annot"><span class="annottext">(Spec fn a, Spec fn a)
</span><a href="#local-6989586621679176286"><span class="hs-identifier hs-var">specs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-2264"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a -&gt; m a
</span><a href="Constrained.GenT.html#explain"><span class="hs-identifier hs-var">explain</span></a></span><span>
</span><span id="line-2265"></span><span>              </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Generating an element:&quot;</span></span><span>
</span><span id="line-2266"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  elemS = &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176394"><span class="hs-identifier hs-var">elemS</span></a></span><span>
</span><span id="line-2267"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  foldS = &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176393"><span class="hs-identifier hs-var">foldS</span></a></span><span>
</span><span id="line-2268"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  fuel  = &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679176392"><span class="hs-identifier hs-var">fuel</span></a></span><span>
</span><span id="line-2269"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  lst   = &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679176391"><span class="hs-identifier hs-var">lst</span></a></span><span>
</span><span id="line-2270"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-2271"></span><span>              </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2272"></span><span>                </span><span id="local-6989586621679176285"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679176285"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Monad m =&gt; GenT m Int
</span><a href="Constrained.GenT.html#sizeT"><span class="hs-identifier hs-var">sizeT</span></a></span><span>
</span><span id="line-2273"></span><span>                </span><span id="local-6989586621679176284"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176284"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (m :: * -&gt; *).
(HasCallStack, HasSpec fn a, MonadGenError m) =&gt;
Spec fn a -&gt; GenT m a
</span><a href="Constrained.Base.html#genFromSpec"><span class="hs-identifier hs-var">genFromSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176394"><span class="hs-identifier hs-var">elemS</span></a></span><span>
</span><span id="line-2274"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679176283"><span class="annot"><span class="annottext">foldS' :: Spec fn a
</span><a href="#local-6989586621679176283"><span class="hs-identifier hs-var hs-var">foldS'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: [*] -&gt; * -&gt; *) (fn :: [*] -&gt; * -&gt; *) (as :: [*]) a b.
(Functions f fn, TypeList as, Typeable as, HasSpec fn a,
 All (HasSpec fn) as) =&gt;
f as b -&gt; ListCtx Value as (HOLE a) -&gt; Spec fn b -&gt; Spec fn a
</span><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var">propagateSpecFun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Foldy fn a =&gt; fn '[a, a] a
</span><a href="Constrained.Base.html#theAddFn"><span class="hs-identifier hs-var">theAddFn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182180"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="annot"><span class="annottext">forall (c :: * -&gt; *) a (f :: * -&gt; *) (a :: [*]).
c a -&gt; List f a -&gt; ListCtx f (a : a) c
</span><a href="Constrained.List.html#%3A%3F"><span class="hs-operator hs-var">:?</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; Value a
</span><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-var">Value</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176284"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (a :: k) (a :: [k]).
f a -&gt; List f a -&gt; List f (a : a)
</span><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *). List f '[]
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176393"><span class="hs-identifier hs-var">foldS</span></a></span><span>
</span><span id="line-2275"></span><span>                    </span><span id="local-6989586621679176282"><span class="annot"><span class="annottext">specs' :: (Spec fn a, Spec fn a)
</span><a href="#local-6989586621679176282"><span class="hs-identifier hs-var hs-var">specs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(BaseUniverse fn, TypeSpec fn a ~ NumSpec a, HasSpec fn a,
 Arbitrary a, Integral a, Ord a, Random a, MaybeBounded a) =&gt;
a -&gt; Int -&gt; (Spec fn a, Spec fn a) -&gt; (Spec fn a, Spec fn a)
</span><a href="Constrained.Base.html#narrowByFuelAndSize"><span class="hs-identifier hs-var">narrowByFuelAndSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679176392"><span class="hs-identifier hs-var">fuel</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679176285"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176394"><span class="hs-identifier hs-var">elemS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679176283"><span class="hs-identifier hs-var">foldS'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2276"></span><span>                </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176284"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Spec fn a, Spec fn a)
</span><a href="#local-6989586621679176282"><span class="hs-identifier hs-var">specs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2277"></span><span>                </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
MonadGenError m =&gt;
GenT m a -&gt; (a -&gt; Bool) -&gt; GenT m a
</span><a href="Constrained.GenT.html#suchThatT"><span class="hs-operator hs-var">`suchThatT`</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span>
</span><span id="line-2278"></span><span>                </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall {fn :: [*] -&gt; * -&gt; *} {a} {fn :: [*] -&gt; * -&gt; *} {a}.
(TypeSpec fn a ~ NumSpec a, TypeSpec fn a ~ NumSpec a,
 HasSpec fn a, Ord a, Ord a, Enum a, Enum a, Num a, Num a,
 MaybeBounded a, MaybeBounded a) =&gt;
(Spec fn a, Spec fn a) -&gt; Bool
</span><a href="#local-6989586621679176362"><span class="hs-identifier hs-var">isUnsat</span></a></span><span>
</span><span id="line-2279"></span><span>                </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span>
</span><span id="line-2280"></span><span>          </span><span class="annot"><span class="annottext">forall (m' :: * -&gt; *).
MonadGenError m' =&gt;
(Spec fn a, Spec fn a) -&gt; Int -&gt; [a] -&gt; GenT m' [a]
</span><a href="#local-6989586621679176479"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="annot"><span class="annottext">(Spec fn a, Spec fn a)
</span><a href="#local-6989586621679176286"><span class="hs-identifier hs-var">specs'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679176392"><span class="hs-identifier hs-var">fuel</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679176287"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679176391"><span class="hs-identifier hs-var">lst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2281"></span><span>
</span><span id="line-2282"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182147"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182147"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Foldy"><span class="hs-identifier hs-type">Foldy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182147"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2283"></span><span>  </span><span id="local-6989586621679176257"><span class="annot"><span class="annottext">genList :: forall (m :: * -&gt; *).
(BaseUniverse fn, MonadGenError m) =&gt;
Spec fn Int -&gt; Spec fn Int -&gt; GenT m [Int]
</span><a href="#local-6989586621679176257"><span class="hs-identifier hs-var hs-var hs-var hs-var">genList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) (m :: * -&gt; *).
(BaseUniverse fn, MonadGenError m, TypeSpec fn a ~ NumSpec a,
 HasSpec fn a, Arbitrary a, Integral a, Ord a, Random a,
 MaybeBounded a, Foldy fn a) =&gt;
Spec fn a -&gt; Spec fn a -&gt; GenT m [a]
</span><a href="Constrained.Base.html#genNumList"><span class="hs-identifier hs-var">genNumList</span></a></span><span>
</span><span id="line-2284"></span><span>  </span><span id="local-6989586621679176247"><span class="annot"><span class="annottext">theAddFn :: fn '[Int, Int] Int
</span><a href="#local-6989586621679176247"><span class="hs-identifier hs-var hs-var hs-var hs-var">theAddFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. NumLike fn a =&gt; IntFn fn '[a, a] a
</span><a href="Constrained.Base.html#Add"><span class="hs-identifier hs-var">Add</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182147"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2285"></span><span>  </span><span id="local-6989586621679176245"><span class="annot"><span class="annottext">theZero :: Int
</span><a href="#local-6989586621679176245"><span class="hs-identifier hs-var hs-var hs-var hs-var">theZero</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2286"></span><span>
</span><span id="line-2287"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182140"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182140"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Foldy"><span class="hs-identifier hs-type">Foldy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182140"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2288"></span><span>  </span><span id="local-6989586621679176218"><span class="annot"><span class="annottext">genList :: forall (m :: * -&gt; *).
(BaseUniverse fn, MonadGenError m) =&gt;
Spec fn Integer -&gt; Spec fn Integer -&gt; GenT m [Integer]
</span><a href="#local-6989586621679176218"><span class="hs-identifier hs-var hs-var hs-var hs-var">genList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) (m :: * -&gt; *).
(BaseUniverse fn, MonadGenError m, TypeSpec fn a ~ NumSpec a,
 HasSpec fn a, Arbitrary a, Integral a, Ord a, Random a,
 MaybeBounded a, Foldy fn a) =&gt;
Spec fn a -&gt; Spec fn a -&gt; GenT m [a]
</span><a href="Constrained.Base.html#genNumList"><span class="hs-identifier hs-var">genNumList</span></a></span><span>
</span><span id="line-2289"></span><span>  </span><span id="local-6989586621679176208"><span class="annot"><span class="annottext">theAddFn :: fn '[Integer, Integer] Integer
</span><a href="#local-6989586621679176208"><span class="hs-identifier hs-var hs-var hs-var hs-var">theAddFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. NumLike fn a =&gt; IntFn fn '[a, a] a
</span><a href="Constrained.Base.html#Add"><span class="hs-identifier hs-var">Add</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182140"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2290"></span><span>  </span><span id="local-6989586621679176207"><span class="annot"><span class="annottext">theZero :: Integer
</span><a href="#local-6989586621679176207"><span class="hs-identifier hs-var hs-var hs-var hs-var">theZero</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2291"></span><span>
</span><span id="line-2292"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182137"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182137"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Foldy"><span class="hs-identifier hs-type">Foldy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182137"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int8</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2293"></span><span>  </span><span id="local-6989586621679176181"><span class="annot"><span class="annottext">genList :: forall (m :: * -&gt; *).
(BaseUniverse fn, MonadGenError m) =&gt;
Spec fn Int8 -&gt; Spec fn Int8 -&gt; GenT m [Int8]
</span><a href="#local-6989586621679176181"><span class="hs-identifier hs-var hs-var hs-var hs-var">genList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) (m :: * -&gt; *).
(BaseUniverse fn, MonadGenError m, TypeSpec fn a ~ NumSpec a,
 HasSpec fn a, Arbitrary a, Integral a, Ord a, Random a,
 MaybeBounded a, Foldy fn a) =&gt;
Spec fn a -&gt; Spec fn a -&gt; GenT m [a]
</span><a href="Constrained.Base.html#genNumList"><span class="hs-identifier hs-var">genNumList</span></a></span><span>
</span><span id="line-2294"></span><span>  </span><span id="local-6989586621679176171"><span class="annot"><span class="annottext">theAddFn :: fn '[Int8, Int8] Int8
</span><a href="#local-6989586621679176171"><span class="hs-identifier hs-var hs-var hs-var hs-var">theAddFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. NumLike fn a =&gt; IntFn fn '[a, a] a
</span><a href="Constrained.Base.html#Add"><span class="hs-identifier hs-var">Add</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182137"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2295"></span><span>  </span><span id="local-6989586621679176169"><span class="annot"><span class="annottext">theZero :: Int8
</span><a href="#local-6989586621679176169"><span class="hs-identifier hs-var hs-var hs-var hs-var">theZero</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2296"></span><span>
</span><span id="line-2297"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182134"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182134"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Foldy"><span class="hs-identifier hs-type">Foldy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182134"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int16</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2298"></span><span>  </span><span id="local-6989586621679176143"><span class="annot"><span class="annottext">genList :: forall (m :: * -&gt; *).
(BaseUniverse fn, MonadGenError m) =&gt;
Spec fn Int16 -&gt; Spec fn Int16 -&gt; GenT m [Int16]
</span><a href="#local-6989586621679176143"><span class="hs-identifier hs-var hs-var hs-var hs-var">genList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) (m :: * -&gt; *).
(BaseUniverse fn, MonadGenError m, TypeSpec fn a ~ NumSpec a,
 HasSpec fn a, Arbitrary a, Integral a, Ord a, Random a,
 MaybeBounded a, Foldy fn a) =&gt;
Spec fn a -&gt; Spec fn a -&gt; GenT m [a]
</span><a href="Constrained.Base.html#genNumList"><span class="hs-identifier hs-var">genNumList</span></a></span><span>
</span><span id="line-2299"></span><span>  </span><span id="local-6989586621679176133"><span class="annot"><span class="annottext">theAddFn :: fn '[Int16, Int16] Int16
</span><a href="#local-6989586621679176133"><span class="hs-identifier hs-var hs-var hs-var hs-var">theAddFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. NumLike fn a =&gt; IntFn fn '[a, a] a
</span><a href="Constrained.Base.html#Add"><span class="hs-identifier hs-var">Add</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182134"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2300"></span><span>  </span><span id="local-6989586621679176131"><span class="annot"><span class="annottext">theZero :: Int16
</span><a href="#local-6989586621679176131"><span class="hs-identifier hs-var hs-var hs-var hs-var">theZero</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int16
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2301"></span><span>
</span><span id="line-2302"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182131"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182131"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Foldy"><span class="hs-identifier hs-type">Foldy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182131"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int32</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2303"></span><span>  </span><span id="local-6989586621679176105"><span class="annot"><span class="annottext">genList :: forall (m :: * -&gt; *).
(BaseUniverse fn, MonadGenError m) =&gt;
Spec fn Int32 -&gt; Spec fn Int32 -&gt; GenT m [Int32]
</span><a href="#local-6989586621679176105"><span class="hs-identifier hs-var hs-var hs-var hs-var">genList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) (m :: * -&gt; *).
(BaseUniverse fn, MonadGenError m, TypeSpec fn a ~ NumSpec a,
 HasSpec fn a, Arbitrary a, Integral a, Ord a, Random a,
 MaybeBounded a, Foldy fn a) =&gt;
Spec fn a -&gt; Spec fn a -&gt; GenT m [a]
</span><a href="Constrained.Base.html#genNumList"><span class="hs-identifier hs-var">genNumList</span></a></span><span>
</span><span id="line-2304"></span><span>  </span><span id="local-6989586621679176095"><span class="annot"><span class="annottext">theAddFn :: fn '[Int32, Int32] Int32
</span><a href="#local-6989586621679176095"><span class="hs-identifier hs-var hs-var hs-var hs-var">theAddFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. NumLike fn a =&gt; IntFn fn '[a, a] a
</span><a href="Constrained.Base.html#Add"><span class="hs-identifier hs-var">Add</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182131"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2305"></span><span>  </span><span id="local-6989586621679176093"><span class="annot"><span class="annottext">theZero :: Int32
</span><a href="#local-6989586621679176093"><span class="hs-identifier hs-var hs-var hs-var hs-var">theZero</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2306"></span><span>
</span><span id="line-2307"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182128"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182128"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Foldy"><span class="hs-identifier hs-type">Foldy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182128"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int64</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2308"></span><span>  </span><span id="local-6989586621679176067"><span class="annot"><span class="annottext">genList :: forall (m :: * -&gt; *).
(BaseUniverse fn, MonadGenError m) =&gt;
Spec fn Int64 -&gt; Spec fn Int64 -&gt; GenT m [Int64]
</span><a href="#local-6989586621679176067"><span class="hs-identifier hs-var hs-var hs-var hs-var">genList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) (m :: * -&gt; *).
(BaseUniverse fn, MonadGenError m, TypeSpec fn a ~ NumSpec a,
 HasSpec fn a, Arbitrary a, Integral a, Ord a, Random a,
 MaybeBounded a, Foldy fn a) =&gt;
Spec fn a -&gt; Spec fn a -&gt; GenT m [a]
</span><a href="Constrained.Base.html#genNumList"><span class="hs-identifier hs-var">genNumList</span></a></span><span>
</span><span id="line-2309"></span><span>  </span><span id="local-6989586621679176057"><span class="annot"><span class="annottext">theAddFn :: fn '[Int64, Int64] Int64
</span><a href="#local-6989586621679176057"><span class="hs-identifier hs-var hs-var hs-var hs-var">theAddFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. NumLike fn a =&gt; IntFn fn '[a, a] a
</span><a href="Constrained.Base.html#Add"><span class="hs-identifier hs-var">Add</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182128"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2310"></span><span>  </span><span id="local-6989586621679176055"><span class="annot"><span class="annottext">theZero :: Int64
</span><a href="#local-6989586621679176055"><span class="hs-identifier hs-var hs-var hs-var hs-var">theZero</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2311"></span><span>
</span><span id="line-2312"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182125"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182125"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Foldy"><span class="hs-identifier hs-type">Foldy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182125"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word8</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2313"></span><span>  </span><span id="local-6989586621679176029"><span class="annot"><span class="annottext">genList :: forall (m :: * -&gt; *).
(BaseUniverse fn, MonadGenError m) =&gt;
Spec fn Word8 -&gt; Spec fn Word8 -&gt; GenT m [Word8]
</span><a href="#local-6989586621679176029"><span class="hs-identifier hs-var hs-var hs-var hs-var">genList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) (m :: * -&gt; *).
(BaseUniverse fn, MonadGenError m, TypeSpec fn a ~ NumSpec a,
 HasSpec fn a, Arbitrary a, Integral a, Ord a, Random a,
 MaybeBounded a, Foldy fn a) =&gt;
Spec fn a -&gt; Spec fn a -&gt; GenT m [a]
</span><a href="Constrained.Base.html#genNumList"><span class="hs-identifier hs-var">genNumList</span></a></span><span>
</span><span id="line-2314"></span><span>  </span><span id="local-6989586621679176019"><span class="annot"><span class="annottext">theAddFn :: fn '[Word8, Word8] Word8
</span><a href="#local-6989586621679176019"><span class="hs-identifier hs-var hs-var hs-var hs-var">theAddFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. NumLike fn a =&gt; IntFn fn '[a, a] a
</span><a href="Constrained.Base.html#Add"><span class="hs-identifier hs-var">Add</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182125"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2315"></span><span>  </span><span id="local-6989586621679176017"><span class="annot"><span class="annottext">theZero :: Word8
</span><a href="#local-6989586621679176017"><span class="hs-identifier hs-var hs-var hs-var hs-var">theZero</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2316"></span><span>
</span><span id="line-2317"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182122"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182122"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Foldy"><span class="hs-identifier hs-type">Foldy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182122"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word16</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2318"></span><span>  </span><span id="local-6989586621679175991"><span class="annot"><span class="annottext">genList :: forall (m :: * -&gt; *).
(BaseUniverse fn, MonadGenError m) =&gt;
Spec fn Word16 -&gt; Spec fn Word16 -&gt; GenT m [Word16]
</span><a href="#local-6989586621679175991"><span class="hs-identifier hs-var hs-var hs-var hs-var">genList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) (m :: * -&gt; *).
(BaseUniverse fn, MonadGenError m, TypeSpec fn a ~ NumSpec a,
 HasSpec fn a, Arbitrary a, Integral a, Ord a, Random a,
 MaybeBounded a, Foldy fn a) =&gt;
Spec fn a -&gt; Spec fn a -&gt; GenT m [a]
</span><a href="Constrained.Base.html#genNumList"><span class="hs-identifier hs-var">genNumList</span></a></span><span>
</span><span id="line-2319"></span><span>  </span><span id="local-6989586621679175981"><span class="annot"><span class="annottext">theAddFn :: fn '[Word16, Word16] Word16
</span><a href="#local-6989586621679175981"><span class="hs-identifier hs-var hs-var hs-var hs-var">theAddFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. NumLike fn a =&gt; IntFn fn '[a, a] a
</span><a href="Constrained.Base.html#Add"><span class="hs-identifier hs-var">Add</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182122"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2320"></span><span>  </span><span id="local-6989586621679175979"><span class="annot"><span class="annottext">theZero :: Word16
</span><a href="#local-6989586621679175979"><span class="hs-identifier hs-var hs-var hs-var hs-var">theZero</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2321"></span><span>
</span><span id="line-2322"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182119"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182119"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Foldy"><span class="hs-identifier hs-type">Foldy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182119"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word32</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2323"></span><span>  </span><span id="local-6989586621679175953"><span class="annot"><span class="annottext">genList :: forall (m :: * -&gt; *).
(BaseUniverse fn, MonadGenError m) =&gt;
Spec fn Word32 -&gt; Spec fn Word32 -&gt; GenT m [Word32]
</span><a href="#local-6989586621679175953"><span class="hs-identifier hs-var hs-var hs-var hs-var">genList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) (m :: * -&gt; *).
(BaseUniverse fn, MonadGenError m, TypeSpec fn a ~ NumSpec a,
 HasSpec fn a, Arbitrary a, Integral a, Ord a, Random a,
 MaybeBounded a, Foldy fn a) =&gt;
Spec fn a -&gt; Spec fn a -&gt; GenT m [a]
</span><a href="Constrained.Base.html#genNumList"><span class="hs-identifier hs-var">genNumList</span></a></span><span>
</span><span id="line-2324"></span><span>  </span><span id="local-6989586621679175943"><span class="annot"><span class="annottext">theAddFn :: fn '[Word32, Word32] Word32
</span><a href="#local-6989586621679175943"><span class="hs-identifier hs-var hs-var hs-var hs-var">theAddFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. NumLike fn a =&gt; IntFn fn '[a, a] a
</span><a href="Constrained.Base.html#Add"><span class="hs-identifier hs-var">Add</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182119"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2325"></span><span>  </span><span id="local-6989586621679175941"><span class="annot"><span class="annottext">theZero :: Word32
</span><a href="#local-6989586621679175941"><span class="hs-identifier hs-var hs-var hs-var hs-var">theZero</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2326"></span><span>
</span><span id="line-2327"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182116"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182116"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Foldy"><span class="hs-identifier hs-type">Foldy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182116"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2328"></span><span>  </span><span id="local-6989586621679175915"><span class="annot"><span class="annottext">genList :: forall (m :: * -&gt; *).
(BaseUniverse fn, MonadGenError m) =&gt;
Spec fn Word64 -&gt; Spec fn Word64 -&gt; GenT m [Word64]
</span><a href="#local-6989586621679175915"><span class="hs-identifier hs-var hs-var hs-var hs-var">genList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) (m :: * -&gt; *).
(BaseUniverse fn, MonadGenError m, TypeSpec fn a ~ NumSpec a,
 HasSpec fn a, Arbitrary a, Integral a, Ord a, Random a,
 MaybeBounded a, Foldy fn a) =&gt;
Spec fn a -&gt; Spec fn a -&gt; GenT m [a]
</span><a href="Constrained.Base.html#genNumList"><span class="hs-identifier hs-var">genNumList</span></a></span><span>
</span><span id="line-2329"></span><span>  </span><span id="local-6989586621679175905"><span class="annot"><span class="annottext">theAddFn :: fn '[Word64, Word64] Word64
</span><a href="#local-6989586621679175905"><span class="hs-identifier hs-var hs-var hs-var hs-var">theAddFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. NumLike fn a =&gt; IntFn fn '[a, a] a
</span><a href="Constrained.Base.html#Add"><span class="hs-identifier hs-var">Add</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182116"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2330"></span><span>  </span><span id="local-6989586621679175903"><span class="annot"><span class="annottext">theZero :: Word64
</span><a href="#local-6989586621679175903"><span class="hs-identifier hs-var hs-var hs-var hs-var">theZero</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2331"></span><span>
</span><span id="line-2332"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182113"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182113"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Foldy"><span class="hs-identifier hs-type">Foldy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182113"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Natural</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2333"></span><span>  </span><span id="local-6989586621679175877"><span class="annot"><span class="annottext">genList :: forall (m :: * -&gt; *).
(BaseUniverse fn, MonadGenError m) =&gt;
Spec fn Natural -&gt; Spec fn Natural -&gt; GenT m [Natural]
</span><a href="#local-6989586621679175877"><span class="hs-identifier hs-var hs-var hs-var hs-var">genList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) (m :: * -&gt; *).
(BaseUniverse fn, MonadGenError m, TypeSpec fn a ~ NumSpec a,
 HasSpec fn a, Arbitrary a, Integral a, Ord a, Random a,
 MaybeBounded a, Foldy fn a) =&gt;
Spec fn a -&gt; Spec fn a -&gt; GenT m [a]
</span><a href="Constrained.Base.html#genNumList"><span class="hs-identifier hs-var">genNumList</span></a></span><span>
</span><span id="line-2334"></span><span>  </span><span id="local-6989586621679175867"><span class="annot"><span class="annottext">theAddFn :: fn '[Natural, Natural] Natural
</span><a href="#local-6989586621679175867"><span class="hs-identifier hs-var hs-var hs-var hs-var">theAddFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. NumLike fn a =&gt; IntFn fn '[a, a] a
</span><a href="Constrained.Base.html#Add"><span class="hs-identifier hs-var">Add</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182113"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2335"></span><span>  </span><span id="local-6989586621679175865"><span class="annot"><span class="annottext">theZero :: Natural
</span><a href="#local-6989586621679175865"><span class="hs-identifier hs-var hs-var hs-var hs-var">theZero</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2336"></span><span>
</span><span id="line-2337"></span><span class="annot"><a href="Constrained.Base.html#genFromFold"><span class="hs-identifier hs-type">genFromFold</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-2338"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182111"><span class="annot"><a href="#local-6989586621679182111"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679182110"><span class="annot"><a href="#local-6989586621679182110"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679182108"><span class="annot"><a href="#local-6989586621679182108"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679182109"><span class="annot"><a href="#local-6989586621679182109"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-2339"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.GenT.html#MonadGenError"><span class="hs-identifier hs-type">MonadGenError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182111"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-2340"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#Foldy"><span class="hs-identifier hs-type">Foldy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182110"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182109"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-2341"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182110"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182108"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2342"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-2343"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182108"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2344"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182110"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2345"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182110"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182108"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2346"></span><span>  </span><span class="annot"><a href="#local-6989586621679182110"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182108"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679182109"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2347"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182110"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182109"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2348"></span><span>  </span><span class="annot"><a href="Constrained.GenT.html#GenT"><span class="hs-identifier hs-type">GenT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182111"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182108"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2349"></span><span id="genFromFold"><span class="annot"><span class="annottext">genFromFold :: forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *) a b.
(MonadGenError m, Foldy fn b, HasSpec fn a) =&gt;
[a]
-&gt; Spec fn Int -&gt; Spec fn a -&gt; fn '[a] b -&gt; Spec fn b -&gt; GenT m [a]
</span><a href="Constrained.Base.html#genFromFold"><span class="hs-identifier hs-var hs-var">genFromFold</span></a></span></span><span> </span><span id="local-6989586621679175801"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679175801"><span class="hs-identifier hs-var">must</span></a></span></span><span> </span><span id="local-6989586621679175800"><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679175800"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621679175799"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175799"><span class="hs-identifier hs-var">elemS</span></a></span></span><span> </span><span id="local-6989586621679175798"><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679175798"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679175797"><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175797"><span class="hs-identifier hs-var">foldS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2350"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679175796"><span class="annot"><span class="annottext">elemS' :: Spec fn b
</span><a href="#local-6989586621679175796"><span class="hs-identifier hs-var hs-var">elemS'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
(HasSpec fn a, HasSpec fn b) =&gt;
fn '[a] b -&gt; Spec fn a -&gt; Spec fn b
</span><a href="Constrained.Base.html#mapSpec"><span class="hs-identifier hs-var">mapSpec</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679175798"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175799"><span class="hs-identifier hs-var">elemS</span></a></span><span>
</span><span id="line-2351"></span><span>      </span><span id="local-6989586621679175795"><span class="annot"><span class="annottext">mustVal :: b
</span><a href="#local-6989586621679175795"><span class="hs-identifier hs-var hs-var">mustVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Foldy fn a =&gt; [a] -&gt; a
</span><a href="Constrained.Base.html#adds"><span class="hs-identifier hs-var">adds</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182110"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (as :: [*]) b.
FunctionLike fn =&gt;
fn as b -&gt; FunTy as b
</span><a href="Constrained.Univ.html#sem"><span class="hs-identifier hs-var">sem</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679175798"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679175801"><span class="hs-identifier hs-var">must</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2352"></span><span>      </span><span id="local-6989586621679175794"><span class="annot"><span class="annottext">foldS' :: Spec fn b
</span><a href="#local-6989586621679175794"><span class="hs-identifier hs-var hs-var">foldS'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: [*] -&gt; * -&gt; *) (fn :: [*] -&gt; * -&gt; *) (as :: [*]) a b.
(Functions f fn, TypeList as, Typeable as, HasSpec fn a,
 All (HasSpec fn) as) =&gt;
f as b -&gt; ListCtx Value as (HOLE a) -&gt; Spec fn b -&gt; Spec fn a
</span><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var">propagateSpecFun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Foldy fn a =&gt; fn '[a, a] a
</span><a href="Constrained.Base.html#theAddFn"><span class="hs-identifier hs-var">theAddFn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182110"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="annot"><span class="annottext">forall (c :: * -&gt; *) a (f :: * -&gt; *) (a :: [*]).
c a -&gt; List f a -&gt; ListCtx f (a : a) c
</span><a href="Constrained.List.html#%3A%3F"><span class="hs-operator hs-var">:?</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; Value a
</span><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-var">Value</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679175795"><span class="hs-identifier hs-var">mustVal</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (a :: k) (a :: [k]).
f a -&gt; List f a -&gt; List f (a : a)
</span><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *). List f '[]
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175797"><span class="hs-identifier hs-var">foldS</span></a></span><span>
</span><span id="line-2353"></span><span>  </span><span id="local-6989586621679175793"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679175793"><span class="hs-identifier hs-var">results</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (m :: * -&gt; *).
(Foldy fn a, BaseUniverse fn, MonadGenError m) =&gt;
Spec fn a -&gt; Spec fn a -&gt; GenT m [a]
</span><a href="Constrained.Base.html#genList"><span class="hs-identifier hs-var">genList</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175796"><span class="hs-identifier hs-var">elemS'</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175794"><span class="hs-identifier hs-var">foldS'</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
MonadGenError m =&gt;
GenT m a -&gt; (a -&gt; Bool) -&gt; GenT m a
</span><a href="Constrained.GenT.html#suchThatT"><span class="hs-operator hs-var">`suchThatT`</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679175792"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679175792"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679175792"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-operator hs-var">`conformsToSpec`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679175800"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2354"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a -&gt; m a
</span><a href="Constrained.GenT.html#explain"><span class="hs-identifier hs-var">explain</span></a></span><span>
</span><span id="line-2355"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genInverse&quot;</span></span><span>
</span><span id="line-2356"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  fn = &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679175798"><span class="hs-identifier hs-var">fn</span></a></span><span>
</span><span id="line-2357"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  results = &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679175793"><span class="hs-identifier hs-var">results</span></a></span><span>
</span><span id="line-2358"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any
</span><span class="hs-string">&quot;  elemS =&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175799"><span class="hs-identifier hs-var">elemS</span></a></span><span>
</span><span id="line-2359"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-2360"></span><span>    </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *) a b.
(MonadGenError m, HasSpec fn a, Show b, Functions fn fn) =&gt;
fn '[a] b -&gt; Spec fn a -&gt; b -&gt; GenT m a
</span><a href="Constrained.Base.html#genInverse"><span class="hs-identifier hs-var">genInverse</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679175798"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175799"><span class="hs-identifier hs-var">elemS</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679175793"><span class="hs-identifier hs-var">results</span></a></span><span>
</span><span id="line-2361"></span><span>
</span><span id="line-2362"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-2363"></span><span class="hs-comment">-- Instances of HasSpec</span><span>
</span><span id="line-2364"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-2365"></span><span>
</span><span id="line-2366"></span><span class="hs-comment">-- Bool -------------------------------------------------------------------</span><span>
</span><span id="line-2367"></span><span>
</span><span id="line-2368"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679175771"><span id="local-6989586621679182527"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182527"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182527"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2369"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="TypeSpec"><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span></span><span> </span><span id="local-6989586621679182527"><span class="annot"><a href="#local-6989586621679182527"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2370"></span><span>  </span><span id="local-6989586621679175768"><span class="annot"><span class="annottext">emptySpec :: TypeSpec fn Bool
</span><a href="#local-6989586621679175768"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptySpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2371"></span><span>  </span><span id="local-6989586621679175766"><span class="annot"><span class="annottext">combineSpec :: TypeSpec fn Bool -&gt; TypeSpec fn Bool -&gt; Spec fn Bool
</span><a href="#local-6989586621679175766"><span class="hs-identifier hs-var hs-var hs-var hs-var">combineSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2372"></span><span>  </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679175764"><span class="annot"><span class="annottext">conformsTo :: HasCallStack =&gt; Bool -&gt; TypeSpec fn Bool -&gt; Bool
</span><a href="#local-6989586621679175764"><span class="hs-operator hs-var hs-var hs-var hs-var">`conformsTo`</span></a></span></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-2373"></span><span>  </span><span id="local-6989586621679175756"><span class="annot"><span class="annottext">genFromTypeSpec :: forall (m :: * -&gt; *).
(HasCallStack, MonadGenError m) =&gt;
TypeSpec fn Bool -&gt; GenT m Bool
</span><a href="#local-6989586621679175756"><span class="hs-identifier hs-var hs-var hs-var hs-var">genFromTypeSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Applicative m =&gt; Gen a -&gt; GenT m a
</span><a href="Constrained.GenT.html#pureGen"><span class="hs-identifier hs-var">pureGen</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Arbitrary a =&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-a65fd1c4eb4ae76375c6e3f3845a1ba912285f018239b330ae730fef533366f9/share/doc/html/src"><span class="hs-identifier hs-var">arbitrary</span></a></span><span>
</span><span id="line-2374"></span><span>  </span><span id="local-6989586621679175754"><span class="annot"><span class="annottext">toPreds :: Term fn Bool -&gt; TypeSpec fn Bool -&gt; Pred fn
</span><a href="#local-6989586621679175754"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPreds</span></a></span></span><span> </span><span class="annot"><span class="annottext">Term fn Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span>
</span><span id="line-2375"></span><span>
</span><span id="line-2376"></span><span class="hs-comment">-- Sum --------------------------------------------------------------------</span><span>
</span><span id="line-2377"></span><span>
</span><span id="line-2378"></span><span class="hs-keyword">data</span><span> </span><span id="SumSpec"><span class="annot"><a href="Constrained.Base.html#SumSpec"><span class="hs-identifier hs-var">SumSpec</span></a></span></span><span> </span><span id="local-6989586621679182928"><span class="annot"><a href="#local-6989586621679182928"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679182927"><span class="annot"><a href="#local-6989586621679182927"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679182926"><span class="annot"><a href="#local-6989586621679182926"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SumSpec"><span class="annot"><a href="Constrained.Base.html#SumSpec"><span class="hs-identifier hs-var">SumSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182928"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182927"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182928"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182926"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2379"></span><span>
</span><span id="line-2380"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679175749"><span id="local-6989586621679175751"><span id="local-6989586621679182098"><span id="local-6989586621679182099"><span id="local-6989586621679182100"><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182100"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182099"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182100"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182098"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SumSpec"><span class="hs-identifier hs-type">SumSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182100"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182099"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182098"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2381"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#SumSpec"><span class="hs-identifier hs-type">SumSpec</span></a></span><span> </span><span id="local-6989586621679175746"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175746"><span class="hs-identifier hs-var">sa</span></a></span></span><span> </span><span id="local-6989586621679175745"><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175745"><span class="hs-identifier hs-var">sb</span></a></span></span><span> </span><span id="local-6989586621679175744"><span class="annot"><span class="annottext">&lt;&gt; :: SumSpec fn a b -&gt; SumSpec fn a b -&gt; SumSpec fn a b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#SumSpec"><span class="hs-identifier hs-type">SumSpec</span></a></span><span> </span><span id="local-6989586621679175743"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175743"><span class="hs-identifier hs-var">sa'</span></a></span></span><span> </span><span id="local-6989586621679175742"><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175742"><span class="hs-identifier hs-var">sb'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
Spec fn a -&gt; Spec fn b -&gt; SumSpec fn a b
</span><a href="Constrained.Base.html#SumSpec"><span class="hs-identifier hs-var">SumSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175746"><span class="hs-identifier hs-var">sa</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175743"><span class="hs-identifier hs-var">sa'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175745"><span class="hs-identifier hs-var">sb</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175742"><span class="hs-identifier hs-var">sb'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2382"></span><span>
</span><span id="line-2383"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679175735"><span id="local-6989586621679175737"><span id="local-6989586621679182095"><span id="local-6989586621679182096"><span id="local-6989586621679182097"><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182097"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182096"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182097"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182095"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SumSpec"><span class="hs-identifier hs-type">SumSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182097"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182096"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182095"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2384"></span><span>  </span><span id="local-6989586621679175732"><span class="annot"><span class="annottext">mempty :: SumSpec fn a b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
Spec fn a -&gt; Spec fn b -&gt; SumSpec fn a b
</span><a href="Constrained.Base.html#SumSpec"><span class="hs-identifier hs-var">SumSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-2385"></span><span>
</span><span id="line-2386"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679175711"><span id="local-6989586621679182092"><span id="local-6989586621679182093"><span id="local-6989586621679182094"><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182094"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182093"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182094"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182092"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182094"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182093"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182092"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2387"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="TypeSpec"><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span></span><span> </span><span id="local-6989586621679182092"><span id="local-6989586621679182093"><span id="local-6989586621679182094"><span class="annot"><a href="#local-6989586621679182094"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182093"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182092"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#SumSpec"><span class="hs-identifier hs-type">SumSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182094"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182093"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182092"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-2388"></span><span>
</span><span id="line-2389"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Prerequisites"><span class="annot"><a href="Constrained.Base.html#Prerequisites"><span class="hs-identifier hs-var">Prerequisites</span></a></span></span><span> </span><span id="local-6989586621679182092"><span id="local-6989586621679182093"><span id="local-6989586621679182094"><span class="annot"><a href="#local-6989586621679182094"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182093"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182092"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182094"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182093"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182094"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182092"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2390"></span><span>
</span><span id="line-2391"></span><span>  </span><span id="local-6989586621679175707"><span class="annot"><span class="annottext">emptySpec :: TypeSpec fn (Sum a b)
</span><a href="#local-6989586621679175707"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptySpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-2392"></span><span>
</span><span id="line-2393"></span><span>  </span><span id="local-6989586621679175703"><span class="annot"><span class="annottext">combineSpec :: TypeSpec fn (Sum a b) -&gt; TypeSpec fn (Sum a b) -&gt; Spec fn (Sum a b)
</span><a href="#local-6989586621679175703"><span class="hs-identifier hs-var hs-var hs-var hs-var">combineSpec</span></a></span></span><span> </span><span id="local-6989586621679175702"><span class="annot"><span class="annottext">TypeSpec fn (Sum a b)
</span><a href="#local-6989586621679175702"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679175701"><span class="annot"><span class="annottext">TypeSpec fn (Sum a b)
</span><a href="#local-6989586621679175701"><span class="hs-identifier hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn (Sum a b)
</span><a href="#local-6989586621679175702"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn (Sum a b)
</span><a href="#local-6989586621679175701"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-2394"></span><span>
</span><span id="line-2395"></span><span>  </span><span id="local-6989586621679175697"><span class="annot"><span class="annottext">conformsTo :: HasCallStack =&gt; Sum a b -&gt; TypeSpec fn (Sum a b) -&gt; Bool
</span><a href="#local-6989586621679175697"><span class="hs-identifier hs-var hs-var hs-var hs-var">conformsTo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#SumLeft"><span class="hs-identifier hs-type">SumLeft</span></a></span><span> </span><span id="local-6989586621679175696"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175696"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SumSpec"><span class="hs-identifier hs-type">SumSpec</span></a></span><span> </span><span id="local-6989586621679175695"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175695"><span class="hs-identifier hs-var">sa</span></a></span></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-identifier hs-var">conformsToSpec</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175696"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175695"><span class="hs-identifier hs-var">sa</span></a></span><span>
</span><span id="line-2396"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#conformsTo"><span class="hs-identifier hs-var">conformsTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#SumRight"><span class="hs-identifier hs-type">SumRight</span></a></span><span> </span><span id="local-6989586621679175694"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679175694"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SumSpec"><span class="hs-identifier hs-type">SumSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679175693"><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175693"><span class="hs-identifier hs-var">sb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-identifier hs-var">conformsToSpec</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679175694"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175693"><span class="hs-identifier hs-var">sb</span></a></span><span>
</span><span id="line-2397"></span><span>
</span><span id="line-2398"></span><span>  </span><span id="local-6989586621679175678"><span class="annot"><span class="annottext">genFromTypeSpec :: forall (m :: * -&gt; *).
(HasCallStack, MonadGenError m) =&gt;
TypeSpec fn (Sum a b) -&gt; GenT m (Sum a b)
</span><a href="#local-6989586621679175678"><span class="hs-identifier hs-var hs-var hs-var hs-var">genFromTypeSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SumSpec"><span class="hs-identifier hs-type">SumSpec</span></a></span><span> </span><span id="local-6989586621679175677"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175677"><span class="hs-identifier hs-var">sa</span></a></span></span><span> </span><span id="local-6989586621679175676"><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175676"><span class="hs-identifier hs-var">sb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2399"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadGenError m =&gt; [GenT GE a] -&gt; GenT m a
</span><a href="Constrained.GenT.html#oneofT"><span class="hs-identifier hs-var">oneofT</span></a></span><span>
</span><span id="line-2400"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Sum a b
</span><a href="Constrained.Univ.html#SumLeft"><span class="hs-identifier hs-var">SumLeft</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (m :: * -&gt; *).
(HasCallStack, HasSpec fn a, MonadGenError m) =&gt;
Spec fn a -&gt; GenT m a
</span><a href="Constrained.Base.html#genFromSpec"><span class="hs-identifier hs-var">genFromSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175677"><span class="hs-identifier hs-var">sa</span></a></span><span>
</span><span id="line-2401"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Sum a b
</span><a href="Constrained.Univ.html#SumRight"><span class="hs-identifier hs-var">SumRight</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (m :: * -&gt; *).
(HasCallStack, HasSpec fn a, MonadGenError m) =&gt;
Spec fn a -&gt; GenT m a
</span><a href="Constrained.Base.html#genFromSpec"><span class="hs-identifier hs-var">genFromSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175676"><span class="hs-identifier hs-var">sb</span></a></span><span>
</span><span id="line-2402"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-2403"></span><span>
</span><span id="line-2404"></span><span>  </span><span id="local-6989586621679175664"><span class="annot"><span class="annottext">toPreds :: Term fn (Sum a b) -&gt; TypeSpec fn (Sum a b) -&gt; Pred fn
</span><a href="#local-6989586621679175664"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPreds</span></a></span></span><span> </span><span id="local-6989586621679175663"><span class="annot"><span class="annottext">Term fn (Sum a b)
</span><a href="#local-6989586621679175663"><span class="hs-identifier hs-var">ct</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SumSpec"><span class="hs-identifier hs-type">SumSpec</span></a></span><span> </span><span id="local-6989586621679175662"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175662"><span class="hs-identifier hs-var">sa</span></a></span></span><span> </span><span id="local-6989586621679175661"><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175661"><span class="hs-identifier hs-var">sb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2405"></span><span>    </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (a :: [*]).
HasSpec fn (SumOver a) =&gt;
Term fn (SumOver a) -&gt; List (Binder fn) a -&gt; Pred fn
</span><a href="Constrained.Base.html#Case"><span class="hs-identifier hs-var">Case</span></a></span><span>
</span><span id="line-2406"></span><span>      </span><span class="annot"><span class="annottext">Term fn (Sum a b)
</span><a href="#local-6989586621679175663"><span class="hs-identifier hs-var">ct</span></a></span><span>
</span><span id="line-2407"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a p.
(HasSpec fn a, IsPred p fn) =&gt;
(Term fn a -&gt; p) -&gt; Binder fn a
</span><a href="Constrained.Base.html#bind"><span class="hs-identifier hs-var">bind</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679175659"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679175659"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Spec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#satisfies"><span class="hs-identifier hs-var">satisfies</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679175659"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175662"><span class="hs-identifier hs-var">sa</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2408"></span><span>          </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (a :: k) (a :: [k]).
f a -&gt; List f a -&gt; List f (a : a)
</span><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a p.
(HasSpec fn a, IsPred p fn) =&gt;
(Term fn a -&gt; p) -&gt; Binder fn a
</span><a href="Constrained.Base.html#bind"><span class="hs-identifier hs-var">bind</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679175658"><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679175658"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Spec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#satisfies"><span class="hs-identifier hs-var">satisfies</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679175658"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175661"><span class="hs-identifier hs-var">sb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2409"></span><span>          </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (a :: k) (a :: [k]).
f a -&gt; List f a -&gt; List f (a : a)
</span><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *). List f '[]
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span>
</span><span id="line-2410"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-2411"></span><span>
</span><span id="line-2412"></span><span id="local-6989586621679175649"><span id="local-6989586621679175651"><span id="local-6989586621679175656"><span id="local-6989586621679182089"><span id="local-6989586621679182090"><span id="local-6989586621679182091"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182091"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182090"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182091"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182089"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SumSpec"><span class="hs-identifier hs-type">SumSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182091"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182090"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182089"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-2413"></span><span>
</span><span id="line-2414"></span><span class="hs-comment">-- Sets -------------------------------------------------------------------</span><span>
</span><span id="line-2415"></span><span>
</span><span id="line-2416"></span><span class="hs-keyword">data</span><span> </span><span id="SetSpec"><span class="annot"><a href="Constrained.Base.html#SetSpec"><span class="hs-identifier hs-var">SetSpec</span></a></span></span><span> </span><span id="local-6989586621679182081"><span class="annot"><a href="#local-6989586621679182081"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679182082"><span class="annot"><a href="#local-6989586621679182082"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SetSpec"><span class="annot"><a href="Constrained.Base.html#SetSpec"><span class="hs-identifier hs-var">SetSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182082"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182081"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182082"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182081"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2417"></span><span>
</span><span id="line-2418"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679175643"><span id="local-6989586621679175645"><span id="local-6989586621679182083"><span id="local-6989586621679182084"><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182084"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182083"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182084"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SetSpec"><span class="hs-identifier hs-type">SetSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182083"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182084"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2419"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#SetSpec"><span class="hs-identifier hs-type">SetSpec</span></a></span><span> </span><span id="local-6989586621679175638"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175638"><span class="hs-identifier hs-var">must</span></a></span></span><span> </span><span id="local-6989586621679175637"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175637"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679175636"><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679175636"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621679175635"><span class="annot"><span class="annottext">&lt;&gt; :: SetSpec fn a -&gt; SetSpec fn a -&gt; SetSpec fn a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#SetSpec"><span class="hs-identifier hs-type">SetSpec</span></a></span><span> </span><span id="local-6989586621679175634"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175634"><span class="hs-identifier hs-var">must'</span></a></span></span><span> </span><span id="local-6989586621679175633"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175633"><span class="hs-identifier hs-var">es'</span></a></span></span><span> </span><span id="local-6989586621679175632"><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679175632"><span class="hs-identifier hs-var">size'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2420"></span><span>    </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Set a -&gt; Spec fn a -&gt; Spec fn Int -&gt; SetSpec fn a
</span><a href="Constrained.Base.html#SetSpec"><span class="hs-identifier hs-var">SetSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175638"><span class="hs-identifier hs-var">must</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175634"><span class="hs-identifier hs-var">must'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175637"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175633"><span class="hs-identifier hs-var">es'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679175636"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679175632"><span class="hs-identifier hs-var">size'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2421"></span><span>
</span><span id="line-2422"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679175625"><span id="local-6989586621679175627"><span id="local-6989586621679182079"><span id="local-6989586621679182080"><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182080"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182079"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182080"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SetSpec"><span class="hs-identifier hs-type">SetSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182079"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182080"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2423"></span><span>  </span><span id="local-6989586621679175622"><span class="annot"><span class="annottext">mempty :: SetSpec fn a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Set a -&gt; Spec fn a -&gt; Spec fn Int -&gt; SetSpec fn a
</span><a href="Constrained.Base.html#SetSpec"><span class="hs-identifier hs-var">SetSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span>
</span><span id="line-2424"></span><span>
</span><span id="line-2425"></span><span class="hs-comment">-- NOTE: No guarantees that this is a tight spec!</span><span>
</span><span id="line-2426"></span><span class="annot"><a href="Constrained.Base.html#sizeSpec"><span class="hs-identifier hs-type">sizeSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182077"><span class="annot"><a href="#local-6989586621679182077"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679182078"><span class="annot"><a href="#local-6989586621679182078"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182078"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182077"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182077"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182078"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182077"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-2427"></span><span id="sizeSpec"><span class="annot"><span class="annottext">sizeSpec :: forall (fn :: [*] -&gt; * -&gt; *) a.
(Ord a, BaseUniverse fn) =&gt;
Spec fn (Set a) -&gt; Spec fn Int
</span><a href="Constrained.Base.html#sizeSpec"><span class="hs-identifier hs-var hs-var">sizeSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">Spec fn (Set a)
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span>
</span><span id="line-2428"></span><span class="annot"><a href="Constrained.Base.html#sizeSpec"><span class="hs-identifier hs-var">sizeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span id="local-6989586621679175616"><span class="annot"><span class="annottext">OrdSet (Set a)
</span><a href="#local-6989586621679175616"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-var">MemberSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Set a -&gt; Int
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.size</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet (Set a)
</span><a href="#local-6989586621679175616"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2429"></span><span class="annot"><a href="Constrained.Base.html#sizeSpec"><span class="hs-identifier hs-var">sizeSpec</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-type">SuspendedSpec</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span>
</span><span id="line-2430"></span><span class="annot"><a href="Constrained.Base.html#sizeSpec"><span class="hs-identifier hs-var">sizeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span id="local-6989586621679175613"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679175613"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679175613"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-2431"></span><span class="annot"><a href="Constrained.Base.html#sizeSpec"><span class="hs-identifier hs-var">sizeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SetSpec"><span class="hs-identifier hs-type">SetSpec</span></a></span><span> </span><span id="local-6989586621679175596"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175596"><span class="hs-identifier hs-var">must</span></a></span></span><span> </span><span id="local-6989586621679175595"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175595"><span class="hs-identifier hs-var">elemSpec</span></a></span></span><span> </span><span id="local-6989586621679175594"><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679175594"><span class="hs-identifier hs-var">sizeSpec</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679175593"><span class="annot"><span class="annottext">OrdSet (Set a)
</span><a href="#local-6989586621679175593"><span class="hs-identifier hs-var">cant</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2432"></span><span>  </span><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679175592"><span class="hs-identifier hs-var">cantSpec</span></a></span><span>
</span><span id="line-2433"></span><span>    </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679175594"><span class="hs-identifier hs-var">sizeSpec</span></a></span><span>
</span><span id="line-2434"></span><span>    </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. OrdLike fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#geqSpec"><span class="hs-identifier hs-var">geqSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182077"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Set a -&gt; Int
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.size</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175596"><span class="hs-identifier hs-var">must</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2435"></span><span>    </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(Eq a, BaseUniverse fn) =&gt;
Spec fn a -&gt; Spec fn Int
</span><a href="Constrained.Base.html#specSizeBound"><span class="hs-identifier hs-var">specSizeBound</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175595"><span class="hs-identifier hs-var">elemSpec</span></a></span><span>
</span><span id="line-2436"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2437"></span><span>    </span><span id="local-6989586621679175592"><span class="annot"><span class="annottext">cantSpec :: Spec fn Int
</span><a href="#local-6989586621679175592"><span class="hs-identifier hs-var hs-var">cantSpec</span></a></span></span><span>
</span><span id="line-2438"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`elem`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet (Set a)
</span><a href="#local-6989586621679175593"><span class="hs-identifier hs-var">cant</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#notEqualSpec"><span class="hs-identifier hs-var">notEqualSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2439"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span>
</span><span id="line-2440"></span><span>
</span><span id="line-2441"></span><span class="annot"><a href="Constrained.Base.html#specSizeBound"><span class="hs-identifier hs-type">specSizeBound</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182072"><span class="annot"><a href="#local-6989586621679182072"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679182073"><span class="annot"><a href="#local-6989586621679182073"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182073"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182072"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182072"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182073"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182072"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-2442"></span><span id="specSizeBound"><span class="annot"><span class="annottext">specSizeBound :: forall (fn :: [*] -&gt; * -&gt; *) a.
(Eq a, BaseUniverse fn) =&gt;
Spec fn a -&gt; Spec fn Int
</span><a href="Constrained.Base.html#specSizeBound"><span class="hs-identifier hs-var hs-var">specSizeBound</span></a></span></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span>
</span><span id="line-2443"></span><span class="annot"><a href="Constrained.Base.html#specSizeBound"><span class="hs-identifier hs-var">specSizeBound</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span id="local-6989586621679175579"><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679175579"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. OrdLike fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#leqSpec"><span class="hs-identifier hs-var">leqSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182072"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">nub</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679175579"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2444"></span><span class="annot"><a href="Constrained.Base.html#specSizeBound"><span class="hs-identifier hs-var">specSizeBound</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). a -&gt; Spec fn a
</span><a href="Constrained.Base.html#equalSpec"><span class="hs-identifier hs-var">equalSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2445"></span><span class="hs-comment">-- NOTE: these are concessions, there is not really a good way to know</span><span>
</span><span id="line-2446"></span><span class="annot"><a href="Constrained.Base.html#specSizeBound"><span class="hs-identifier hs-var">specSizeBound</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span>
</span><span id="line-2447"></span><span class="annot"><a href="Constrained.Base.html#specSizeBound"><span class="hs-identifier hs-var">specSizeBound</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-type">SuspendedSpec</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span>
</span><span id="line-2448"></span><span>
</span><span id="line-2449"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679175557"><span id="local-6989586621679182066"><span id="local-6989586621679182067"><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182067"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182066"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182067"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182066"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182067"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2450"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="TypeSpec"><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span></span><span> </span><span id="local-6989586621679182066"><span id="local-6989586621679182067"><span class="annot"><a href="#local-6989586621679182066"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182067"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#SetSpec"><span class="hs-identifier hs-type">SetSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182066"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182067"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2451"></span><span>
</span><span id="line-2452"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Prerequisites"><span class="annot"><a href="Constrained.Base.html#Prerequisites"><span class="hs-identifier hs-var">Prerequisites</span></a></span></span><span> </span><span id="local-6989586621679182066"><span id="local-6989586621679182067"><span class="annot"><a href="#local-6989586621679182066"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182067"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182066"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182067"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2453"></span><span>
</span><span id="line-2454"></span><span>  </span><span id="local-6989586621679175554"><span class="annot"><span class="annottext">emptySpec :: TypeSpec fn (Set a)
</span><a href="#local-6989586621679175554"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptySpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-2455"></span><span>
</span><span id="line-2456"></span><span>  </span><span class="hs-comment">-- TODO: we need to check conformsTo for musts and elem specs</span><span>
</span><span id="line-2457"></span><span>  </span><span id="local-6989586621679175550"><span class="annot"><span class="annottext">combineSpec :: TypeSpec fn (Set a) -&gt; TypeSpec fn (Set a) -&gt; Spec fn (Set a)
</span><a href="#local-6989586621679175550"><span class="hs-identifier hs-var hs-var hs-var hs-var">combineSpec</span></a></span></span><span> </span><span id="local-6989586621679175549"><span class="annot"><span class="annottext">TypeSpec fn (Set a)
</span><a href="#local-6989586621679175549"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679175548"><span class="annot"><span class="annottext">TypeSpec fn (Set a)
</span><a href="#local-6989586621679175548"><span class="hs-identifier hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn (Set a)
</span><a href="#local-6989586621679175549"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn (Set a)
</span><a href="#local-6989586621679175548"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-2458"></span><span>
</span><span id="line-2459"></span><span>  </span><span id="local-6989586621679175541"><span class="annot"><span class="annottext">conformsTo :: HasCallStack =&gt; Set a -&gt; TypeSpec fn (Set a) -&gt; Bool
</span><a href="#local-6989586621679175541"><span class="hs-identifier hs-var hs-var hs-var hs-var">conformsTo</span></a></span></span><span> </span><span id="local-6989586621679175540"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175540"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SetSpec"><span class="hs-identifier hs-type">SetSpec</span></a></span><span> </span><span id="local-6989586621679175539"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175539"><span class="hs-identifier hs-var">must</span></a></span></span><span> </span><span id="local-6989586621679175538"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175538"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679175537"><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679175537"><span class="hs-identifier hs-var">size</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2460"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">and</span></a></span><span>
</span><span id="line-2461"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; Int
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.size</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175540"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-operator hs-var">`conformsToSpec`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679175537"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-2462"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175539"><span class="hs-identifier hs-var">must</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-operator hs-var">`Set.isSubsetOf`</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175540"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-2463"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-operator hs-var">`conformsToSpec`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175538"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175540"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-2464"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-2465"></span><span>
</span><span id="line-2466"></span><span>  </span><span id="local-6989586621679175493"><span class="annot"><span class="annottext">genFromTypeSpec :: forall (m :: * -&gt; *).
(HasCallStack, MonadGenError m) =&gt;
TypeSpec fn (Set a) -&gt; GenT m (Set a)
</span><a href="#local-6989586621679175493"><span class="hs-identifier hs-var hs-var hs-var hs-var">genFromTypeSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SetSpec"><span class="hs-identifier hs-type">SetSpec</span></a></span><span> </span><span id="local-6989586621679175492"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175492"><span class="hs-identifier hs-var">must</span></a></span></span><span> </span><span id="local-6989586621679175491"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175491"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="annottext">Spec fn Int
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175492"><span class="hs-identifier hs-var">must</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadGenError m =&gt; GenT GE a -&gt; GenT m [a]
</span><a href="Constrained.GenT.html#listOfT"><span class="hs-identifier hs-var">listOfT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (m :: * -&gt; *).
(HasCallStack, HasSpec fn a, MonadGenError m) =&gt;
Spec fn a -&gt; GenT m a
</span><a href="Constrained.Base.html#genFromSpec"><span class="hs-identifier hs-var">genFromSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175491"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2467"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#genFromTypeSpec"><span class="hs-identifier hs-var">genFromTypeSpec</span></a></span><span> </span><span id="local-6989586621679175489"><span class="annot"><span class="annottext">ss :: TypeSpec fn (Set a)
</span><a href="#local-6989586621679175489"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SetSpec"><span class="hs-identifier hs-type">SetSpec</span></a></span><span> </span><span id="local-6989586621679175488"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175488"><span class="hs-identifier hs-var">must</span></a></span></span><span> </span><span id="local-6989586621679175487"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175487"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="annottext">Spec fn Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2468"></span><span>    </span><span class="hs-comment">-- Compute more constrained size spec based on must and elem spec!</span><span>
</span><span id="line-2469"></span><span>    </span><span id="local-6989586621679175486"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679175486"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a -&gt; m a
</span><a href="Constrained.GenT.html#explain"><span class="hs-identifier hs-var">explain</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Generate set size&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (m :: * -&gt; *).
(HasCallStack, HasSpec fn a, MonadGenError m) =&gt;
Spec fn a -&gt; GenT m a
</span><a href="Constrained.Base.html#genFromSpec"><span class="hs-identifier hs-var">genFromSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(Ord a, BaseUniverse fn) =&gt;
Spec fn (Set a) -&gt; Spec fn Int
</span><a href="Constrained.Base.html#sizeSpec"><span class="hs-identifier hs-var">sizeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn (Set a)
</span><a href="#local-6989586621679175489"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
MonadGenError m =&gt;
GenT m a -&gt; (a -&gt; Bool) -&gt; GenT m a
</span><a href="Constrained.GenT.html#suchThatT"><span class="hs-operator hs-var">`suchThatT`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; Int
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.size</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175488"><span class="hs-identifier hs-var">must</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2470"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; Set a -&gt; GenT m (Set a)
</span><a href="#local-6989586621679175485"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679175486"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; Int
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.size</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175488"><span class="hs-identifier hs-var">must</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175488"><span class="hs-identifier hs-var">must</span></a></span><span>
</span><span id="line-2471"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-2472"></span><span>      </span><span id="local-6989586621679175485"><span class="annot"><span class="annottext">go :: Int -&gt; Set a -&gt; GenT m (Set a)
</span><a href="#local-6989586621679175485"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621679175484"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175484"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175484"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-2473"></span><span>      </span><span class="annot"><a href="#local-6989586621679175485"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679175483"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679175483"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679175482"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175482"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2474"></span><span>        </span><span id="local-6989586621679175481"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175481"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a -&gt; m a
</span><a href="Constrained.GenT.html#explain"><span class="hs-identifier hs-var">explain</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;generate set member&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. GenMode -&gt; GenT m a -&gt; GenT m a
</span><a href="Constrained.GenT.html#withMode"><span class="hs-identifier hs-var">withMode</span></a></span><span> </span><span class="annot"><span class="annottext">GenMode
</span><a href="Constrained.GenT.html#Strict"><span class="hs-identifier hs-var">Strict</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (m :: * -&gt; *).
(HasCallStack, HasSpec fn a, MonadGenError m) =&gt;
Spec fn a -&gt; GenT m a
</span><a href="Constrained.Base.html#genFromSpec"><span class="hs-identifier hs-var">genFromSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175487"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
MonadGenError m =&gt;
GenT m a -&gt; (a -&gt; Bool) -&gt; GenT m a
</span><a href="Constrained.GenT.html#suchThatT"><span class="hs-operator hs-var">`suchThatT`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-operator hs-var">`Set.notMember`</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175482"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2475"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; Set a -&gt; GenT m (Set a)
</span><a href="#local-6989586621679175485"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679175483"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.insert</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175481"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175482"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2476"></span><span>
</span><span id="line-2477"></span><span>  </span><span id="local-6989586621679175456"><span class="annot"><span class="annottext">toPreds :: Term fn (Set a) -&gt; TypeSpec fn (Set a) -&gt; Pred fn
</span><a href="#local-6989586621679175456"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPreds</span></a></span></span><span> </span><span id="local-6989586621679175455"><span class="annot"><span class="annottext">Term fn (Set a)
</span><a href="#local-6989586621679175455"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SetSpec"><span class="hs-identifier hs-type">SetSpec</span></a></span><span> </span><span id="local-6989586621679175454"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175454"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679175453"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175453"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679175452"><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679175452"><span class="hs-identifier hs-var">size</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2478"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
[String] -&gt; Term fn Bool -&gt; Pred fn
</span><a href="Constrained.Base.html#Assert"><span class="hs-identifier hs-var">Assert</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Subset of &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175454"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn a, Ord a) =&gt;
Term fn (Set a) -&gt; Term fn (Set a) -&gt; Term fn Bool
</span><a href="Constrained.Base.html#subset_"><span class="hs-identifier hs-var">subset_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175454"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term fn (Set a)
</span><a href="#local-6989586621679175455"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2479"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall t a (fn :: [*] -&gt; * -&gt; *) p.
(Forallable t a, HasSpec fn t, HasSpec fn a, IsPred p fn) =&gt;
Term fn t -&gt; (Term fn a -&gt; p) -&gt; Pred fn
</span><a href="Constrained.Base.html#forAll"><span class="hs-identifier hs-var">forAll</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (Set a)
</span><a href="#local-6989586621679175455"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679175449"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679175449"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Spec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#satisfies"><span class="hs-identifier hs-var">satisfies</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679175449"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175453"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2480"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Spec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#satisfies"><span class="hs-identifier hs-var">satisfies</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn (Set a), Ord a) =&gt;
Term fn (Set a) -&gt; Term fn Int
</span><a href="Constrained.Base.html#size_"><span class="hs-identifier hs-var">size_</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (Set a)
</span><a href="#local-6989586621679175455"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679175452"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-2481"></span><span>
</span><span id="line-2482"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182057"><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182057"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Forallable"><span class="hs-identifier hs-type">Forallable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182057"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679182057"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2483"></span><span>  </span><span id="local-6989586621679175439"><span class="annot"><span class="annottext">forAllSpec :: forall (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn (Set a), HasSpec fn a, BaseUniverse fn) =&gt;
Spec fn a -&gt; Spec fn (Set a)
</span><a href="#local-6989586621679175439"><span class="hs-identifier hs-var hs-var hs-var hs-var">forAllSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679175438"><span id="local-6989586621679175437"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175437"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679175438"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182057"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2484"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Evidence (Prerequisites fn (Set a))
</span><a href="Constrained.Core.html#Evidence"><span class="hs-identifier hs-var">Evidence</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Evidence (Prerequisites fn a)
</span><a href="Constrained.Base.html#prerequisites"><span class="hs-identifier hs-var">prerequisites</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679175438"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182057"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Set a -&gt; Spec fn a -&gt; Spec fn Int -&gt; SetSpec fn a
</span><a href="Constrained.Base.html#SetSpec"><span class="hs-identifier hs-var">SetSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175437"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span>
</span><span id="line-2485"></span><span>  </span><span id="local-6989586621679175433"><span class="annot"><span class="annottext">forAllToList :: Set a -&gt; [a]
</span><a href="#local-6989586621679175433"><span class="hs-identifier hs-var hs-var hs-var hs-var">forAllToList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.toList</span></a></span><span>
</span><span id="line-2486"></span><span>
</span><span id="line-2487"></span><span id="local-6989586621679175422"><span id="local-6989586621679175424"><span id="local-6989586621679175431"><span id="local-6989586621679182064"><span id="local-6989586621679182065"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182065"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182064"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SetSpec"><span class="hs-identifier hs-type">SetSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182065"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182064"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-2488"></span><span>
</span><span id="line-2489"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182044"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182044"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Functions"><span class="hs-identifier hs-type">Functions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#SetFn"><span class="hs-identifier hs-type">SetFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182044"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679182044"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2490"></span><span>  </span><span id="local-6989586621679175398"><span class="annot"><span class="annottext">propagateSpecFun :: forall (as :: [*]) a b.
(TypeList as, Typeable as, HasSpec fn a, All (HasSpec fn) as) =&gt;
SetFn fn as b
-&gt; ListCtx Value as (HOLE a) -&gt; Spec fn b -&gt; Spec fn a
</span><a href="#local-6989586621679175398"><span class="hs-identifier hs-var hs-var hs-var hs-var">propagateSpecFun</span></a></span></span><span> </span><span class="annot"><span class="annottext">SetFn fn as b
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span>
</span><span id="line-2491"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var">propagateSpecFun</span></a></span><span> </span><span class="annot"><span class="annottext">SetFn fn as b
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span id="local-6989586621679175397"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679175397"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679175397"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-2492"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var">propagateSpecFun</span></a></span><span> </span><span id="local-6989586621679175396"><span class="annot"><span class="annottext">SetFn fn as b
</span><a href="#local-6989586621679175396"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679175395"><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679175395"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679175394"><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175394"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SetFn fn as b
</span><a href="#local-6989586621679175396"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2493"></span><span>    </span><span class="annot"><span class="annottext">SetFn fn as b
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-2494"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-type">SuspendedSpec</span></a></span><span> </span><span id="local-6989586621679175392"><span class="annot"><span class="annottext">Var b
</span><a href="#local-6989586621679175392"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679175391"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679175391"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175394"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-2495"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.List.html#ListCtx"><span class="hs-identifier hs-type">ListCtx</span></a></span><span> </span><span id="local-6989586621679175387"><span class="annot"><span class="annottext">List Value as
</span><a href="#local-6989586621679175387"><span class="hs-identifier hs-var">pre</span></a></span></span><span> </span><span class="annot"><span class="annottext">HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span id="local-6989586621679175370"><span class="annot"><span class="annottext">List Value as'
</span><a href="#local-6989586621679175370"><span class="hs-identifier hs-var">suf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679175395"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2496"></span><span>          </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) p.
(IsPred p fn, HasSpec fn a) =&gt;
(Term fn a -&gt; p) -&gt; Spec fn a
</span><a href="Constrained.Base.html#constrained"><span class="hs-identifier hs-var">constrained</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679175369"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679175369"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2497"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679175368"><span class="annot"><span class="annottext">args :: List (Term fn) (Append as (a : as'))
</span><a href="#local-6989586621679175368"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2498"></span><span>                  </span><span class="annot"><span class="annottext">forall {a} (f :: a -&gt; *) (as :: [a]) (bs :: [a]).
List f as -&gt; List f bs -&gt; List f (Append as bs)
</span><a href="Constrained.List.html#appendList"><span class="hs-identifier hs-var">appendList</span></a></span><span>
</span><span id="line-2499"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (as :: [k]).
(forall (a :: k). f a -&gt; g a) -&gt; List f as -&gt; List g as
</span><a href="Constrained.List.html#mapList"><span class="hs-identifier hs-var">mapList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679175364"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175364"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175364"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List Value as
</span><a href="#local-6989586621679175387"><span class="hs-identifier hs-var">pre</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2500"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679175369"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (a :: k) (a :: [k]).
f a -&gt; List f a -&gt; List f (a : a)
</span><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (as :: [k]).
(forall (a :: k). f a -&gt; g a) -&gt; List f as -&gt; List g as
</span><a href="Constrained.List.html#mapList"><span class="hs-identifier hs-var">mapList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679175361"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175361"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175361"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List Value as'
</span><a href="#local-6989586621679175370"><span class="hs-identifier hs-var">suf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2501"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (a :: [*]) (fn :: [*] -&gt; * -&gt; *) b.
(Typeable a, TypeList a, All (HasSpec fn) a, HasSpec fn b,
 BaseUniverse fn) =&gt;
fn a b -&gt; List (Term fn) a -&gt; Term fn b
</span><a href="Constrained.Base.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="annot"><span class="annottext">SetFn fn as b
</span><a href="#local-6989586621679175396"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List (Term fn) (Append as (a : as'))
</span><a href="#local-6989586621679175368"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var b
</span><a href="#local-6989586621679175392"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679175391"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2502"></span><span>    </span><span class="annot"><span class="annottext">SetFn fn as b
</span><a href="Constrained.Univ.html#Size"><span class="hs-identifier hs-var">Size</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.List.html#NilCtx"><span class="hs-identifier hs-type">NilCtx</span></a></span><span> </span><span class="annot"><span class="annottext">HOLE a (Set a)
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679175395"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Set a -&gt; Spec fn a -&gt; Spec fn Int -&gt; SetSpec fn a
</span><a href="Constrained.Base.html#SetSpec"><span class="hs-identifier hs-var">SetSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175394"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-2503"></span><span>    </span><span class="annot"><span class="annottext">SetFn fn as b
</span><a href="Constrained.Univ.html#Singleton"><span class="hs-identifier hs-var">Singleton</span></a></span><span>
</span><span id="line-2504"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.List.html#NilCtx"><span class="hs-identifier hs-type">NilCtx</span></a></span><span> </span><span class="annot"><span class="annottext">HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679175395"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2505"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679175340"><span class="annot"><span class="annottext">singletons :: [Set a] -&gt; [Set a]
</span><a href="#local-6989586621679175340"><span class="hs-identifier hs-var hs-var">singletons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; Int
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2506"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175394"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2507"></span><span>                </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SetSpec"><span class="hs-identifier hs-type">SetSpec</span></a></span><span> </span><span id="local-6989586621679175325"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175325"><span class="hs-identifier hs-var">must</span></a></span></span><span> </span><span id="local-6989586621679175324"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175324"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679175323"><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679175323"><span class="hs-identifier hs-var">size</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679175322"><span class="annot"><span class="annottext">OrdSet b
</span><a href="#local-6989586621679175322"><span class="hs-identifier hs-var">cant</span></a></span></span><span>
</span><span id="line-2508"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679175321"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175321"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175325"><span class="hs-identifier hs-var">must</span></a></span><span>
</span><span id="line-2509"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175321"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-operator hs-var">`conformsToSpec`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175324"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-2510"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-operator hs-var">`conformsToSpec`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679175323"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-2511"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175321"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`notElem`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet b
</span><a href="#local-6989586621679175322"><span class="hs-identifier hs-var">cant</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2512"></span><span>                      </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). a -&gt; Spec fn a
</span><a href="Constrained.Base.html#equalSpec"><span class="hs-identifier hs-var">equalSpec</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175321"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-2513"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175325"><span class="hs-identifier hs-var">must</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175324"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (f :: * -&gt; *).
(HasSpec fn a, Foldable f) =&gt;
f a -&gt; Spec fn a
</span><a href="Constrained.Base.html#notMemberSpec"><span class="hs-identifier hs-var">notMemberSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.toList</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a}. [Set a] -&gt; [Set a]
</span><a href="#local-6989586621679175340"><span class="hs-identifier hs-var">singletons</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet b
</span><a href="#local-6989586621679175322"><span class="hs-identifier hs-var">cant</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2514"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;propagateSpecFun Singleton with `must` of size &gt; 1&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-2515"></span><span>                </span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span id="local-6989586621679175320"><span class="annot"><span class="annottext">OrdSet b
</span><a href="#local-6989586621679175320"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-var">MemberSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.toList</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a}. [Set a] -&gt; [Set a]
</span><a href="#local-6989586621679175340"><span class="hs-identifier hs-var">singletons</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet b
</span><a href="#local-6989586621679175320"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2516"></span><span>    </span><span class="annot"><span class="annottext">SetFn fn as b
</span><a href="Constrained.Univ.html#Union"><span class="hs-identifier hs-var">Union</span></a></span><span>
</span><span id="line-2517"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679175303"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175303"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%21"><span class="hs-operator hs-type">:!</span></a></span><span> </span><span class="annot"><a href="Constrained.List.html#NilCtx"><span class="hs-identifier hs-type">NilCtx</span></a></span><span> </span><span class="annot"><span class="annottext">HOLE a (Set a)
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679175395"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: [*] -&gt; * -&gt; *) (fn :: [*] -&gt; * -&gt; *) (as :: [*]) a b.
(Functions f fn, TypeList as, Typeable as, HasSpec fn a,
 All (HasSpec fn) as) =&gt;
f as b -&gt; ListCtx Value as (HOLE a) -&gt; Spec fn b -&gt; Spec fn a
</span><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var">propagateSpecFun</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#SetFn"><span class="hs-identifier hs-type">SetFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182044"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182044"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
Ord a =&gt;
SetFn fn '[Set a, Set a] (Set a)
</span><a href="Constrained.Univ.html#Union"><span class="hs-identifier hs-var">Union</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="annot"><span class="annottext">forall (c :: * -&gt; *) a (f :: * -&gt; *) (a :: [*]).
c a -&gt; List f a -&gt; ListCtx f (a : a) c
</span><a href="Constrained.List.html#%3A%3F"><span class="hs-operator hs-var">:?</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; Value a
</span><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-var">Value</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175303"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (a :: k) (a :: [k]).
f a -&gt; List f a -&gt; List f (a : a)
</span><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *). List f '[]
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175394"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-2518"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3F"><span class="hs-operator hs-type">:?</span></a></span><span> </span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679175279"><span id="local-6989586621679175278"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175278"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679175279"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">List Value as
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679175395"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-2519"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Evidence (Prerequisites fn (Set a))
</span><a href="Constrained.Core.html#Evidence"><span class="hs-identifier hs-var">Evidence</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Evidence (Prerequisites fn a)
</span><a href="Constrained.Base.html#prerequisites"><span class="hs-identifier hs-var">prerequisites</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182044"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679175279"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2520"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175394"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2521"></span><span>            </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SetSpec"><span class="hs-identifier hs-type">SetSpec</span></a></span><span> </span><span id="local-6989586621679175211"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175211"><span class="hs-identifier hs-var">must</span></a></span></span><span> </span><span id="local-6989586621679175210"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175210"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679175209"><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679175209"><span class="hs-identifier hs-var">size</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679175208"><span class="annot"><span class="annottext">OrdSet b
</span><a href="#local-6989586621679175208"><span class="hs-identifier hs-var">cant</span></a></span></span><span>
</span><span id="line-2522"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-operator hs-var">`conformsToSpec`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175210"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175278"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2523"></span><span>                  </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span>
</span><span id="line-2524"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Elements in union argument does not conform to elem spec&quot;</span></span><span>
</span><span id="line-2525"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  spec: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175210"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-2526"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  elems: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-operator hs-var">`conformsToSpec`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175210"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175278"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2527"></span><span>                    </span><span class="hs-special">]</span><span>
</span><span id="line-2528"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet b
</span><a href="#local-6989586621679175208"><span class="hs-identifier hs-var">cant</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;propagateSpecFun Union TypeSpec, not (null cant)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-2529"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Spec fn Int
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679175209"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Set a -&gt; Spec fn a -&gt; Spec fn Int -&gt; SetSpec fn a
</span><a href="Constrained.Base.html#SetSpec"><span class="hs-identifier hs-var">SetSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.difference</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175211"><span class="hs-identifier hs-var">must</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175278"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679175210"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span>
</span><span id="line-2530"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) p.
(IsPred p fn, HasSpec fn a) =&gt;
(Term fn a -&gt; p) -&gt; Spec fn a
</span><a href="Constrained.Base.html#constrained"><span class="hs-identifier hs-var">constrained</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679175206"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679175206"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2531"></span><span>                  </span><span class="annot"><span class="annottext">forall a p (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, IsPred p fn) =&gt;
((forall b. Term fn b -&gt; b) -&gt; GE a) -&gt; (Term fn a -&gt; p) -&gt; Pred fn
</span><a href="Constrained.Base.html#exists"><span class="hs-identifier hs-var">exists</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679175204"><span class="annot"><span class="annottext">forall b. Term fn b -&gt; b
</span><a href="#local-6989586621679175204"><span class="hs-identifier hs-var">eval</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.intersection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b. Term fn b -&gt; b
</span><a href="#local-6989586621679175204"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679175206"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175278"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679175202"><span class="annot"><span class="annottext">Term fn (Set a)
</span><a href="#local-6989586621679175202"><span class="hs-identifier hs-var">overlap</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2532"></span><span>                    </span><span class="annot"><span class="annottext">forall a p (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, IsPred p fn) =&gt;
((forall b. Term fn b -&gt; b) -&gt; GE a) -&gt; (Term fn a -&gt; p) -&gt; Pred fn
</span><a href="Constrained.Base.html#exists"><span class="hs-identifier hs-var">exists</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679175201"><span class="annot"><span class="annottext">forall b. Term fn b -&gt; b
</span><a href="#local-6989586621679175201"><span class="hs-identifier hs-var">eval</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.difference</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b. Term fn b -&gt; b
</span><a href="#local-6989586621679175201"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679175206"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175278"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679175200"><span class="annot"><span class="annottext">Term fn (Set a)
</span><a href="#local-6989586621679175200"><span class="hs-identifier hs-var">disjoint</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2533"></span><span>                      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
p -&gt; Pred fn
</span><a href="Constrained.Base.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (Set a)
</span><a href="#local-6989586621679175202"><span class="hs-identifier hs-var">overlap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn a, Ord a) =&gt;
Term fn (Set a) -&gt; Term fn (Set a) -&gt; Term fn Bool
</span><a href="Constrained.Base.html#subset_"><span class="hs-operator hs-var">`subset_`</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175278"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-2534"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
p -&gt; Pred fn
</span><a href="Constrained.Base.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (Set a)
</span><a href="#local-6989586621679175200"><span class="hs-identifier hs-var">disjoint</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn a, Ord a) =&gt;
Term fn (Set a) -&gt; Term fn (Set a) -&gt; Term fn Bool
</span><a href="Constrained.Base.html#disjoint_"><span class="hs-operator hs-var">`disjoint_`</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175278"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-2535"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Spec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#satisfies"><span class="hs-identifier hs-var">satisfies</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn (Set a), Ord a) =&gt;
Term fn (Set a) -&gt; Term fn Int
</span><a href="Constrained.Base.html#size_"><span class="hs-identifier hs-var">size_</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (Set a)
</span><a href="#local-6989586621679175200"><span class="hs-identifier hs-var">disjoint</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Set a -&gt; Int
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.size</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175278"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679175209"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-2536"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
p -&gt; Pred fn
</span><a href="Constrained.Base.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679175206"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Term fn a -&gt; Term fn Bool
</span><a href="Constrained.Base.html#%3D%3D."><span class="hs-operator hs-var">==.</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (Set a)
</span><a href="#local-6989586621679175202"><span class="hs-identifier hs-var">overlap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (Set a)
</span><a href="#local-6989586621679175200"><span class="hs-identifier hs-var">disjoint</span></a></span><span>
</span><span id="line-2537"></span><span>                      </span><span class="hs-special">]</span><span>
</span><span id="line-2538"></span><span>            </span><span class="hs-comment">-- TODO: shortcut more cases?</span><span>
</span><span id="line-2539"></span><span>            </span><span class="hs-comment">--    Lower bound and |s| &gt;= bound: mempty</span><span>
</span><span id="line-2540"></span><span>            </span><span class="hs-comment">--    Upper bound and |s| == bound: X `subset` s</span><span>
</span><span id="line-2541"></span><span>            </span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679175198"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679175198"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Set a -&gt; Spec fn a -&gt; Spec fn Int -&gt; SetSpec fn a
</span><a href="Constrained.Base.html#SetSpec"><span class="hs-identifier hs-var">SetSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.difference</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679175198"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175278"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-var">MemberSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.toList</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679175198"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2542"></span><span>            </span><span class="hs-comment">-- This risks blowing up too much, don't build sets of sets</span><span>
</span><span id="line-2543"></span><span>            </span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;propagateSpecFun Union MemberSpec&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-2544"></span><span>    </span><span class="annot"><span class="annottext">SetFn fn as b
</span><a href="Constrained.Univ.html#Subset"><span class="hs-identifier hs-var">Subset</span></a></span><span>
</span><span id="line-2545"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3F"><span class="hs-operator hs-type">:?</span></a></span><span> </span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679175176"><span id="local-6989586621679175175"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175175"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679175176"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">List Value as
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679175395"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-2546"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Evidence (Prerequisites fn (Set a))
</span><a href="Constrained.Core.html#Evidence"><span class="hs-identifier hs-var">Evidence</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Evidence (Prerequisites fn a)
</span><a href="Constrained.Base.html#prerequisites"><span class="hs-identifier hs-var">prerequisites</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182044"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679175176"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Spec fn Bool -&gt; (Bool -&gt; Spec fn a) -&gt; Spec fn a
</span><a href="Constrained.Base.html#caseBoolSpec"><span class="hs-identifier hs-var">caseBoolSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175394"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-2547"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Set a -&gt; Spec fn a -&gt; Spec fn Int -&gt; SetSpec fn a
</span><a href="Constrained.Base.html#SetSpec"><span class="hs-identifier hs-var">SetSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-var">MemberSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175175"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-2548"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) p.
(IsPred p fn, HasSpec fn a) =&gt;
(Term fn a -&gt; p) -&gt; Spec fn a
</span><a href="Constrained.Base.html#constrained"><span class="hs-identifier hs-var">constrained</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679175138"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679175138"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2549"></span><span>            </span><span class="annot"><span class="annottext">forall a p (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, IsPred p fn) =&gt;
((forall b. Term fn b -&gt; b) -&gt; GE a) -&gt; (Term fn a -&gt; p) -&gt; Pred fn
</span><a href="Constrained.Base.html#exists"><span class="hs-identifier hs-var">exists</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679175137"><span class="annot"><span class="annottext">forall b. Term fn b -&gt; b
</span><a href="#local-6989586621679175137"><span class="hs-identifier hs-var">eval</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; GE a
</span><a href="Constrained.GenT.html#headGE"><span class="hs-identifier hs-var">headGE</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.difference</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b. Term fn b -&gt; b
</span><a href="#local-6989586621679175137"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679175138"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175175"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679175135"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679175135"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2550"></span><span>              </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679175138"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a a.
(HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; Term fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#DependsOn"><span class="hs-operator hs-var">`DependsOn`</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679175135"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-2551"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
p -&gt; Pred fn
</span><a href="Constrained.Base.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
Term fn Bool -&gt; Term fn Bool
</span><a href="Constrained.Base.html#not_"><span class="hs-identifier hs-var">not_</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, Ord a) =&gt;
Term fn a -&gt; Term fn (Set a) -&gt; Term fn Bool
</span><a href="Constrained.Base.html#member_"><span class="hs-identifier hs-var">member_</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679175135"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175175"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2552"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
p -&gt; Pred fn
</span><a href="Constrained.Base.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, Ord a) =&gt;
Term fn a -&gt; Term fn (Set a) -&gt; Term fn Bool
</span><a href="Constrained.Base.html#member_"><span class="hs-identifier hs-var">member_</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679175135"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679175138"><span class="hs-identifier hs-var">set</span></a></span><span>
</span><span id="line-2553"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-2554"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679175126"><span id="local-6989586621679175125"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175125"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679175126"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%21"><span class="hs-operator hs-type">:!</span></a></span><span> </span><span class="annot"><a href="Constrained.List.html#NilCtx"><span class="hs-identifier hs-type">NilCtx</span></a></span><span> </span><span class="annot"><span class="annottext">HOLE a (Set a)
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679175395"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-2555"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Evidence (Prerequisites fn (Set a))
</span><a href="Constrained.Core.html#Evidence"><span class="hs-identifier hs-var">Evidence</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Evidence (Prerequisites fn a)
</span><a href="Constrained.Base.html#prerequisites"><span class="hs-identifier hs-var">prerequisites</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182044"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679175126"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Spec fn Bool -&gt; (Bool -&gt; Spec fn a) -&gt; Spec fn a
</span><a href="Constrained.Base.html#caseBoolSpec"><span class="hs-identifier hs-var">caseBoolSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175394"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-2556"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Set a -&gt; Spec fn a -&gt; Spec fn Int -&gt; SetSpec fn a
</span><a href="Constrained.Base.html#SetSpec"><span class="hs-identifier hs-var">SetSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175125"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-2557"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) p.
(IsPred p fn, HasSpec fn a) =&gt;
(Term fn a -&gt; p) -&gt; Spec fn a
</span><a href="Constrained.Base.html#constrained"><span class="hs-identifier hs-var">constrained</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679175088"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679175088"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2558"></span><span>            </span><span class="annot"><span class="annottext">forall a p (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, IsPred p fn) =&gt;
((forall b. Term fn b -&gt; b) -&gt; GE a) -&gt; (Term fn a -&gt; p) -&gt; Pred fn
</span><a href="Constrained.Base.html#exists"><span class="hs-identifier hs-var">exists</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679175087"><span class="annot"><span class="annottext">forall b. Term fn b -&gt; b
</span><a href="#local-6989586621679175087"><span class="hs-identifier hs-var">eval</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; GE a
</span><a href="Constrained.GenT.html#headGE"><span class="hs-identifier hs-var">headGE</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.difference</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b. Term fn b -&gt; b
</span><a href="#local-6989586621679175087"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679175088"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175125"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679175086"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679175086"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2559"></span><span>              </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679175088"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a a.
(HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; Term fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#DependsOn"><span class="hs-operator hs-var">`DependsOn`</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679175086"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-2560"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
p -&gt; Pred fn
</span><a href="Constrained.Base.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, Ord a) =&gt;
Term fn a -&gt; Term fn (Set a) -&gt; Term fn Bool
</span><a href="Constrained.Base.html#member_"><span class="hs-identifier hs-var">member_</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679175086"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679175125"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2561"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
p -&gt; Pred fn
</span><a href="Constrained.Base.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
Term fn Bool -&gt; Term fn Bool
</span><a href="Constrained.Base.html#not_"><span class="hs-identifier hs-var">not_</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, Ord a) =&gt;
Term fn a -&gt; Term fn (Set a) -&gt; Term fn Bool
</span><a href="Constrained.Base.html#member_"><span class="hs-identifier hs-var">member_</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679175086"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679175088"><span class="hs-identifier hs-var">set</span></a></span><span>
</span><span id="line-2562"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-2563"></span><span>    </span><span class="annot"><span class="annottext">SetFn fn as b
</span><a href="Constrained.Univ.html#Member"><span class="hs-identifier hs-var">Member</span></a></span><span>
</span><span id="line-2564"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3F"><span class="hs-operator hs-type">:?</span></a></span><span> </span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679175064"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175064"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">List Value as
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679175395"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Spec fn Bool -&gt; (Bool -&gt; Spec fn a) -&gt; Spec fn a
</span><a href="Constrained.Base.html#caseBoolSpec"><span class="hs-identifier hs-var">caseBoolSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175394"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-2565"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-var">MemberSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.toList</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175064"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-2566"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (f :: * -&gt; *).
(HasSpec fn a, Foldable f) =&gt;
f a -&gt; Spec fn a
</span><a href="Constrained.Base.html#notMemberSpec"><span class="hs-identifier hs-var">notMemberSpec</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175064"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-2567"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679175052"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175052"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%21"><span class="hs-operator hs-type">:!</span></a></span><span> </span><span class="annot"><a href="Constrained.List.html#NilCtx"><span class="hs-identifier hs-type">NilCtx</span></a></span><span> </span><span class="annot"><span class="annottext">HOLE a (Set a)
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679175395"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Spec fn Bool -&gt; (Bool -&gt; Spec fn a) -&gt; Spec fn a
</span><a href="Constrained.Base.html#caseBoolSpec"><span class="hs-identifier hs-var">caseBoolSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175394"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-2568"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Set a -&gt; Spec fn a -&gt; Spec fn Int -&gt; SetSpec fn a
</span><a href="Constrained.Base.html#SetSpec"><span class="hs-identifier hs-var">SetSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175052"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-2569"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Set a -&gt; Spec fn a -&gt; Spec fn Int -&gt; SetSpec fn a
</span><a href="Constrained.Base.html#SetSpec"><span class="hs-identifier hs-var">SetSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#notEqualSpec"><span class="hs-identifier hs-var">notEqualSpec</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175052"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-2570"></span><span>    </span><span class="annot"><span class="annottext">SetFn fn as b
</span><a href="Constrained.Univ.html#Elem"><span class="hs-identifier hs-var">Elem</span></a></span><span>
</span><span id="line-2571"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3F"><span class="hs-operator hs-type">:?</span></a></span><span> </span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679175017"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175017"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">List Value as
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679175395"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Spec fn Bool -&gt; (Bool -&gt; Spec fn a) -&gt; Spec fn a
</span><a href="Constrained.Base.html#caseBoolSpec"><span class="hs-identifier hs-var">caseBoolSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175394"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-2572"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-var">MemberSpec</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175017"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-2573"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (f :: * -&gt; *).
(HasSpec fn a, Foldable f) =&gt;
f a -&gt; Spec fn a
</span><a href="Constrained.Base.html#notMemberSpec"><span class="hs-identifier hs-var">notMemberSpec</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175017"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-2574"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679175005"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175005"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%21"><span class="hs-operator hs-type">:!</span></a></span><span> </span><span class="annot"><a href="Constrained.List.html#NilCtx"><span class="hs-identifier hs-type">NilCtx</span></a></span><span> </span><span class="annot"><span class="annottext">HOLE a [a]
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679175395"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Spec fn Bool -&gt; (Bool -&gt; Spec fn a) -&gt; Spec fn a
</span><a href="Constrained.Base.html#caseBoolSpec"><span class="hs-identifier hs-var">caseBoolSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175394"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-2575"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
[a] -&gt; Spec fn Int -&gt; Spec fn a -&gt; FoldSpec fn a -&gt; ListSpec fn a
</span><a href="Constrained.Base.html#ListSpec"><span class="hs-identifier hs-var">ListSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175005"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. FoldSpec fn a
</span><a href="Constrained.Base.html#NoFold"><span class="hs-identifier hs-var">NoFold</span></a></span><span>
</span><span id="line-2576"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
[a] -&gt; Spec fn Int -&gt; Spec fn a -&gt; FoldSpec fn a -&gt; ListSpec fn a
</span><a href="Constrained.Base.html#ListSpec"><span class="hs-identifier hs-var">ListSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#notEqualSpec"><span class="hs-identifier hs-var">notEqualSpec</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175005"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. FoldSpec fn a
</span><a href="Constrained.Base.html#NoFold"><span class="hs-identifier hs-var">NoFold</span></a></span><span>
</span><span id="line-2577"></span><span>    </span><span class="annot"><span class="annottext">SetFn fn as b
</span><a href="Constrained.Univ.html#Disjoint"><span class="hs-identifier hs-var">Disjoint</span></a></span><span>
</span><span id="line-2578"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3F"><span class="hs-operator hs-type">:?</span></a></span><span> </span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679174967"><span id="local-6989586621679174966"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679174966"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679174967"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">List Value as
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679175395"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: [*] -&gt; * -&gt; *) (fn :: [*] -&gt; * -&gt; *) (as :: [*]) a b.
(Functions f fn, TypeList as, Typeable as, HasSpec fn a,
 All (HasSpec fn) as) =&gt;
f as b -&gt; ListCtx Value as (HOLE a) -&gt; Spec fn b -&gt; Spec fn a
</span><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var">propagateSpecFun</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#SetFn"><span class="hs-identifier hs-type">SetFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182044"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182044"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
Ord a =&gt;
SetFn fn '[Set a, Set a] Bool
</span><a href="Constrained.Univ.html#Disjoint"><span class="hs-identifier hs-var">Disjoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; Value a
</span><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-var">Value</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679174966"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a (a :: [*]) (c :: * -&gt; *).
f a -&gt; ListCtx f a c -&gt; ListCtx f (a : a) c
</span><a href="Constrained.List.html#%3A%21"><span class="hs-operator hs-var">:!</span></a></span><span> </span><span class="annot"><span class="annottext">forall (c :: * -&gt; *) a (f :: * -&gt; *). c a -&gt; ListCtx f '[a] c
</span><a href="Constrained.List.html#NilCtx"><span class="hs-identifier hs-var">NilCtx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175394"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-2579"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679174950"><span id="local-6989586621679174949"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679174949"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679174950"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%21"><span class="hs-operator hs-type">:!</span></a></span><span> </span><span class="annot"><a href="Constrained.List.html#NilCtx"><span class="hs-identifier hs-type">NilCtx</span></a></span><span> </span><span class="annot"><span class="annottext">HOLE a (Set a)
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679175395"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-2580"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Evidence (Prerequisites fn (Set a))
</span><a href="Constrained.Core.html#Evidence"><span class="hs-identifier hs-var">Evidence</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Evidence (Prerequisites fn a)
</span><a href="Constrained.Base.html#prerequisites"><span class="hs-identifier hs-var">prerequisites</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182044"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679174950"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Spec fn Bool -&gt; (Bool -&gt; Spec fn a) -&gt; Spec fn a
</span><a href="Constrained.Base.html#caseBoolSpec"><span class="hs-identifier hs-var">caseBoolSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679175394"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-2581"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Set a -&gt; Spec fn a -&gt; Spec fn Int -&gt; SetSpec fn a
</span><a href="Constrained.Base.html#SetSpec"><span class="hs-identifier hs-var">SetSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (f :: * -&gt; *).
(HasSpec fn a, Foldable f) =&gt;
f a -&gt; Spec fn a
</span><a href="Constrained.Base.html#notMemberSpec"><span class="hs-identifier hs-var">notMemberSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679174949"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-2582"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) p.
(IsPred p fn, HasSpec fn a) =&gt;
(Term fn a -&gt; p) -&gt; Spec fn a
</span><a href="Constrained.Base.html#constrained"><span class="hs-identifier hs-var">constrained</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679174910"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679174910"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2583"></span><span>            </span><span class="annot"><span class="annottext">forall a p (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, IsPred p fn) =&gt;
((forall b. Term fn b -&gt; b) -&gt; GE a) -&gt; (Term fn a -&gt; p) -&gt; Pred fn
</span><a href="Constrained.Base.html#exists"><span class="hs-identifier hs-var">exists</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679174909"><span class="annot"><span class="annottext">forall b. Term fn b -&gt; b
</span><a href="#local-6989586621679174909"><span class="hs-identifier hs-var">eval</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; GE a
</span><a href="Constrained.GenT.html#headGE"><span class="hs-identifier hs-var">headGE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">Set.intersection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b. Term fn b -&gt; b
</span><a href="#local-6989586621679174909"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679174910"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679174949"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679174908"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679174908"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2584"></span><span>              </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679174910"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a a.
(HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; Term fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#DependsOn"><span class="hs-operator hs-var">`DependsOn`</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679174908"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-2585"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
p -&gt; Pred fn
</span><a href="Constrained.Base.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, Ord a) =&gt;
Term fn a -&gt; Term fn (Set a) -&gt; Term fn Bool
</span><a href="Constrained.Base.html#member_"><span class="hs-identifier hs-var">member_</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679174908"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679174949"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2586"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
p -&gt; Pred fn
</span><a href="Constrained.Base.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, Ord a) =&gt;
Term fn a -&gt; Term fn (Set a) -&gt; Term fn Bool
</span><a href="Constrained.Base.html#member_"><span class="hs-identifier hs-var">member_</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679174908"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679174910"><span class="hs-identifier hs-var">set</span></a></span><span>
</span><span id="line-2587"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-2588"></span><span>
</span><span id="line-2589"></span><span>  </span><span id="local-6989586621679174902"><span class="annot"><span class="annottext">rewriteRules :: forall (as :: [*]) b.
(TypeList as, Typeable as, HasSpec fn b, All (HasSpec fn) as) =&gt;
SetFn fn as b -&gt; [RewriteRule fn b]
</span><a href="#local-6989586621679174902"><span class="hs-identifier hs-var hs-var hs-var hs-var">rewriteRules</span></a></span></span><span> </span><span id="local-6989586621679174901"><span class="annot"><span class="annottext">f :: SetFn fn as b
</span><a href="#local-6989586621679174901"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">SetFn fn as b
</span><a href="Constrained.Univ.html#Elem"><span class="hs-identifier hs-var">Elem</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2590"></span><span>    </span><span class="hs-comment">-- No TypeAbstractions in ghc-8.10 (otherwise we could bind a in the head with</span><span>
</span><span id="line-2591"></span><span>    </span><span class="hs-comment">-- `rewriteRules (Elem @a)`. Without it we need this song and dance with the case.</span><span>
</span><span id="line-2592"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SetFn fn as b
</span><a href="#local-6989586621679174901"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2593"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679174875"><span class="annot"><span class="annottext">SetFn fn '[a, [a]] Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Univ.html#SetFn"><span class="hs-identifier hs-type">SetFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182044"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679174875"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679174875"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2594"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall (as :: [*]) (fn :: [*] -&gt; * -&gt; *) r b.
(All (HasSpec fn) as, HasSpec fn b, TypeList as,
 r ~ FunTy (MapList (Term fn) as) (PatternPair fn b),
 RewriteArgumentTypes r ~ as) =&gt;
r -&gt; RewriteRule fn b
</span><a href="Constrained.Base.html#rewriteRule_"><span class="hs-identifier hs-var">rewriteRule_</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679174874"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679174874"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
HasSpec fn a =&gt;
Term fn a -&gt; Term fn [a] -&gt; Term fn Bool
</span><a href="Constrained.Base.html#elem_"><span class="hs-identifier hs-var">elem_</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679174875"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679174874"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Pattern fn a -&gt; Pattern fn a -&gt; PatternPair fn a
</span><a href="Constrained.Base.html#~%3E"><span class="hs-operator hs-var">~&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-2595"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-2596"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#rewriteRules"><span class="hs-identifier hs-var">rewriteRules</span></a></span><span> </span><span id="local-6989586621679174873"><span class="annot"><span class="annottext">f :: SetFn fn as b
</span><a href="#local-6989586621679174873"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">SetFn fn as b
</span><a href="Constrained.Univ.html#Member"><span class="hs-identifier hs-var">Member</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2597"></span><span>    </span><span class="hs-comment">-- No TypeAbstractions in ghc-8.10</span><span>
</span><span id="line-2598"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SetFn fn as b
</span><a href="#local-6989586621679174873"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2599"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679174848"><span class="annot"><span class="annottext">SetFn fn '[a, Set a] Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Univ.html#SetFn"><span class="hs-identifier hs-type">SetFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182044"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679174848"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679174848"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2600"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall (as :: [*]) (fn :: [*] -&gt; * -&gt; *) r b.
(All (HasSpec fn) as, HasSpec fn b, TypeList as,
 r ~ FunTy (MapList (Term fn) as) (PatternPair fn b),
 RewriteArgumentTypes r ~ as) =&gt;
r -&gt; RewriteRule fn b
</span><a href="Constrained.Base.html#rewriteRule_"><span class="hs-identifier hs-var">rewriteRule_</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679174847"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679174847"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, Ord a) =&gt;
Term fn a -&gt; Term fn (Set a) -&gt; Term fn Bool
</span><a href="Constrained.Base.html#member_"><span class="hs-identifier hs-var">member_</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679174848"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679174847"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Pattern fn a -&gt; Pattern fn a -&gt; PatternPair fn a
</span><a href="Constrained.Base.html#~%3E"><span class="hs-operator hs-var">~&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-2601"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-2602"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#rewriteRules"><span class="hs-identifier hs-var">rewriteRules</span></a></span><span> </span><span id="local-6989586621679174846"><span class="annot"><span class="annottext">f :: SetFn fn as b
</span><a href="#local-6989586621679174846"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">SetFn fn as b
</span><a href="Constrained.Univ.html#Union"><span class="hs-identifier hs-var">Union</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2603"></span><span>    </span><span class="hs-comment">-- No TypeAbstractions in ghc-8.10</span><span>
</span><span id="line-2604"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SetFn fn as b
</span><a href="#local-6989586621679174846"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2605"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679174820"><span class="annot"><span class="annottext">SetFn fn '[Set a, Set a] (Set a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Univ.html#SetFn"><span class="hs-identifier hs-type">SetFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182044"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679174820"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679174820"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679174820"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2606"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall (as :: [*]) (fn :: [*] -&gt; * -&gt; *) r b.
(All (HasSpec fn) as, HasSpec fn b, TypeList as,
 r ~ FunTy (MapList (Term fn) as) (PatternPair fn b),
 RewriteArgumentTypes r ~ as) =&gt;
r -&gt; RewriteRule fn b
</span><a href="Constrained.Base.html#rewriteRule_"><span class="hs-identifier hs-var">rewriteRule_</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679174820"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679174819"><span class="annot"><span class="annottext">Pattern fn (Set a)
</span><a href="#local-6989586621679174819"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern fn (Set a)
</span><a href="#local-6989586621679174819"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Pattern fn a -&gt; Pattern fn a -&gt; PatternPair fn a
</span><a href="Constrained.Base.html#~%3E"><span class="hs-operator hs-var">~&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern fn (Set a)
</span><a href="#local-6989586621679174819"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-2607"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (as :: [*]) (fn :: [*] -&gt; * -&gt; *) r b.
(All (HasSpec fn) as, HasSpec fn b, TypeList as,
 r ~ FunTy (MapList (Term fn) as) (PatternPair fn b),
 RewriteArgumentTypes r ~ as) =&gt;
r -&gt; RewriteRule fn b
</span><a href="Constrained.Base.html#rewriteRule_"><span class="hs-identifier hs-var">rewriteRule_</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679174820"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679174818"><span class="annot"><span class="annottext">Pattern fn (Set a)
</span><a href="#local-6989586621679174818"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern fn (Set a)
</span><a href="#local-6989586621679174818"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Pattern fn a -&gt; Pattern fn a -&gt; PatternPair fn a
</span><a href="Constrained.Base.html#~%3E"><span class="hs-operator hs-var">~&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern fn (Set a)
</span><a href="#local-6989586621679174818"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-2608"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-2609"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#rewriteRules"><span class="hs-identifier hs-var">rewriteRules</span></a></span><span> </span><span class="annot"><span class="annottext">SetFn fn as b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2610"></span><span>
</span><span id="line-2611"></span><span>  </span><span class="hs-comment">-- NOTE: this function over-approximates and returns a liberal spec.</span><span>
</span><span id="line-2612"></span><span>  </span><span id="local-6989586621679174815"><span class="annot"><span class="annottext">mapTypeSpec :: forall a b.
(HasSpec fn a, HasSpec fn b) =&gt;
SetFn fn '[a] b -&gt; TypeSpec fn a -&gt; Spec fn b
</span><a href="#local-6989586621679174815"><span class="hs-identifier hs-var hs-var hs-var hs-var">mapTypeSpec</span></a></span></span><span> </span><span id="local-6989586621679174814"><span class="annot"><span class="annottext">SetFn fn '[a] b
</span><a href="#local-6989586621679174814"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679174813"><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679174813"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SetFn fn '[a] b
</span><a href="#local-6989586621679174814"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2613"></span><span>    </span><span class="annot"><span class="annottext">SetFn fn '[a] b
</span><a href="Constrained.Univ.html#Singleton"><span class="hs-identifier hs-var">Singleton</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2614"></span><span>      </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) p.
(IsPred p fn, HasSpec fn a) =&gt;
(Term fn a -&gt; p) -&gt; Spec fn a
</span><a href="Constrained.Base.html#constrained"><span class="hs-identifier hs-var">constrained</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679174787"><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679174787"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2615"></span><span>        </span><span class="annot"><span class="annottext">forall a p (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, IsPred p fn) =&gt;
(Term fn a -&gt; p) -&gt; Pred fn
</span><a href="Constrained.Base.html#unsafeExists"><span class="hs-identifier hs-var">unsafeExists</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679174785"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679174785"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2616"></span><span>          </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
p -&gt; Pred fn
</span><a href="Constrained.Base.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679174787"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Term fn a -&gt; Term fn Bool
</span><a href="Constrained.Base.html#%3D%3D."><span class="hs-operator hs-var">==.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn a, Ord a) =&gt;
Term fn a -&gt; Term fn (Set a)
</span><a href="Constrained.Base.html#singleton_"><span class="hs-identifier hs-var">singleton_</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679174785"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; TypeSpec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#toPreds"><span class="hs-identifier hs-var">toPreds</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679174785"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679174813"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-2617"></span><span>    </span><span class="annot"><span class="annottext">SetFn fn '[a] b
</span><a href="Constrained.Univ.html#Size"><span class="hs-identifier hs-var">Size</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2618"></span><span>      </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) p.
(IsPred p fn, HasSpec fn a) =&gt;
(Term fn a -&gt; p) -&gt; Spec fn a
</span><a href="Constrained.Base.html#constrained"><span class="hs-identifier hs-var">constrained</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679174760"><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679174760"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2619"></span><span>        </span><span class="annot"><span class="annottext">forall a p (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, IsPred p fn) =&gt;
(Term fn a -&gt; p) -&gt; Pred fn
</span><a href="Constrained.Base.html#unsafeExists"><span class="hs-identifier hs-var">unsafeExists</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679174759"><span class="annot"><span class="annottext">Term fn (Set a)
</span><a href="#local-6989586621679174759"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2620"></span><span>          </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
p -&gt; Pred fn
</span><a href="Constrained.Base.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679174760"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Term fn a -&gt; Term fn Bool
</span><a href="Constrained.Base.html#%3D%3D."><span class="hs-operator hs-var">==.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn (Set a), Ord a) =&gt;
Term fn (Set a) -&gt; Term fn Int
</span><a href="Constrained.Base.html#size_"><span class="hs-identifier hs-var">size_</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (Set a)
</span><a href="#local-6989586621679174759"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; TypeSpec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#toPreds"><span class="hs-identifier hs-var">toPreds</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (Set a)
</span><a href="#local-6989586621679174759"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679174813"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-2621"></span><span>
</span><span id="line-2622"></span><span class="hs-comment">-- List -------------------------------------------------------------------</span><span>
</span><span id="line-2623"></span><span>
</span><span id="line-2624"></span><span class="hs-keyword">data</span><span> </span><span id="ListSpec"><span class="annot"><a href="Constrained.Base.html#ListSpec"><span class="hs-identifier hs-var">ListSpec</span></a></span></span><span> </span><span id="local-6989586621679181986"><span class="annot"><a href="#local-6989586621679181986"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679181987"><span class="annot"><a href="#local-6989586621679181987"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ListSpec"><span class="annot"><a href="Constrained.Base.html#ListSpec"><span class="hs-identifier hs-var">ListSpec</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679181987"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181986"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181986"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181987"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#FoldSpec"><span class="hs-identifier hs-type">FoldSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181986"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181987"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2625"></span><span>
</span><span id="line-2626"></span><span id="local-6989586621679174753"><span id="local-6989586621679174755"><span id="local-6989586621679174757"><span id="local-6989586621679181960"><span id="local-6989586621679181961"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#FoldSpec"><span class="hs-identifier hs-type">FoldSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181961"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181960"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-2627"></span><span id="local-6989586621679174741"><span id="local-6989586621679174743"><span id="local-6989586621679174751"><span id="local-6989586621679181958"><span id="local-6989586621679181959"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181959"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181958"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ListSpec"><span class="hs-identifier hs-type">ListSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181959"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181958"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-2628"></span><span>
</span><span id="line-2629"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679174721"><span id="local-6989586621679182227"><span id="local-6989586621679182228"><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182228"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182227"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182228"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182227"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2630"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="TypeSpec"><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span></span><span> </span><span id="local-6989586621679182227"><span id="local-6989586621679182228"><span class="annot"><a href="#local-6989586621679182228"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182227"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#ListSpec"><span class="hs-identifier hs-type">ListSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182228"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182227"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2631"></span><span>  </span><span id="local-6989586621679174717"><span class="annot"><span class="annottext">emptySpec :: TypeSpec fn [a]
</span><a href="#local-6989586621679174717"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptySpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
[a] -&gt; Spec fn Int -&gt; Spec fn a -&gt; FoldSpec fn a -&gt; ListSpec fn a
</span><a href="Constrained.Base.html#ListSpec"><span class="hs-identifier hs-var">ListSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. FoldSpec fn a
</span><a href="Constrained.Base.html#NoFold"><span class="hs-identifier hs-var">NoFold</span></a></span><span>
</span><span id="line-2632"></span><span>  </span><span id="local-6989586621679174701"><span class="annot"><span class="annottext">combineSpec :: TypeSpec fn [a] -&gt; TypeSpec fn [a] -&gt; Spec fn [a]
</span><a href="#local-6989586621679174701"><span class="hs-identifier hs-var hs-var hs-var hs-var">combineSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ListSpec"><span class="hs-identifier hs-type">ListSpec</span></a></span><span> </span><span id="local-6989586621679174700"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174700"><span class="hs-identifier hs-var">must</span></a></span></span><span> </span><span id="local-6989586621679174699"><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679174699"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621679174698"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679174698"><span class="hs-identifier hs-var">elemS</span></a></span></span><span> </span><span id="local-6989586621679174697"><span class="annot"><span class="annottext">FoldSpec fn a
</span><a href="#local-6989586621679174697"><span class="hs-identifier hs-var">foldS</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ListSpec"><span class="hs-identifier hs-type">ListSpec</span></a></span><span> </span><span id="local-6989586621679174696"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174696"><span class="hs-identifier hs-var">must'</span></a></span></span><span> </span><span id="local-6989586621679174695"><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679174695"><span class="hs-identifier hs-var">size'</span></a></span></span><span> </span><span id="local-6989586621679174694"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679174694"><span class="hs-identifier hs-var">elemS'</span></a></span></span><span> </span><span id="local-6989586621679174693"><span class="annot"><span class="annottext">FoldSpec fn a
</span><a href="#local-6989586621679174693"><span class="hs-identifier hs-var">foldS'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ([String] -&gt; a) -&gt; GE a -&gt; a
</span><a href="Constrained.GenT.html#fromGE"><span class="hs-identifier hs-var">fromGE</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2633"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679174692"><span class="annot"><span class="annottext">must'' :: [a]
</span><a href="#local-6989586621679174692"><span class="hs-identifier hs-var hs-var">must''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">nub</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174700"><span class="hs-identifier hs-var">must</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174696"><span class="hs-identifier hs-var">must'</span></a></span><span>
</span><span id="line-2634"></span><span>        </span><span id="local-6989586621679174691"><span class="annot"><span class="annottext">elemS'' :: Spec fn a
</span><a href="#local-6989586621679174691"><span class="hs-identifier hs-var hs-var">elemS''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679174698"><span class="hs-identifier hs-var">elemS</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679174694"><span class="hs-identifier hs-var">elemS'</span></a></span><span>
</span><span id="line-2635"></span><span>        </span><span id="local-6989586621679174690"><span class="annot"><span class="annottext">size'' :: Spec fn Int
</span><a href="#local-6989586621679174690"><span class="hs-identifier hs-var hs-var">size''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679174699"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679174695"><span class="hs-identifier hs-var">size'</span></a></span><span>
</span><span id="line-2636"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-operator hs-var">`conformsToSpec`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679174691"><span class="hs-identifier hs-var">elemS''</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174692"><span class="hs-identifier hs-var">must''</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-2637"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a
</span><a href="Constrained.GenT.html#genError"><span class="hs-identifier hs-var">genError</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;combineSpec ListSpec failed with &lt;REASON&gt;&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-2638"></span><span>    </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
[a] -&gt; Spec fn Int -&gt; Spec fn a -&gt; FoldSpec fn a -&gt; ListSpec fn a
</span><a href="Constrained.Base.html#ListSpec"><span class="hs-identifier hs-var">ListSpec</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174692"><span class="hs-identifier hs-var">must''</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679174690"><span class="hs-identifier hs-var">size''</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679174691"><span class="hs-identifier hs-var">elemS''</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *) a.
MonadGenError m =&gt;
FoldSpec fn a -&gt; FoldSpec fn a -&gt; m (FoldSpec fn a)
</span><a href="Constrained.Base.html#combineFoldSpec"><span class="hs-identifier hs-var">combineFoldSpec</span></a></span><span> </span><span class="annot"><span class="annottext">FoldSpec fn a
</span><a href="#local-6989586621679174697"><span class="hs-identifier hs-var">foldS</span></a></span><span> </span><span class="annot"><span class="annottext">FoldSpec fn a
</span><a href="#local-6989586621679174693"><span class="hs-identifier hs-var">foldS'</span></a></span><span>
</span><span id="line-2639"></span><span>
</span><span id="line-2640"></span><span>  </span><span id="local-6989586621679174659"><span class="annot"><span class="annottext">genFromTypeSpec :: forall (m :: * -&gt; *).
(HasCallStack, MonadGenError m) =&gt;
TypeSpec fn [a] -&gt; GenT m [a]
</span><a href="#local-6989586621679174659"><span class="hs-identifier hs-var hs-var hs-var hs-var">genFromTypeSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ListSpec"><span class="hs-identifier hs-type">ListSpec</span></a></span><span> </span><span id="local-6989586621679174658"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174658"><span class="hs-identifier hs-var">must</span></a></span></span><span> </span><span class="annot"><span class="annottext">Spec fn Int
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span id="local-6989586621679174657"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679174657"><span class="hs-identifier hs-var">elemS</span></a></span></span><span> </span><span class="annot"><span class="annottext">FoldSpec fn a
</span><a href="Constrained.Base.html#NoFold"><span class="hs-identifier hs-var">NoFold</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2641"></span><span>    </span><span id="local-6989586621679174656"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174656"><span class="hs-identifier hs-var">lst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadGenError m =&gt; GenT GE a -&gt; GenT m [a]
</span><a href="Constrained.GenT.html#listOfT"><span class="hs-identifier hs-var">listOfT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (m :: * -&gt; *).
(HasCallStack, HasSpec fn a, MonadGenError m) =&gt;
Spec fn a -&gt; GenT m a
</span><a href="Constrained.Base.html#genFromSpec"><span class="hs-identifier hs-var">genFromSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679174657"><span class="hs-identifier hs-var">elemS</span></a></span><span>
</span><span id="line-2642"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Applicative m =&gt; Gen a -&gt; GenT m a
</span><a href="Constrained.GenT.html#pureGen"><span class="hs-identifier hs-var">pureGen</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Gen [a]
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-a65fd1c4eb4ae76375c6e3f3845a1ba912285f018239b330ae730fef533366f9/share/doc/html/src"><span class="hs-identifier hs-var">shuffle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174658"><span class="hs-identifier hs-var">must</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174656"><span class="hs-identifier hs-var">lst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2643"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#genFromTypeSpec"><span class="hs-identifier hs-var">genFromTypeSpec</span></a></span><span> </span><span id="local-6989586621679174655"><span class="annot"><span class="annottext">ss :: TypeSpec fn [a]
</span><a href="#local-6989586621679174655"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ListSpec"><span class="hs-identifier hs-type">ListSpec</span></a></span><span> </span><span id="local-6989586621679174654"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174654"><span class="hs-identifier hs-var">must</span></a></span></span><span> </span><span id="local-6989586621679174653"><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679174653"><span class="hs-identifier hs-var">szSpec</span></a></span></span><span> </span><span id="local-6989586621679174652"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679174652"><span class="hs-identifier hs-var">elemS</span></a></span></span><span> </span><span class="annot"><span class="annottext">FoldSpec fn a
</span><a href="Constrained.Base.html#NoFold"><span class="hs-identifier hs-var">NoFold</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2644"></span><span>    </span><span id="local-6989586621679174651"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679174651"><span class="hs-identifier hs-var">sz0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (m :: * -&gt; *).
(HasCallStack, HasSpec fn a, MonadGenError m) =&gt;
Spec fn a -&gt; GenT m a
</span><a href="Constrained.Base.html#genFromSpec"><span class="hs-identifier hs-var">genFromSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn [a] -&gt; Spec fn Int
</span><a href="Constrained.Base.html#sizeSpecList"><span class="hs-identifier hs-var">sizeSpecList</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn [a]
</span><a href="#local-6989586621679174655"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2645"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679174649"><span class="annot"><span class="annottext">sz :: Int
</span><a href="#local-6989586621679174649"><span class="hs-identifier hs-var hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679174651"><span class="hs-identifier hs-var">sz0</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174654"><span class="hs-identifier hs-var">must</span></a></span><span>
</span><span id="line-2646"></span><span>    </span><span id="local-6989586621679174648"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174648"><span class="hs-identifier hs-var">lst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-2647"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
MonadGenError m =&gt;
GenT GE a -&gt; Int -&gt; (Int -&gt; Bool) -&gt; GenT m [a]
</span><a href="Constrained.GenT.html#listOfUntilLenT"><span class="hs-identifier hs-var">listOfUntilLenT</span></a></span><span>
</span><span id="line-2648"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (m :: * -&gt; *).
(HasCallStack, HasSpec fn a, MonadGenError m) =&gt;
Spec fn a -&gt; GenT m a
</span><a href="Constrained.Base.html#genFromSpec"><span class="hs-identifier hs-var">genFromSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679174652"><span class="hs-identifier hs-var">elemS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2649"></span><span>        </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679174649"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-2650"></span><span>        </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-operator hs-var">`conformsToSpec`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679174653"><span class="hs-identifier hs-var">szSpec</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174654"><span class="hs-identifier hs-var">must</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2651"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Applicative m =&gt; Gen a -&gt; GenT m a
</span><a href="Constrained.GenT.html#pureGen"><span class="hs-identifier hs-var">pureGen</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Gen [a]
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-a65fd1c4eb4ae76375c6e3f3845a1ba912285f018239b330ae730fef533366f9/share/doc/html/src"><span class="hs-identifier hs-var">shuffle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174654"><span class="hs-identifier hs-var">must</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174648"><span class="hs-identifier hs-var">lst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2652"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#genFromTypeSpec"><span class="hs-identifier hs-var">genFromTypeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ListSpec"><span class="hs-identifier hs-type">ListSpec</span></a></span><span> </span><span id="local-6989586621679174646"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174646"><span class="hs-identifier hs-var">must</span></a></span></span><span> </span><span id="local-6989586621679174645"><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679174645"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621679174644"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679174644"><span class="hs-identifier hs-var">elemS</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#FoldSpec"><span class="hs-identifier hs-type">FoldSpec</span></a></span><span> </span><span id="local-6989586621679174635"><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679174635"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679174634"><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679174634"><span class="hs-identifier hs-var">foldS</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2653"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (fn :: [*] -&gt; * -&gt; *) a b.
(MonadGenError m, Foldy fn b, HasSpec fn a) =&gt;
[a]
-&gt; Spec fn Int -&gt; Spec fn a -&gt; fn '[a] b -&gt; Spec fn b -&gt; GenT m [a]
</span><a href="Constrained.Base.html#genFromFold"><span class="hs-identifier hs-var">genFromFold</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174646"><span class="hs-identifier hs-var">must</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679174645"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679174644"><span class="hs-identifier hs-var">elemS</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679174635"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679174634"><span class="hs-identifier hs-var">foldS</span></a></span><span>
</span><span id="line-2654"></span><span>
</span><span id="line-2655"></span><span>  </span><span id="local-6989586621679174625"><span class="annot"><span class="annottext">conformsTo :: HasCallStack =&gt; [a] -&gt; TypeSpec fn [a] -&gt; Bool
</span><a href="#local-6989586621679174625"><span class="hs-identifier hs-var hs-var hs-var hs-var">conformsTo</span></a></span></span><span> </span><span id="local-6989586621679174624"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174624"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ListSpec"><span class="hs-identifier hs-type">ListSpec</span></a></span><span> </span><span id="local-6989586621679174623"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174623"><span class="hs-identifier hs-var">must</span></a></span></span><span> </span><span id="local-6989586621679174622"><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679174622"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621679174621"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679174621"><span class="hs-identifier hs-var">elemS</span></a></span></span><span> </span><span id="local-6989586621679174620"><span class="annot"><span class="annottext">FoldSpec fn a
</span><a href="#local-6989586621679174620"><span class="hs-identifier hs-var">foldS</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2656"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174624"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-operator hs-var">`conformsToSpec`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679174622"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-2657"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`elem`</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174624"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174623"><span class="hs-identifier hs-var">must</span></a></span><span>
</span><span id="line-2658"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-operator hs-var">`conformsToSpec`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679174621"><span class="hs-identifier hs-var">elemS</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174624"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-2659"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174624"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [a] -&gt; FoldSpec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToFoldSpec"><span class="hs-operator hs-var">`conformsToFoldSpec`</span></a></span><span> </span><span class="annot"><span class="annottext">FoldSpec fn a
</span><a href="#local-6989586621679174620"><span class="hs-identifier hs-var">foldS</span></a></span><span>
</span><span id="line-2660"></span><span>
</span><span id="line-2661"></span><span>  </span><span id="local-6989586621679174597"><span class="annot"><span class="annottext">toPreds :: Term fn [a] -&gt; TypeSpec fn [a] -&gt; Pred fn
</span><a href="#local-6989586621679174597"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPreds</span></a></span></span><span> </span><span id="local-6989586621679174596"><span class="annot"><span class="annottext">Term fn [a]
</span><a href="#local-6989586621679174596"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ListSpec"><span class="hs-identifier hs-type">ListSpec</span></a></span><span> </span><span id="local-6989586621679174595"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174595"><span class="hs-identifier hs-var">must</span></a></span></span><span> </span><span id="local-6989586621679174594"><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679174594"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621679174593"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679174593"><span class="hs-identifier hs-var">elemS</span></a></span></span><span> </span><span id="local-6989586621679174592"><span class="annot"><span class="annottext">FoldSpec fn a
</span><a href="#local-6989586621679174592"><span class="hs-identifier hs-var">foldS</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2662"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t a (fn :: [*] -&gt; * -&gt; *) p.
(Forallable t a, HasSpec fn t, HasSpec fn a, IsPred p fn) =&gt;
Term fn t -&gt; (Term fn a -&gt; p) -&gt; Pred fn
</span><a href="Constrained.Base.html#forAll"><span class="hs-identifier hs-var">forAll</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn [a]
</span><a href="#local-6989586621679174596"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679174591"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679174591"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
p -&gt; Pred fn
</span><a href="Constrained.Base.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
HasSpec fn a =&gt;
Term fn a -&gt; Term fn [a] -&gt; Term fn Bool
</span><a href="Constrained.Base.html#elem_"><span class="hs-identifier hs-var">elem_</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679174591"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174595"><span class="hs-identifier hs-var">must</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Spec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#satisfies"><span class="hs-identifier hs-var">satisfies</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679174591"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679174593"><span class="hs-identifier hs-var">elemS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2663"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
BaseUniverse fn =&gt;
Term fn [a] -&gt; FoldSpec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#toPredsFoldSpec"><span class="hs-identifier hs-var">toPredsFoldSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn [a]
</span><a href="#local-6989586621679174596"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">FoldSpec fn a
</span><a href="#local-6989586621679174592"><span class="hs-identifier hs-var">foldS</span></a></span><span>
</span><span id="line-2664"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Spec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#satisfies"><span class="hs-identifier hs-var">satisfies</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
HasSpec fn [a] =&gt;
Term fn [a] -&gt; Term fn Int
</span><a href="Constrained.Base.html#length_"><span class="hs-identifier hs-var">length_</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn [a]
</span><a href="#local-6989586621679174596"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679174594"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-2665"></span><span>
</span><span id="line-2666"></span><span class="annot"><a href="Constrained.Base.html#sizeSpecList"><span class="hs-identifier hs-type">sizeSpecList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679181954"><span class="annot"><a href="#local-6989586621679181954"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679181953"><span class="annot"><a href="#local-6989586621679181953"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181954"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679181953"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181954"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-2667"></span><span id="sizeSpecList"><span class="annot"><span class="annottext">sizeSpecList :: forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn [a] -&gt; Spec fn Int
</span><a href="Constrained.Base.html#sizeSpecList"><span class="hs-identifier hs-var hs-var">sizeSpecList</span></a></span></span><span> </span><span class="annot"><span class="annottext">Spec fn [a]
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span>
</span><span id="line-2668"></span><span class="annot"><a href="Constrained.Base.html#sizeSpecList"><span class="hs-identifier hs-var">sizeSpecList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span id="local-6989586621679174587"><span class="annot"><span class="annottext">OrdSet [a]
</span><a href="#local-6989586621679174587"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-var">MemberSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet [a]
</span><a href="#local-6989586621679174587"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2669"></span><span class="annot"><a href="Constrained.Base.html#sizeSpecList"><span class="hs-identifier hs-var">sizeSpecList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-type">SuspendedSpec</span></a></span><span> </span><span id="local-6989586621679174570"><span class="annot"><span class="annottext">Var [a]
</span><a href="#local-6989586621679174570"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679174569"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679174569"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2670"></span><span>  </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) p.
(IsPred p fn, HasSpec fn a) =&gt;
(Term fn a -&gt; p) -&gt; Spec fn a
</span><a href="Constrained.Base.html#constrained"><span class="hs-identifier hs-var">constrained</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679174568"><span class="annot"><span class="annottext">Term fn Int
</span><a href="#local-6989586621679174568"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2671"></span><span>    </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
((forall b. Term fn b -&gt; b) -&gt; GE a) -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Exists"><span class="hs-identifier hs-var">Exists</span></a></span><span>
</span><span id="line-2672"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">forall b. Term fn b -&gt; b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a
</span><a href="Constrained.GenT.html#fatalError"><span class="hs-identifier hs-var">fatalError</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sizeSpecList: Exists&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2673"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var [a]
</span><a href="#local-6989586621679174570"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
[String] -&gt; Term fn Bool -&gt; Pred fn
</span><a href="Constrained.Base.html#Assert"><span class="hs-identifier hs-var">Assert</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term fn Int
</span><a href="#local-6989586621679174568"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Term fn a -&gt; Term fn Bool
</span><a href="Constrained.Base.html#%3D%3D."><span class="hs-operator hs-var">==.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
HasSpec fn [a] =&gt;
Term fn [a] -&gt; Term fn Int
</span><a href="Constrained.Base.html#length_"><span class="hs-identifier hs-var">length_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; Var a -&gt; Term fn a
</span><a href="Constrained.Base.html#V"><span class="hs-identifier hs-var">V</span></a></span><span> </span><span class="annot"><span class="annottext">Var [a]
</span><a href="#local-6989586621679174570"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679174569"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2674"></span><span class="annot"><a href="Constrained.Base.html#sizeSpecList"><span class="hs-identifier hs-var">sizeSpecList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span id="local-6989586621679174567"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679174567"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679174567"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-2675"></span><span class="annot"><a href="Constrained.Base.html#sizeSpecList"><span class="hs-identifier hs-var">sizeSpecList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ListSpec"><span class="hs-identifier hs-type">ListSpec</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Spec fn Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">FoldSpec fn a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdSet [a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). a -&gt; Spec fn a
</span><a href="Constrained.Base.html#equalSpec"><span class="hs-identifier hs-var">equalSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2676"></span><span class="annot"><a href="Constrained.Base.html#sizeSpecList"><span class="hs-identifier hs-var">sizeSpecList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ListSpec"><span class="hs-identifier hs-type">ListSpec</span></a></span><span> </span><span id="local-6989586621679174549"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174549"><span class="hs-identifier hs-var">must</span></a></span></span><span> </span><span id="local-6989586621679174548"><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679174548"><span class="hs-identifier hs-var">sizeSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FoldSpec fn a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679174547"><span class="annot"><span class="annottext">OrdSet [a]
</span><a href="#local-6989586621679174547"><span class="hs-identifier hs-var">cant</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2677"></span><span>  </span><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679174546"><span class="hs-identifier hs-var">cantSpec</span></a></span><span>
</span><span id="line-2678"></span><span>    </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn Int
</span><a href="#local-6989586621679174548"><span class="hs-identifier hs-var">sizeSpec</span></a></span><span>
</span><span id="line-2679"></span><span>    </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. OrdLike fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#geqSpec"><span class="hs-identifier hs-var">geqSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679181954"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679174549"><span class="hs-identifier hs-var">must</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2680"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2681"></span><span>    </span><span id="local-6989586621679174546"><span class="annot"><span class="annottext">cantSpec :: Spec fn Int
</span><a href="#local-6989586621679174546"><span class="hs-identifier hs-var hs-var">cantSpec</span></a></span></span><span>
</span><span id="line-2682"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`elem`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet [a]
</span><a href="#local-6989586621679174547"><span class="hs-identifier hs-var">cant</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#notEqualSpec"><span class="hs-identifier hs-var">notEqualSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2683"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span>
</span><span id="line-2684"></span><span>
</span><span id="line-2685"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679181949"><span class="annot"><a href="Constrained.Base.html#Forallable"><span class="hs-identifier hs-type">Forallable</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679181949"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679181949"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2686"></span><span>  </span><span id="local-6989586621679174537"><span class="annot"><span class="annottext">forAllSpec :: forall (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn [a], HasSpec fn a, BaseUniverse fn) =&gt;
Spec fn a -&gt; Spec fn [a]
</span><a href="#local-6989586621679174537"><span class="hs-identifier hs-var hs-var hs-var hs-var">forAllSpec</span></a></span></span><span> </span><span id="local-6989586621679174536"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679174536"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
[a] -&gt; Spec fn Int -&gt; Spec fn a -&gt; FoldSpec fn a -&gt; ListSpec fn a
</span><a href="Constrained.Base.html#ListSpec"><span class="hs-identifier hs-var">ListSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679174536"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. FoldSpec fn a
</span><a href="Constrained.Base.html#NoFold"><span class="hs-identifier hs-var">NoFold</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2687"></span><span>  </span><span id="local-6989586621679174535"><span class="annot"><span class="annottext">forAllToList :: [a] -&gt; [a]
</span><a href="#local-6989586621679174535"><span class="hs-identifier hs-var hs-var hs-var hs-var">forAllToList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-2688"></span><span>
</span><span id="line-2689"></span><span class="hs-comment">-- Numbers ----------------------------------------------------------------</span><span>
</span><span id="line-2690"></span><span>
</span><span id="line-2691"></span><span class="hs-keyword">class</span><span> </span><span id="MaybeBounded"><span class="annot"><a href="Constrained.Base.html#MaybeBounded"><span class="hs-identifier hs-var">MaybeBounded</span></a></span></span><span> </span><span id="local-6989586621679182221"><span class="annot"><a href="#local-6989586621679182221"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2692"></span><span>  </span><span id="lowerBound"><span class="annot"><a href="Constrained.Base.html#lowerBound"><span class="hs-identifier hs-type">lowerBound</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182221"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2693"></span><span>  </span><span id="upperBound"><span class="annot"><a href="Constrained.Base.html#upperBound"><span class="hs-identifier hs-type">upperBound</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182221"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2694"></span><span>
</span><span id="line-2695"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="lowerBound"><span class="annot"><a href="Constrained.Base.html#lowerBound"><span class="hs-identifier hs-type">lowerBound</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Bounded</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182221"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182221"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2696"></span><span>  </span><span id="local-6989586621679174533"><span class="annot"><a href="Constrained.Base.html#lowerBound"><span class="hs-identifier hs-var hs-var">lowerBound</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">minBound</span></a></span></span><span>
</span><span id="line-2697"></span><span>
</span><span id="line-2698"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="upperBound"><span class="annot"><a href="Constrained.Base.html#upperBound"><span class="hs-identifier hs-type">upperBound</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Bounded</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182221"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182221"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2699"></span><span>  </span><span id="local-6989586621679174529"><span class="annot"><a href="Constrained.Base.html#upperBound"><span class="hs-identifier hs-var hs-var">upperBound</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maxBound</span></a></span></span><span>
</span><span id="line-2700"></span><span>
</span><span id="line-2701"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679174522"><span id="local-6989586621679174524"><span class="annot"><a href="Constrained.Base.html#MaybeBounded"><span class="hs-identifier hs-type">MaybeBounded</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span></span></span><span>
</span><span id="line-2702"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679174517"><span id="local-6989586621679174519"><span class="annot"><a href="Constrained.Base.html#MaybeBounded"><span class="hs-identifier hs-type">MaybeBounded</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int64</span></a></span></span></span><span>
</span><span id="line-2703"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679174513"><span id="local-6989586621679174515"><span class="annot"><a href="Constrained.Base.html#MaybeBounded"><span class="hs-identifier hs-type">MaybeBounded</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int32</span></a></span></span></span><span>
</span><span id="line-2704"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679174509"><span id="local-6989586621679174511"><span class="annot"><a href="Constrained.Base.html#MaybeBounded"><span class="hs-identifier hs-type">MaybeBounded</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int16</span></a></span></span></span><span>
</span><span id="line-2705"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679174505"><span id="local-6989586621679174507"><span class="annot"><a href="Constrained.Base.html#MaybeBounded"><span class="hs-identifier hs-type">MaybeBounded</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int8</span></a></span></span></span><span>
</span><span id="line-2706"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679174501"><span id="local-6989586621679174503"><span class="annot"><a href="Constrained.Base.html#MaybeBounded"><span class="hs-identifier hs-type">MaybeBounded</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span></span></span><span>
</span><span id="line-2707"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679174497"><span id="local-6989586621679174499"><span class="annot"><a href="Constrained.Base.html#MaybeBounded"><span class="hs-identifier hs-type">MaybeBounded</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word32</span></a></span></span></span><span>
</span><span id="line-2708"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679174493"><span id="local-6989586621679174495"><span class="annot"><a href="Constrained.Base.html#MaybeBounded"><span class="hs-identifier hs-type">MaybeBounded</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word16</span></a></span></span></span><span>
</span><span id="line-2709"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679174489"><span id="local-6989586621679174491"><span class="annot"><a href="Constrained.Base.html#MaybeBounded"><span class="hs-identifier hs-type">MaybeBounded</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word8</span></a></span></span></span><span>
</span><span id="line-2710"></span><span>
</span><span id="line-2711"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Constrained.Base.html#MaybeBounded"><span class="hs-identifier hs-type">MaybeBounded</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2712"></span><span>  </span><span id="local-6989586621679174486"><span class="annot"><span class="annottext">lowerBound :: Maybe Integer
</span><a href="#local-6989586621679174486"><span class="hs-identifier hs-var hs-var hs-var hs-var">lowerBound</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2713"></span><span>  </span><span id="local-6989586621679174485"><span class="annot"><span class="annottext">upperBound :: Maybe Integer
</span><a href="#local-6989586621679174485"><span class="hs-identifier hs-var hs-var hs-var hs-var">upperBound</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2714"></span><span>
</span><span id="line-2715"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Constrained.Base.html#MaybeBounded"><span class="hs-identifier hs-type">MaybeBounded</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Ratio</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2716"></span><span>  </span><span id="local-6989586621679174481"><span class="annot"><span class="annottext">lowerBound :: Maybe (Ratio Integer)
</span><a href="#local-6989586621679174481"><span class="hs-identifier hs-var hs-var hs-var hs-var">lowerBound</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2717"></span><span>  </span><span id="local-6989586621679174480"><span class="annot"><span class="annottext">upperBound :: Maybe (Ratio Integer)
</span><a href="#local-6989586621679174480"><span class="hs-identifier hs-var hs-var hs-var hs-var">upperBound</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2718"></span><span>
</span><span id="line-2719"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Constrained.Base.html#MaybeBounded"><span class="hs-identifier hs-type">MaybeBounded</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2720"></span><span>  </span><span id="local-6989586621679174476"><span class="annot"><span class="annottext">lowerBound :: Maybe Natural
</span><a href="#local-6989586621679174476"><span class="hs-identifier hs-var hs-var hs-var hs-var">lowerBound</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2721"></span><span>  </span><span id="local-6989586621679174475"><span class="annot"><span class="annottext">upperBound :: Maybe Natural
</span><a href="#local-6989586621679174475"><span class="hs-identifier hs-var hs-var hs-var hs-var">upperBound</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2722"></span><span>
</span><span id="line-2723"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Constrained.Base.html#MaybeBounded"><span class="hs-identifier hs-type">MaybeBounded</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Float</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2724"></span><span>  </span><span id="local-6989586621679174471"><span class="annot"><span class="annottext">lowerBound :: Maybe Float
</span><a href="#local-6989586621679174471"><span class="hs-identifier hs-var hs-var hs-var hs-var">lowerBound</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2725"></span><span>  </span><span id="local-6989586621679174470"><span class="annot"><span class="annottext">upperBound :: Maybe Float
</span><a href="#local-6989586621679174470"><span class="hs-identifier hs-var hs-var hs-var hs-var">upperBound</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2726"></span><span>
</span><span id="line-2727"></span><span class="hs-keyword">data</span><span> </span><span id="NumSpec"><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-var">NumSpec</span></a></span></span><span> </span><span id="local-6989586621679182181"><span class="annot"><a href="#local-6989586621679182181"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NumSpecInterval"><span class="annot"><a href="Constrained.Base.html#NumSpecInterval"><span class="hs-identifier hs-var">NumSpecInterval</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182181"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182181"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2728"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679174446"><span id="local-6989586621679174448"><span id="local-6989586621679174451"><span id="local-6989586621679174454"><span id="local-6989586621679174457"><span id="local-6989586621679174461"><span id="local-6989586621679174466"><span class="annot"><span class="annottext">NumSpec n -&gt; NumSpec n -&gt; Bool
NumSpec n -&gt; NumSpec n -&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {n}. Ord n =&gt; Eq (NumSpec n)
forall n. Ord n =&gt; NumSpec n -&gt; NumSpec n -&gt; Bool
forall n. Ord n =&gt; NumSpec n -&gt; NumSpec n -&gt; Ordering
forall n. Ord n =&gt; NumSpec n -&gt; NumSpec n -&gt; NumSpec n
min :: NumSpec n -&gt; NumSpec n -&gt; NumSpec n
$cmin :: forall n. Ord n =&gt; NumSpec n -&gt; NumSpec n -&gt; NumSpec n
max :: NumSpec n -&gt; NumSpec n -&gt; NumSpec n
$cmax :: forall n. Ord n =&gt; NumSpec n -&gt; NumSpec n -&gt; NumSpec n
&gt;= :: NumSpec n -&gt; NumSpec n -&gt; Bool
$c&gt;= :: forall n. Ord n =&gt; NumSpec n -&gt; NumSpec n -&gt; Bool
&gt; :: NumSpec n -&gt; NumSpec n -&gt; Bool
$c&gt; :: forall n. Ord n =&gt; NumSpec n -&gt; NumSpec n -&gt; Bool
&lt;= :: NumSpec n -&gt; NumSpec n -&gt; Bool
$c&lt;= :: forall n. Ord n =&gt; NumSpec n -&gt; NumSpec n -&gt; Bool
&lt; :: NumSpec n -&gt; NumSpec n -&gt; Bool
$c&lt; :: forall n. Ord n =&gt; NumSpec n -&gt; NumSpec n -&gt; Bool
compare :: NumSpec n -&gt; NumSpec n -&gt; Ordering
$ccompare :: forall n. Ord n =&gt; NumSpec n -&gt; NumSpec n -&gt; Ordering
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679174439"><span id="local-6989586621679174444"><span class="annot"><span class="annottext">NumSpec n -&gt; NumSpec n -&gt; Bool
forall n. Eq n =&gt; NumSpec n -&gt; NumSpec n -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: NumSpec n -&gt; NumSpec n -&gt; Bool
$c/= :: forall n. Eq n =&gt; NumSpec n -&gt; NumSpec n -&gt; Bool
== :: NumSpec n -&gt; NumSpec n -&gt; Bool
$c== :: forall n. Eq n =&gt; NumSpec n -&gt; NumSpec n -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-2729"></span><span>
</span><span id="line-2730"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679174434"><span id="local-6989586621679174437"><span id="local-6989586621679181939"><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181939"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181939"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2731"></span><span>  </span><span id="local-6989586621679174425"><span class="annot"><span class="annottext">show :: NumSpec n -&gt; String
</span><a href="#local-6989586621679174425"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#NumSpecInterval"><span class="hs-identifier hs-type">NumSpecInterval</span></a></span><span> </span><span id="local-6989586621679174424"><span class="annot"><span class="annottext">Maybe n
</span><a href="#local-6989586621679174424"><span class="hs-identifier hs-var">ml</span></a></span></span><span> </span><span id="local-6989586621679174423"><span class="annot"><span class="annottext">Maybe n
</span><a href="#local-6989586621679174423"><span class="hs-identifier hs-var">mu</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679174422"><span class="hs-identifier hs-var">lb</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;..&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679174421"><span class="hs-identifier hs-var">ub</span></a></span><span>
</span><span id="line-2732"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-2733"></span><span>      </span><span id="local-6989586621679174422"><span class="annot"><span class="annottext">lb :: String
</span><a href="#local-6989586621679174422"><span class="hs-identifier hs-var hs-var">lb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe n
</span><a href="#local-6989586621679174424"><span class="hs-identifier hs-var">ml</span></a></span><span>
</span><span id="line-2734"></span><span>      </span><span id="local-6989586621679174421"><span class="annot"><span class="annottext">ub :: String
</span><a href="#local-6989586621679174421"><span class="hs-identifier hs-var hs-var">ub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe n
</span><a href="#local-6989586621679174423"><span class="hs-identifier hs-var">mu</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-2735"></span><span>
</span><span id="line-2736"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679174416"><span id="local-6989586621679174418"><span id="local-6989586621679181938"><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181938"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181938"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2737"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#NumSpecInterval"><span class="hs-identifier hs-type">NumSpecInterval</span></a></span><span> </span><span id="local-6989586621679174413"><span class="annot"><span class="annottext">Maybe n
</span><a href="#local-6989586621679174413"><span class="hs-identifier hs-var">ml</span></a></span></span><span> </span><span id="local-6989586621679174412"><span class="annot"><span class="annottext">Maybe n
</span><a href="#local-6989586621679174412"><span class="hs-identifier hs-var">mu</span></a></span></span><span> </span><span id="local-6989586621679174411"><span class="annot"><span class="annottext">&lt;&gt; :: NumSpec n -&gt; NumSpec n -&gt; NumSpec n
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpecInterval"><span class="hs-identifier hs-type">NumSpecInterval</span></a></span><span> </span><span id="local-6989586621679174410"><span class="annot"><span class="annottext">Maybe n
</span><a href="#local-6989586621679174410"><span class="hs-identifier hs-var">ml'</span></a></span></span><span> </span><span id="local-6989586621679174409"><span class="annot"><span class="annottext">Maybe n
</span><a href="#local-6989586621679174409"><span class="hs-identifier hs-var">mu'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2738"></span><span>    </span><span class="annot"><span class="annottext">forall n. Maybe n -&gt; Maybe n -&gt; NumSpec n
</span><a href="Constrained.Base.html#NumSpecInterval"><span class="hs-identifier hs-var">NumSpecInterval</span></a></span><span>
</span><span id="line-2739"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; a) -&gt; Maybe a -&gt; Maybe a -&gt; Maybe a
</span><a href="Constrained.Core.html#unionWithMaybe"><span class="hs-identifier hs-var">unionWithMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">max</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe n
</span><a href="#local-6989586621679174413"><span class="hs-identifier hs-var">ml</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe n
</span><a href="#local-6989586621679174410"><span class="hs-identifier hs-var">ml'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2740"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; a) -&gt; Maybe a -&gt; Maybe a -&gt; Maybe a
</span><a href="Constrained.Core.html#unionWithMaybe"><span class="hs-identifier hs-var">unionWithMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">min</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe n
</span><a href="#local-6989586621679174412"><span class="hs-identifier hs-var">mu</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe n
</span><a href="#local-6989586621679174409"><span class="hs-identifier hs-var">mu'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2741"></span><span>
</span><span id="line-2742"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679174399"><span id="local-6989586621679174401"><span id="local-6989586621679181936"><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181936"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181936"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2743"></span><span>  </span><span id="local-6989586621679174398"><span class="annot"><span class="annottext">mempty :: NumSpec n
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. Maybe n -&gt; Maybe n -&gt; NumSpec n
</span><a href="Constrained.Base.html#NumSpecInterval"><span class="hs-identifier hs-var">NumSpecInterval</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2744"></span><span>
</span><span id="line-2745"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-a65fd1c4eb4ae76375c6e3f3845a1ba912285f018239b330ae730fef533366f9/share/doc/html/src"><span class="hs-identifier hs-type">Arbitrary</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2746"></span><span>  </span><span id="local-6989586621679174388"><span class="annot"><span class="annottext">arbitrary :: Gen Natural
</span><a href="#local-6989586621679174388"><span class="hs-identifier hs-var hs-var hs-var hs-var">arbitrary</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Natural
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">wordToNatural</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">abs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Arbitrary a =&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-a65fd1c4eb4ae76375c6e3f3845a1ba912285f018239b330ae730fef533366f9/share/doc/html/src"><span class="hs-identifier hs-var">arbitrary</span></a></span><span>
</span><span id="line-2747"></span><span>  </span><span id="local-6989586621679174384"><span class="annot"><span class="annottext">shrink :: Natural -&gt; [Natural]
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-a65fd1c4eb4ae76375c6e3f3845a1ba912285f018239b330ae730fef533366f9/share/doc/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">shrink</span></a></span></span><span> </span><span id="local-6989586621679174382"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679174382"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word -&gt; Natural
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">wordToNatural</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679174381"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679174381"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679174381"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Arbitrary a =&gt; a -&gt; [a]
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-a65fd1c4eb4ae76375c6e3f3845a1ba912285f018239b330ae730fef533366f9/share/doc/html/src"><span class="hs-identifier hs-var">shrink</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; Word
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">naturalToWord</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679174382"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2748"></span><span>
</span><span id="line-2749"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/random-1.2.1.1-97d351bf97dd57637441798736e25556058018a1de673671ce7fdce6e47d0d77/share/doc/html/src"><span class="hs-identifier hs-type">Uniform</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2750"></span><span>  </span><span id="local-6989586621679174367"><span class="annot"><span class="annottext">uniformM :: forall g (m :: * -&gt; *). StatefulGen g m =&gt; g -&gt; m Natural
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/random-1.2.1.1-97d351bf97dd57637441798736e25556058018a1de673671ce7fdce6e47d0d77/share/doc/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">uniformM</span></a></span></span><span> </span><span id="local-6989586621679174365"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679174365"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Natural
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">wordToNatural</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">abs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a g (m :: * -&gt; *). (Uniform a, StatefulGen g m) =&gt; g -&gt; m a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/random-1.2.1.1-97d351bf97dd57637441798736e25556058018a1de673671ce7fdce6e47d0d77/share/doc/html/src"><span class="hs-identifier hs-var">uniformM</span></a></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679174365"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-2751"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679174358"><span id="local-6989586621679174360"><span id="local-6989586621679174362"><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/random-1.2.1.1-97d351bf97dd57637441798736e25556058018a1de673671ce7fdce6e47d0d77/share/doc/html/src"><span class="hs-identifier hs-type">Random</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Natural</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2752"></span><span>  </span><span id="local-6989586621679174347"><span class="annot"><span class="annottext">randomR :: forall g. RandomGen g =&gt; (Natural, Natural) -&gt; g -&gt; (Natural, g)
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/random-1.2.1.1-97d351bf97dd57637441798736e25556058018a1de673671ce7fdce6e47d0d77/share/doc/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">randomR</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679174345"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679174345"><span class="hs-identifier hs-var">lo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679174344"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679174344"><span class="hs-identifier hs-var">hi</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679174343"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679174343"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a g. (Random a, RandomGen g) =&gt; (a, a) -&gt; g -&gt; (a, g)
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/random-1.2.1.1-97d351bf97dd57637441798736e25556058018a1de673671ce7fdce6e47d0d77/share/doc/html/src"><span class="hs-identifier hs-var">randomR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; Integer
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">toInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679174345"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; Integer
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">toInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679174344"><span class="hs-identifier hs-var">hi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679174343"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-2753"></span><span>
</span><span id="line-2754"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679174337"><span id="local-6989586621679174339"><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/random-1.2.1.1-97d351bf97dd57637441798736e25556058018a1de673671ce7fdce6e47d0d77/share/doc/html/src"><span class="hs-identifier hs-type">Random</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Ratio</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2755"></span><span>  </span><span id="local-6989586621679174328"><span class="annot"><span class="annottext">randomR :: forall g.
RandomGen g =&gt;
(Ratio Integer, Ratio Integer) -&gt; g -&gt; (Ratio Integer, g)
</span><a href="#local-6989586621679174328"><span class="hs-identifier hs-var hs-var hs-var hs-var">randomR</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679174327"><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621679174327"><span class="hs-identifier hs-var">lo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679174326"><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621679174326"><span class="hs-identifier hs-var">hi</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679174325"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679174325"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2756"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679174324"><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621679174324"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679174323"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679174323"><span class="hs-identifier hs-var">g'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a g. (Random a, RandomGen g) =&gt; g -&gt; (a, g)
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/random-1.2.1.1-97d351bf97dd57637441798736e25556058018a1de673671ce7fdce6e47d0d77/share/doc/html/src"><span class="hs-identifier hs-var">random</span></a></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679174325"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-2757"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621679174327"><span class="hs-identifier hs-var">lo</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621679174326"><span class="hs-identifier hs-var">hi</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621679174327"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621679174324"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679174323"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2758"></span><span>  </span><span id="local-6989586621679174310"><span class="annot"><span class="annottext">random :: forall g. RandomGen g =&gt; g -&gt; (Ratio Integer, g)
</span><a href="#local-6989586621679174310"><span class="hs-identifier hs-var hs-var hs-var hs-var">random</span></a></span></span><span> </span><span id="local-6989586621679174309"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679174309"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2759"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679174308"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679174308"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679174307"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679174307"><span class="hs-identifier hs-var">g'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">abs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a g. (Random a, RandomGen g) =&gt; g -&gt; (a, g)
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/random-1.2.1.1-97d351bf97dd57637441798736e25556058018a1de673671ce7fdce6e47d0d77/share/doc/html/src"><span class="hs-identifier hs-var">random</span></a></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679174309"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-2760"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679174306"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679174306"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679174305"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679174305"><span class="hs-identifier hs-var">g''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a g. (Random a, RandomGen g) =&gt; (a, a) -&gt; g -&gt; (a, g)
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/random-1.2.1.1-97d351bf97dd57637441798736e25556058018a1de673671ce7fdce6e47d0d77/share/doc/html/src"><span class="hs-identifier hs-var">randomR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679174308"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679174307"><span class="hs-identifier hs-var">g'</span></a></span><span>
</span><span id="line-2761"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679174306"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">%</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679174308"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679174305"><span class="hs-identifier hs-var">g''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2762"></span><span>
</span><span id="line-2763"></span><span id="local-6989586621679174303"><span class="annot"><a href="Constrained.Base.html#emptyNumSpec"><span class="hs-identifier hs-type">emptyNumSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679174303"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679174303"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-2764"></span><span id="emptyNumSpec"><span class="annot"><span class="annottext">emptyNumSpec :: forall n. Ord n =&gt; NumSpec n
</span><a href="Constrained.Base.html#emptyNumSpec"><span class="hs-identifier hs-var hs-var">emptyNumSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-2765"></span><span>
</span><span id="line-2766"></span><span id="local-6989586621679181910"><span id="local-6989586621679181911"><span class="annot"><a href="Constrained.Base.html#combineNumSpec"><span class="hs-identifier hs-type">combineNumSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181911"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181910"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181910"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181911"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181910"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181910"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181910"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181910"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181911"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181910"><span class="hs-identifier hs-type">n</span></a></span></span></span><span>
</span><span id="line-2767"></span><span id="combineNumSpec"><span class="annot"><span class="annottext">combineNumSpec :: forall (fn :: [*] -&gt; * -&gt; *) n.
(HasSpec fn n, Ord n, TypeSpec fn n ~ NumSpec n) =&gt;
NumSpec n -&gt; NumSpec n -&gt; Spec fn n
</span><a href="Constrained.Base.html#combineNumSpec"><span class="hs-identifier hs-var hs-var">combineNumSpec</span></a></span></span><span> </span><span id="local-6989586621679174288"><span class="annot"><span class="annottext">NumSpec n
</span><a href="#local-6989586621679174288"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679174287"><span class="annot"><span class="annottext">NumSpec n
</span><a href="#local-6989586621679174287"><span class="hs-identifier hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NumSpec n
</span><a href="#local-6989586621679174288"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">NumSpec n
</span><a href="#local-6989586621679174287"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2768"></span><span>  </span><span id="local-6989586621679174286"><span class="annot"><span class="annottext">s'' :: NumSpec n
</span><a href="#local-6989586621679174286"><span class="hs-identifier hs-var">s''</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#NumSpecInterval"><span class="hs-identifier hs-type">NumSpecInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679174285"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679174285"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679174284"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679174284"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679174285"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679174284"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">NumSpec n
</span><a href="#local-6989586621679174286"><span class="hs-identifier hs-var">s''</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2769"></span><span>  </span><span id="local-6989586621679174283"><span class="annot"><span class="annottext">NumSpec n
</span><a href="#local-6989586621679174283"><span class="hs-identifier hs-var">s''</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">NumSpec n
</span><a href="#local-6989586621679174283"><span class="hs-identifier hs-var">s''</span></a></span><span>
</span><span id="line-2770"></span><span>
</span><span id="line-2771"></span><span id="local-6989586621679181906"><span id="local-6989586621679181907"><span class="annot"><a href="Constrained.Base.html#genFromNumSpec"><span class="hs-identifier hs-type">genFromNumSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-2772"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.GenT.html#MonadGenError"><span class="hs-identifier hs-type">MonadGenError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181907"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181906"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/random-1.2.1.1-97d351bf97dd57637441798736e25556058018a1de673671ce7fdce6e47d0d77/share/doc/html/src"><span class="hs-identifier hs-type">Random</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181906"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181906"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Num</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181906"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#MaybeBounded"><span class="hs-identifier hs-type">MaybeBounded</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181906"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-2773"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181906"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2774"></span><span>  </span><span class="annot"><a href="Constrained.GenT.html#GenT"><span class="hs-identifier hs-type">GenT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181907"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181906"><span class="hs-identifier hs-type">n</span></a></span></span></span><span>
</span><span id="line-2775"></span><span id="genFromNumSpec"><span class="annot"><span class="annottext">genFromNumSpec :: forall (m :: * -&gt; *) n.
(MonadGenError m, Show n, Random n, Ord n, Num n,
 MaybeBounded n) =&gt;
NumSpec n -&gt; GenT m n
</span><a href="Constrained.Base.html#genFromNumSpec"><span class="hs-identifier hs-var hs-var">genFromNumSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#NumSpecInterval"><span class="hs-identifier hs-type">NumSpecInterval</span></a></span><span> </span><span id="local-6989586621679174258"><span class="annot"><span class="annottext">Maybe n
</span><a href="#local-6989586621679174258"><span class="hs-identifier hs-var">ml</span></a></span></span><span> </span><span id="local-6989586621679174257"><span class="annot"><span class="annottext">Maybe n
</span><a href="#local-6989586621679174257"><span class="hs-identifier hs-var">mu</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2776"></span><span>  </span><span id="local-6989586621679174256"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679174256"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Monad m =&gt; GenT m Int
</span><a href="Constrained.GenT.html#sizeT"><span class="hs-identifier hs-var">sizeT</span></a></span><span>
</span><span id="line-2777"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Applicative m =&gt; Gen a -&gt; GenT m a
</span><a href="Constrained.GenT.html#pureGen"><span class="hs-identifier hs-var">pureGen</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/QuickCheck-2.14.3-a65fd1c4eb4ae76375c6e3f3845a1ba912285f018239b330ae730fef533366f9/share/doc/html/src"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, Ord a, Num a, Show a) =&gt;
Maybe a -&gt; Maybe a -&gt; Integer -&gt; m (a, a)
</span><a href="Constrained.Base.html#constrainInterval"><span class="hs-identifier hs-var">constrainInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe n
</span><a href="#local-6989586621679174258"><span class="hs-identifier hs-var">ml</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. MaybeBounded a =&gt; Maybe a
</span><a href="Constrained.Base.html#lowerBound"><span class="hs-identifier hs-var">lowerBound</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe n
</span><a href="#local-6989586621679174257"><span class="hs-identifier hs-var">mu</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. MaybeBounded a =&gt; Maybe a
</span><a href="Constrained.Base.html#upperBound"><span class="hs-identifier hs-var">upperBound</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679174256"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2778"></span><span>
</span><span id="line-2779"></span><span id="local-6989586621679181901"><span id="local-6989586621679181902"><span class="annot"><a href="Constrained.Base.html#constrainInterval"><span class="hs-identifier hs-type">constrainInterval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.GenT.html#MonadGenError"><span class="hs-identifier hs-type">MonadGenError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181902"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181901"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Num</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181901"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181901"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181901"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181901"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679181902"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679181901"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679181901"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-2780"></span><span id="constrainInterval"><span class="annot"><span class="annottext">constrainInterval :: forall (m :: * -&gt; *) a.
(MonadGenError m, Ord a, Num a, Show a) =&gt;
Maybe a -&gt; Maybe a -&gt; Integer -&gt; m (a, a)
</span><a href="Constrained.Base.html#constrainInterval"><span class="hs-identifier hs-var hs-var">constrainInterval</span></a></span></span><span> </span><span id="local-6989586621679174199"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679174199"><span class="hs-identifier hs-var">ml</span></a></span></span><span> </span><span id="local-6989586621679174198"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679174198"><span class="hs-identifier hs-var">mu</span></a></span></span><span> </span><span id="local-6989586621679174197"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679174197"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2781"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679174199"><span class="hs-identifier hs-var">ml</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679174198"><span class="hs-identifier hs-var">mu</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2782"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174196"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174196"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2783"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679174195"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174195"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2784"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174195"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">max</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174195"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">negate</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174196"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174196"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2785"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174195"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174195"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174196"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2786"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679174194"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174194"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2787"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174194"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">negate</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174196"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">min</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174194"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174196"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2788"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174194"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174196"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174196"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174194"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2789"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679174193"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174193"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679174192"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174192"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2790"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174193"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174192"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a
</span><a href="Constrained.GenT.html#genError"><span class="hs-identifier hs-var">genError</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;bad interval: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174193"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174192"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2791"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174192"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {p}. (Ord p, Num p) =&gt; p -&gt; p -&gt; p -&gt; p
</span><a href="#local-6989586621679174191"><span class="hs-identifier hs-var">safeSub</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174193"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {p}. (Ord p, Num p) =&gt; p -&gt; p -&gt; p -&gt; p
</span><a href="#local-6989586621679174191"><span class="hs-identifier hs-var">safeSub</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174193"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174192"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174196"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174196"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174192"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2792"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174193"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174193"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall {p}. (Ord p, Num p) =&gt; p -&gt; p -&gt; p -&gt; p
</span><a href="#local-6989586621679174190"><span class="hs-identifier hs-var">safeAdd</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174192"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {p}. (Ord p, Num p) =&gt; p -&gt; p -&gt; p -&gt; p
</span><a href="#local-6989586621679174190"><span class="hs-identifier hs-var">safeAdd</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174192"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174193"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174196"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174196"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2793"></span><span>      </span><span class="hs-comment">-- TODO: this is a bit suspect if the bounds are lopsided</span><span>
</span><span id="line-2794"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">max</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174193"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174196"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">min</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174192"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679174196"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2795"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2796"></span><span>    </span><span id="local-6989586621679174196"><span class="annot"><span class="annottext">r' :: a
</span><a href="#local-6989586621679174196"><span class="hs-identifier hs-var hs-var">r'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">abs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; Integer -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679174197"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-2797"></span><span>    </span><span id="local-6989586621679174191"><span class="annot"><span class="annottext">safeSub :: p -&gt; p -&gt; p -&gt; p
</span><a href="#local-6989586621679174191"><span class="hs-identifier hs-var hs-var">safeSub</span></a></span></span><span> </span><span id="local-6989586621679174183"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679174183"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679174182"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679174182"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679174181"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679174181"><span class="hs-identifier hs-var">b</span></a></span></span><span>
</span><span id="line-2798"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679174182"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679174181"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679174182"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679174183"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-2799"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">max</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679174183"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679174182"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679174181"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2800"></span><span>    </span><span id="local-6989586621679174190"><span class="annot"><span class="annottext">safeAdd :: p -&gt; p -&gt; p -&gt; p
</span><a href="#local-6989586621679174190"><span class="hs-identifier hs-var hs-var">safeAdd</span></a></span></span><span> </span><span id="local-6989586621679174174"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679174174"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679174173"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679174173"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679174172"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679174172"><span class="hs-identifier hs-var">b</span></a></span></span><span>
</span><span id="line-2801"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679174173"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679174172"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679174173"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679174174"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-2802"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">min</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679174174"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679174173"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679174172"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2803"></span><span>
</span><span id="line-2804"></span><span id="local-6989586621679181896"><span class="annot"><a href="Constrained.Base.html#conformsToNumSpec"><span class="hs-identifier hs-type">conformsToNumSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181896"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679181896"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181896"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-2805"></span><span id="conformsToNumSpec"><span class="annot"><span class="annottext">conformsToNumSpec :: forall n. Ord n =&gt; n -&gt; NumSpec n -&gt; Bool
</span><a href="Constrained.Base.html#conformsToNumSpec"><span class="hs-identifier hs-var hs-var">conformsToNumSpec</span></a></span></span><span> </span><span id="local-6989586621679174167"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679174167"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#NumSpecInterval"><span class="hs-identifier hs-type">NumSpecInterval</span></a></span><span> </span><span id="local-6989586621679174166"><span class="annot"><span class="annottext">Maybe n
</span><a href="#local-6989586621679174166"><span class="hs-identifier hs-var">ml</span></a></span></span><span> </span><span id="local-6989586621679174165"><span class="annot"><span class="annottext">Maybe n
</span><a href="#local-6989586621679174165"><span class="hs-identifier hs-var">mu</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679174167"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe n
</span><a href="#local-6989586621679174166"><span class="hs-identifier hs-var">ml</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679174167"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe n
</span><a href="#local-6989586621679174165"><span class="hs-identifier hs-var">mu</span></a></span><span>
</span><span id="line-2806"></span><span>
</span><span id="line-2807"></span><span id="local-6989586621679181893"><span id="local-6989586621679181894"><span class="annot"><a href="Constrained.Base.html#toPredsNumSpec"><span class="hs-identifier hs-type">toPredsNumSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-2808"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181894"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-2809"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#OrdLike"><span class="hs-identifier hs-type">OrdLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181893"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181894"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-2810"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-2811"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181893"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181894"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2812"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181894"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2813"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181893"><span class="hs-identifier hs-type">fn</span></a></span></span></span><span>
</span><span id="line-2814"></span><span id="toPredsNumSpec"><span class="annot"><span class="annottext">toPredsNumSpec :: forall n (fn :: [*] -&gt; * -&gt; *).
(Ord n, OrdLike fn n) =&gt;
Term fn n -&gt; NumSpec n -&gt; Pred fn
</span><a href="Constrained.Base.html#toPredsNumSpec"><span class="hs-identifier hs-var hs-var">toPredsNumSpec</span></a></span></span><span> </span><span id="local-6989586621679174142"><span class="annot"><span class="annottext">Term fn n
</span><a href="#local-6989586621679174142"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#NumSpecInterval"><span class="hs-identifier hs-type">NumSpecInterval</span></a></span><span> </span><span id="local-6989586621679174141"><span class="annot"><span class="annottext">Maybe n
</span><a href="#local-6989586621679174141"><span class="hs-identifier hs-var">ml</span></a></span></span><span> </span><span id="local-6989586621679174140"><span class="annot"><span class="annottext">Maybe n
</span><a href="#local-6989586621679174140"><span class="hs-identifier hs-var">mu</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2815"></span><span>  </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-2816"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
p -&gt; Pred fn
</span><a href="Constrained.Base.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679174139"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(Ord a, OrdLike fn a) =&gt;
Term fn a -&gt; Term fn a -&gt; Term fn Bool
</span><a href="Constrained.Base.html#%3C%3D."><span class="hs-operator hs-var">&lt;=.</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn n
</span><a href="#local-6989586621679174142"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679174139"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679174139"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybeToList</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe n
</span><a href="#local-6989586621679174141"><span class="hs-identifier hs-var">ml</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2817"></span><span>      </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
p -&gt; Pred fn
</span><a href="Constrained.Base.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn n
</span><a href="#local-6989586621679174142"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(Ord a, OrdLike fn a) =&gt;
Term fn a -&gt; Term fn a -&gt; Term fn Bool
</span><a href="Constrained.Base.html#%3C%3D."><span class="hs-operator hs-var">&lt;=.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679174136"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679174136"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679174136"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybeToList</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe n
</span><a href="#local-6989586621679174140"><span class="hs-identifier hs-var">mu</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2818"></span><span>
</span><span id="line-2819"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679174117"><span id="local-6989586621679174135"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679174135"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679174135"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2820"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="TypeSpec"><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span></span><span> </span><span id="local-6989586621679174135"><span class="annot"><a href="#local-6989586621679174135"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-2821"></span><span>  </span><span id="local-6989586621679174114"><span class="annot"><span class="annottext">emptySpec :: TypeSpec fn Int
</span><a href="#local-6989586621679174114"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptySpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. Ord n =&gt; NumSpec n
</span><a href="Constrained.Base.html#emptyNumSpec"><span class="hs-identifier hs-var">emptyNumSpec</span></a></span><span>
</span><span id="line-2822"></span><span>  </span><span id="local-6989586621679174109"><span class="annot"><span class="annottext">combineSpec :: TypeSpec fn Int -&gt; TypeSpec fn Int -&gt; Spec fn Int
</span><a href="#local-6989586621679174109"><span class="hs-identifier hs-var hs-var hs-var hs-var">combineSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) n.
(HasSpec fn n, Ord n, TypeSpec fn n ~ NumSpec n) =&gt;
NumSpec n -&gt; NumSpec n -&gt; Spec fn n
</span><a href="Constrained.Base.html#combineNumSpec"><span class="hs-identifier hs-var">combineNumSpec</span></a></span><span>
</span><span id="line-2823"></span><span>  </span><span id="local-6989586621679174100"><span class="annot"><span class="annottext">genFromTypeSpec :: forall (m :: * -&gt; *).
(HasCallStack, MonadGenError m) =&gt;
TypeSpec fn Int -&gt; GenT m Int
</span><a href="#local-6989586621679174100"><span class="hs-identifier hs-var hs-var hs-var hs-var">genFromTypeSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) n.
(MonadGenError m, Show n, Random n, Ord n, Num n,
 MaybeBounded n) =&gt;
NumSpec n -&gt; GenT m n
</span><a href="Constrained.Base.html#genFromNumSpec"><span class="hs-identifier hs-var">genFromNumSpec</span></a></span><span>
</span><span id="line-2824"></span><span>  </span><span id="local-6989586621679174097"><span class="annot"><span class="annottext">conformsTo :: HasCallStack =&gt; Int -&gt; TypeSpec fn Int -&gt; Bool
</span><a href="#local-6989586621679174097"><span class="hs-identifier hs-var hs-var hs-var hs-var">conformsTo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. Ord n =&gt; n -&gt; NumSpec n -&gt; Bool
</span><a href="Constrained.Base.html#conformsToNumSpec"><span class="hs-identifier hs-var">conformsToNumSpec</span></a></span><span>
</span><span id="line-2825"></span><span>  </span><span id="local-6989586621679174089"><span class="annot"><span class="annottext">toPreds :: Term fn Int -&gt; TypeSpec fn Int -&gt; Pred fn
</span><a href="#local-6989586621679174089"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPreds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n (fn :: [*] -&gt; * -&gt; *).
(Ord n, OrdLike fn n) =&gt;
Term fn n -&gt; NumSpec n -&gt; Pred fn
</span><a href="Constrained.Base.html#toPredsNumSpec"><span class="hs-identifier hs-var">toPredsNumSpec</span></a></span><span>
</span><span id="line-2826"></span><span>
</span><span id="line-2827"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679174068"><span id="local-6989586621679174088"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679174088"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679174088"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2828"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="TypeSpec"><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span></span><span> </span><span id="local-6989586621679174088"><span class="annot"><a href="#local-6989586621679174088"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span>
</span><span id="line-2829"></span><span>  </span><span id="local-6989586621679174065"><span class="annot"><span class="annottext">emptySpec :: TypeSpec fn Integer
</span><a href="#local-6989586621679174065"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptySpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. Ord n =&gt; NumSpec n
</span><a href="Constrained.Base.html#emptyNumSpec"><span class="hs-identifier hs-var">emptyNumSpec</span></a></span><span>
</span><span id="line-2830"></span><span>  </span><span id="local-6989586621679174060"><span class="annot"><span class="annottext">combineSpec :: TypeSpec fn Integer -&gt; TypeSpec fn Integer -&gt; Spec fn Integer
</span><a href="#local-6989586621679174060"><span class="hs-identifier hs-var hs-var hs-var hs-var">combineSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) n.
(HasSpec fn n, Ord n, TypeSpec fn n ~ NumSpec n) =&gt;
NumSpec n -&gt; NumSpec n -&gt; Spec fn n
</span><a href="Constrained.Base.html#combineNumSpec"><span class="hs-identifier hs-var">combineNumSpec</span></a></span><span>
</span><span id="line-2831"></span><span>  </span><span id="local-6989586621679174051"><span class="annot"><span class="annottext">genFromTypeSpec :: forall (m :: * -&gt; *).
(HasCallStack, MonadGenError m) =&gt;
TypeSpec fn Integer -&gt; GenT m Integer
</span><a href="#local-6989586621679174051"><span class="hs-identifier hs-var hs-var hs-var hs-var">genFromTypeSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) n.
(MonadGenError m, Show n, Random n, Ord n, Num n,
 MaybeBounded n) =&gt;
NumSpec n -&gt; GenT m n
</span><a href="Constrained.Base.html#genFromNumSpec"><span class="hs-identifier hs-var">genFromNumSpec</span></a></span><span>
</span><span id="line-2832"></span><span>  </span><span id="local-6989586621679174048"><span class="annot"><span class="annottext">conformsTo :: HasCallStack =&gt; Integer -&gt; TypeSpec fn Integer -&gt; Bool
</span><a href="#local-6989586621679174048"><span class="hs-identifier hs-var hs-var hs-var hs-var">conformsTo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. Ord n =&gt; n -&gt; NumSpec n -&gt; Bool
</span><a href="Constrained.Base.html#conformsToNumSpec"><span class="hs-identifier hs-var">conformsToNumSpec</span></a></span><span>
</span><span id="line-2833"></span><span>  </span><span id="local-6989586621679174040"><span class="annot"><span class="annottext">toPreds :: Term fn Integer -&gt; TypeSpec fn Integer -&gt; Pred fn
</span><a href="#local-6989586621679174040"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPreds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n (fn :: [*] -&gt; * -&gt; *).
(Ord n, OrdLike fn n) =&gt;
Term fn n -&gt; NumSpec n -&gt; Pred fn
</span><a href="Constrained.Base.html#toPredsNumSpec"><span class="hs-identifier hs-var">toPredsNumSpec</span></a></span><span>
</span><span id="line-2834"></span><span>
</span><span id="line-2835"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679174016"><span id="local-6989586621679181883"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181883"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181883"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Ratio</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2836"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="TypeSpec"><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span></span><span> </span><span id="local-6989586621679181883"><span class="annot"><a href="#local-6989586621679181883"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Ratio</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Ratio</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2837"></span><span>  </span><span id="local-6989586621679174010"><span class="annot"><span class="annottext">emptySpec :: TypeSpec fn (Ratio Integer)
</span><a href="#local-6989586621679174010"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptySpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. Ord n =&gt; NumSpec n
</span><a href="Constrained.Base.html#emptyNumSpec"><span class="hs-identifier hs-var">emptyNumSpec</span></a></span><span>
</span><span id="line-2838"></span><span>  </span><span id="local-6989586621679174004"><span class="annot"><span class="annottext">combineSpec :: TypeSpec fn (Ratio Integer)
-&gt; TypeSpec fn (Ratio Integer) -&gt; Spec fn (Ratio Integer)
</span><a href="#local-6989586621679174004"><span class="hs-identifier hs-var hs-var hs-var hs-var">combineSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) n.
(HasSpec fn n, Ord n, TypeSpec fn n ~ NumSpec n) =&gt;
NumSpec n -&gt; NumSpec n -&gt; Spec fn n
</span><a href="Constrained.Base.html#combineNumSpec"><span class="hs-identifier hs-var">combineNumSpec</span></a></span><span>
</span><span id="line-2839"></span><span>  </span><span id="local-6989586621679173993"><span class="annot"><span class="annottext">genFromTypeSpec :: forall (m :: * -&gt; *).
(HasCallStack, MonadGenError m) =&gt;
TypeSpec fn (Ratio Integer) -&gt; GenT m (Ratio Integer)
</span><a href="#local-6989586621679173993"><span class="hs-identifier hs-var hs-var hs-var hs-var">genFromTypeSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) n.
(MonadGenError m, Show n, Random n, Ord n, Num n,
 MaybeBounded n) =&gt;
NumSpec n -&gt; GenT m n
</span><a href="Constrained.Base.html#genFromNumSpec"><span class="hs-identifier hs-var">genFromNumSpec</span></a></span><span>
</span><span id="line-2840"></span><span>  </span><span id="local-6989586621679173989"><span class="annot"><span class="annottext">conformsTo :: HasCallStack =&gt;
Ratio Integer -&gt; TypeSpec fn (Ratio Integer) -&gt; Bool
</span><a href="#local-6989586621679173989"><span class="hs-identifier hs-var hs-var hs-var hs-var">conformsTo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. Ord n =&gt; n -&gt; NumSpec n -&gt; Bool
</span><a href="Constrained.Base.html#conformsToNumSpec"><span class="hs-identifier hs-var">conformsToNumSpec</span></a></span><span>
</span><span id="line-2841"></span><span>  </span><span id="local-6989586621679173980"><span class="annot"><span class="annottext">toPreds :: Term fn (Ratio Integer) -&gt; TypeSpec fn (Ratio Integer) -&gt; Pred fn
</span><a href="#local-6989586621679173980"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPreds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n (fn :: [*] -&gt; * -&gt; *).
(Ord n, OrdLike fn n) =&gt;
Term fn n -&gt; NumSpec n -&gt; Pred fn
</span><a href="Constrained.Base.html#toPredsNumSpec"><span class="hs-identifier hs-var">toPredsNumSpec</span></a></span><span>
</span><span id="line-2842"></span><span>
</span><span id="line-2843"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679173959"><span id="local-6989586621679173979"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173979"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173979"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Natural</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2844"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="TypeSpec"><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span></span><span> </span><span id="local-6989586621679173979"><span class="annot"><a href="#local-6989586621679173979"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Natural</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Natural</span></a></span><span>
</span><span id="line-2845"></span><span>  </span><span id="local-6989586621679173956"><span class="annot"><span class="annottext">emptySpec :: TypeSpec fn Natural
</span><a href="#local-6989586621679173956"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptySpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. Ord n =&gt; NumSpec n
</span><a href="Constrained.Base.html#emptyNumSpec"><span class="hs-identifier hs-var">emptyNumSpec</span></a></span><span>
</span><span id="line-2846"></span><span>  </span><span id="local-6989586621679173951"><span class="annot"><span class="annottext">combineSpec :: TypeSpec fn Natural -&gt; TypeSpec fn Natural -&gt; Spec fn Natural
</span><a href="#local-6989586621679173951"><span class="hs-identifier hs-var hs-var hs-var hs-var">combineSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) n.
(HasSpec fn n, Ord n, TypeSpec fn n ~ NumSpec n) =&gt;
NumSpec n -&gt; NumSpec n -&gt; Spec fn n
</span><a href="Constrained.Base.html#combineNumSpec"><span class="hs-identifier hs-var">combineNumSpec</span></a></span><span>
</span><span id="line-2847"></span><span>  </span><span id="local-6989586621679173942"><span class="annot"><span class="annottext">genFromTypeSpec :: forall (m :: * -&gt; *).
(HasCallStack, MonadGenError m) =&gt;
TypeSpec fn Natural -&gt; GenT m Natural
</span><a href="#local-6989586621679173942"><span class="hs-identifier hs-var hs-var hs-var hs-var">genFromTypeSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) n.
(MonadGenError m, Show n, Random n, Ord n, Num n,
 MaybeBounded n) =&gt;
NumSpec n -&gt; GenT m n
</span><a href="Constrained.Base.html#genFromNumSpec"><span class="hs-identifier hs-var">genFromNumSpec</span></a></span><span>
</span><span id="line-2848"></span><span>  </span><span id="local-6989586621679173939"><span class="annot"><span class="annottext">conformsTo :: HasCallStack =&gt; Natural -&gt; TypeSpec fn Natural -&gt; Bool
</span><a href="#local-6989586621679173939"><span class="hs-identifier hs-var hs-var hs-var hs-var">conformsTo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. Ord n =&gt; n -&gt; NumSpec n -&gt; Bool
</span><a href="Constrained.Base.html#conformsToNumSpec"><span class="hs-identifier hs-var">conformsToNumSpec</span></a></span><span>
</span><span id="line-2849"></span><span>  </span><span id="local-6989586621679173931"><span class="annot"><span class="annottext">toPreds :: Term fn Natural -&gt; TypeSpec fn Natural -&gt; Pred fn
</span><a href="#local-6989586621679173931"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPreds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n (fn :: [*] -&gt; * -&gt; *).
(Ord n, OrdLike fn n) =&gt;
Term fn n -&gt; NumSpec n -&gt; Pred fn
</span><a href="Constrained.Base.html#toPredsNumSpec"><span class="hs-identifier hs-var">toPredsNumSpec</span></a></span><span>
</span><span id="line-2850"></span><span>
</span><span id="line-2851"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679173910"><span id="local-6989586621679173930"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173930"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173930"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word8</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2852"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="TypeSpec"><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span></span><span> </span><span id="local-6989586621679173930"><span class="annot"><a href="#local-6989586621679173930"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span>
</span><span id="line-2853"></span><span>  </span><span id="local-6989586621679173907"><span class="annot"><span class="annottext">emptySpec :: TypeSpec fn Word8
</span><a href="#local-6989586621679173907"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptySpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. Ord n =&gt; NumSpec n
</span><a href="Constrained.Base.html#emptyNumSpec"><span class="hs-identifier hs-var">emptyNumSpec</span></a></span><span>
</span><span id="line-2854"></span><span>  </span><span id="local-6989586621679173902"><span class="annot"><span class="annottext">combineSpec :: TypeSpec fn Word8 -&gt; TypeSpec fn Word8 -&gt; Spec fn Word8
</span><a href="#local-6989586621679173902"><span class="hs-identifier hs-var hs-var hs-var hs-var">combineSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) n.
(HasSpec fn n, Ord n, TypeSpec fn n ~ NumSpec n) =&gt;
NumSpec n -&gt; NumSpec n -&gt; Spec fn n
</span><a href="Constrained.Base.html#combineNumSpec"><span class="hs-identifier hs-var">combineNumSpec</span></a></span><span>
</span><span id="line-2855"></span><span>  </span><span id="local-6989586621679173893"><span class="annot"><span class="annottext">genFromTypeSpec :: forall (m :: * -&gt; *).
(HasCallStack, MonadGenError m) =&gt;
TypeSpec fn Word8 -&gt; GenT m Word8
</span><a href="#local-6989586621679173893"><span class="hs-identifier hs-var hs-var hs-var hs-var">genFromTypeSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) n.
(MonadGenError m, Show n, Random n, Ord n, Num n,
 MaybeBounded n) =&gt;
NumSpec n -&gt; GenT m n
</span><a href="Constrained.Base.html#genFromNumSpec"><span class="hs-identifier hs-var">genFromNumSpec</span></a></span><span>
</span><span id="line-2856"></span><span>  </span><span id="local-6989586621679173890"><span class="annot"><span class="annottext">conformsTo :: HasCallStack =&gt; Word8 -&gt; TypeSpec fn Word8 -&gt; Bool
</span><a href="#local-6989586621679173890"><span class="hs-identifier hs-var hs-var hs-var hs-var">conformsTo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. Ord n =&gt; n -&gt; NumSpec n -&gt; Bool
</span><a href="Constrained.Base.html#conformsToNumSpec"><span class="hs-identifier hs-var">conformsToNumSpec</span></a></span><span>
</span><span id="line-2857"></span><span>  </span><span id="local-6989586621679173882"><span class="annot"><span class="annottext">toPreds :: Term fn Word8 -&gt; TypeSpec fn Word8 -&gt; Pred fn
</span><a href="#local-6989586621679173882"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPreds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n (fn :: [*] -&gt; * -&gt; *).
(Ord n, OrdLike fn n) =&gt;
Term fn n -&gt; NumSpec n -&gt; Pred fn
</span><a href="Constrained.Base.html#toPredsNumSpec"><span class="hs-identifier hs-var">toPredsNumSpec</span></a></span><span>
</span><span id="line-2858"></span><span>
</span><span id="line-2859"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679173861"><span id="local-6989586621679173881"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173881"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173881"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word16</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2860"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="TypeSpec"><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span></span><span> </span><span id="local-6989586621679173881"><span class="annot"><a href="#local-6989586621679173881"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word16</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word16</span></a></span><span>
</span><span id="line-2861"></span><span>  </span><span id="local-6989586621679173858"><span class="annot"><span class="annottext">emptySpec :: TypeSpec fn Word16
</span><a href="#local-6989586621679173858"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptySpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. Ord n =&gt; NumSpec n
</span><a href="Constrained.Base.html#emptyNumSpec"><span class="hs-identifier hs-var">emptyNumSpec</span></a></span><span>
</span><span id="line-2862"></span><span>  </span><span id="local-6989586621679173853"><span class="annot"><span class="annottext">combineSpec :: TypeSpec fn Word16 -&gt; TypeSpec fn Word16 -&gt; Spec fn Word16
</span><a href="#local-6989586621679173853"><span class="hs-identifier hs-var hs-var hs-var hs-var">combineSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) n.
(HasSpec fn n, Ord n, TypeSpec fn n ~ NumSpec n) =&gt;
NumSpec n -&gt; NumSpec n -&gt; Spec fn n
</span><a href="Constrained.Base.html#combineNumSpec"><span class="hs-identifier hs-var">combineNumSpec</span></a></span><span>
</span><span id="line-2863"></span><span>  </span><span id="local-6989586621679173844"><span class="annot"><span class="annottext">genFromTypeSpec :: forall (m :: * -&gt; *).
(HasCallStack, MonadGenError m) =&gt;
TypeSpec fn Word16 -&gt; GenT m Word16
</span><a href="#local-6989586621679173844"><span class="hs-identifier hs-var hs-var hs-var hs-var">genFromTypeSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) n.
(MonadGenError m, Show n, Random n, Ord n, Num n,
 MaybeBounded n) =&gt;
NumSpec n -&gt; GenT m n
</span><a href="Constrained.Base.html#genFromNumSpec"><span class="hs-identifier hs-var">genFromNumSpec</span></a></span><span>
</span><span id="line-2864"></span><span>  </span><span id="local-6989586621679173841"><span class="annot"><span class="annottext">conformsTo :: HasCallStack =&gt; Word16 -&gt; TypeSpec fn Word16 -&gt; Bool
</span><a href="#local-6989586621679173841"><span class="hs-identifier hs-var hs-var hs-var hs-var">conformsTo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. Ord n =&gt; n -&gt; NumSpec n -&gt; Bool
</span><a href="Constrained.Base.html#conformsToNumSpec"><span class="hs-identifier hs-var">conformsToNumSpec</span></a></span><span>
</span><span id="line-2865"></span><span>  </span><span id="local-6989586621679173833"><span class="annot"><span class="annottext">toPreds :: Term fn Word16 -&gt; TypeSpec fn Word16 -&gt; Pred fn
</span><a href="#local-6989586621679173833"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPreds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n (fn :: [*] -&gt; * -&gt; *).
(Ord n, OrdLike fn n) =&gt;
Term fn n -&gt; NumSpec n -&gt; Pred fn
</span><a href="Constrained.Base.html#toPredsNumSpec"><span class="hs-identifier hs-var">toPredsNumSpec</span></a></span><span>
</span><span id="line-2866"></span><span>
</span><span id="line-2867"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679173812"><span id="local-6989586621679173832"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173832"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173832"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word32</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2868"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="TypeSpec"><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span></span><span> </span><span id="local-6989586621679173832"><span class="annot"><a href="#local-6989586621679173832"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word32</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word32</span></a></span><span>
</span><span id="line-2869"></span><span>  </span><span id="local-6989586621679173809"><span class="annot"><span class="annottext">emptySpec :: TypeSpec fn Word32
</span><a href="#local-6989586621679173809"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptySpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. Ord n =&gt; NumSpec n
</span><a href="Constrained.Base.html#emptyNumSpec"><span class="hs-identifier hs-var">emptyNumSpec</span></a></span><span>
</span><span id="line-2870"></span><span>  </span><span id="local-6989586621679173804"><span class="annot"><span class="annottext">combineSpec :: TypeSpec fn Word32 -&gt; TypeSpec fn Word32 -&gt; Spec fn Word32
</span><a href="#local-6989586621679173804"><span class="hs-identifier hs-var hs-var hs-var hs-var">combineSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) n.
(HasSpec fn n, Ord n, TypeSpec fn n ~ NumSpec n) =&gt;
NumSpec n -&gt; NumSpec n -&gt; Spec fn n
</span><a href="Constrained.Base.html#combineNumSpec"><span class="hs-identifier hs-var">combineNumSpec</span></a></span><span>
</span><span id="line-2871"></span><span>  </span><span id="local-6989586621679173795"><span class="annot"><span class="annottext">genFromTypeSpec :: forall (m :: * -&gt; *).
(HasCallStack, MonadGenError m) =&gt;
TypeSpec fn Word32 -&gt; GenT m Word32
</span><a href="#local-6989586621679173795"><span class="hs-identifier hs-var hs-var hs-var hs-var">genFromTypeSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) n.
(MonadGenError m, Show n, Random n, Ord n, Num n,
 MaybeBounded n) =&gt;
NumSpec n -&gt; GenT m n
</span><a href="Constrained.Base.html#genFromNumSpec"><span class="hs-identifier hs-var">genFromNumSpec</span></a></span><span>
</span><span id="line-2872"></span><span>  </span><span id="local-6989586621679173792"><span class="annot"><span class="annottext">conformsTo :: HasCallStack =&gt; Word32 -&gt; TypeSpec fn Word32 -&gt; Bool
</span><a href="#local-6989586621679173792"><span class="hs-identifier hs-var hs-var hs-var hs-var">conformsTo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. Ord n =&gt; n -&gt; NumSpec n -&gt; Bool
</span><a href="Constrained.Base.html#conformsToNumSpec"><span class="hs-identifier hs-var">conformsToNumSpec</span></a></span><span>
</span><span id="line-2873"></span><span>  </span><span id="local-6989586621679173784"><span class="annot"><span class="annottext">toPreds :: Term fn Word32 -&gt; TypeSpec fn Word32 -&gt; Pred fn
</span><a href="#local-6989586621679173784"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPreds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n (fn :: [*] -&gt; * -&gt; *).
(Ord n, OrdLike fn n) =&gt;
Term fn n -&gt; NumSpec n -&gt; Pred fn
</span><a href="Constrained.Base.html#toPredsNumSpec"><span class="hs-identifier hs-var">toPredsNumSpec</span></a></span><span>
</span><span id="line-2874"></span><span>
</span><span id="line-2875"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679173763"><span id="local-6989586621679173783"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173783"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173783"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2876"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="TypeSpec"><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span></span><span> </span><span id="local-6989586621679173783"><span class="annot"><a href="#local-6989586621679173783"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-2877"></span><span>  </span><span id="local-6989586621679173760"><span class="annot"><span class="annottext">emptySpec :: TypeSpec fn Word64
</span><a href="#local-6989586621679173760"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptySpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. Ord n =&gt; NumSpec n
</span><a href="Constrained.Base.html#emptyNumSpec"><span class="hs-identifier hs-var">emptyNumSpec</span></a></span><span>
</span><span id="line-2878"></span><span>  </span><span id="local-6989586621679173755"><span class="annot"><span class="annottext">combineSpec :: TypeSpec fn Word64 -&gt; TypeSpec fn Word64 -&gt; Spec fn Word64
</span><a href="#local-6989586621679173755"><span class="hs-identifier hs-var hs-var hs-var hs-var">combineSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) n.
(HasSpec fn n, Ord n, TypeSpec fn n ~ NumSpec n) =&gt;
NumSpec n -&gt; NumSpec n -&gt; Spec fn n
</span><a href="Constrained.Base.html#combineNumSpec"><span class="hs-identifier hs-var">combineNumSpec</span></a></span><span>
</span><span id="line-2879"></span><span>  </span><span id="local-6989586621679173746"><span class="annot"><span class="annottext">genFromTypeSpec :: forall (m :: * -&gt; *).
(HasCallStack, MonadGenError m) =&gt;
TypeSpec fn Word64 -&gt; GenT m Word64
</span><a href="#local-6989586621679173746"><span class="hs-identifier hs-var hs-var hs-var hs-var">genFromTypeSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) n.
(MonadGenError m, Show n, Random n, Ord n, Num n,
 MaybeBounded n) =&gt;
NumSpec n -&gt; GenT m n
</span><a href="Constrained.Base.html#genFromNumSpec"><span class="hs-identifier hs-var">genFromNumSpec</span></a></span><span>
</span><span id="line-2880"></span><span>  </span><span id="local-6989586621679173743"><span class="annot"><span class="annottext">conformsTo :: HasCallStack =&gt; Word64 -&gt; TypeSpec fn Word64 -&gt; Bool
</span><a href="#local-6989586621679173743"><span class="hs-identifier hs-var hs-var hs-var hs-var">conformsTo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. Ord n =&gt; n -&gt; NumSpec n -&gt; Bool
</span><a href="Constrained.Base.html#conformsToNumSpec"><span class="hs-identifier hs-var">conformsToNumSpec</span></a></span><span>
</span><span id="line-2881"></span><span>  </span><span id="local-6989586621679173735"><span class="annot"><span class="annottext">toPreds :: Term fn Word64 -&gt; TypeSpec fn Word64 -&gt; Pred fn
</span><a href="#local-6989586621679173735"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPreds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n (fn :: [*] -&gt; * -&gt; *).
(Ord n, OrdLike fn n) =&gt;
Term fn n -&gt; NumSpec n -&gt; Pred fn
</span><a href="Constrained.Base.html#toPredsNumSpec"><span class="hs-identifier hs-var">toPredsNumSpec</span></a></span><span>
</span><span id="line-2882"></span><span>
</span><span id="line-2883"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679173714"><span id="local-6989586621679173734"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173734"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173734"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int8</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2884"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="TypeSpec"><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span></span><span> </span><span id="local-6989586621679173734"><span class="annot"><a href="#local-6989586621679173734"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int8</span></a></span><span>
</span><span id="line-2885"></span><span>  </span><span id="local-6989586621679173711"><span class="annot"><span class="annottext">emptySpec :: TypeSpec fn Int8
</span><a href="#local-6989586621679173711"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptySpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. Ord n =&gt; NumSpec n
</span><a href="Constrained.Base.html#emptyNumSpec"><span class="hs-identifier hs-var">emptyNumSpec</span></a></span><span>
</span><span id="line-2886"></span><span>  </span><span id="local-6989586621679173706"><span class="annot"><span class="annottext">combineSpec :: TypeSpec fn Int8 -&gt; TypeSpec fn Int8 -&gt; Spec fn Int8
</span><a href="#local-6989586621679173706"><span class="hs-identifier hs-var hs-var hs-var hs-var">combineSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) n.
(HasSpec fn n, Ord n, TypeSpec fn n ~ NumSpec n) =&gt;
NumSpec n -&gt; NumSpec n -&gt; Spec fn n
</span><a href="Constrained.Base.html#combineNumSpec"><span class="hs-identifier hs-var">combineNumSpec</span></a></span><span>
</span><span id="line-2887"></span><span>  </span><span id="local-6989586621679173697"><span class="annot"><span class="annottext">genFromTypeSpec :: forall (m :: * -&gt; *).
(HasCallStack, MonadGenError m) =&gt;
TypeSpec fn Int8 -&gt; GenT m Int8
</span><a href="#local-6989586621679173697"><span class="hs-identifier hs-var hs-var hs-var hs-var">genFromTypeSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) n.
(MonadGenError m, Show n, Random n, Ord n, Num n,
 MaybeBounded n) =&gt;
NumSpec n -&gt; GenT m n
</span><a href="Constrained.Base.html#genFromNumSpec"><span class="hs-identifier hs-var">genFromNumSpec</span></a></span><span>
</span><span id="line-2888"></span><span>  </span><span id="local-6989586621679173694"><span class="annot"><span class="annottext">conformsTo :: HasCallStack =&gt; Int8 -&gt; TypeSpec fn Int8 -&gt; Bool
</span><a href="#local-6989586621679173694"><span class="hs-identifier hs-var hs-var hs-var hs-var">conformsTo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. Ord n =&gt; n -&gt; NumSpec n -&gt; Bool
</span><a href="Constrained.Base.html#conformsToNumSpec"><span class="hs-identifier hs-var">conformsToNumSpec</span></a></span><span>
</span><span id="line-2889"></span><span>  </span><span id="local-6989586621679173686"><span class="annot"><span class="annottext">toPreds :: Term fn Int8 -&gt; TypeSpec fn Int8 -&gt; Pred fn
</span><a href="#local-6989586621679173686"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPreds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n (fn :: [*] -&gt; * -&gt; *).
(Ord n, OrdLike fn n) =&gt;
Term fn n -&gt; NumSpec n -&gt; Pred fn
</span><a href="Constrained.Base.html#toPredsNumSpec"><span class="hs-identifier hs-var">toPredsNumSpec</span></a></span><span>
</span><span id="line-2890"></span><span>
</span><span id="line-2891"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679173665"><span id="local-6989586621679173685"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173685"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173685"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int16</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2892"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="TypeSpec"><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span></span><span> </span><span id="local-6989586621679173685"><span class="annot"><a href="#local-6989586621679173685"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int16</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int16</span></a></span><span>
</span><span id="line-2893"></span><span>  </span><span id="local-6989586621679173662"><span class="annot"><span class="annottext">emptySpec :: TypeSpec fn Int16
</span><a href="#local-6989586621679173662"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptySpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. Ord n =&gt; NumSpec n
</span><a href="Constrained.Base.html#emptyNumSpec"><span class="hs-identifier hs-var">emptyNumSpec</span></a></span><span>
</span><span id="line-2894"></span><span>  </span><span id="local-6989586621679173657"><span class="annot"><span class="annottext">combineSpec :: TypeSpec fn Int16 -&gt; TypeSpec fn Int16 -&gt; Spec fn Int16
</span><a href="#local-6989586621679173657"><span class="hs-identifier hs-var hs-var hs-var hs-var">combineSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) n.
(HasSpec fn n, Ord n, TypeSpec fn n ~ NumSpec n) =&gt;
NumSpec n -&gt; NumSpec n -&gt; Spec fn n
</span><a href="Constrained.Base.html#combineNumSpec"><span class="hs-identifier hs-var">combineNumSpec</span></a></span><span>
</span><span id="line-2895"></span><span>  </span><span id="local-6989586621679173648"><span class="annot"><span class="annottext">genFromTypeSpec :: forall (m :: * -&gt; *).
(HasCallStack, MonadGenError m) =&gt;
TypeSpec fn Int16 -&gt; GenT m Int16
</span><a href="#local-6989586621679173648"><span class="hs-identifier hs-var hs-var hs-var hs-var">genFromTypeSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) n.
(MonadGenError m, Show n, Random n, Ord n, Num n,
 MaybeBounded n) =&gt;
NumSpec n -&gt; GenT m n
</span><a href="Constrained.Base.html#genFromNumSpec"><span class="hs-identifier hs-var">genFromNumSpec</span></a></span><span>
</span><span id="line-2896"></span><span>  </span><span id="local-6989586621679173645"><span class="annot"><span class="annottext">conformsTo :: HasCallStack =&gt; Int16 -&gt; TypeSpec fn Int16 -&gt; Bool
</span><a href="#local-6989586621679173645"><span class="hs-identifier hs-var hs-var hs-var hs-var">conformsTo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. Ord n =&gt; n -&gt; NumSpec n -&gt; Bool
</span><a href="Constrained.Base.html#conformsToNumSpec"><span class="hs-identifier hs-var">conformsToNumSpec</span></a></span><span>
</span><span id="line-2897"></span><span>  </span><span id="local-6989586621679173637"><span class="annot"><span class="annottext">toPreds :: Term fn Int16 -&gt; TypeSpec fn Int16 -&gt; Pred fn
</span><a href="#local-6989586621679173637"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPreds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n (fn :: [*] -&gt; * -&gt; *).
(Ord n, OrdLike fn n) =&gt;
Term fn n -&gt; NumSpec n -&gt; Pred fn
</span><a href="Constrained.Base.html#toPredsNumSpec"><span class="hs-identifier hs-var">toPredsNumSpec</span></a></span><span>
</span><span id="line-2898"></span><span>
</span><span id="line-2899"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679173616"><span id="local-6989586621679173636"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173636"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173636"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int32</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2900"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="TypeSpec"><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span></span><span> </span><span id="local-6989586621679173636"><span class="annot"><a href="#local-6989586621679173636"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int32</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int32</span></a></span><span>
</span><span id="line-2901"></span><span>  </span><span id="local-6989586621679173613"><span class="annot"><span class="annottext">emptySpec :: TypeSpec fn Int32
</span><a href="#local-6989586621679173613"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptySpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. Ord n =&gt; NumSpec n
</span><a href="Constrained.Base.html#emptyNumSpec"><span class="hs-identifier hs-var">emptyNumSpec</span></a></span><span>
</span><span id="line-2902"></span><span>  </span><span id="local-6989586621679173608"><span class="annot"><span class="annottext">combineSpec :: TypeSpec fn Int32 -&gt; TypeSpec fn Int32 -&gt; Spec fn Int32
</span><a href="#local-6989586621679173608"><span class="hs-identifier hs-var hs-var hs-var hs-var">combineSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) n.
(HasSpec fn n, Ord n, TypeSpec fn n ~ NumSpec n) =&gt;
NumSpec n -&gt; NumSpec n -&gt; Spec fn n
</span><a href="Constrained.Base.html#combineNumSpec"><span class="hs-identifier hs-var">combineNumSpec</span></a></span><span>
</span><span id="line-2903"></span><span>  </span><span id="local-6989586621679173599"><span class="annot"><span class="annottext">genFromTypeSpec :: forall (m :: * -&gt; *).
(HasCallStack, MonadGenError m) =&gt;
TypeSpec fn Int32 -&gt; GenT m Int32
</span><a href="#local-6989586621679173599"><span class="hs-identifier hs-var hs-var hs-var hs-var">genFromTypeSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) n.
(MonadGenError m, Show n, Random n, Ord n, Num n,
 MaybeBounded n) =&gt;
NumSpec n -&gt; GenT m n
</span><a href="Constrained.Base.html#genFromNumSpec"><span class="hs-identifier hs-var">genFromNumSpec</span></a></span><span>
</span><span id="line-2904"></span><span>  </span><span id="local-6989586621679173596"><span class="annot"><span class="annottext">conformsTo :: HasCallStack =&gt; Int32 -&gt; TypeSpec fn Int32 -&gt; Bool
</span><a href="#local-6989586621679173596"><span class="hs-identifier hs-var hs-var hs-var hs-var">conformsTo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. Ord n =&gt; n -&gt; NumSpec n -&gt; Bool
</span><a href="Constrained.Base.html#conformsToNumSpec"><span class="hs-identifier hs-var">conformsToNumSpec</span></a></span><span>
</span><span id="line-2905"></span><span>  </span><span id="local-6989586621679173588"><span class="annot"><span class="annottext">toPreds :: Term fn Int32 -&gt; TypeSpec fn Int32 -&gt; Pred fn
</span><a href="#local-6989586621679173588"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPreds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n (fn :: [*] -&gt; * -&gt; *).
(Ord n, OrdLike fn n) =&gt;
Term fn n -&gt; NumSpec n -&gt; Pred fn
</span><a href="Constrained.Base.html#toPredsNumSpec"><span class="hs-identifier hs-var">toPredsNumSpec</span></a></span><span>
</span><span id="line-2906"></span><span>
</span><span id="line-2907"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679173567"><span id="local-6989586621679173587"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173587"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173587"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int64</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2908"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="TypeSpec"><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span></span><span> </span><span id="local-6989586621679173587"><span class="annot"><a href="#local-6989586621679173587"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int64</span></a></span><span>
</span><span id="line-2909"></span><span>  </span><span id="local-6989586621679173564"><span class="annot"><span class="annottext">emptySpec :: TypeSpec fn Int64
</span><a href="#local-6989586621679173564"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptySpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. Ord n =&gt; NumSpec n
</span><a href="Constrained.Base.html#emptyNumSpec"><span class="hs-identifier hs-var">emptyNumSpec</span></a></span><span>
</span><span id="line-2910"></span><span>  </span><span id="local-6989586621679173559"><span class="annot"><span class="annottext">combineSpec :: TypeSpec fn Int64 -&gt; TypeSpec fn Int64 -&gt; Spec fn Int64
</span><a href="#local-6989586621679173559"><span class="hs-identifier hs-var hs-var hs-var hs-var">combineSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) n.
(HasSpec fn n, Ord n, TypeSpec fn n ~ NumSpec n) =&gt;
NumSpec n -&gt; NumSpec n -&gt; Spec fn n
</span><a href="Constrained.Base.html#combineNumSpec"><span class="hs-identifier hs-var">combineNumSpec</span></a></span><span>
</span><span id="line-2911"></span><span>  </span><span id="local-6989586621679173550"><span class="annot"><span class="annottext">genFromTypeSpec :: forall (m :: * -&gt; *).
(HasCallStack, MonadGenError m) =&gt;
TypeSpec fn Int64 -&gt; GenT m Int64
</span><a href="#local-6989586621679173550"><span class="hs-identifier hs-var hs-var hs-var hs-var">genFromTypeSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) n.
(MonadGenError m, Show n, Random n, Ord n, Num n,
 MaybeBounded n) =&gt;
NumSpec n -&gt; GenT m n
</span><a href="Constrained.Base.html#genFromNumSpec"><span class="hs-identifier hs-var">genFromNumSpec</span></a></span><span>
</span><span id="line-2912"></span><span>  </span><span id="local-6989586621679173547"><span class="annot"><span class="annottext">conformsTo :: HasCallStack =&gt; Int64 -&gt; TypeSpec fn Int64 -&gt; Bool
</span><a href="#local-6989586621679173547"><span class="hs-identifier hs-var hs-var hs-var hs-var">conformsTo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. Ord n =&gt; n -&gt; NumSpec n -&gt; Bool
</span><a href="Constrained.Base.html#conformsToNumSpec"><span class="hs-identifier hs-var">conformsToNumSpec</span></a></span><span>
</span><span id="line-2913"></span><span>  </span><span id="local-6989586621679173539"><span class="annot"><span class="annottext">toPreds :: Term fn Int64 -&gt; TypeSpec fn Int64 -&gt; Pred fn
</span><a href="#local-6989586621679173539"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPreds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n (fn :: [*] -&gt; * -&gt; *).
(Ord n, OrdLike fn n) =&gt;
Term fn n -&gt; NumSpec n -&gt; Pred fn
</span><a href="Constrained.Base.html#toPredsNumSpec"><span class="hs-identifier hs-var">toPredsNumSpec</span></a></span><span>
</span><span id="line-2914"></span><span>
</span><span id="line-2915"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679173519"><span id="local-6989586621679181871"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181871"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181871"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Float</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2916"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="TypeSpec"><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span></span><span> </span><span id="local-6989586621679181871"><span class="annot"><a href="#local-6989586621679181871"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Float</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Float</span></a></span><span>
</span><span id="line-2917"></span><span>  </span><span id="local-6989586621679173515"><span class="annot"><span class="annottext">emptySpec :: TypeSpec fn Float
</span><a href="#local-6989586621679173515"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptySpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. Ord n =&gt; NumSpec n
</span><a href="Constrained.Base.html#emptyNumSpec"><span class="hs-identifier hs-var">emptyNumSpec</span></a></span><span>
</span><span id="line-2918"></span><span>  </span><span id="local-6989586621679173510"><span class="annot"><span class="annottext">combineSpec :: TypeSpec fn Float -&gt; TypeSpec fn Float -&gt; Spec fn Float
</span><a href="#local-6989586621679173510"><span class="hs-identifier hs-var hs-var hs-var hs-var">combineSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) n.
(HasSpec fn n, Ord n, TypeSpec fn n ~ NumSpec n) =&gt;
NumSpec n -&gt; NumSpec n -&gt; Spec fn n
</span><a href="Constrained.Base.html#combineNumSpec"><span class="hs-identifier hs-var">combineNumSpec</span></a></span><span>
</span><span id="line-2919"></span><span>  </span><span id="local-6989586621679173499"><span class="annot"><span class="annottext">genFromTypeSpec :: forall (m :: * -&gt; *).
(HasCallStack, MonadGenError m) =&gt;
TypeSpec fn Float -&gt; GenT m Float
</span><a href="#local-6989586621679173499"><span class="hs-identifier hs-var hs-var hs-var hs-var">genFromTypeSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) n.
(MonadGenError m, Show n, Random n, Ord n, Num n,
 MaybeBounded n) =&gt;
NumSpec n -&gt; GenT m n
</span><a href="Constrained.Base.html#genFromNumSpec"><span class="hs-identifier hs-var">genFromNumSpec</span></a></span><span>
</span><span id="line-2920"></span><span>  </span><span id="local-6989586621679173496"><span class="annot"><span class="annottext">conformsTo :: HasCallStack =&gt; Float -&gt; TypeSpec fn Float -&gt; Bool
</span><a href="#local-6989586621679173496"><span class="hs-identifier hs-var hs-var hs-var hs-var">conformsTo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. Ord n =&gt; n -&gt; NumSpec n -&gt; Bool
</span><a href="Constrained.Base.html#conformsToNumSpec"><span class="hs-identifier hs-var">conformsToNumSpec</span></a></span><span>
</span><span id="line-2921"></span><span>  </span><span id="local-6989586621679173488"><span class="annot"><span class="annottext">toPreds :: Term fn Float -&gt; TypeSpec fn Float -&gt; Pred fn
</span><a href="#local-6989586621679173488"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPreds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n (fn :: [*] -&gt; * -&gt; *).
(Ord n, OrdLike fn n) =&gt;
Term fn n -&gt; NumSpec n -&gt; Pred fn
</span><a href="Constrained.Base.html#toPredsNumSpec"><span class="hs-identifier hs-var">toPredsNumSpec</span></a></span><span>
</span><span id="line-2922"></span><span>
</span><span id="line-2923"></span><span class="hs-comment">-----------------------------------------------------------------------------------</span><span>
</span><span id="line-2924"></span><span class="hs-comment">-- The Base Function universe defines operations on TypeSpec defined in the Base.</span><span>
</span><span id="line-2925"></span><span class="hs-comment">-- See module  Test.Cardano.Ledger.Constrained.V2.Conway for a Universe</span><span>
</span><span id="line-2926"></span><span class="hs-comment">-- that is an extension of the Base Universe.</span><span>
</span><span id="line-2927"></span><span class="hs-comment">-----------------------------------------------------------------------------------</span><span>
</span><span id="line-2928"></span><span>
</span><span id="line-2929"></span><span class="hs-keyword">type</span><span> </span><span id="BaseFns"><span class="annot"><a href="Constrained.Base.html#BaseFns"><span class="hs-identifier hs-var">BaseFns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Base.html#ListFn"><span class="hs-identifier hs-type">ListFn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Univ.html#SumFn"><span class="hs-identifier hs-type">SumFn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Univ.html#MapFn"><span class="hs-identifier hs-type">MapFn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Univ.html#SetFn"><span class="hs-identifier hs-type">SetFn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#FunFn"><span class="hs-identifier hs-type">FunFn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#GenericsFn"><span class="hs-identifier hs-type">GenericsFn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Univ.html#PairFn"><span class="hs-identifier hs-type">PairFn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#IntFn"><span class="hs-identifier hs-type">IntFn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Univ.html#BoolFn"><span class="hs-identifier hs-type">BoolFn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Univ.html#EqFn"><span class="hs-identifier hs-type">EqFn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#OrdFn"><span class="hs-identifier hs-type">OrdFn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2930"></span><span class="hs-keyword">type</span><span> </span><span id="BaseFn"><span class="annot"><a href="Constrained.Base.html#BaseFn"><span class="hs-identifier hs-var">BaseFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Univ.html#Fix"><span class="hs-identifier hs-type">Fix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#OneofL"><span class="hs-identifier hs-type">OneofL</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseFns"><span class="hs-identifier hs-type">BaseFns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2931"></span><span>
</span><span id="line-2932"></span><span class="hs-comment">-- | A minimal Universe contains functions for a bunch of different things.</span><span>
</span><span id="line-2933"></span><span class="hs-keyword">type</span><span> </span><span id="BaseUniverse"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-var">BaseUniverse</span></a></span></span><span> </span><span id="local-6989586621679173483"><span class="annot"><a href="#local-6989586621679173483"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2934"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#Functions"><span class="hs-identifier hs-type">Functions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173483"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173483"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-2935"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Univ.html#Member"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#EqFn"><span class="hs-identifier hs-type">EqFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173483"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679173483"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-2936"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Univ.html#Member"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#SetFn"><span class="hs-identifier hs-type">SetFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173483"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679173483"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-2937"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Univ.html#Member"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#BoolFn"><span class="hs-identifier hs-type">BoolFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173483"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679173483"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-2938"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Univ.html#Member"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#PairFn"><span class="hs-identifier hs-type">PairFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173483"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679173483"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-2939"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Univ.html#Member"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#IntFn"><span class="hs-identifier hs-type">IntFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173483"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679173483"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-2940"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Univ.html#Member"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#OrdFn"><span class="hs-identifier hs-type">OrdFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173483"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679173483"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-2941"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Univ.html#Member"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#GenericsFn"><span class="hs-identifier hs-type">GenericsFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173483"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679173483"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-2942"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Univ.html#Member"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ListFn"><span class="hs-identifier hs-type">ListFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173483"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679173483"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-2943"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Univ.html#Member"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#SumFn"><span class="hs-identifier hs-type">SumFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173483"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679173483"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-2944"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Univ.html#Member"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#MapFn"><span class="hs-identifier hs-type">MapFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173483"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679173483"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-2945"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Univ.html#Member"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#FunFn"><span class="hs-identifier hs-type">FunFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173483"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679173483"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-2946"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-2947"></span><span>
</span><span id="line-2948"></span><span class="hs-comment">-- Higher order functions -------------------------------------------------</span><span>
</span><span id="line-2949"></span><span>
</span><span id="line-2950"></span><span class="annot"><a href="Constrained.Base.html#idFn"><span class="hs-identifier hs-type">idFn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679181869"><span class="annot"><a href="#local-6989586621679181869"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679181868"><span class="annot"><a href="#local-6989586621679181868"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.Univ.html#Member"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#FunFn"><span class="hs-identifier hs-type">FunFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181869"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679181869"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679181869"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679181868"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679181868"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2951"></span><span id="idFn"><span class="annot"><span class="annottext">idFn :: forall (fn :: [*] -&gt; * -&gt; *) a. Member (FunFn fn) fn =&gt; fn '[a] a
</span><a href="Constrained.Base.html#idFn"><span class="hs-identifier hs-var hs-var">idFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. FunFn fn '[a] a
</span><a href="Constrained.Base.html#Id"><span class="hs-identifier hs-var">Id</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679181869"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-2952"></span><span>
</span><span id="line-2953"></span><span id="local-6989586621679181860"><span id="local-6989586621679181861"><span id="local-6989586621679181862"><span id="local-6989586621679181863"><span class="annot"><a href="Constrained.Base.html#composeFn"><span class="hs-identifier hs-type">composeFn</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-2954"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Univ.html#Member"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#FunFn"><span class="hs-identifier hs-type">FunFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181863"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679181863"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-2955"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181863"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181862"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-2956"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679181863"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679181861"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679181862"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2957"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679181863"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679181862"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679181860"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2958"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679181863"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679181861"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679181862"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2959"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679181863"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679181862"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679181860"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2960"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-2961"></span><span>  </span><span class="annot"><a href="#local-6989586621679181863"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679181862"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679181860"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2962"></span><span>  </span><span class="annot"><a href="#local-6989586621679181863"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679181861"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679181862"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2963"></span><span>  </span><span class="annot"><a href="#local-6989586621679181863"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679181861"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679181860"><span class="hs-identifier hs-type">c</span></a></span></span></span></span></span><span>
</span><span id="line-2964"></span><span id="composeFn"><span class="annot"><span class="annottext">composeFn :: forall (fn :: [*] -&gt; * -&gt; *) b a c.
(Member (FunFn fn) fn, HasSpec fn b, Show (fn '[a] b),
 Show (fn '[b] c), Eq (fn '[a] b), Eq (fn '[b] c)) =&gt;
fn '[b] c -&gt; fn '[a] b -&gt; fn '[a] c
</span><a href="Constrained.Base.html#composeFn"><span class="hs-identifier hs-var hs-var">composeFn</span></a></span></span><span> </span><span id="local-6989586621679173463"><span class="annot"><span class="annottext">fn '[b] c
</span><a href="#local-6989586621679173463"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679173462"><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679173462"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) a c.
(Typeable a, HasSpec fn a, Show (fn '[a] a), Show (fn '[a] c),
 Eq (fn '[a] a), Eq (fn '[a] c)) =&gt;
fn '[a] c -&gt; fn '[a] a -&gt; FunFn fn '[a] c
</span><a href="Constrained.Base.html#Compose"><span class="hs-identifier hs-var">Compose</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[b] c
</span><a href="#local-6989586621679173463"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679173462"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-2965"></span><span>
</span><span id="line-2966"></span><span class="hs-keyword">data</span><span> </span><span id="FunFn"><span class="annot"><a href="Constrained.Base.html#FunFn"><span class="hs-identifier hs-var">FunFn</span></a></span></span><span> </span><span id="local-6989586621679173460"><span class="annot"><a href="#local-6989586621679173460"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679173459"><span class="annot"><a href="#local-6989586621679173459"><span class="hs-identifier hs-type">args</span></a></span></span><span> </span><span id="local-6989586621679173458"><span class="annot"><a href="#local-6989586621679173458"><span class="hs-identifier hs-type">res</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2967"></span><span>  </span><span id="local-6989586621679181864"><span id="local-6989586621679181865"><span id="Id"><span class="annot"><a href="Constrained.Base.html#Id"><span class="hs-identifier hs-var">Id</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#FunFn"><span class="hs-identifier hs-type">FunFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181865"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679181864"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679181864"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-2968"></span><span>  </span><span id="local-6989586621679173456"><span id="local-6989586621679173457"><span id="local-6989586621679181854"><span id="local-6989586621679181855"><span id="Compose"><span class="annot"><a href="Constrained.Base.html#Compose"><span class="hs-identifier hs-var">Compose</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-2969"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173457"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-2970"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181855"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173457"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-2971"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679181855"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679173456"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679173457"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2972"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679181855"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679173457"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679181854"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2973"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679181855"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679173456"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679173457"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2974"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679181855"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679173457"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679181854"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2975"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-2976"></span><span>    </span><span class="annot"><a href="#local-6989586621679181855"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679173457"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679181854"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2977"></span><span>    </span><span class="annot"><a href="#local-6989586621679181855"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679173456"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679173457"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2978"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#FunFn"><span class="hs-identifier hs-type">FunFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181855"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679173456"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679181854"><span class="hs-identifier hs-type">c</span></a></span></span></span></span></span><span>
</span><span id="line-2979"></span><span>
</span><span id="line-2980"></span><span class="hs-comment">-- TODO: Doing this opens up a few issues:</span><span>
</span><span id="line-2981"></span><span class="hs-comment">-- 1. You need the functions to be linear</span><span>
</span><span id="line-2982"></span><span class="hs-comment">-- 2. You will need to track free variables</span><span>
</span><span id="line-2983"></span><span class="hs-comment">--    in functions</span><span>
</span><span id="line-2984"></span><span class="hs-comment">-- 3. You will need to sort out dependencies</span><span>
</span><span id="line-2985"></span><span class="hs-comment">--    in functions (just do it the normal way,</span><span>
</span><span id="line-2986"></span><span class="hs-comment">--    left depends on right)</span><span>
</span><span id="line-2987"></span><span class="hs-comment">-- 4. You need to turn `mapSpec` into something that</span><span>
</span><span id="line-2988"></span><span class="hs-comment">--    takes a whole context instead of just a `fn`</span><span>
</span><span id="line-2989"></span><span class="hs-comment">-- Another option to avoid (2) and (3) is to simply</span><span>
</span><span id="line-2990"></span><span class="hs-comment">-- require that lambdas are closed. This might be a</span><span>
</span><span id="line-2991"></span><span class="hs-comment">-- workeable first step that we can get quite far on.</span><span>
</span><span id="line-2992"></span><span class="hs-comment">-- Lam :: (HasSpec fn a, HasSpec fn b)</span><span>
</span><span id="line-2993"></span><span class="hs-comment">--       =&gt; Var a -&gt; Term fn b -&gt; FunFn fn '[a] b</span><span>
</span><span id="line-2994"></span><span>
</span><span id="line-2995"></span><span id="local-6989586621679173450"><span id="local-6989586621679173452"><span id="local-6989586621679173454"><span id="local-6989586621679181851"><span id="local-6989586621679181852"><span id="local-6989586621679181853"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#FunFn"><span class="hs-identifier hs-type">FunFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181853"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181852"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181851"><span class="hs-identifier hs-type">res</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-2996"></span><span>
</span><span id="line-2997"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679173447"><span id="local-6989586621679181848"><span id="local-6989586621679181849"><span id="local-6989586621679181850"><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181850"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#FunFn"><span class="hs-identifier hs-type">FunFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181850"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181849"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181848"><span class="hs-identifier hs-type">res</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2998"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Compose"><span class="hs-identifier hs-type">Compose</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679173438"><span id="local-6989586621679173439"><span id="local-6989586621679173437"><span class="annot"><span class="annottext">fn '[b] res
</span><a href="#local-6989586621679173437"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679181850"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679173439"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679173438"><span class="hs-identifier hs-type">c</span></a></span></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679173436"><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679173436"><span class="hs-identifier hs-var">f'</span></a></span></span><span> </span><span id="local-6989586621679173435"><span class="annot"><span class="annottext">== :: FunFn fn args res -&gt; FunFn fn args res -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#Compose"><span class="hs-identifier hs-type">Compose</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679173421"><span id="local-6989586621679173422"><span id="local-6989586621679173420"><span class="annot"><span class="annottext">fn '[b] res
</span><a href="#local-6989586621679173420"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679181850"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679173422"><span class="hs-identifier hs-type">b'</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679173421"><span class="hs-identifier hs-type">c'</span></a></span></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679173419"><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679173419"><span class="hs-identifier hs-var">g'</span></a></span></span><span>
</span><span id="line-2999"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><span class="annottext">b :~: b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Refl</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {k} (a :: k) (b :: k).
(Typeable a, Typeable b) =&gt;
Maybe (a :~: b)
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">eqT</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679173439"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679173422"><span class="hs-identifier hs-type">b'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">fn '[b] res
</span><a href="#local-6989586621679173437"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[b] res
</span><a href="#local-6989586621679173420"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679173436"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679173419"><span class="hs-identifier hs-var">g'</span></a></span><span>
</span><span id="line-3000"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Compose"><span class="hs-identifier hs-type">Compose</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">FunFn fn args res
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-3001"></span><span>  </span><span class="annot"><span class="annottext">FunFn fn args res
</span><a href="Constrained.Base.html#Id"><span class="hs-identifier hs-var">Id</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">FunFn fn args res
</span><a href="Constrained.Base.html#Id"><span class="hs-identifier hs-var">Id</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-3002"></span><span>  </span><span class="annot"><span class="annottext">FunFn fn args res
</span><a href="Constrained.Base.html#Id"><span class="hs-identifier hs-var">Id</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">FunFn fn args res
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-3003"></span><span>
</span><span id="line-3004"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679181840"><span class="annot"><a href="Constrained.Univ.html#FunctionLike"><span class="hs-identifier hs-type">FunctionLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181840"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Univ.html#FunctionLike"><span class="hs-identifier hs-type">FunctionLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#FunFn"><span class="hs-identifier hs-type">FunFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181840"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3005"></span><span>  </span><span id="local-6989586621679173401"><span class="annot"><span class="annottext">sem :: forall (as :: [*]) b. FunFn fn as b -&gt; FunTy as b
</span><a href="#local-6989586621679173401"><span class="hs-identifier hs-var hs-var hs-var hs-var">sem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-3006"></span><span>    </span><span class="annot"><span class="annottext">FunFn fn as b
</span><a href="Constrained.Base.html#Id"><span class="hs-identifier hs-var">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-3007"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Compose"><span class="hs-identifier hs-type">Compose</span></a></span><span> </span><span id="local-6989586621679173390"><span class="annot"><span class="annottext">fn '[b] b
</span><a href="#local-6989586621679173390"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679173389"><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679173389"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (as :: [*]) b.
FunctionLike fn =&gt;
fn as b -&gt; FunTy as b
</span><a href="Constrained.Univ.html#sem"><span class="hs-identifier hs-var">sem</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[b] b
</span><a href="#local-6989586621679173390"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (as :: [*]) b.
FunctionLike fn =&gt;
fn as b -&gt; FunTy as b
</span><a href="Constrained.Univ.html#sem"><span class="hs-identifier hs-var">sem</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679173389"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-3008"></span><span>
</span><span id="line-3009"></span><span class="hs-comment">-- Lam x t -&gt; \ a -&gt; errorGE $ runTerm (singletonEnv x a) t</span><span>
</span><span id="line-3010"></span><span>
</span><span id="line-3011"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679181834"><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181834"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Univ.html#Member"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#FunFn"><span class="hs-identifier hs-type">FunFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181834"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679181834"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Functions"><span class="hs-identifier hs-type">Functions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#FunFn"><span class="hs-identifier hs-type">FunFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181834"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679181834"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3012"></span><span>  </span><span id="local-6989586621679173365"><span class="annot"><span class="annottext">propagateSpecFun :: forall (as :: [*]) a b.
(TypeList as, Typeable as, HasSpec fn a, All (HasSpec fn) as) =&gt;
FunFn fn as b
-&gt; ListCtx Value as (HOLE a) -&gt; Spec fn b -&gt; Spec fn a
</span><a href="#local-6989586621679173365"><span class="hs-identifier hs-var hs-var hs-var hs-var">propagateSpecFun</span></a></span></span><span> </span><span class="annot"><span class="annottext">FunFn fn as b
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span id="local-6989586621679173364"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679173364"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679173364"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-3013"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var">propagateSpecFun</span></a></span><span> </span><span id="local-6989586621679173363"><span class="annot"><span class="annottext">FunFn fn as b
</span><a href="#local-6989586621679173363"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679173362"><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679173362"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679173361"><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679173361"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FunFn fn as b
</span><a href="#local-6989586621679173363"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3014"></span><span>    </span><span class="annot"><span class="annottext">FunFn fn as b
</span><a href="Constrained.Base.html#Id"><span class="hs-identifier hs-var">Id</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.List.html#NilCtx"><span class="hs-identifier hs-type">NilCtx</span></a></span><span> </span><span class="annot"><span class="annottext">HOLE a b
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679173362"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679173361"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-3015"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Compose"><span class="hs-identifier hs-type">Compose</span></a></span><span> </span><span id="local-6989586621679173347"><span class="annot"><span class="annottext">fn '[b] b
</span><a href="#local-6989586621679173347"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679173346"><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679173346"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.List.html#NilCtx"><span class="hs-identifier hs-type">NilCtx</span></a></span><span> </span><span class="annot"><span class="annottext">HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679173362"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: [*] -&gt; * -&gt; *) (fn :: [*] -&gt; * -&gt; *) (as :: [*]) a b.
(Functions f fn, TypeList as, Typeable as, HasSpec fn a,
 All (HasSpec fn) as) =&gt;
f as b -&gt; ListCtx Value as (HOLE a) -&gt; Spec fn b -&gt; Spec fn a
</span><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var">propagateSpecFun</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679173346"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (c :: * -&gt; *) a (f :: * -&gt; *). c a -&gt; ListCtx f '[a] c
</span><a href="Constrained.List.html#NilCtx"><span class="hs-identifier hs-var">NilCtx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: [*] -&gt; * -&gt; *) (fn :: [*] -&gt; * -&gt; *) (as :: [*]) a b.
(Functions f fn, TypeList as, Typeable as, HasSpec fn a,
 All (HasSpec fn) as) =&gt;
f as b -&gt; ListCtx Value as (HOLE a) -&gt; Spec fn b -&gt; Spec fn a
</span><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var">propagateSpecFun</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[b] b
</span><a href="#local-6989586621679173347"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (c :: * -&gt; *) a (f :: * -&gt; *). c a -&gt; ListCtx f '[a] c
</span><a href="Constrained.List.html#NilCtx"><span class="hs-identifier hs-var">NilCtx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679173361"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-3016"></span><span>
</span><span id="line-3017"></span><span>  </span><span class="hs-comment">-- Lam x t | NilCtx HOLE &lt;- ctx -&gt; fromGE ErrorSpec $ propagateSpec spec &lt;$&gt; toCtx x t</span><span>
</span><span id="line-3018"></span><span>
</span><span id="line-3019"></span><span>  </span><span class="hs-comment">-- NOTE: this function over-approximates and returns a liberal spec.</span><span>
</span><span id="line-3020"></span><span>  </span><span id="local-6989586621679173319"><span class="annot"><span class="annottext">mapTypeSpec :: forall a b.
(HasSpec fn a, HasSpec fn b) =&gt;
FunFn fn '[a] b -&gt; TypeSpec fn a -&gt; Spec fn b
</span><a href="#local-6989586621679173319"><span class="hs-identifier hs-var hs-var hs-var hs-var">mapTypeSpec</span></a></span></span><span> </span><span id="local-6989586621679173318"><span class="annot"><span class="annottext">FunFn fn '[a] b
</span><a href="#local-6989586621679173318"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679173317"><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679173317"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FunFn fn '[a] b
</span><a href="#local-6989586621679173318"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3021"></span><span>    </span><span class="annot"><span class="annottext">FunFn fn '[a] b
</span><a href="Constrained.Base.html#Id"><span class="hs-identifier hs-var">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679173317"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-3022"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Compose"><span class="hs-identifier hs-type">Compose</span></a></span><span> </span><span id="local-6989586621679173299"><span class="annot"><span class="annottext">fn '[b] b
</span><a href="#local-6989586621679173299"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679173298"><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679173298"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
(HasSpec fn a, HasSpec fn b) =&gt;
fn '[a] b -&gt; Spec fn a -&gt; Spec fn b
</span><a href="Constrained.Base.html#mapSpec"><span class="hs-identifier hs-var">mapSpec</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[b] b
</span><a href="#local-6989586621679173299"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
(HasSpec fn a, HasSpec fn b) =&gt;
fn '[a] b -&gt; Spec fn a -&gt; Spec fn b
</span><a href="Constrained.Base.html#mapSpec"><span class="hs-identifier hs-var">mapSpec</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679173298"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679173317"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-3023"></span><span>
</span><span id="line-3024"></span><span>  </span><span id="local-6989586621679173293"><span class="annot"><span class="annottext">rewriteRules :: forall (as :: [*]) b.
(TypeList as, Typeable as, HasSpec fn b, All (HasSpec fn) as) =&gt;
FunFn fn as b -&gt; [RewriteRule fn b]
</span><a href="#local-6989586621679173293"><span class="hs-identifier hs-var hs-var hs-var hs-var">rewriteRules</span></a></span></span><span> </span><span id="local-6989586621679173292"><span class="annot"><span class="annottext">f :: FunFn fn as b
</span><a href="#local-6989586621679173292"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">FunFn fn as b
</span><a href="Constrained.Base.html#Id"><span class="hs-identifier hs-var">Id</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3025"></span><span>    </span><span class="hs-comment">-- No TypeAbstractions in ghc-8.10</span><span>
</span><span id="line-3026"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FunFn fn as b
</span><a href="#local-6989586621679173292"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3027"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679173276"><span class="annot"><span class="annottext">FunFn fn '[b] b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#FunFn"><span class="hs-identifier hs-type">FunFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181834"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679173276"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679173276"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3028"></span><span>        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall (as :: [*]) (fn :: [*] -&gt; * -&gt; *) r b.
(All (HasSpec fn) as, HasSpec fn b, TypeList as,
 r ~ FunTy (MapList (Term fn) as) (PatternPair fn b),
 RewriteArgumentTypes r ~ as) =&gt;
r -&gt; RewriteRule fn b
</span><a href="Constrained.Base.html#rewriteRule_"><span class="hs-identifier hs-var">rewriteRule_</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679173275"><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679173275"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. FunFn fn '[a] a
</span><a href="Constrained.Base.html#Id"><span class="hs-identifier hs-var">Id</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679181834"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679173276"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679173275"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Pattern fn a -&gt; Pattern fn a -&gt; PatternPair fn a
</span><a href="Constrained.Base.html#~%3E"><span class="hs-operator hs-var">~&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679173275"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3029"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#rewriteRules"><span class="hs-identifier hs-var">rewriteRules</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Compose"><span class="hs-identifier hs-type">Compose</span></a></span><span> </span><span id="local-6989586621679173229"><span class="annot"><span class="annottext">fn '[b] b
</span><a href="#local-6989586621679173229"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679173228"><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679173228"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3030"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall (as :: [*]) (fn :: [*] -&gt; * -&gt; *) r b.
(All (HasSpec fn) as, HasSpec fn b, TypeList as,
 r ~ FunTy (MapList (Term fn) as) (PatternPair fn b),
 RewriteArgumentTypes r ~ as) =&gt;
r -&gt; RewriteRule fn b
</span><a href="Constrained.Base.html#rewriteRule_"><span class="hs-identifier hs-var">rewriteRule_</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679173227"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679173227"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) a c.
(Typeable a, HasSpec fn a, Show (fn '[a] a), Show (fn '[a] c),
 Eq (fn '[a] a), Eq (fn '[a] c)) =&gt;
fn '[a] c -&gt; fn '[a] a -&gt; FunFn fn '[a] c
</span><a href="Constrained.Base.html#Compose"><span class="hs-identifier hs-var">Compose</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[b] b
</span><a href="#local-6989586621679173229"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679173228"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679173227"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Pattern fn a -&gt; Pattern fn a -&gt; PatternPair fn a
</span><a href="Constrained.Base.html#~%3E"><span class="hs-operator hs-var">~&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[b] b
</span><a href="#local-6989586621679173229"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679173228"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679173227"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-3031"></span><span>
</span><span id="line-3032"></span><span class="hs-comment">-- TODO: to solve this problem we need to generalize mapSpec to work on contexts, which means</span><span>
</span><span id="line-3033"></span><span class="hs-comment">-- we need to generalize mapTypeSpec to work on contexts too</span><span>
</span><span id="line-3034"></span><span class="hs-comment">-- Lam x t -&gt; _</span><span>
</span><span id="line-3035"></span><span>
</span><span id="line-3036"></span><span class="hs-comment">-- Ord functions ----------------------------------------------------------</span><span>
</span><span id="line-3037"></span><span>
</span><span id="line-3038"></span><span class="annot"><a href="Constrained.Base.html#lessOrEqualFn"><span class="hs-identifier hs-type">lessOrEqualFn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679181819"><span class="annot"><a href="#local-6989586621679181819"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679181820"><span class="annot"><a href="#local-6989586621679181820"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181820"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#OrdLike"><span class="hs-identifier hs-type">OrdLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181819"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181820"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679181819"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679181820"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679181820"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-3039"></span><span id="lessOrEqualFn"><span class="annot"><span class="annottext">lessOrEqualFn :: forall (fn :: [*] -&gt; * -&gt; *) a.
(Ord a, OrdLike fn a) =&gt;
fn '[a, a] Bool
</span><a href="Constrained.Base.html#lessOrEqualFn"><span class="hs-identifier hs-var hs-var">lessOrEqualFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(Ord a, OrdLike fn a) =&gt;
OrdFn fn '[a, a] Bool
</span><a href="Constrained.Base.html#LessOrEqual"><span class="hs-identifier hs-var">LessOrEqual</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679181819"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3040"></span><span>
</span><span id="line-3041"></span><span class="annot"><a href="Constrained.Base.html#lessFn"><span class="hs-identifier hs-type">lessFn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679173215"><span class="annot"><a href="#local-6989586621679173215"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679173214"><span class="annot"><a href="#local-6989586621679173214"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173214"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#OrdLike"><span class="hs-identifier hs-type">OrdLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173215"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173214"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679173215"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679173214"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679173214"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-3042"></span><span id="lessFn"><span class="annot"><span class="annottext">lessFn :: forall (fn :: [*] -&gt; * -&gt; *) a.
(Ord a, OrdLike fn a) =&gt;
fn '[a, a] Bool
</span><a href="Constrained.Base.html#lessFn"><span class="hs-identifier hs-var hs-var">lessFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(Ord a, OrdLike fn a) =&gt;
OrdFn fn '[a, a] Bool
</span><a href="Constrained.Base.html#Less"><span class="hs-identifier hs-var">Less</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679173215"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3043"></span><span>
</span><span id="line-3044"></span><span class="hs-keyword">data</span><span> </span><span id="OrdFn"><span class="annot"><a href="Constrained.Base.html#OrdFn"><span class="hs-identifier hs-var">OrdFn</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679173204"><span class="annot"><a href="#local-6989586621679173204"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679173203"><span class="annot"><a href="#local-6989586621679173203"><span class="hs-keyword hs-type">as</span></a></span></span><span> </span><span id="local-6989586621679173202"><span class="annot"><a href="#local-6989586621679173202"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3045"></span><span>  </span><span id="local-6989586621679173201"><span id="local-6989586621679181816"><span id="LessOrEqual"><span class="annot"><a href="Constrained.Base.html#LessOrEqual"><span class="hs-identifier hs-var">LessOrEqual</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173201"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#OrdLike"><span class="hs-identifier hs-type">OrdLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181816"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173201"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#OrdFn"><span class="hs-identifier hs-type">OrdFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181816"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679173201"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679173201"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span><span>
</span><span id="line-3046"></span><span>  </span><span id="local-6989586621679173199"><span id="local-6989586621679173200"><span id="Less"><span class="annot"><a href="Constrained.Base.html#Less"><span class="hs-identifier hs-var">Less</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173200"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#OrdLike"><span class="hs-identifier hs-type">OrdLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173199"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173200"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#OrdFn"><span class="hs-identifier hs-type">OrdFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679173199"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679173200"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679173200"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span><span>
</span><span id="line-3047"></span><span>
</span><span id="line-3048"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182191"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="OrdLike"><span class="annot"><a href="Constrained.Base.html#OrdLike"><span class="hs-identifier hs-var">OrdLike</span></a></span></span><span> </span><span id="local-6989586621679182191"><span class="annot"><a href="#local-6989586621679182191"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679182190"><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3049"></span><span>  </span><span id="leqSpec"><span class="annot"><a href="Constrained.Base.html#leqSpec"><span class="hs-identifier hs-type">leqSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182191"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3050"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="leqSpec"><span class="annot"><a href="Constrained.Base.html#leqSpec"><span class="hs-identifier hs-type">leqSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3051"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182191"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182191"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3052"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSimpleRep"><span class="hs-identifier hs-type">HasSimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3053"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#OrdLike"><span class="hs-identifier hs-type">OrdLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182191"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3054"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3055"></span><span>    </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3056"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182191"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3057"></span><span>  </span><span id="local-6989586621679173197"><span class="annot"><a href="Constrained.Base.html#leqSpec"><span class="hs-identifier hs-var hs-var">leqSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, HasSimpleRep a,
 TypeSpec fn a ~ TypeSpec fn (SimpleRep a)) =&gt;
Spec fn (SimpleRep a) -&gt; Spec fn a
</span><a href="Constrained.Base.html#fromSimpleRepSpec"><span class="hs-identifier hs-var">fromSimpleRepSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. OrdLike fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#leqSpec"><span class="hs-identifier hs-var">leqSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182191"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. HasSimpleRep a =&gt; a -&gt; SimpleRep a
</span><a href="Constrained.Base.html#toSimpleRep"><span class="hs-identifier hs-var">toSimpleRep</span></a></span></span><span>
</span><span id="line-3058"></span><span>
</span><span id="line-3059"></span><span>  </span><span id="ltSpec"><span class="annot"><a href="Constrained.Base.html#ltSpec"><span class="hs-identifier hs-type">ltSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182191"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3060"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="ltSpec"><span class="annot"><a href="Constrained.Base.html#ltSpec"><span class="hs-identifier hs-type">ltSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3061"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182191"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182191"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3062"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSimpleRep"><span class="hs-identifier hs-type">HasSimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3063"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#OrdLike"><span class="hs-identifier hs-type">OrdLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182191"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3064"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3065"></span><span>    </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3066"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182191"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3067"></span><span>  </span><span id="local-6989586621679173184"><span class="annot"><a href="Constrained.Base.html#ltSpec"><span class="hs-identifier hs-var hs-var">ltSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, HasSimpleRep a,
 TypeSpec fn a ~ TypeSpec fn (SimpleRep a)) =&gt;
Spec fn (SimpleRep a) -&gt; Spec fn a
</span><a href="Constrained.Base.html#fromSimpleRepSpec"><span class="hs-identifier hs-var">fromSimpleRepSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. OrdLike fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#ltSpec"><span class="hs-identifier hs-var">ltSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182191"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. HasSimpleRep a =&gt; a -&gt; SimpleRep a
</span><a href="Constrained.Base.html#toSimpleRep"><span class="hs-identifier hs-var">toSimpleRep</span></a></span></span><span>
</span><span id="line-3068"></span><span>
</span><span id="line-3069"></span><span>  </span><span id="geqSpec"><span class="annot"><a href="Constrained.Base.html#geqSpec"><span class="hs-identifier hs-type">geqSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182191"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3070"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="geqSpec"><span class="annot"><a href="Constrained.Base.html#geqSpec"><span class="hs-identifier hs-type">geqSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3071"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182191"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182191"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3072"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSimpleRep"><span class="hs-identifier hs-type">HasSimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3073"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#OrdLike"><span class="hs-identifier hs-type">OrdLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182191"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3074"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3075"></span><span>    </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3076"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182191"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3077"></span><span>  </span><span id="local-6989586621679173172"><span class="annot"><a href="Constrained.Base.html#geqSpec"><span class="hs-identifier hs-var hs-var">geqSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, HasSimpleRep a,
 TypeSpec fn a ~ TypeSpec fn (SimpleRep a)) =&gt;
Spec fn (SimpleRep a) -&gt; Spec fn a
</span><a href="Constrained.Base.html#fromSimpleRepSpec"><span class="hs-identifier hs-var">fromSimpleRepSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. OrdLike fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#geqSpec"><span class="hs-identifier hs-var">geqSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182191"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. HasSimpleRep a =&gt; a -&gt; SimpleRep a
</span><a href="Constrained.Base.html#toSimpleRep"><span class="hs-identifier hs-var">toSimpleRep</span></a></span></span><span>
</span><span id="line-3078"></span><span>
</span><span id="line-3079"></span><span>  </span><span id="gtSpec"><span class="annot"><a href="Constrained.Base.html#gtSpec"><span class="hs-identifier hs-type">gtSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182191"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3080"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="gtSpec"><span class="annot"><a href="Constrained.Base.html#gtSpec"><span class="hs-identifier hs-type">gtSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3081"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182191"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182191"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3082"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSimpleRep"><span class="hs-identifier hs-type">HasSimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3083"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#OrdLike"><span class="hs-identifier hs-type">OrdLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182191"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3084"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3085"></span><span>    </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3086"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182191"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182190"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3087"></span><span>  </span><span id="local-6989586621679173160"><span class="annot"><a href="Constrained.Base.html#gtSpec"><span class="hs-identifier hs-var hs-var">gtSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, HasSimpleRep a,
 TypeSpec fn a ~ TypeSpec fn (SimpleRep a)) =&gt;
Spec fn (SimpleRep a) -&gt; Spec fn a
</span><a href="Constrained.Base.html#fromSimpleRepSpec"><span class="hs-identifier hs-var">fromSimpleRepSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. OrdLike fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#gtSpec"><span class="hs-identifier hs-var">gtSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182191"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. HasSimpleRep a =&gt; a -&gt; SimpleRep a
</span><a href="Constrained.Base.html#toSimpleRep"><span class="hs-identifier hs-var">toSimpleRep</span></a></span></span><span>
</span><span id="line-3088"></span><span>
</span><span id="line-3089"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-pragma">{-# OVERLAPPABLE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span id="local-6989586621679182198"><span id="local-6989586621679182199"><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182199"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182198"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#MaybeBounded"><span class="hs-identifier hs-type">MaybeBounded</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182198"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Num</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182198"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182199"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182198"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182198"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#OrdLike"><span class="hs-identifier hs-type">OrdLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182199"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182198"><span class="hs-identifier hs-type">a</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3090"></span><span>  </span><span id="local-6989586621679173132"><span class="annot"><span class="annottext">leqSpec :: a -&gt; Spec fn a
</span><a href="#local-6989586621679173132"><span class="hs-identifier hs-var hs-var hs-var hs-var">leqSpec</span></a></span></span><span> </span><span id="local-6989586621679173131"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679173131"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall n. Maybe n -&gt; Maybe n -&gt; NumSpec n
</span><a href="Constrained.Base.html#NumSpecInterval"><span class="hs-identifier hs-var">NumSpecInterval</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679173131"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3091"></span><span>  </span><span id="local-6989586621679173119"><span class="annot"><span class="annottext">ltSpec :: a -&gt; Spec fn a
</span><a href="#local-6989586621679173119"><span class="hs-identifier hs-var hs-var hs-var hs-var">ltSpec</span></a></span></span><span> </span><span id="local-6989586621679173118"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679173118"><span class="hs-identifier hs-var">l</span></a></span></span><span>
</span><span id="line-3092"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679173117"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679173117"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. MaybeBounded a =&gt; Maybe a
</span><a href="Constrained.Base.html#lowerBound"><span class="hs-identifier hs-var">lowerBound</span></a></span><span>
</span><span id="line-3093"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679173118"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679173117"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3094"></span><span>        </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ltSpec @&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Typeable a =&gt; a -&gt; TypeRep
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">typeOf</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679173118"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679173118"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3095"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall n. Maybe n -&gt; Maybe n -&gt; NumSpec n
</span><a href="Constrained.Base.html#NumSpecInterval"><span class="hs-identifier hs-var">NumSpecInterval</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679173118"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3096"></span><span>  </span><span id="local-6989586621679173114"><span class="annot"><span class="annottext">geqSpec :: a -&gt; Spec fn a
</span><a href="#local-6989586621679173114"><span class="hs-identifier hs-var hs-var hs-var hs-var">geqSpec</span></a></span></span><span> </span><span id="local-6989586621679173113"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679173113"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall n. Maybe n -&gt; Maybe n -&gt; NumSpec n
</span><a href="Constrained.Base.html#NumSpecInterval"><span class="hs-identifier hs-var">NumSpecInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679173113"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-3097"></span><span>  </span><span id="local-6989586621679173101"><span class="annot"><span class="annottext">gtSpec :: a -&gt; Spec fn a
</span><a href="#local-6989586621679173101"><span class="hs-identifier hs-var hs-var hs-var hs-var">gtSpec</span></a></span></span><span> </span><span id="local-6989586621679173100"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679173100"><span class="hs-identifier hs-var">l</span></a></span></span><span>
</span><span id="line-3098"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679173099"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679173099"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. MaybeBounded a =&gt; Maybe a
</span><a href="Constrained.Base.html#upperBound"><span class="hs-identifier hs-var">upperBound</span></a></span><span>
</span><span id="line-3099"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679173100"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679173099"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3100"></span><span>        </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;gtSpec @&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Typeable a =&gt; a -&gt; TypeRep
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">typeOf</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679173100"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679173100"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3101"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall n. Maybe n -&gt; Maybe n -&gt; NumSpec n
</span><a href="Constrained.Base.html#NumSpecInterval"><span class="hs-identifier hs-var">NumSpecInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679173100"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-3102"></span><span>
</span><span id="line-3103"></span><span id="local-6989586621679173095"><span id="local-6989586621679173097"><span id="local-6989586621679181808"><span id="local-6989586621679181809"><span id="local-6989586621679181810"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#OrdFn"><span class="hs-identifier hs-type">OrdFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181810"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181809"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181808"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-3104"></span><span id="local-6989586621679173089"><span id="local-6989586621679173091"><span id="local-6989586621679173093"><span id="local-6989586621679181805"><span id="local-6989586621679181806"><span id="local-6989586621679181807"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#OrdFn"><span class="hs-identifier hs-type">OrdFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181807"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181806"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181805"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-3105"></span><span>
</span><span id="line-3106"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679181803"><span class="annot"><a href="Constrained.Univ.html#FunctionLike"><span class="hs-identifier hs-type">FunctionLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#OrdFn"><span class="hs-identifier hs-type">OrdFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181803"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3107"></span><span>  </span><span id="local-6989586621679173086"><span class="annot"><span class="annottext">sem :: forall (as :: [*]) b. OrdFn fn as b -&gt; FunTy as b
</span><a href="#local-6989586621679173086"><span class="hs-identifier hs-var hs-var hs-var hs-var">sem</span></a></span></span><span> </span><span class="annot"><span class="annottext">OrdFn fn as b
</span><a href="Constrained.Base.html#LessOrEqual"><span class="hs-identifier hs-var">LessOrEqual</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">(&lt;=)</span></a></span><span>
</span><span id="line-3108"></span><span>  </span><span class="annot"><a href="Constrained.Univ.html#sem"><span class="hs-identifier hs-var">sem</span></a></span><span> </span><span class="annot"><span class="annottext">OrdFn fn as b
</span><a href="Constrained.Base.html#Less"><span class="hs-identifier hs-var">Less</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">(&lt;)</span></a></span><span>
</span><span id="line-3109"></span><span>
</span><span id="line-3110"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679173064"><span id="local-6989586621679181798"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181798"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Functions"><span class="hs-identifier hs-type">Functions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#OrdFn"><span class="hs-identifier hs-type">OrdFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181798"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679181798"><span class="hs-identifier hs-type">fn</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3111"></span><span>  </span><span id="local-6989586621679173058"><span class="annot"><span class="annottext">propagateSpecFun :: forall (as :: [*]) a b.
(TypeList as, Typeable as, HasSpec fn a, All (HasSpec fn) as) =&gt;
OrdFn fn as b
-&gt; ListCtx Value as (HOLE a) -&gt; Spec fn b -&gt; Spec fn a
</span><a href="#local-6989586621679173058"><span class="hs-identifier hs-var hs-var hs-var hs-var">propagateSpecFun</span></a></span></span><span> </span><span class="annot"><span class="annottext">OrdFn fn as b
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span>
</span><span id="line-3112"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var">propagateSpecFun</span></a></span><span> </span><span class="annot"><span class="annottext">OrdFn fn as b
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span id="local-6989586621679173057"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679173057"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679173057"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-3113"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var">propagateSpecFun</span></a></span><span> </span><span id="local-6989586621679173056"><span class="annot"><span class="annottext">OrdFn fn as b
</span><a href="#local-6989586621679173056"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.List.html#ListCtx"><span class="hs-identifier hs-type">ListCtx</span></a></span><span> </span><span id="local-6989586621679173052"><span class="annot"><span class="annottext">List Value as
</span><a href="#local-6989586621679173052"><span class="hs-identifier hs-var">pre</span></a></span></span><span> </span><span class="annot"><span class="annottext">HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span id="local-6989586621679173047"><span class="annot"><span class="annottext">List Value as'
</span><a href="#local-6989586621679173047"><span class="hs-identifier hs-var">suf</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-type">SuspendedSpec</span></a></span><span> </span><span id="local-6989586621679173033"><span class="annot"><span class="annottext">Var b
</span><a href="#local-6989586621679173033"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679173032"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679173032"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3114"></span><span>    </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) p.
(IsPred p fn, HasSpec fn a) =&gt;
(Term fn a -&gt; p) -&gt; Spec fn a
</span><a href="Constrained.Base.html#constrained"><span class="hs-identifier hs-var">constrained</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679173031"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679173031"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3115"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679173030"><span class="annot"><span class="annottext">args :: List (Term fn) (Append as (a : as'))
</span><a href="#local-6989586621679173030"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {a} (f :: a -&gt; *) (as :: [a]) (bs :: [a]).
List f as -&gt; List f bs -&gt; List f (Append as bs)
</span><a href="Constrained.List.html#appendList"><span class="hs-identifier hs-var">appendList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (as :: [k]).
(forall (a :: k). f a -&gt; g a) -&gt; List f as -&gt; List g as
</span><a href="Constrained.List.html#mapList"><span class="hs-identifier hs-var">mapList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679173027"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679173027"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679173027"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List Value as
</span><a href="#local-6989586621679173052"><span class="hs-identifier hs-var">pre</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679173031"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (a :: k) (a :: [k]).
f a -&gt; List f a -&gt; List f (a : a)
</span><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (as :: [k]).
(forall (a :: k). f a -&gt; g a) -&gt; List f as -&gt; List g as
</span><a href="Constrained.List.html#mapList"><span class="hs-identifier hs-var">mapList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679173024"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679173024"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679173024"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List Value as'
</span><a href="#local-6989586621679173047"><span class="hs-identifier hs-var">suf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3116"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (a :: [*]) (fn :: [*] -&gt; * -&gt; *) b.
(Typeable a, TypeList a, All (HasSpec fn) a, HasSpec fn b,
 BaseUniverse fn) =&gt;
fn a b -&gt; List (Term fn) a -&gt; Term fn b
</span><a href="Constrained.Base.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="annot"><span class="annottext">OrdFn fn as b
</span><a href="#local-6989586621679173056"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List (Term fn) (Append as (a : as'))
</span><a href="#local-6989586621679173030"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var b
</span><a href="#local-6989586621679173033"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679173032"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3117"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var">propagateSpecFun</span></a></span><span> </span><span class="annot"><span class="annottext">OrdFn fn as b
</span><a href="Constrained.Base.html#LessOrEqual"><span class="hs-identifier hs-var">LessOrEqual</span></a></span><span> </span><span id="local-6989586621679173019"><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679173019"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679173018"><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679173018"><span class="hs-identifier hs-var">spec</span></a></span></span><span>
</span><span id="line-3118"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3F"><span class="hs-operator hs-type">:?</span></a></span><span> </span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679173003"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679173003"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">List Value as
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679173019"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Spec fn Bool -&gt; (Bool -&gt; Spec fn a) -&gt; Spec fn a
</span><a href="Constrained.Base.html#caseBoolSpec"><span class="hs-identifier hs-var">caseBoolSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679173018"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-3119"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. OrdLike fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#leqSpec"><span class="hs-identifier hs-var">leqSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679181798"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679173003"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-3120"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. OrdLike fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#gtSpec"><span class="hs-identifier hs-var">gtSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679181798"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679173003"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-3121"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679172991"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172991"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%21"><span class="hs-operator hs-type">:!</span></a></span><span> </span><span class="annot"><a href="Constrained.List.html#NilCtx"><span class="hs-identifier hs-type">NilCtx</span></a></span><span> </span><span class="annot"><span class="annottext">HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679173019"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Spec fn Bool -&gt; (Bool -&gt; Spec fn a) -&gt; Spec fn a
</span><a href="Constrained.Base.html#caseBoolSpec"><span class="hs-identifier hs-var">caseBoolSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679173018"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-3122"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. OrdLike fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#geqSpec"><span class="hs-identifier hs-var">geqSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679181798"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172991"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-3123"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. OrdLike fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#ltSpec"><span class="hs-identifier hs-var">ltSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679181798"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172991"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-3124"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var">propagateSpecFun</span></a></span><span> </span><span class="annot"><span class="annottext">OrdFn fn as b
</span><a href="Constrained.Base.html#Less"><span class="hs-identifier hs-var">Less</span></a></span><span> </span><span id="local-6989586621679172981"><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679172981"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679172980"><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679172980"><span class="hs-identifier hs-var">spec</span></a></span></span><span>
</span><span id="line-3125"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3F"><span class="hs-operator hs-type">:?</span></a></span><span> </span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679172965"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172965"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">List Value as
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679172981"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Spec fn Bool -&gt; (Bool -&gt; Spec fn a) -&gt; Spec fn a
</span><a href="Constrained.Base.html#caseBoolSpec"><span class="hs-identifier hs-var">caseBoolSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679172980"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-3126"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. OrdLike fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#ltSpec"><span class="hs-identifier hs-var">ltSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679181798"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172965"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-3127"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. OrdLike fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#geqSpec"><span class="hs-identifier hs-var">geqSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679181798"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172965"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-3128"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679172953"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172953"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%21"><span class="hs-operator hs-type">:!</span></a></span><span> </span><span class="annot"><a href="Constrained.List.html#NilCtx"><span class="hs-identifier hs-type">NilCtx</span></a></span><span> </span><span class="annot"><span class="annottext">HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679172981"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Spec fn Bool -&gt; (Bool -&gt; Spec fn a) -&gt; Spec fn a
</span><a href="Constrained.Base.html#caseBoolSpec"><span class="hs-identifier hs-var">caseBoolSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679172980"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-3129"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. OrdLike fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#gtSpec"><span class="hs-identifier hs-var">gtSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679181798"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172953"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-3130"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. OrdLike fn a =&gt; a -&gt; Spec fn a
</span><a href="Constrained.Base.html#leqSpec"><span class="hs-identifier hs-var">leqSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679181798"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172953"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-3131"></span><span>
</span><span id="line-3132"></span><span>  </span><span id="local-6989586621679172941"><span class="annot"><span class="annottext">mapTypeSpec :: forall a b.
(HasSpec fn a, HasSpec fn b) =&gt;
OrdFn fn '[a] b -&gt; TypeSpec fn a -&gt; Spec fn b
</span><a href="#local-6989586621679172941"><span class="hs-identifier hs-var hs-var hs-var hs-var">mapTypeSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;No cases&quot;</span></span><span>
</span><span id="line-3133"></span><span>
</span><span id="line-3134"></span><span class="hs-comment">-- List functions ---------------------------------------------------------</span><span>
</span><span id="line-3135"></span><span>
</span><span id="line-3136"></span><span class="hs-keyword">data</span><span> </span><span id="ListFn"><span class="annot"><a href="Constrained.Base.html#ListFn"><span class="hs-identifier hs-var">ListFn</span></a></span></span><span> </span><span id="local-6989586621679172940"><span class="annot"><a href="#local-6989586621679172940"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679172939"><span class="annot"><a href="#local-6989586621679172939"><span class="hs-identifier hs-type">args</span></a></span></span><span> </span><span id="local-6989586621679172938"><span class="annot"><a href="#local-6989586621679172938"><span class="hs-identifier hs-type">res</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3137"></span><span>  </span><span id="local-6989586621679172937"><span id="local-6989586621679181731"><span id="local-6989586621679181732"><span id="FoldMap"><span class="annot"><a href="Constrained.Base.html#FoldMap"><span class="hs-identifier hs-var">FoldMap</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3138"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181732"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172937"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3139"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#Foldy"><span class="hs-identifier hs-type">Foldy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181732"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181731"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-3140"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679181732"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679172937"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679181731"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3141"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679181732"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679172937"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679181731"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3142"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3143"></span><span>    </span><span class="annot"><a href="#local-6989586621679181732"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679172937"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679181731"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3144"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#ListFn"><span class="hs-identifier hs-type">ListFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181732"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679172937"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679181731"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-3145"></span><span>  </span><span id="local-6989586621679172935"><span id="local-6989586621679181769"><span id="ListSize"><span class="annot"><a href="Constrained.Base.html#ListSize"><span class="hs-identifier hs-var">ListSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#ListFn"><span class="hs-identifier hs-type">ListFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181769"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679172935"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span></span></span><span>
</span><span id="line-3146"></span><span>
</span><span id="line-3147"></span><span class="annot"><a href="Constrained.Base.html#listSizeFn"><span class="hs-identifier hs-type">listSizeFn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679181773"><span class="annot"><a href="#local-6989586621679181773"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679181772"><span class="annot"><a href="#local-6989586621679181772"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.Univ.html#Member"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ListFn"><span class="hs-identifier hs-type">ListFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181773"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679181773"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679181773"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679181772"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-3148"></span><span id="listSizeFn"><span class="annot"><span class="annottext">listSizeFn :: forall (fn :: [*] -&gt; * -&gt; *) a.
Member (ListFn fn) fn =&gt;
fn '[[a]] Int
</span><a href="Constrained.Base.html#listSizeFn"><span class="hs-identifier hs-var hs-var">listSizeFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. ListFn fn '[[a]] Int
</span><a href="Constrained.Base.html#ListSize"><span class="hs-identifier hs-var">ListSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679181773"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-3149"></span><span>
</span><span id="line-3150"></span><span id="local-6989586621679172925"><span id="local-6989586621679172927"><span id="local-6989586621679172929"><span id="local-6989586621679181766"><span id="local-6989586621679181767"><span id="local-6989586621679181768"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ListFn"><span class="hs-identifier hs-type">ListFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181768"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181767"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181766"><span class="hs-identifier hs-type">res</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-3151"></span><span>
</span><span id="line-3152"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679172922"><span id="local-6989586621679181763"><span id="local-6989586621679181764"><span id="local-6989586621679181765"><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181765"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ListFn"><span class="hs-identifier hs-type">ListFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181765"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181764"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181763"><span class="hs-identifier hs-type">res</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3153"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#FoldMap"><span class="hs-identifier hs-type">FoldMap</span></a></span><span> </span><span id="local-6989586621679172913"><span class="annot"><span class="annottext">fn '[a] res
</span><a href="#local-6989586621679172913"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679172912"><span class="annot"><span class="annottext">== :: ListFn fn args res -&gt; ListFn fn args res -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#FoldMap"><span class="hs-identifier hs-type">FoldMap</span></a></span><span> </span><span id="local-6989586621679172888"><span class="annot"><span class="annottext">fn '[a] res
</span><a href="#local-6989586621679172888"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Typeable a, Typeable b) =&gt; a -&gt; Maybe b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">cast</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] res
</span><a href="#local-6989586621679172913"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] res
</span><a href="#local-6989586621679172888"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-3154"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#FoldMap"><span class="hs-identifier hs-type">FoldMap</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">ListFn fn args res
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-3155"></span><span>  </span><span class="annot"><span class="annottext">ListFn fn args res
</span><a href="Constrained.Base.html#ListSize"><span class="hs-identifier hs-var">ListSize</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">ListFn fn args res
</span><a href="Constrained.Base.html#ListSize"><span class="hs-identifier hs-var">ListSize</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-3156"></span><span>  </span><span class="annot"><span class="annottext">ListFn fn args res
</span><a href="Constrained.Base.html#ListSize"><span class="hs-identifier hs-var">ListSize</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">ListFn fn args res
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-3157"></span><span>
</span><span id="line-3158"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679181755"><span class="annot"><a href="Constrained.Univ.html#FunctionLike"><span class="hs-identifier hs-type">FunctionLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181755"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Univ.html#FunctionLike"><span class="hs-identifier hs-type">FunctionLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ListFn"><span class="hs-identifier hs-type">ListFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181755"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3159"></span><span>  </span><span id="local-6989586621679172873"><span class="annot"><span class="annottext">sem :: forall (as :: [*]) b. ListFn fn as b -&gt; FunTy as b
</span><a href="#local-6989586621679172873"><span class="hs-identifier hs-var hs-var hs-var hs-var">sem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-3160"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#FoldMap"><span class="hs-identifier hs-type">FoldMap</span></a></span><span> </span><span id="local-6989586621679172865"><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679172865"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Foldy fn a =&gt; [a] -&gt; a
</span><a href="Constrained.Base.html#adds"><span class="hs-identifier hs-var">adds</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679181755"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (as :: [*]) b.
FunctionLike fn =&gt;
fn as b -&gt; FunTy as b
</span><a href="Constrained.Univ.html#sem"><span class="hs-identifier hs-var">sem</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679172865"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3161"></span><span>    </span><span class="annot"><span class="annottext">ListFn fn as b
</span><a href="Constrained.Base.html#ListSize"><span class="hs-identifier hs-var">ListSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">length</span></a></span><span>
</span><span id="line-3162"></span><span>
</span><span id="line-3163"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679172850"><span id="local-6989586621679181750"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181750"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Functions"><span class="hs-identifier hs-type">Functions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ListFn"><span class="hs-identifier hs-type">ListFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181750"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679181750"><span class="hs-identifier hs-type">fn</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3164"></span><span>  </span><span id="local-6989586621679172844"><span class="annot"><span class="annottext">propagateSpecFun :: forall (as :: [*]) a b.
(TypeList as, Typeable as, HasSpec fn a, All (HasSpec fn) as) =&gt;
ListFn fn as b
-&gt; ListCtx Value as (HOLE a) -&gt; Spec fn b -&gt; Spec fn a
</span><a href="#local-6989586621679172844"><span class="hs-identifier hs-var hs-var hs-var hs-var">propagateSpecFun</span></a></span></span><span> </span><span class="annot"><span class="annottext">ListFn fn as b
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span id="local-6989586621679172843"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679172843"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679172843"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-3165"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var">propagateSpecFun</span></a></span><span> </span><span id="local-6989586621679172842"><span class="annot"><span class="annottext">ListFn fn as b
</span><a href="#local-6989586621679172842"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679172841"><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679172841"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679172840"><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679172840"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ListFn fn as b
</span><a href="#local-6989586621679172842"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3166"></span><span>    </span><span class="annot"><span class="annottext">ListFn fn as b
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-3167"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-type">SuspendedSpec</span></a></span><span> </span><span id="local-6989586621679172838"><span class="annot"><span class="annottext">Var b
</span><a href="#local-6989586621679172838"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679172837"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679172837"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679172840"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-3168"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.List.html#ListCtx"><span class="hs-identifier hs-type">ListCtx</span></a></span><span> </span><span id="local-6989586621679172833"><span class="annot"><span class="annottext">List Value as
</span><a href="#local-6989586621679172833"><span class="hs-identifier hs-var">pre</span></a></span></span><span> </span><span class="annot"><span class="annottext">HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span id="local-6989586621679172816"><span class="annot"><span class="annottext">List Value as'
</span><a href="#local-6989586621679172816"><span class="hs-identifier hs-var">suf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679172841"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3169"></span><span>          </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) p.
(IsPred p fn, HasSpec fn a) =&gt;
(Term fn a -&gt; p) -&gt; Spec fn a
</span><a href="Constrained.Base.html#constrained"><span class="hs-identifier hs-var">constrained</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679172815"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679172815"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3170"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679172814"><span class="annot"><span class="annottext">args :: List (Term fn) (Append as (a : as'))
</span><a href="#local-6989586621679172814"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {a} (f :: a -&gt; *) (as :: [a]) (bs :: [a]).
List f as -&gt; List f bs -&gt; List f (Append as bs)
</span><a href="Constrained.List.html#appendList"><span class="hs-identifier hs-var">appendList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (as :: [k]).
(forall (a :: k). f a -&gt; g a) -&gt; List f as -&gt; List g as
</span><a href="Constrained.List.html#mapList"><span class="hs-identifier hs-var">mapList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679172811"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172811"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172811"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List Value as
</span><a href="#local-6989586621679172833"><span class="hs-identifier hs-var">pre</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679172815"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (a :: k) (a :: [k]).
f a -&gt; List f a -&gt; List f (a : a)
</span><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (as :: [k]).
(forall (a :: k). f a -&gt; g a) -&gt; List f as -&gt; List g as
</span><a href="Constrained.List.html#mapList"><span class="hs-identifier hs-var">mapList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679172808"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172808"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172808"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List Value as'
</span><a href="#local-6989586621679172816"><span class="hs-identifier hs-var">suf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3171"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (a :: [*]) (fn :: [*] -&gt; * -&gt; *) b.
(Typeable a, TypeList a, All (HasSpec fn) a, HasSpec fn b,
 BaseUniverse fn) =&gt;
fn a b -&gt; List (Term fn) a -&gt; Term fn b
</span><a href="Constrained.Base.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="annot"><span class="annottext">ListFn fn as b
</span><a href="#local-6989586621679172842"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List (Term fn) (Append as (a : as'))
</span><a href="#local-6989586621679172814"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var b
</span><a href="#local-6989586621679172838"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679172837"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3172"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#FoldMap"><span class="hs-identifier hs-type">FoldMap</span></a></span><span> </span><span id="local-6989586621679172799"><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679172799"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.List.html#NilCtx"><span class="hs-identifier hs-type">NilCtx</span></a></span><span> </span><span class="annot"><span class="annottext">HOLE a [a]
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679172841"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
[a] -&gt; Spec fn Int -&gt; Spec fn a -&gt; FoldSpec fn a -&gt; ListSpec fn a
</span><a href="Constrained.Base.html#ListSpec"><span class="hs-identifier hs-var">ListSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn a, HasSpec fn a, Foldy fn a, Member (ListFn fn) fn,
 BaseUniverse fn) =&gt;
fn '[a] a -&gt; Spec fn a -&gt; FoldSpec fn a
</span><a href="Constrained.Base.html#FoldSpec"><span class="hs-identifier hs-var">FoldSpec</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679172799"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679172840"><span class="hs-identifier hs-var">spec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3173"></span><span>    </span><span class="annot"><span class="annottext">ListFn fn as b
</span><a href="Constrained.Base.html#ListSize"><span class="hs-identifier hs-var">ListSize</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.List.html#NilCtx"><span class="hs-identifier hs-type">NilCtx</span></a></span><span> </span><span class="annot"><span class="annottext">HOLE a [a]
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679172841"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
[a] -&gt; Spec fn Int -&gt; Spec fn a -&gt; FoldSpec fn a -&gt; ListSpec fn a
</span><a href="Constrained.Base.html#ListSpec"><span class="hs-identifier hs-var">ListSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679172840"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. FoldSpec fn a
</span><a href="Constrained.Base.html#NoFold"><span class="hs-identifier hs-var">NoFold</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3174"></span><span>
</span><span id="line-3175"></span><span>  </span><span class="hs-comment">-- NOTE: this function over-approximates and returns a liberal spec.</span><span>
</span><span id="line-3176"></span><span>  </span><span id="local-6989586621679172780"><span class="annot"><span class="annottext">mapTypeSpec :: forall a b.
(HasSpec fn a, HasSpec fn b) =&gt;
ListFn fn '[a] b -&gt; TypeSpec fn a -&gt; Spec fn b
</span><a href="#local-6989586621679172780"><span class="hs-identifier hs-var hs-var hs-var hs-var">mapTypeSpec</span></a></span></span><span> </span><span id="local-6989586621679172779"><span class="annot"><span class="annottext">ListFn fn '[a] b
</span><a href="#local-6989586621679172779"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679172778"><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679172778"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ListFn fn '[a] b
</span><a href="#local-6989586621679172779"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3177"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#FoldMap"><span class="hs-identifier hs-type">FoldMap</span></a></span><span> </span><span id="local-6989586621679172735"><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679172735"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3178"></span><span>      </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) p.
(IsPred p fn, HasSpec fn a) =&gt;
(Term fn a -&gt; p) -&gt; Spec fn a
</span><a href="Constrained.Base.html#constrained"><span class="hs-identifier hs-var">constrained</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679172734"><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679172734"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3179"></span><span>        </span><span class="annot"><span class="annottext">forall a p (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, IsPred p fn) =&gt;
(Term fn a -&gt; p) -&gt; Pred fn
</span><a href="Constrained.Base.html#unsafeExists"><span class="hs-identifier hs-var">unsafeExists</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679172733"><span class="annot"><span class="annottext">Term fn [a]
</span><a href="#local-6989586621679172733"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3180"></span><span>          </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
p -&gt; Pred fn
</span><a href="Constrained.Base.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679172734"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Term fn a -&gt; Term fn Bool
</span><a href="Constrained.Base.html#%3D%3D."><span class="hs-operator hs-var">==.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
(HasSpec fn a, Foldy fn b, Show (fn '[a] b), Eq (fn '[a] b)) =&gt;
fn '[a] b -&gt; fn '[[a]] b
</span><a href="Constrained.Base.html#foldMapFn"><span class="hs-identifier hs-var">foldMapFn</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679172735"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term fn [a]
</span><a href="#local-6989586621679172733"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; TypeSpec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#toPreds"><span class="hs-identifier hs-var">toPreds</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn [a]
</span><a href="#local-6989586621679172733"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679172778"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-3181"></span><span>    </span><span class="annot"><span class="annottext">ListFn fn '[a] b
</span><a href="Constrained.Base.html#ListSize"><span class="hs-identifier hs-var">ListSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn [a] -&gt; Spec fn Int
</span><a href="Constrained.Base.html#sizeSpecList"><span class="hs-identifier hs-var">sizeSpecList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679172778"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3182"></span><span>
</span><span id="line-3183"></span><span class="annot"><a href="Constrained.Base.html#foldMapFn"><span class="hs-identifier hs-type">foldMapFn</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3184"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182226"><span class="annot"><a href="#local-6989586621679182226"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679182225"><span class="annot"><a href="#local-6989586621679182225"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679182224"><span class="annot"><a href="#local-6989586621679182224"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-3185"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182226"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182225"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3186"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#Foldy"><span class="hs-identifier hs-type">Foldy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182226"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182224"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-3187"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182226"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182225"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679182224"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3188"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182226"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182225"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679182224"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3189"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3190"></span><span>  </span><span class="annot"><a href="#local-6989586621679182226"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182225"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679182224"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3191"></span><span>  </span><span class="annot"><a href="#local-6989586621679182226"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182225"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679182224"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-3192"></span><span id="foldMapFn"><span class="annot"><span class="annottext">foldMapFn :: forall (fn :: [*] -&gt; * -&gt; *) a b.
(HasSpec fn a, Foldy fn b, Show (fn '[a] b), Eq (fn '[a] b)) =&gt;
fn '[a] b -&gt; fn '[[a]] b
</span><a href="Constrained.Base.html#foldMapFn"><span class="hs-identifier hs-var hs-var">foldMapFn</span></a></span></span><span> </span><span id="local-6989586621679172715"><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679172715"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
(HasSpec fn a, Foldy fn b, Show (fn '[a] b), Eq (fn '[a] b)) =&gt;
fn '[a] b -&gt; ListFn fn '[[a]] b
</span><a href="Constrained.Base.html#FoldMap"><span class="hs-identifier hs-var">FoldMap</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182226"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679172715"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-3193"></span><span>
</span><span id="line-3194"></span><span class="hs-comment">-- Number functions -------------------------------------------------------</span><span>
</span><span id="line-3195"></span><span>
</span><span id="line-3196"></span><span class="annot"><a href="Constrained.Base.html#addFn"><span class="hs-identifier hs-type">addFn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679181730"><span class="annot"><a href="#local-6989586621679181730"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679181729"><span class="annot"><a href="#local-6989586621679181729"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.Base.html#NumLike"><span class="hs-identifier hs-type">NumLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181730"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181729"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679181730"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679181729"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679181729"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679181729"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3197"></span><span id="addFn"><span class="annot"><span class="annottext">addFn :: forall (fn :: [*] -&gt; * -&gt; *) a. NumLike fn a =&gt; fn '[a, a] a
</span><a href="Constrained.Base.html#addFn"><span class="hs-identifier hs-var hs-var">addFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. NumLike fn a =&gt; IntFn fn '[a, a] a
</span><a href="Constrained.Base.html#Add"><span class="hs-identifier hs-var">Add</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679181730"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3198"></span><span>
</span><span id="line-3199"></span><span class="annot"><a href="Constrained.Base.html#negateFn"><span class="hs-identifier hs-type">negateFn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679181724"><span class="annot"><a href="#local-6989586621679181724"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679181723"><span class="annot"><a href="#local-6989586621679181723"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.Base.html#NumLike"><span class="hs-identifier hs-type">NumLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181724"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181723"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679181724"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679181723"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679181723"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3200"></span><span id="negateFn"><span class="annot"><span class="annottext">negateFn :: forall (fn :: [*] -&gt; * -&gt; *) a. NumLike fn a =&gt; fn '[a] a
</span><a href="Constrained.Base.html#negateFn"><span class="hs-identifier hs-var hs-var">negateFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. NumLike fn a =&gt; IntFn fn '[a] a
</span><a href="Constrained.Base.html#Negate"><span class="hs-identifier hs-var">Negate</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679181724"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3201"></span><span>
</span><span id="line-3202"></span><span class="hs-keyword">data</span><span> </span><span id="IntFn"><span class="annot"><a href="Constrained.Base.html#IntFn"><span class="hs-identifier hs-var">IntFn</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679172699"><span class="annot"><a href="#local-6989586621679172699"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679172698"><span class="annot"><a href="#local-6989586621679172698"><span class="hs-keyword hs-type">as</span></a></span></span><span> </span><span id="local-6989586621679172697"><span class="annot"><a href="#local-6989586621679172697"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3203"></span><span>  </span><span id="local-6989586621679182142"><span id="local-6989586621679182143"><span id="Add"><span class="annot"><a href="Constrained.Base.html#Add"><span class="hs-identifier hs-var">Add</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#NumLike"><span class="hs-identifier hs-type">NumLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182143"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182142"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#IntFn"><span class="hs-identifier hs-type">IntFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182143"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182142"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679182142"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679182142"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-3204"></span><span>  </span><span id="local-6989586621679181719"><span id="local-6989586621679181720"><span id="Negate"><span class="annot"><a href="Constrained.Base.html#Negate"><span class="hs-identifier hs-var">Negate</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#NumLike"><span class="hs-identifier hs-type">NumLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181720"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181719"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#IntFn"><span class="hs-identifier hs-type">IntFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181720"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679181719"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679181719"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-3205"></span><span>
</span><span id="line-3206"></span><span id="local-6989586621679172693"><span id="local-6989586621679172695"><span id="local-6989586621679181716"><span id="local-6989586621679181717"><span id="local-6989586621679181718"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#IntFn"><span class="hs-identifier hs-type">IntFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181718"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181717"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181716"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-3207"></span><span id="local-6989586621679172687"><span id="local-6989586621679172689"><span id="local-6989586621679172691"><span id="local-6989586621679181713"><span id="local-6989586621679181714"><span id="local-6989586621679181715"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#IntFn"><span class="hs-identifier hs-type">IntFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181715"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181714"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181713"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-3208"></span><span>
</span><span id="line-3209"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679181711"><span class="annot"><a href="Constrained.Univ.html#FunctionLike"><span class="hs-identifier hs-type">FunctionLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#IntFn"><span class="hs-identifier hs-type">IntFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181711"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3210"></span><span>  </span><span id="local-6989586621679172684"><span class="annot"><span class="annottext">sem :: forall (as :: [*]) b. IntFn fn as b -&gt; FunTy as b
</span><a href="#local-6989586621679172684"><span class="hs-identifier hs-var hs-var hs-var hs-var">sem</span></a></span></span><span> </span><span class="annot"><span class="annottext">IntFn fn as b
</span><a href="Constrained.Base.html#Add"><span class="hs-identifier hs-var">Add</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">(+)</span></a></span><span>
</span><span id="line-3211"></span><span>  </span><span class="annot"><a href="Constrained.Univ.html#sem"><span class="hs-identifier hs-var">sem</span></a></span><span> </span><span class="annot"><span class="annottext">IntFn fn as b
</span><a href="Constrained.Base.html#Negate"><span class="hs-identifier hs-var">Negate</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">negate</span></a></span><span>
</span><span id="line-3212"></span><span>
</span><span id="line-3213"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Num</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181726"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="NumLike"><span class="annot"><a href="Constrained.Base.html#NumLike"><span class="hs-identifier hs-var">NumLike</span></a></span></span><span> </span><span id="local-6989586621679181726"><span class="annot"><a href="#local-6989586621679181726"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679181725"><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3214"></span><span>  </span><span id="subtractSpec"><span class="annot"><a href="Constrained.Base.html#subtractSpec"><span class="hs-identifier hs-type">subtractSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181726"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181726"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3215"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="subtractSpec"><span class="annot"><a href="Constrained.Base.html#subtractSpec"><span class="hs-identifier hs-type">subtractSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3216"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181726"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181726"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3217"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSimpleRep"><span class="hs-identifier hs-type">HasSimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3218"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#NumLike"><span class="hs-identifier hs-type">NumLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181726"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3219"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3220"></span><span>    </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3221"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181726"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3222"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181726"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3223"></span><span>  </span><span id="local-6989586621679172673"><span class="annot"><a href="Constrained.Base.html#subtractSpec"><span class="hs-identifier hs-var hs-var">subtractSpec</span></a></span><span> </span><span id="local-6989586621679172661"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172661"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679172660"><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679172660"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, HasSimpleRep a,
 TypeSpec fn a ~ TypeSpec fn (SimpleRep a)) =&gt;
Spec fn (SimpleRep a) -&gt; Spec fn a
</span><a href="Constrained.Base.html#fromSimpleRepSpec"><span class="hs-identifier hs-var">fromSimpleRepSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
NumLike fn a =&gt;
a -&gt; TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#subtractSpec"><span class="hs-identifier hs-var">subtractSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679181726"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HasSimpleRep a =&gt; a -&gt; SimpleRep a
</span><a href="Constrained.Base.html#toSimpleRep"><span class="hs-identifier hs-var">toSimpleRep</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172661"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679172660"><span class="hs-identifier hs-var">ts</span></a></span></span><span>
</span><span id="line-3224"></span><span>
</span><span id="line-3225"></span><span>  </span><span id="negateSpec"><span class="annot"><a href="Constrained.Base.html#negateSpec"><span class="hs-identifier hs-type">negateSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181726"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181726"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3226"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="negateSpec"><span class="annot"><a href="Constrained.Base.html#negateSpec"><span class="hs-identifier hs-type">negateSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3227"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181726"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181726"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3228"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSimpleRep"><span class="hs-identifier hs-type">HasSimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3229"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#NumLike"><span class="hs-identifier hs-type">NumLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181726"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3230"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3231"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181726"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3232"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181726"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3233"></span><span>  </span><span id="local-6989586621679172658"><span class="annot"><a href="Constrained.Base.html#negateSpec"><span class="hs-identifier hs-var hs-var">negateSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, HasSimpleRep a,
 TypeSpec fn a ~ TypeSpec fn (SimpleRep a)) =&gt;
Spec fn (SimpleRep a) -&gt; Spec fn a
</span><a href="Constrained.Base.html#fromSimpleRepSpec"><span class="hs-identifier hs-var">fromSimpleRepSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
NumLike fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#negateSpec"><span class="hs-identifier hs-var">negateSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679181726"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-3234"></span><span>
</span><span id="line-3235"></span><span>  </span><span id="safeSubtract"><span class="annot"><a href="Constrained.Base.html#safeSubtract"><span class="hs-identifier hs-type">safeSubtract</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3236"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="safeSubtract"><span class="annot"><a href="Constrained.Base.html#safeSubtract"><span class="hs-identifier hs-type">safeSubtract</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3237"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSimpleRep"><span class="hs-identifier hs-type">HasSimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#NumLike"><span class="hs-identifier hs-type">NumLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181726"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3238"></span><span>    </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3239"></span><span>    </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3240"></span><span>    </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3241"></span><span>  </span><span id="local-6989586621679172646"><span class="annot"><a href="Constrained.Base.html#safeSubtract"><span class="hs-identifier hs-var hs-var">safeSubtract</span></a></span><span> </span><span id="local-6989586621679172638"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172638"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679172637"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172637"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasSimpleRep a =&gt; SimpleRep a -&gt; a
</span><a href="Constrained.Base.html#fromSimpleRep"><span class="hs-identifier hs-var">fromSimpleRep</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. NumLike fn a =&gt; a -&gt; a -&gt; Maybe a
</span><a href="Constrained.Base.html#safeSubtract"><span class="hs-identifier hs-var">safeSubtract</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679181726"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181725"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HasSimpleRep a =&gt; a -&gt; SimpleRep a
</span><a href="Constrained.Base.html#toSimpleRep"><span class="hs-identifier hs-var">toSimpleRep</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172638"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HasSimpleRep a =&gt; a -&gt; SimpleRep a
</span><a href="Constrained.Base.html#toSimpleRep"><span class="hs-identifier hs-var">toSimpleRep</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172637"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-3242"></span><span>
</span><span id="line-3243"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679172634"><span id="local-6989586621679182019"><span id="local-6989586621679182020"><span class="annot"><a href="Constrained.Base.html#NumLike"><span class="hs-identifier hs-type">NumLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182020"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182019"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Num</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182020"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182019"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3244"></span><span>  </span><span id="local-6989586621679172608"><span class="annot"><span class="annottext">+ :: Term fn a -&gt; Term fn a -&gt; Term fn a
</span><a href="#local-6989586621679172608"><span class="hs-operator hs-var hs-var hs-var hs-var">(+)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. NumLike fn a =&gt; fn '[a, a] a
</span><a href="Constrained.Base.html#addFn"><span class="hs-identifier hs-var">addFn</span></a></span><span>
</span><span id="line-3245"></span><span>  </span><span id="local-6989586621679172591"><span class="annot"><span class="annottext">negate :: Term fn a -&gt; Term fn a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">negate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. NumLike fn a =&gt; fn '[a] a
</span><a href="Constrained.Base.html#negateFn"><span class="hs-identifier hs-var">negateFn</span></a></span><span>
</span><span id="line-3246"></span><span>  </span><span id="local-6989586621679172588"><span class="annot"><span class="annottext">fromInteger :: Integer -&gt; Term fn a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromInteger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; Integer -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromInteger</span></a></span><span>
</span><span id="line-3247"></span><span>  </span><span id="local-6989586621679172583"><span class="annot"><span class="annottext">* :: Term fn a -&gt; Term fn a -&gt; Term fn a
</span><a href="#local-6989586621679172583"><span class="hs-operator hs-var hs-var hs-var hs-var">(*)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(*) not implemented for Term Fn Int&quot;</span></span><span>
</span><span id="line-3248"></span><span>  </span><span id="local-6989586621679172578"><span class="annot"><span class="annottext">abs :: Term fn a -&gt; Term fn a
</span><a href="#local-6989586621679172578"><span class="hs-identifier hs-var hs-var hs-var hs-var">abs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;abs not implemented for Term Fn Int&quot;</span></span><span>
</span><span id="line-3249"></span><span>  </span><span id="local-6989586621679172573"><span class="annot"><span class="annottext">signum :: Term fn a -&gt; Term fn a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">signum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;signum not implemented for Term Fn Int&quot;</span></span><span>
</span><span id="line-3250"></span><span>
</span><span id="line-3251"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-pragma">{-# OVERLAPPABLE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span id="local-6989586621679182144"><span id="local-6989586621679182145"><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182145"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182144"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182144"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Num</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182144"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182145"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182144"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#NumSpec"><span class="hs-identifier hs-type">NumSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182144"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#MaybeBounded"><span class="hs-identifier hs-type">MaybeBounded</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182144"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#NumLike"><span class="hs-identifier hs-type">NumLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182145"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182144"><span class="hs-identifier hs-type">a</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3252"></span><span>  </span><span id="local-6989586621679172516"><span class="annot"><span class="annottext">subtractSpec :: a -&gt; TypeSpec fn a -&gt; Spec fn a
</span><a href="#local-6989586621679172516"><span class="hs-identifier hs-var hs-var hs-var hs-var">subtractSpec</span></a></span></span><span> </span><span id="local-6989586621679172515"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172515"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679172514"><span class="annot"><span class="annottext">ts :: TypeSpec fn a
</span><a href="#local-6989586621679172514"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#NumSpecInterval"><span class="hs-identifier hs-type">NumSpecInterval</span></a></span><span> </span><span id="local-6989586621679172513"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679172513"><span class="hs-identifier hs-var">ml</span></a></span></span><span> </span><span id="local-6989586621679172512"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679172512"><span class="hs-identifier hs-var">mu</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3253"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679172511"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172511"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679172512"><span class="hs-identifier hs-var">mu</span></a></span><span>
</span><span id="line-3254"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172515"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-3255"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. NumLike fn a =&gt; a -&gt; a -&gt; Maybe a
</span><a href="Constrained.Base.html#safeSubtract"><span class="hs-identifier hs-var">safeSubtract</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182145"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172515"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172511"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3256"></span><span>        </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span>
</span><span id="line-3257"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Underflow in subtractSpec (&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Typeable a =&gt; a -&gt; TypeRep
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">typeOf</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172515"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;):&quot;</span></span><span>
</span><span id="line-3258"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  a = &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172515"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-3259"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  ts = &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679172514"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-3260"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-3261"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679172510"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172510"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679172513"><span class="hs-identifier hs-var">ml</span></a></span><span>
</span><span id="line-3262"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172515"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-3263"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. NumLike fn a =&gt; a -&gt; a -&gt; Maybe a
</span><a href="Constrained.Base.html#safeSubtract"><span class="hs-identifier hs-var">safeSubtract</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182145"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172515"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172510"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3264"></span><span>        </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span>
</span><span id="line-3265"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Overflow in subtractSpec (&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Typeable a =&gt; a -&gt; TypeRep
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">typeOf</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172515"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;):&quot;</span></span><span>
</span><span id="line-3266"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  a = &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172515"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-3267"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  ts = &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679172514"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-3268"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-3269"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall n. Maybe n -&gt; Maybe n -&gt; NumSpec n
</span><a href="Constrained.Base.html#NumSpecInterval"><span class="hs-identifier hs-var">NumSpecInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621679172509"><span class="hs-identifier hs-var">safeSub</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172515"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679172513"><span class="hs-identifier hs-var">ml</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621679172509"><span class="hs-identifier hs-var">safeSub</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172515"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679172512"><span class="hs-identifier hs-var">mu</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3270"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-3271"></span><span>      </span><span class="annot"><a href="#local-6989586621679172509"><span class="hs-identifier hs-type">safeSub</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679182144"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679182144"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679182144"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3272"></span><span>      </span><span id="local-6989586621679172509"><span class="annot"><span class="annottext">safeSub :: a -&gt; a -&gt; a
</span><a href="#local-6989586621679172509"><span class="hs-identifier hs-var hs-var">safeSub</span></a></span></span><span> </span><span id="local-6989586621679172508"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172508"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679172507"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172507"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-3273"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679172506"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172506"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. NumLike fn a =&gt; a -&gt; a -&gt; Maybe a
</span><a href="Constrained.Base.html#safeSubtract"><span class="hs-identifier hs-var">safeSubtract</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679182145"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172508"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172507"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172506"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-3274"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172508"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. MaybeBounded a =&gt; Maybe a
</span><a href="Constrained.Base.html#upperBound"><span class="hs-identifier hs-var">upperBound</span></a></span><span>
</span><span id="line-3275"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. MaybeBounded a =&gt; Maybe a
</span><a href="Constrained.Base.html#lowerBound"><span class="hs-identifier hs-var">lowerBound</span></a></span><span>
</span><span id="line-3276"></span><span>  </span><span id="local-6989586621679172499"><span class="annot"><span class="annottext">negateSpec :: TypeSpec fn a -&gt; Spec fn a
</span><a href="#local-6989586621679172499"><span class="hs-identifier hs-var hs-var hs-var hs-var">negateSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#NumSpecInterval"><span class="hs-identifier hs-type">NumSpecInterval</span></a></span><span> </span><span id="local-6989586621679172498"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679172498"><span class="hs-identifier hs-var">ml</span></a></span></span><span> </span><span id="local-6989586621679172497"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679172497"><span class="hs-identifier hs-var">mu</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall n. Maybe n -&gt; Maybe n -&gt; NumSpec n
</span><a href="Constrained.Base.html#NumSpecInterval"><span class="hs-identifier hs-var">NumSpecInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">negate</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679172497"><span class="hs-identifier hs-var">mu</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">negate</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679172498"><span class="hs-identifier hs-var">ml</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3277"></span><span>
</span><span id="line-3278"></span><span>  </span><span id="local-6989586621679172485"><span class="annot"><span class="annottext">safeSubtract :: a -&gt; a -&gt; Maybe a
</span><a href="#local-6989586621679172485"><span class="hs-identifier hs-var hs-var hs-var hs-var">safeSubtract</span></a></span></span><span> </span><span id="local-6989586621679172484"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172484"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679172483"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172483"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-3279"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172484"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-3280"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679172482"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172482"><span class="hs-identifier hs-var">lb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. MaybeBounded a =&gt; Maybe a
</span><a href="Constrained.Base.html#lowerBound"><span class="hs-identifier hs-var">lowerBound</span></a></span><span>
</span><span id="line-3281"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172482"><span class="hs-identifier hs-var">lb</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172484"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172483"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3282"></span><span>        </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-3283"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172484"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-3284"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679172481"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172481"><span class="hs-identifier hs-var">ub</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. MaybeBounded a =&gt; Maybe a
</span><a href="Constrained.Base.html#upperBound"><span class="hs-identifier hs-var">upperBound</span></a></span><span>
</span><span id="line-3285"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172481"><span class="hs-identifier hs-var">ub</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172484"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172483"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3286"></span><span>        </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-3287"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172483"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172484"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-3288"></span><span>
</span><span id="line-3289"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679172469"><span id="local-6989586621679181705"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181705"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Functions"><span class="hs-identifier hs-type">Functions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#IntFn"><span class="hs-identifier hs-type">IntFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181705"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679181705"><span class="hs-identifier hs-type">fn</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3290"></span><span>  </span><span id="local-6989586621679172462"><span class="annot"><span class="annottext">propagateSpecFun :: forall (as :: [*]) a b.
(TypeList as, Typeable as, HasSpec fn a, All (HasSpec fn) as) =&gt;
IntFn fn as b
-&gt; ListCtx Value as (HOLE a) -&gt; Spec fn b -&gt; Spec fn a
</span><a href="#local-6989586621679172462"><span class="hs-identifier hs-var hs-var hs-var hs-var">propagateSpecFun</span></a></span></span><span> </span><span class="annot"><span class="annottext">IntFn fn as b
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span>
</span><span id="line-3291"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var">propagateSpecFun</span></a></span><span> </span><span class="annot"><span class="annottext">IntFn fn as b
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span id="local-6989586621679172461"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679172461"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679172461"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-3292"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var">propagateSpecFun</span></a></span><span> </span><span id="local-6989586621679172460"><span class="annot"><span class="annottext">IntFn fn as b
</span><a href="#local-6989586621679172460"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.List.html#ListCtx"><span class="hs-identifier hs-type">ListCtx</span></a></span><span> </span><span id="local-6989586621679172456"><span class="annot"><span class="annottext">List Value as
</span><a href="#local-6989586621679172456"><span class="hs-identifier hs-var">pre</span></a></span></span><span> </span><span class="annot"><span class="annottext">HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span id="local-6989586621679172451"><span class="annot"><span class="annottext">List Value as'
</span><a href="#local-6989586621679172451"><span class="hs-identifier hs-var">suf</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-type">SuspendedSpec</span></a></span><span> </span><span id="local-6989586621679172437"><span class="annot"><span class="annottext">Var b
</span><a href="#local-6989586621679172437"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679172436"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679172436"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3293"></span><span>    </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) p.
(IsPred p fn, HasSpec fn a) =&gt;
(Term fn a -&gt; p) -&gt; Spec fn a
</span><a href="Constrained.Base.html#constrained"><span class="hs-identifier hs-var">constrained</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679172435"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679172435"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3294"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679172434"><span class="annot"><span class="annottext">args :: List (Term fn) (Append as (a : as'))
</span><a href="#local-6989586621679172434"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {a} (f :: a -&gt; *) (as :: [a]) (bs :: [a]).
List f as -&gt; List f bs -&gt; List f (Append as bs)
</span><a href="Constrained.List.html#appendList"><span class="hs-identifier hs-var">appendList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (as :: [k]).
(forall (a :: k). f a -&gt; g a) -&gt; List f as -&gt; List g as
</span><a href="Constrained.List.html#mapList"><span class="hs-identifier hs-var">mapList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679172431"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172431"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172431"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List Value as
</span><a href="#local-6989586621679172456"><span class="hs-identifier hs-var">pre</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679172435"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (a :: k) (a :: [k]).
f a -&gt; List f a -&gt; List f (a : a)
</span><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (as :: [k]).
(forall (a :: k). f a -&gt; g a) -&gt; List f as -&gt; List g as
</span><a href="Constrained.List.html#mapList"><span class="hs-identifier hs-var">mapList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679172428"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172428"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172428"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List Value as'
</span><a href="#local-6989586621679172451"><span class="hs-identifier hs-var">suf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3295"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (a :: [*]) (fn :: [*] -&gt; * -&gt; *) b.
(Typeable a, TypeList a, All (HasSpec fn) a, HasSpec fn b,
 BaseUniverse fn) =&gt;
fn a b -&gt; List (Term fn) a -&gt; Term fn b
</span><a href="Constrained.Base.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="annot"><span class="annottext">IntFn fn as b
</span><a href="#local-6989586621679172460"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List (Term fn) (Append as (a : as'))
</span><a href="#local-6989586621679172434"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var b
</span><a href="#local-6989586621679172437"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679172436"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3296"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var">propagateSpecFun</span></a></span><span> </span><span class="annot"><span class="annottext">IntFn fn as b
</span><a href="Constrained.Base.html#Add"><span class="hs-identifier hs-var">Add</span></a></span><span> </span><span id="local-6989586621679172422"><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679172422"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679172421"><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679172421"><span class="hs-identifier hs-var">spec</span></a></span></span><span>
</span><span id="line-3297"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679172413"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172413"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%21"><span class="hs-operator hs-type">:!</span></a></span><span> </span><span class="annot"><a href="Constrained.List.html#NilCtx"><span class="hs-identifier hs-type">NilCtx</span></a></span><span> </span><span class="annot"><span class="annottext">HOLE a b
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679172422"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: [*] -&gt; * -&gt; *) (fn :: [*] -&gt; * -&gt; *) (as :: [*]) a b.
(Functions f fn, TypeList as, Typeable as, HasSpec fn a,
 All (HasSpec fn) as) =&gt;
f as b -&gt; ListCtx Value as (HOLE a) -&gt; Spec fn b -&gt; Spec fn a
</span><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var">propagateSpecFun</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#IntFn"><span class="hs-identifier hs-type">IntFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181705"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679181705"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. NumLike fn a =&gt; IntFn fn '[a, a] a
</span><a href="Constrained.Base.html#Add"><span class="hs-identifier hs-var">Add</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="annot"><span class="annottext">forall (c :: * -&gt; *) a (f :: * -&gt; *) (a :: [*]).
c a -&gt; List f a -&gt; ListCtx f (a : a) c
</span><a href="Constrained.List.html#%3A%3F"><span class="hs-operator hs-var">:?</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; Value a
</span><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-var">Value</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172413"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (a :: k) (a :: [k]).
f a -&gt; List f a -&gt; List f (a : a)
</span><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *). List f '[]
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679172421"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-3298"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3F"><span class="hs-operator hs-type">:?</span></a></span><span> </span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679172386"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172386"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">List Value as
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679172422"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3299"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679172421"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3300"></span><span>          </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span id="local-6989586621679172377"><span class="annot"><span class="annottext">TypeSpec fn b
</span><a href="#local-6989586621679172377"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span id="local-6989586621679172376"><span class="annot"><span class="annottext">OrdSet b
</span><a href="#local-6989586621679172376"><span class="hs-identifier hs-var">cant</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3301"></span><span>            </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
NumLike fn a =&gt;
a -&gt; TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#subtractSpec"><span class="hs-identifier hs-var">subtractSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679181705"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172386"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn b
</span><a href="#local-6989586621679172377"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (f :: * -&gt; *).
(HasSpec fn a, Foldable f) =&gt;
f a -&gt; Spec fn a
</span><a href="Constrained.Base.html#notMemberSpec"><span class="hs-identifier hs-var">notMemberSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [Maybe a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">catMaybes</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. NumLike fn a =&gt; a -&gt; a -&gt; Maybe a
</span><a href="Constrained.Base.html#safeSubtract"><span class="hs-identifier hs-var">safeSubtract</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679181705"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172386"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdSet b
</span><a href="#local-6989586621679172376"><span class="hs-identifier hs-var">cant</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3302"></span><span>          </span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span id="local-6989586621679172374"><span class="annot"><span class="annottext">OrdSet b
</span><a href="#local-6989586621679172374"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-var">MemberSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [Maybe a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">catMaybes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. NumLike fn a =&gt; a -&gt; a -&gt; Maybe a
</span><a href="Constrained.Base.html#safeSubtract"><span class="hs-identifier hs-var">safeSubtract</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679181705"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679172386"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdSet b
</span><a href="#local-6989586621679172374"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3303"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var">propagateSpecFun</span></a></span><span> </span><span class="annot"><span class="annottext">IntFn fn as b
</span><a href="Constrained.Base.html#Negate"><span class="hs-identifier hs-var">Negate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.List.html#NilCtx"><span class="hs-identifier hs-type">NilCtx</span></a></span><span> </span><span class="annot"><span class="annottext">HOLE a b
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679172366"><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679172366"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679172366"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3304"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span id="local-6989586621679172358"><span class="annot"><span class="annottext">TypeSpec fn b
</span><a href="#local-6989586621679172358"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679172357"><span id="local-6989586621679172356"><span class="annot"><span class="annottext">OrdSet b
</span><a href="#local-6989586621679172356"><span class="hs-identifier hs-var">cant</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#OrdSet"><span class="hs-identifier hs-type">OrdSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172357"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3305"></span><span>      </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
NumLike fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#negateSpec"><span class="hs-identifier hs-var">negateSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679181705"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679172357"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn b
</span><a href="#local-6989586621679172358"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (f :: * -&gt; *).
(HasSpec fn a, Foldable f) =&gt;
f a -&gt; Spec fn a
</span><a href="Constrained.Base.html#notMemberSpec"><span class="hs-identifier hs-var">notMemberSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">negate</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet b
</span><a href="#local-6989586621679172356"><span class="hs-identifier hs-var">cant</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3306"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span id="local-6989586621679172355"><span class="annot"><span class="annottext">OrdSet b
</span><a href="#local-6989586621679172355"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-var">MemberSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">negate</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet b
</span><a href="#local-6989586621679172355"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-3307"></span><span>
</span><span id="line-3308"></span><span>  </span><span id="local-6989586621679172352"><span class="annot"><span class="annottext">mapTypeSpec :: forall a b.
(HasSpec fn a, HasSpec fn b) =&gt;
IntFn fn '[a] b -&gt; TypeSpec fn a -&gt; Spec fn b
</span><a href="#local-6989586621679172352"><span class="hs-identifier hs-var hs-var hs-var hs-var">mapTypeSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">IntFn fn '[a] b
</span><a href="Constrained.Base.html#Negate"><span class="hs-identifier hs-var">Negate</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679172347"><span id="local-6989586621679172346"><span class="annot"><span class="annottext">TypeSpec fn b
</span><a href="#local-6989586621679172346"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181705"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172347"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3309"></span><span>    </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
NumLike fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#negateSpec"><span class="hs-identifier hs-var">negateSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679181705"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679172347"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn b
</span><a href="#local-6989586621679172346"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-3310"></span><span>
</span><span id="line-3311"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-3312"></span><span class="hs-comment">-- Syntax</span><span>
</span><span id="line-3313"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-3314"></span><span>
</span><span id="line-3315"></span><span class="hs-comment">-- Functions on terms -----------------------------------------------------</span><span>
</span><span id="line-3316"></span><span>
</span><span id="line-3317"></span><span class="annot"><a href="Constrained.Base.html#toGeneric_"><span class="hs-identifier hs-type">toGeneric_</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3318"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183187"><span class="annot"><a href="#local-6989586621679183187"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679183188"><span class="annot"><a href="#local-6989586621679183188"><span class="hs-identifier hs-type">fn</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-3319"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183188"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183187"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3320"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183188"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183187"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3321"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSimpleRep"><span class="hs-identifier hs-type">HasSimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183187"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3322"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183188"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183187"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183188"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183187"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3323"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3324"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183188"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183187"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3325"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183188"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183187"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3326"></span><span id="toGeneric_"><span class="annot"><span class="annottext">toGeneric_ :: forall a (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, HasSpec fn (SimpleRep a), HasSimpleRep a,
 TypeSpec fn a ~ TypeSpec fn (SimpleRep a)) =&gt;
Term fn a -&gt; Term fn (SimpleRep a)
</span><a href="Constrained.Base.html#toGeneric_"><span class="hs-identifier hs-var hs-var">toGeneric_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn (SimpleRep a),
 TypeSpec fn a ~ TypeSpec fn (SimpleRep a), HasSimpleRep a) =&gt;
fn '[a] (SimpleRep a)
</span><a href="Constrained.Base.html#toGenericFn"><span class="hs-identifier hs-var">toGenericFn</span></a></span><span>
</span><span id="line-3327"></span><span>
</span><span id="line-3328"></span><span class="annot"><a href="Constrained.Base.html#fromGeneric_"><span class="hs-identifier hs-type">fromGeneric_</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3329"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182413"><span class="annot"><a href="#local-6989586621679182413"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679182414"><span class="annot"><a href="#local-6989586621679182414"><span class="hs-identifier hs-type">fn</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-3330"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182414"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182413"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3331"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182414"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182413"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3332"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSimpleRep"><span class="hs-identifier hs-type">HasSimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182413"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3333"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182414"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182413"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182414"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182413"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3334"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3335"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182414"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#SimpleRep"><span class="hs-identifier hs-type">SimpleRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182413"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3336"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182414"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182413"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3337"></span><span id="fromGeneric_"><span class="annot"><span class="annottext">fromGeneric_ :: forall a (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, HasSpec fn (SimpleRep a), HasSimpleRep a,
 TypeSpec fn a ~ TypeSpec fn (SimpleRep a)) =&gt;
Term fn (SimpleRep a) -&gt; Term fn a
</span><a href="Constrained.Base.html#fromGeneric_"><span class="hs-identifier hs-var hs-var">fromGeneric_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn (SimpleRep a),
 TypeSpec fn a ~ TypeSpec fn (SimpleRep a), HasSimpleRep a) =&gt;
fn '[SimpleRep a] a
</span><a href="Constrained.Base.html#fromGenericFn"><span class="hs-identifier hs-var">fromGenericFn</span></a></span><span>
</span><span id="line-3338"></span><span>
</span><span id="line-3339"></span><span id="local-6989586621679183147"><span class="annot"><a href="Constrained.Base.html#not_"><span class="hs-identifier hs-type">not_</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3340"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183147"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3341"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183147"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3342"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183147"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-3343"></span><span id="not_"><span class="annot"><span class="annottext">not_ :: forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
Term fn Bool -&gt; Term fn Bool
</span><a href="Constrained.Base.html#not_"><span class="hs-identifier hs-var hs-var">not_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
Member (BoolFn fn) fn =&gt;
fn '[Bool] Bool
</span><a href="Constrained.Univ.html#notFn"><span class="hs-identifier hs-var">notFn</span></a></span><span>
</span><span id="line-3344"></span><span>
</span><span id="line-3345"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">3</span><span> </span><span class="annot"><a href="Constrained.Base.html#%26%26."><span class="hs-operator hs-type">&amp;&amp;.</span></a></span><span>
</span><span id="line-3346"></span><span id="local-6989586621679181681"><span class="annot"><a href="Constrained.Base.html#%26%26."><span class="hs-operator hs-type">(&amp;&amp;.)</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3347"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181681"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3348"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181681"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3349"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181681"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3350"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181681"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-3351"></span><span id="%26%26."><span class="annot"><span class="annottext">&amp;&amp;. :: forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
Term fn Bool -&gt; Term fn Bool -&gt; Term fn Bool
</span><a href="Constrained.Base.html#%26%26."><span class="hs-operator hs-var hs-var">(&amp;&amp;.)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
Member (BoolFn fn) fn =&gt;
fn '[Bool, Bool] Bool
</span><a href="Constrained.Univ.html#andFn"><span class="hs-identifier hs-var">andFn</span></a></span><span>
</span><span id="line-3352"></span><span>
</span><span id="line-3353"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">2</span><span> </span><span class="annot"><a href="Constrained.Base.html#%7C%7C."><span class="hs-operator hs-type">||.</span></a></span><span>
</span><span id="line-3354"></span><span id="local-6989586621679172252"><span class="annot"><a href="Constrained.Base.html#%7C%7C."><span class="hs-operator hs-type">(||.)</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3355"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172252"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3356"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172252"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3357"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172252"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3358"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172252"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-3359"></span><span id="%7C%7C."><span class="annot"><span class="annottext">||. :: forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
Term fn Bool -&gt; Term fn Bool -&gt; Term fn Bool
</span><a href="Constrained.Base.html#%7C%7C."><span class="hs-operator hs-var hs-var">(||.)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
Member (BoolFn fn) fn =&gt;
fn '[Bool, Bool] Bool
</span><a href="Constrained.Univ.html#orFn"><span class="hs-identifier hs-var">orFn</span></a></span><span>
</span><span id="line-3360"></span><span>
</span><span id="line-3361"></span><span class="annot"><a href="Constrained.Base.html#elem_"><span class="hs-identifier hs-type">elem_</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3362"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679183149"><span class="annot"><a href="#local-6989586621679183149"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679183150"><span class="annot"><a href="#local-6989586621679183150"><span class="hs-identifier hs-type">fn</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-3363"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183150"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183149"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3364"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183150"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183149"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3365"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183150"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679183149"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3366"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183150"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-3367"></span><span id="elem_"><span class="annot"><span class="annottext">elem_ :: forall a (fn :: [*] -&gt; * -&gt; *).
HasSpec fn a =&gt;
Term fn a -&gt; Term fn [a] -&gt; Term fn Bool
</span><a href="Constrained.Base.html#elem_"><span class="hs-identifier hs-var hs-var">elem_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(Member (SetFn fn) fn, Eq a) =&gt;
fn '[a, [a]] Bool
</span><a href="Constrained.Univ.html#elemFn"><span class="hs-identifier hs-var">elemFn</span></a></span><span>
</span><span id="line-3368"></span><span>
</span><span id="line-3369"></span><span class="annot"><a href="Constrained.Base.html#member_"><span class="hs-identifier hs-type">member_</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3370"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182004"><span class="annot"><a href="#local-6989586621679182004"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679182005"><span class="annot"><a href="#local-6989586621679182005"><span class="hs-identifier hs-type">fn</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-3371"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182005"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182004"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3372"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182004"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3373"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3374"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182005"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182004"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3375"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182005"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182004"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3376"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182005"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-3377"></span><span id="member_"><span class="annot"><span class="annottext">member_ :: forall a (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, Ord a) =&gt;
Term fn a -&gt; Term fn (Set a) -&gt; Term fn Bool
</span><a href="Constrained.Base.html#member_"><span class="hs-identifier hs-var hs-var">member_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(Member (SetFn fn) fn, Ord a) =&gt;
fn '[a, Set a] Bool
</span><a href="Constrained.Univ.html#memberFn"><span class="hs-identifier hs-var">memberFn</span></a></span><span>
</span><span id="line-3378"></span><span>
</span><span id="line-3379"></span><span id="local-6989586621679182055"><span id="local-6989586621679182056"><span class="annot"><a href="Constrained.Base.html#subset_"><span class="hs-identifier hs-type">subset_</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3380"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182056"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182055"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3381"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182055"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3382"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3383"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182056"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182055"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3384"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182056"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182055"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3385"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182056"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span><span>
</span><span id="line-3386"></span><span id="subset_"><span class="annot"><span class="annottext">subset_ :: forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn a, Ord a) =&gt;
Term fn (Set a) -&gt; Term fn (Set a) -&gt; Term fn Bool
</span><a href="Constrained.Base.html#subset_"><span class="hs-identifier hs-var hs-var">subset_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(Member (SetFn fn) fn, Ord a) =&gt;
fn '[Set a, Set a] Bool
</span><a href="Constrained.Univ.html#subsetFn"><span class="hs-identifier hs-var">subsetFn</span></a></span><span>
</span><span id="line-3387"></span><span>
</span><span id="line-3388"></span><span id="local-6989586621679172138"><span id="local-6989586621679172139"><span class="annot"><a href="Constrained.Base.html#disjoint_"><span class="hs-identifier hs-type">disjoint_</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3389"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172139"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172138"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3390"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172138"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3391"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3392"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172139"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172138"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3393"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172139"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172138"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3394"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172139"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span><span>
</span><span id="line-3395"></span><span id="disjoint_"><span class="annot"><span class="annottext">disjoint_ :: forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn a, Ord a) =&gt;
Term fn (Set a) -&gt; Term fn (Set a) -&gt; Term fn Bool
</span><a href="Constrained.Base.html#disjoint_"><span class="hs-identifier hs-var hs-var">disjoint_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(Member (SetFn fn) fn, Ord a) =&gt;
fn '[Set a, Set a] Bool
</span><a href="Constrained.Univ.html#disjointFn"><span class="hs-identifier hs-var">disjointFn</span></a></span><span>
</span><span id="line-3396"></span><span>
</span><span id="line-3397"></span><span id="local-6989586621679181963"><span id="local-6989586621679181964"><span class="annot"><a href="Constrained.Base.html#singleton_"><span class="hs-identifier hs-type">singleton_</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3398"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181964"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181963"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3399"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181963"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3400"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3401"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181964"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181963"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3402"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181964"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181963"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-3403"></span><span id="singleton_"><span class="annot"><span class="annottext">singleton_ :: forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn a, Ord a) =&gt;
Term fn a -&gt; Term fn (Set a)
</span><a href="Constrained.Base.html#singleton_"><span class="hs-identifier hs-var hs-var">singleton_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(Member (SetFn fn) fn, Ord a) =&gt;
fn '[a] (Set a)
</span><a href="Constrained.Univ.html#singletonFn"><span class="hs-identifier hs-var">singletonFn</span></a></span><span>
</span><span id="line-3404"></span><span>
</span><span id="line-3405"></span><span class="annot"><a href="Constrained.Base.html#size_"><span class="hs-identifier hs-type">size_</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3406"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182049"><span class="annot"><a href="#local-6989586621679182049"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679182050"><span class="annot"><a href="#local-6989586621679182050"><span class="hs-identifier hs-type">fn</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-3407"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182050"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182049"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182049"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3408"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182050"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182049"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3409"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182050"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-3410"></span><span id="size_"><span class="annot"><span class="annottext">size_ :: forall a (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn (Set a), Ord a) =&gt;
Term fn (Set a) -&gt; Term fn Int
</span><a href="Constrained.Base.html#size_"><span class="hs-identifier hs-var hs-var">size_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(Member (SetFn fn) fn, Ord a) =&gt;
fn '[Set a] Int
</span><a href="Constrained.Univ.html#sizeFn"><span class="hs-identifier hs-var">sizeFn</span></a></span><span>
</span><span id="line-3411"></span><span>
</span><span id="line-3412"></span><span class="annot"><a href="Constrained.Base.html#length_"><span class="hs-identifier hs-type">length_</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3413"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679181947"><span class="annot"><a href="#local-6989586621679181947"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679181948"><span class="annot"><a href="#local-6989586621679181948"><span class="hs-identifier hs-type">fn</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-3414"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181948"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679181947"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3415"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181948"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679181947"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3416"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181948"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-3417"></span><span id="length_"><span class="annot"><span class="annottext">length_ :: forall a (fn :: [*] -&gt; * -&gt; *).
HasSpec fn [a] =&gt;
Term fn [a] -&gt; Term fn Int
</span><a href="Constrained.Base.html#length_"><span class="hs-identifier hs-var hs-var">length_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Member (ListFn fn) fn =&gt;
fn '[[a]] Int
</span><a href="Constrained.Base.html#listSizeFn"><span class="hs-identifier hs-var">listSizeFn</span></a></span><span>
</span><span id="line-3418"></span><span>
</span><span id="line-3419"></span><span class="hs-keyword">infix</span><span> </span><span class="hs-number">4</span><span> </span><span class="annot"><a href="Constrained.Base.html#%3C%3D."><span class="hs-operator hs-type">&lt;=.</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#%3C."><span class="hs-operator hs-type">&lt;.</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#%3D%3D."><span class="hs-operator hs-type">==.</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#%2F%3D."><span class="hs-operator hs-type">/=.</span></a></span><span>
</span><span id="line-3420"></span><span>
</span><span id="line-3421"></span><span id="local-6989586621679181889"><span id="local-6989586621679181890"><span class="annot"><a href="Constrained.Base.html#%3C%3D."><span class="hs-operator hs-type">(&lt;=.)</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3422"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181890"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3423"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#OrdLike"><span class="hs-identifier hs-type">OrdLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181889"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181890"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3424"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3425"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181889"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181890"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3426"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181889"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181890"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3427"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181889"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span><span>
</span><span id="line-3428"></span><span id="%3C%3D."><span class="annot"><span class="annottext">&lt;=. :: forall a (fn :: [*] -&gt; * -&gt; *).
(Ord a, OrdLike fn a) =&gt;
Term fn a -&gt; Term fn a -&gt; Term fn Bool
</span><a href="Constrained.Base.html#%3C%3D."><span class="hs-operator hs-var hs-var">(&lt;=.)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(Ord a, OrdLike fn a) =&gt;
fn '[a, a] Bool
</span><a href="Constrained.Base.html#lessOrEqualFn"><span class="hs-identifier hs-var">lessOrEqualFn</span></a></span><span>
</span><span id="line-3429"></span><span>
</span><span id="line-3430"></span><span id="local-6989586621679172014"><span id="local-6989586621679172015"><span class="annot"><a href="Constrained.Base.html#%3C."><span class="hs-operator hs-type">(&lt;.)</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3431"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172015"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3432"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#OrdLike"><span class="hs-identifier hs-type">OrdLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172014"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172015"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3433"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3434"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172014"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172015"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3435"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172014"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172015"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3436"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679172014"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span><span>
</span><span id="line-3437"></span><span id="%3C."><span class="annot"><span class="annottext">&lt;. :: forall a (fn :: [*] -&gt; * -&gt; *).
(Ord a, OrdLike fn a) =&gt;
Term fn a -&gt; Term fn a -&gt; Term fn Bool
</span><a href="Constrained.Base.html#%3C."><span class="hs-operator hs-var hs-var">(&lt;.)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(Ord a, OrdLike fn a) =&gt;
fn '[a, a] Bool
</span><a href="Constrained.Base.html#lessFn"><span class="hs-identifier hs-var">lessFn</span></a></span><span>
</span><span id="line-3438"></span><span>
</span><span id="line-3439"></span><span id="local-6989586621679183081"><span id="local-6989586621679183082"><span class="annot"><a href="Constrained.Base.html#%3D%3D."><span class="hs-operator hs-type">(==.)</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3440"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183082"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183081"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3441"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183082"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183081"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3442"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183082"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183081"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3443"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183082"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span><span>
</span><span id="line-3444"></span><span id="%3D%3D."><span class="annot"><span class="annottext">==. :: forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Term fn a -&gt; Term fn Bool
</span><a href="Constrained.Base.html#%3D%3D."><span class="hs-operator hs-var hs-var">(==.)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(Eq a, Member (EqFn fn) fn) =&gt;
fn '[a, a] Bool
</span><a href="Constrained.Univ.html#equalFn"><span class="hs-identifier hs-var">equalFn</span></a></span><span>
</span><span id="line-3445"></span><span>
</span><span id="line-3446"></span><span id="local-6989586621679171961"><span id="local-6989586621679171962"><span class="annot"><a href="Constrained.Base.html#%2F%3D."><span class="hs-operator hs-type">(/=.)</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3447"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171962"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171961"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3448"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171962"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171961"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3449"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171962"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171961"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3450"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171962"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span><span>
</span><span id="line-3451"></span><span id="local-6989586621679171956"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679171956"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="%2F%3D."><span class="annot"><span class="annottext">/=. :: forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Term fn a -&gt; Term fn Bool
</span><a href="Constrained.Base.html#%2F%3D."><span class="hs-operator hs-var hs-var">/=.</span></a></span></span><span> </span><span id="local-6989586621679171955"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679171955"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
Term fn Bool -&gt; Term fn Bool
</span><a href="Constrained.Base.html#not_"><span class="hs-identifier hs-var">not_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679171956"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Term fn a -&gt; Term fn Bool
</span><a href="Constrained.Base.html#%3D%3D."><span class="hs-operator hs-var">==.</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679171955"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3452"></span><span>
</span><span id="line-3453"></span><span id="local-6989586621679181642"><span id="local-6989586621679181643"><span class="annot"><a href="Constrained.Base.html#sum_"><span class="hs-identifier hs-type">sum_</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3454"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181643"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-3455"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Univ.html#Member"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#FunFn"><span class="hs-identifier hs-type">FunFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181643"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679181643"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-3456"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#Foldy"><span class="hs-identifier hs-type">Foldy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181643"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181642"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3457"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3458"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181643"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679181642"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3459"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181643"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181642"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-3460"></span><span id="sum_"><span class="annot"><span class="annottext">sum_ :: forall (fn :: [*] -&gt; * -&gt; *) a.
(BaseUniverse fn, Member (FunFn fn) fn, Foldy fn a) =&gt;
Term fn [a] -&gt; Term fn a
</span><a href="Constrained.Base.html#sum_"><span class="hs-identifier hs-var hs-var">sum_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
(HasSpec fn a, Foldy fn b, Show (fn '[a] b), Eq (fn '[a] b)) =&gt;
fn '[a] b -&gt; fn '[[a]] b
</span><a href="Constrained.Base.html#foldMapFn"><span class="hs-identifier hs-var">foldMapFn</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Member (FunFn fn) fn =&gt; fn '[a] a
</span><a href="Constrained.Base.html#idFn"><span class="hs-identifier hs-var">idFn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3461"></span><span>
</span><span id="line-3462"></span><span id="local-6989586621679181637"><span id="local-6989586621679181638"><span id="local-6989586621679181639"><span class="annot"><a href="Constrained.Base.html#foldMap_"><span class="hs-identifier hs-type">foldMap_</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3463"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181639"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-3464"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#Foldy"><span class="hs-identifier hs-type">Foldy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181639"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181638"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-3465"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181639"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181637"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3466"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3467"></span><span>  </span><span class="annot"><a href="#local-6989586621679181639"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679181637"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679181638"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3468"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181639"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679181637"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3469"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181639"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181638"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-3470"></span><span id="foldMap_"><span class="annot"><span class="annottext">foldMap_ :: forall (fn :: [*] -&gt; * -&gt; *) b a.
(BaseUniverse fn, Foldy fn b, HasSpec fn a) =&gt;
fn '[a] b -&gt; Term fn [a] -&gt; Term fn b
</span><a href="Constrained.Base.html#foldMap_"><span class="hs-identifier hs-var hs-var">foldMap_</span></a></span></span><span> </span><span id="local-6989586621679171890"><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679171890"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
(HasSpec fn a, Foldy fn b, Show (fn '[a] b), Eq (fn '[a] b)) =&gt;
fn '[a] b -&gt; fn '[[a]] b
</span><a href="Constrained.Base.html#foldMapFn"><span class="hs-identifier hs-var">foldMapFn</span></a></span><span> </span><span class="annot"><span class="annottext">fn '[a] b
</span><a href="#local-6989586621679171890"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3471"></span><span>
</span><span id="line-3472"></span><span class="hs-comment">-- Language constructs ----------------------------------------------------</span><span>
</span><span id="line-3473"></span><span>
</span><span id="line-3474"></span><span class="annot"><a href="Constrained.Base.html#constrained"><span class="hs-identifier hs-type">constrained</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3475"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182889"><span class="annot"><a href="#local-6989586621679182889"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679182890"><span class="annot"><a href="#local-6989586621679182890"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679182891"><span class="annot"><a href="#local-6989586621679182891"><span class="hs-identifier hs-type">p</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-3476"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#IsPred"><span class="hs-identifier hs-type">IsPred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182891"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182890"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182890"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182889"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3477"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182890"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182889"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679182891"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3478"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182890"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182889"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3479"></span><span id="constrained"><span class="annot"><span class="annottext">constrained :: forall a (fn :: [*] -&gt; * -&gt; *) p.
(IsPred p fn, HasSpec fn a) =&gt;
(Term fn a -&gt; p) -&gt; Spec fn a
</span><a href="Constrained.Base.html#constrained"><span class="hs-identifier hs-var hs-var">constrained</span></a></span></span><span> </span><span id="local-6989586621679171880"><span class="annot"><span class="annottext">Term fn a -&gt; p
</span><a href="#local-6989586621679171880"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3480"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679171878"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679171878"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679171877"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679171877"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a p.
(HasSpec fn a, IsPred p fn) =&gt;
(Term fn a -&gt; p) -&gt; Binder fn a
</span><a href="Constrained.Base.html#bind"><span class="hs-identifier hs-var">bind</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a -&gt; p
</span><a href="#local-6989586621679171880"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-3481"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn a, HasCallStack) =&gt;
Var a -&gt; Pred fn -&gt; Spec fn a
</span><a href="Constrained.Base.html#computeSpec"><span class="hs-identifier hs-var">computeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679171878"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). BaseUniverse fn =&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#optimisePred"><span class="hs-identifier hs-var">optimisePred</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679171877"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3482"></span><span>
</span><span id="line-3483"></span><span id="local-6989586621679182667"><span id="local-6989586621679182668"><span class="annot"><a href="Constrained.Base.html#assertExplain"><span class="hs-identifier hs-type">assertExplain</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3484"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182668"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#IsPred"><span class="hs-identifier hs-type">IsPred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182667"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182668"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3485"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3486"></span><span>  </span><span class="annot"><a href="#local-6989586621679182667"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3487"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182668"><span class="hs-identifier hs-type">fn</span></a></span></span></span><span>
</span><span id="line-3488"></span><span id="assertExplain"><span class="annot"><span class="annottext">assertExplain :: forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
[String] -&gt; p -&gt; Pred fn
</span><a href="Constrained.Base.html#assertExplain"><span class="hs-identifier hs-var hs-var">assertExplain</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall p (fn :: [*] -&gt; * -&gt; *).
(PredLike p, BaseUniverse fn, UnivConstr p fn) =&gt;
[String] -&gt; p -&gt; Pred fn
</span><a href="Constrained.Base.html#toPredExplain"><span class="hs-identifier hs-var">toPredExplain</span></a></span><span>
</span><span id="line-3489"></span><span>
</span><span id="line-3490"></span><span id="local-6989586621679183083"><span id="local-6989586621679183084"><span class="annot"><a href="Constrained.Base.html#assert"><span class="hs-identifier hs-type">assert</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3491"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183084"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#IsPred"><span class="hs-identifier hs-type">IsPred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183083"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183084"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3492"></span><span>  </span><span class="annot"><a href="#local-6989586621679183083"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3493"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183084"><span class="hs-identifier hs-type">fn</span></a></span></span></span><span>
</span><span id="line-3494"></span><span id="assert"><span class="annot"><span class="annottext">assert :: forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
p -&gt; Pred fn
</span><a href="Constrained.Base.html#assert"><span class="hs-identifier hs-var hs-var">assert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
p -&gt; Pred fn
</span><a href="Constrained.Base.html#toPred"><span class="hs-identifier hs-var">toPred</span></a></span><span>
</span><span id="line-3495"></span><span>
</span><span id="line-3496"></span><span id="local-6989586621679182051"><span id="local-6989586621679182052"><span id="local-6989586621679182053"><span id="local-6989586621679182054"><span class="annot"><a href="Constrained.Base.html#forAll"><span class="hs-identifier hs-type">forAll</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3497"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#Forallable"><span class="hs-identifier hs-type">Forallable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182054"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182053"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3498"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182052"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182054"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-3499"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182052"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182053"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3500"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#IsPred"><span class="hs-identifier hs-type">IsPred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182051"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182052"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-3501"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3502"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182052"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182054"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3503"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182052"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182053"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679182051"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3504"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182052"><span class="hs-identifier hs-type">fn</span></a></span></span></span></span></span><span>
</span><span id="line-3505"></span><span id="forAll"><span class="annot"><span class="annottext">forAll :: forall t a (fn :: [*] -&gt; * -&gt; *) p.
(Forallable t a, HasSpec fn t, HasSpec fn a, IsPred p fn) =&gt;
Term fn t -&gt; (Term fn a -&gt; p) -&gt; Pred fn
</span><a href="Constrained.Base.html#forAll"><span class="hs-identifier hs-var hs-var">forAll</span></a></span></span><span> </span><span id="local-6989586621679171854"><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679171854"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span id="local-6989586621679171853"><span class="annot"><span class="annottext">Term fn a -&gt; p
</span><a href="#local-6989586621679171853"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a a (fn :: [*] -&gt; * -&gt; *).
(Forallable a a, HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#ForAll"><span class="hs-identifier hs-var">ForAll</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679171854"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a p.
(HasSpec fn a, IsPred p fn) =&gt;
(Term fn a -&gt; p) -&gt; Binder fn a
</span><a href="Constrained.Base.html#bind"><span class="hs-identifier hs-var">bind</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a -&gt; p
</span><a href="#local-6989586621679171853"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3506"></span><span>
</span><span id="line-3507"></span><span class="annot"><a href="Constrained.Base.html#exists"><span class="hs-identifier hs-type">exists</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3508"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182015"><span class="annot"><a href="#local-6989586621679182015"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679182014"><span class="annot"><a href="#local-6989586621679182014"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span id="local-6989586621679182016"><span class="annot"><a href="#local-6989586621679182016"><span class="hs-identifier hs-type">fn</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-3509"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182016"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182015"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#IsPred"><span class="hs-identifier hs-type">IsPred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182014"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182016"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3510"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679182013"><span class="annot"><a href="#local-6989586621679182013"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182016"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182013"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679182013"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.GenT.html#GE"><span class="hs-identifier hs-type">GE</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182015"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3511"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182016"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182015"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679182014"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3512"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182016"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-3513"></span><span id="exists"><span class="annot"><span class="annottext">exists :: forall a p (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, IsPred p fn) =&gt;
((forall b. Term fn b -&gt; b) -&gt; GE a) -&gt; (Term fn a -&gt; p) -&gt; Pred fn
</span><a href="Constrained.Base.html#exists"><span class="hs-identifier hs-var hs-var">exists</span></a></span></span><span> </span><span id="local-6989586621679171848"><span class="annot"><span class="annottext">(forall b. Term fn b -&gt; b) -&gt; GE a
</span><a href="#local-6989586621679171848"><span class="hs-identifier hs-var">sem</span></a></span></span><span> </span><span id="local-6989586621679171847"><span class="annot"><span class="annottext">Term fn a -&gt; p
</span><a href="#local-6989586621679171847"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3514"></span><span>  </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
((forall b. Term fn b -&gt; b) -&gt; GE a) -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Exists"><span class="hs-identifier hs-var">Exists</span></a></span><span> </span><span class="annot"><span class="annottext">(forall b. Term fn b -&gt; b) -&gt; GE a
</span><a href="#local-6989586621679171848"><span class="hs-identifier hs-var">sem</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a p.
(HasSpec fn a, IsPred p fn) =&gt;
(Term fn a -&gt; p) -&gt; Binder fn a
</span><a href="Constrained.Base.html#bind"><span class="hs-identifier hs-var">bind</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a -&gt; p
</span><a href="#local-6989586621679171847"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-3515"></span><span>
</span><span id="line-3516"></span><span class="annot"><a href="Constrained.Base.html#unsafeExists"><span class="hs-identifier hs-type">unsafeExists</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3517"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679181966"><span class="annot"><a href="#local-6989586621679181966"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679181965"><span class="annot"><a href="#local-6989586621679181965"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span id="local-6989586621679181967"><span class="annot"><a href="#local-6989586621679181967"><span class="hs-identifier hs-type">fn</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-3518"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181967"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181966"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#IsPred"><span class="hs-identifier hs-type">IsPred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181965"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181967"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3519"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181967"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181966"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679181965"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3520"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181967"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-3521"></span><span id="unsafeExists"><span class="annot"><span class="annottext">unsafeExists :: forall a p (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, IsPred p fn) =&gt;
(Term fn a -&gt; p) -&gt; Pred fn
</span><a href="Constrained.Base.html#unsafeExists"><span class="hs-identifier hs-var hs-var">unsafeExists</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a p (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn a, IsPred p fn) =&gt;
((forall b. Term fn b -&gt; b) -&gt; GE a) -&gt; (Term fn a -&gt; p) -&gt; Pred fn
</span><a href="Constrained.Base.html#exists"><span class="hs-identifier hs-var">exists</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">forall b. Term fn b -&gt; b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadGenError m, HasCallStack) =&gt;
[String] -&gt; m a
</span><a href="Constrained.GenT.html#fatalError"><span class="hs-identifier hs-var">fatalError</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unsafeExists&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3522"></span><span>
</span><span id="line-3523"></span><span id="local-6989586621679181611"><span id="local-6989586621679181612"><span id="local-6989586621679181613"><span class="annot"><a href="Constrained.Base.html#letBind"><span class="hs-identifier hs-type">letBind</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3524"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181613"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181612"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3525"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#IsPred"><span class="hs-identifier hs-type">IsPred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181611"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181613"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-3526"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3527"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181613"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181612"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3528"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181613"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181612"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679181611"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3529"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181613"><span class="hs-identifier hs-type">fn</span></a></span></span></span></span><span>
</span><span id="line-3530"></span><span id="letBind"><span class="annot"><span class="annottext">letBind :: forall (fn :: [*] -&gt; * -&gt; *) a p.
(HasSpec fn a, IsPred p fn) =&gt;
Term fn a -&gt; (Term fn a -&gt; p) -&gt; Pred fn
</span><a href="Constrained.Base.html#letBind"><span class="hs-identifier hs-var hs-var">letBind</span></a></span></span><span> </span><span id="local-6989586621679171833"><span class="annot"><span class="annottext">tm :: Term fn a
</span><a href="#local-6989586621679171833"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Constrained.Base.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span id="local-6989586621679171829"><span class="annot"><span class="annottext">Term fn a -&gt; p
</span><a href="#local-6989586621679171829"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
p -&gt; Pred fn
</span><a href="Constrained.Base.html#toPred"><span class="hs-identifier hs-var">toPred</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a -&gt; p
</span><a href="#local-6989586621679171829"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679171833"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-3531"></span><span class="annot"><a href="Constrained.Base.html#letBind"><span class="hs-identifier hs-var">letBind</span></a></span><span> </span><span id="local-6989586621679171828"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679171828"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span id="local-6989586621679171827"><span class="annot"><span class="annottext">Term fn a -&gt; p
</span><a href="#local-6989586621679171827"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Term fn a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679171828"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a p.
(HasSpec fn a, IsPred p fn) =&gt;
(Term fn a -&gt; p) -&gt; Binder fn a
</span><a href="Constrained.Base.html#bind"><span class="hs-identifier hs-var">bind</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a -&gt; p
</span><a href="#local-6989586621679171827"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3532"></span><span>
</span><span id="line-3533"></span><span id="local-6989586621679181604"><span id="local-6989586621679181605"><span id="local-6989586621679181606"><span id="local-6989586621679181607"><span class="annot"><a href="Constrained.Base.html#reify"><span class="hs-identifier hs-type">reify</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3534"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181607"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181606"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3535"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181607"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181605"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-3536"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#IsPred"><span class="hs-identifier hs-type">IsPred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181604"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181607"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-3537"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3538"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181607"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181606"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3539"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679181606"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679181605"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3540"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181607"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181605"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679181604"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3541"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181607"><span class="hs-identifier hs-type">fn</span></a></span></span></span></span></span><span>
</span><span id="line-3542"></span><span id="reify"><span class="annot"><span class="annottext">reify :: forall (fn :: [*] -&gt; * -&gt; *) a b p.
(HasSpec fn a, HasSpec fn b, IsPred p fn) =&gt;
Term fn a -&gt; (a -&gt; b) -&gt; (Term fn b -&gt; p) -&gt; Pred fn
</span><a href="Constrained.Base.html#reify"><span class="hs-identifier hs-var hs-var">reify</span></a></span></span><span> </span><span id="local-6989586621679171818"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679171818"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span id="local-6989586621679171817"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679171817"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679171816"><span class="annot"><span class="annottext">Term fn b -&gt; p
</span><a href="#local-6989586621679171816"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3543"></span><span>  </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a a.
(HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; (a -&gt; a) -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#mkReify"><span class="hs-identifier hs-var">mkReify</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679171818"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679171817"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a p.
(HasSpec fn a, IsPred p fn) =&gt;
(Term fn a -&gt; p) -&gt; Binder fn a
</span><a href="Constrained.Base.html#bind"><span class="hs-identifier hs-var">bind</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn b -&gt; p
</span><a href="#local-6989586621679171816"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3544"></span><span>
</span><span id="line-3545"></span><span id="local-6989586621679171813"><span id="local-6989586621679171814"><span id="local-6989586621679171815"><span class="annot"><a href="Constrained.Base.html#dependsOn"><span class="hs-identifier hs-type">dependsOn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171815"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171814"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171815"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171813"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171815"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171814"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171815"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171813"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171815"><span class="hs-identifier hs-type">fn</span></a></span></span></span></span><span>
</span><span id="line-3546"></span><span id="dependsOn"><span class="annot"><span class="annottext">dependsOn :: forall (fn :: [*] -&gt; * -&gt; *) a a.
(HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; Term fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#dependsOn"><span class="hs-identifier hs-var hs-var">dependsOn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a a.
(HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; Term fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#DependsOn"><span class="hs-identifier hs-var">DependsOn</span></a></span><span>
</span><span id="line-3547"></span><span>
</span><span id="line-3548"></span><span id="local-6989586621679171806"><span id="local-6989586621679171807"><span class="annot"><a href="Constrained.Base.html#lit"><span class="hs-identifier hs-type">lit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171807"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679171807"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171806"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171807"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-3549"></span><span id="lit"><span class="annot"><span class="annottext">lit :: forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#lit"><span class="hs-identifier hs-var hs-var">lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span>
</span><span id="line-3550"></span><span>
</span><span id="line-3551"></span><span class="annot"><a href="Constrained.Base.html#genHint"><span class="hs-identifier hs-type">genHint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679171801"><span class="annot"><a href="#local-6989586621679171801"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679171800"><span class="annot"><a href="#local-6989586621679171800"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasGenHint"><span class="hs-identifier hs-type">HasGenHint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171801"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171800"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Hint"><span class="hs-identifier hs-type">Hint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171800"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171801"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171800"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171801"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-3552"></span><span id="genHint"><span class="annot"><span class="annottext">genHint :: forall (fn :: [*] -&gt; * -&gt; *) a.
HasGenHint fn a =&gt;
Hint a -&gt; Term fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#genHint"><span class="hs-identifier hs-var hs-var">genHint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasGenHint fn a =&gt;
Hint a -&gt; Term fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#GenHint"><span class="hs-identifier hs-var">GenHint</span></a></span><span>
</span><span id="line-3553"></span><span>
</span><span id="line-3554"></span><span class="hs-comment">-- Internals --------------------------------------------------------------</span><span>
</span><span id="line-3555"></span><span>
</span><span id="line-3556"></span><span id="local-6989586621679183451"><span id="local-6989586621679183452"><span id="local-6989586621679183453"><span class="annot"><a href="Constrained.Base.html#app"><span class="hs-identifier hs-type">app</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-3557"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183453"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183452"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-3558"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183451"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-3559"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.List.html#TypeList"><span class="hs-identifier hs-type">TypeList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183451"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-3560"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.List.html#All"><span class="hs-identifier hs-type">All</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183453"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679183451"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-3561"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-3562"></span><span>  </span><span class="annot"><a href="#local-6989586621679183453"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183451"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183452"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3563"></span><span>  </span><span class="annot"><a href="Constrained.List.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.List.html#MapList"><span class="hs-identifier hs-type">MapList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183453"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679183451"><span class="hs-keyword hs-type">as</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183453"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183452"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-3564"></span><span id="app"><span class="annot"><span class="annottext">app :: forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var hs-var">app</span></a></span></span><span> </span><span id="local-6989586621679171786"><span class="annot"><span class="annottext">fn as b
</span><a href="#local-6989586621679171786"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (ts :: [*]) (f :: * -&gt; *) r.
TypeList ts =&gt;
(List f ts -&gt; r) -&gt; FunTy (MapList f ts) r
</span><a href="Constrained.List.html#curryList"><span class="hs-identifier hs-var">curryList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (a :: [*]) (fn :: [*] -&gt; * -&gt; *) b.
(Typeable a, TypeList a, All (HasSpec fn) a, HasSpec fn b,
 BaseUniverse fn) =&gt;
fn a b -&gt; List (Term fn) a -&gt; Term fn b
</span><a href="Constrained.Base.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="annot"><span class="annottext">fn as b
</span><a href="#local-6989586621679171786"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3565"></span><span>
</span><span id="line-3566"></span><span id="local-6989586621679182085"><span id="local-6989586621679182086"><span id="local-6989586621679182087"><span class="annot"><a href="Constrained.Base.html#bind"><span class="hs-identifier hs-type">bind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182087"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182086"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#IsPred"><span class="hs-identifier hs-type">IsPred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182085"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182087"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182087"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182086"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679182085"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182087"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182086"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-3567"></span><span id="bind"><span class="annot"><span class="annottext">bind :: forall (fn :: [*] -&gt; * -&gt; *) a p.
(HasSpec fn a, IsPred p fn) =&gt;
(Term fn a -&gt; p) -&gt; Binder fn a
</span><a href="Constrained.Base.html#bind"><span class="hs-identifier hs-var hs-var">bind</span></a></span></span><span> </span><span id="local-6989586621679171777"><span class="annot"><span class="annottext">Term fn a -&gt; p
</span><a href="#local-6989586621679171777"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679171776"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679171775"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-3568"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3569"></span><span>    </span><span id="local-6989586621679171775"><span class="annot"><span class="annottext">p :: Pred fn
</span><a href="#local-6989586621679171775"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
p -&gt; Pred fn
</span><a href="Constrained.Base.html#toPred"><span class="hs-identifier hs-var">toPred</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a -&gt; p
</span><a href="#local-6989586621679171777"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. HasSpec fn a =&gt; Var a -&gt; Term fn a
</span><a href="Constrained.Base.html#V"><span class="hs-identifier hs-var">V</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679171776"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3570"></span><span>    </span><span id="local-6989586621679171776"><span class="annot"><span class="annottext">x :: Var a
</span><a href="#local-6989586621679171776"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; Var a
</span><a href="Constrained.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {fn :: [*] -&gt; * -&gt; *}. Pred fn -&gt; Int
</span><a href="#local-6989586621679171774"><span class="hs-identifier hs-var">nextVar</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679171775"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3571"></span><span>
</span><span id="line-3572"></span><span>    </span><span id="local-6989586621679171774"><span class="annot"><span class="annottext">nextVar :: Pred fn -&gt; Int
</span><a href="#local-6989586621679171774"><span class="hs-identifier hs-var hs-var">nextVar</span></a></span></span><span> </span><span id="local-6989586621679171771"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679171771"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">forall {fn :: [*] -&gt; * -&gt; *}. Pred fn -&gt; Int
</span><a href="#local-6989586621679171770"><span class="hs-identifier hs-var">bound</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679171771"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-3573"></span><span>
</span><span id="line-3574"></span><span>    </span><span id="local-6989586621679181583"><span id="local-6989586621679181584"><span class="annot"><a href="#local-6989586621679171769"><span class="hs-identifier hs-type">boundBinder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181584"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181583"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span></span></span><span>
</span><span id="line-3575"></span><span>    </span><span id="local-6989586621679171769"><span class="annot"><span class="annottext">boundBinder :: forall (fn :: [*] -&gt; * -&gt; *) a. Binder fn a -&gt; Int
</span><a href="#local-6989586621679171769"><span class="hs-identifier hs-var hs-var">boundBinder</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679171766"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679171766"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679171765"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679171765"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">max</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Var a -&gt; Int
</span><a href="Constrained.Core.html#nameOf"><span class="hs-identifier hs-var">nameOf</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679171766"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {fn :: [*] -&gt; * -&gt; *}. Pred fn -&gt; Int
</span><a href="#local-6989586621679171770"><span class="hs-identifier hs-var">bound</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679171765"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3576"></span><span>
</span><span id="line-3577"></span><span>    </span><span id="local-6989586621679171770"><span class="annot"><span class="annottext">bound :: Pred fn -&gt; Int
</span><a href="#local-6989586621679171770"><span class="hs-identifier hs-var hs-var">bound</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679171757"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679171757"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pred fn -&gt; Int
</span><a href="#local-6989586621679171770"><span class="hs-identifier hs-var">bound</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679171757"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-3578"></span><span>    </span><span class="annot"><a href="#local-6989586621679171770"><span class="hs-identifier hs-var">bound</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span id="local-6989586621679171756"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679171756"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maximum</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn -&gt; Int
</span><a href="#local-6989586621679171770"><span class="hs-identifier hs-var">bound</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679171756"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-3579"></span><span>    </span><span class="annot"><a href="#local-6989586621679171770"><span class="hs-identifier hs-var">bound</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Exists"><span class="hs-identifier hs-type">Exists</span></a></span><span> </span><span class="annot"><span class="annottext">(forall b. Term fn b -&gt; b) -&gt; GE a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679171755"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679171755"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Binder fn a -&gt; Int
</span><a href="#local-6989586621679171769"><span class="hs-identifier hs-var">boundBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679171755"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-3580"></span><span>    </span><span class="annot"><a href="#local-6989586621679171770"><span class="hs-identifier hs-var">bound</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679171754"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679171754"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Binder fn a -&gt; Int
</span><a href="#local-6989586621679171769"><span class="hs-identifier hs-var">boundBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679171754"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-3581"></span><span>    </span><span class="annot"><a href="#local-6989586621679171770"><span class="hs-identifier hs-var">bound</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ForAll"><span class="hs-identifier hs-type">ForAll</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn t
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679171750"><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679171750"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Binder fn a -&gt; Int
</span><a href="#local-6989586621679171769"><span class="hs-identifier hs-var">boundBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><a href="#local-6989586621679171750"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-3582"></span><span>    </span><span class="annot"><a href="#local-6989586621679171770"><span class="hs-identifier hs-var">bound</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Case"><span class="hs-identifier hs-type">Case</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679171744"><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679171744"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Max a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">getMax</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} b (f :: k -&gt; *) (as :: [k]).
Monoid b =&gt;
(forall (a :: k). f a -&gt; b) -&gt; List f as -&gt; b
</span><a href="Constrained.List.html#foldMapList"><span class="hs-identifier hs-var">foldMapList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Max a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Max</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Binder fn a -&gt; Int
</span><a href="#local-6989586621679171769"><span class="hs-identifier hs-var">boundBinder</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679171744"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-3583"></span><span>    </span><span class="annot"><a href="#local-6989586621679171770"><span class="hs-identifier hs-var">bound</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Reify"><span class="hs-identifier hs-type">Reify</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679171740"><span class="annot"><span class="annottext">Binder fn b
</span><a href="#local-6989586621679171740"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Binder fn a -&gt; Int
</span><a href="#local-6989586621679171769"><span class="hs-identifier hs-var">boundBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn b
</span><a href="#local-6989586621679171740"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-3584"></span><span>    </span><span class="annot"><a href="#local-6989586621679171770"><span class="hs-identifier hs-var">bound</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#GenHint"><span class="hs-identifier hs-type">GenHint</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-3585"></span><span>    </span><span class="annot"><a href="#local-6989586621679171770"><span class="hs-identifier hs-var">bound</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#Assert"><span class="hs-identifier hs-type">Assert</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-3586"></span><span>    </span><span class="annot"><a href="#local-6989586621679171770"><span class="hs-identifier hs-var">bound</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#DependsOn"><span class="hs-identifier hs-type">DependsOn</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-3587"></span><span>    </span><span class="annot"><a href="#local-6989586621679171770"><span class="hs-identifier hs-var">bound</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-3588"></span><span>    </span><span class="annot"><a href="#local-6989586621679171770"><span class="hs-identifier hs-var">bound</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-type">FalsePred</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-3589"></span><span>
</span><span id="line-3590"></span><span id="local-6989586621679171727"><span id="local-6989586621679171728"><span id="local-6989586621679171729"><span class="annot"><a href="Constrained.Base.html#mkReify"><span class="hs-identifier hs-type">mkReify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171729"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171728"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171729"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171727"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171729"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171728"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679171728"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679171727"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171729"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171727"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171729"><span class="hs-identifier hs-type">fn</span></a></span></span></span></span><span>
</span><span id="line-3591"></span><span id="mkReify"><span class="annot"><span class="annottext">mkReify :: forall (fn :: [*] -&gt; * -&gt; *) a a.
(HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; (a -&gt; a) -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#mkReify"><span class="hs-identifier hs-var hs-var">mkReify</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679171721"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679171721"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679171720"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679171720"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679171719"><span class="annot"><span class="annottext">Binder fn b
</span><a href="#local-6989586621679171719"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). a -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#unBind"><span class="hs-identifier hs-var">unBind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679171720"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679171721"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Binder fn b
</span><a href="#local-6989586621679171719"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-3592"></span><span class="annot"><a href="Constrained.Base.html#mkReify"><span class="hs-identifier hs-var">mkReify</span></a></span><span> </span><span id="local-6989586621679171718"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679171718"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679171717"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679171717"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679171716"><span class="annot"><span class="annottext">Binder fn b
</span><a href="#local-6989586621679171716"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a a.
(HasSpec fn a, HasSpec fn a) =&gt;
Term fn a -&gt; (a -&gt; a) -&gt; Binder fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#Reify"><span class="hs-identifier hs-var">Reify</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679171718"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679171717"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn b
</span><a href="#local-6989586621679171716"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-3593"></span><span>
</span><span id="line-3594"></span><span id="local-6989586621679171714"><span id="local-6989586621679171715"><span class="annot"><a href="Constrained.Base.html#mkCase"><span class="hs-identifier hs-type">mkCase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171715"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#SumOver"><span class="hs-identifier hs-type">SumOver</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171714"><span class="hs-keyword hs-type">as</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171715"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#SumOver"><span class="hs-identifier hs-type">SumOver</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171714"><span class="hs-keyword hs-type">as</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.List.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171715"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679171714"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171715"><span class="hs-identifier hs-type">fn</span></a></span></span></span><span>
</span><span id="line-3595"></span><span id="mkCase"><span class="annot"><span class="annottext">mkCase :: forall (fn :: [*] -&gt; * -&gt; *) (a :: [*]).
HasSpec fn (SumOver a) =&gt;
Term fn (SumOver a) -&gt; List (Binder fn) a -&gt; Pred fn
</span><a href="Constrained.Base.html#mkCase"><span class="hs-identifier hs-var hs-var">mkCase</span></a></span></span><span> </span><span id="local-6989586621679171707"><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679171707"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span id="local-6989586621679171706"><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679171706"><span class="hs-identifier hs-var">cs</span></a></span></span><span>
</span><span id="line-3596"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679171702"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679171702"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679171701"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679171701"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679171706"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Term fn a -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#Subst"><span class="hs-identifier hs-var">Subst</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679171702"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679171707"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679171701"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-3597"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">All -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">getAll</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} b (f :: k -&gt; *) (as :: [k]).
Monoid b =&gt;
(forall (a :: k). f a -&gt; b) -&gt; List f as -&gt; b
</span><a href="Constrained.List.html#foldMapList"><span class="hs-identifier hs-var">foldMapList</span></a></span><span> </span><span class="annot"><span class="annottext">forall {fn :: [*] -&gt; * -&gt; *} {a}. Binder fn a -&gt; All
</span><a href="#local-6989586621679171697"><span class="hs-identifier hs-var">isTrueBinder</span></a></span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679171706"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span>
</span><span id="line-3598"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">All -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">getAll</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} b (f :: k -&gt; *) (as :: [k]).
Monoid b =&gt;
(forall (a :: k). f a -&gt; b) -&gt; List f as -&gt; b
</span><a href="Constrained.List.html#foldMapList"><span class="hs-identifier hs-var">foldMapList</span></a></span><span> </span><span class="annot"><span class="annottext">forall {fn :: [*] -&gt; * -&gt; *} {a}. Binder fn a -&gt; All
</span><a href="#local-6989586621679171696"><span class="hs-identifier hs-var">isFalseBinder</span></a></span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679171706"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). [String] -&gt; Pred fn
</span><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-var">FalsePred</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mkCase on all False&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-3599"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679171694"><span class="annot"><span class="annottext">SumOver as
</span><a href="#local-6989586621679171694"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679171707"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (as :: [*]) (fn :: [*] -&gt; * -&gt; *) r.
SumOver as
-&gt; List (Binder fn) as
-&gt; (forall a. HasSpec fn a =&gt; Var a -&gt; a -&gt; Pred fn -&gt; r)
-&gt; r
</span><a href="Constrained.Base.html#runCaseOn"><span class="hs-identifier hs-var">runCaseOn</span></a></span><span> </span><span class="annot"><span class="annottext">SumOver as
</span><a href="#local-6989586621679171694"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679171706"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679171687"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679171687"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679171686"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679171686"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621679171685"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679171685"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
Env -&gt; Pred fn -&gt; Pred fn
</span><a href="Constrained.Base.html#substPred"><span class="hs-identifier hs-var">substPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Typeable a, Show a) =&gt; Var a -&gt; a -&gt; Env
</span><a href="Constrained.Env.html#singletonEnv"><span class="hs-identifier hs-var">singletonEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679171687"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679171686"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679171685"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3600"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (a :: [*]).
HasSpec fn (SumOver a) =&gt;
Term fn (SumOver a) -&gt; List (Binder fn) a -&gt; Pred fn
</span><a href="Constrained.Base.html#Case"><span class="hs-identifier hs-var">Case</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679171707"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679171706"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-3601"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3602"></span><span>    </span><span id="local-6989586621679171697"><span class="annot"><span class="annottext">isTrueBinder :: Binder fn a -&gt; All
</span><a href="#local-6989586621679171697"><span class="hs-identifier hs-var hs-var">isTrueBinder</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; All
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Semigroup.All</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-3603"></span><span>    </span><span class="annot"><a href="#local-6989586621679171697"><span class="hs-identifier hs-var">isTrueBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; All
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Semigroup.All</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-3604"></span><span>
</span><span id="line-3605"></span><span>    </span><span id="local-6989586621679171696"><span class="annot"><span class="annottext">isFalseBinder :: Binder fn a -&gt; All
</span><a href="#local-6989586621679171696"><span class="hs-identifier hs-var hs-var">isFalseBinder</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span class="annot"><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-type">FalsePred</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; All
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Semigroup.All</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-3606"></span><span>    </span><span class="annot"><a href="#local-6989586621679171696"><span class="hs-identifier hs-var">isFalseBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; All
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Semigroup.All</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-3607"></span><span>
</span><span id="line-3608"></span><span class="hs-comment">-- Liberal syntax for what is a predicate ---------------------------------</span><span>
</span><span id="line-3609"></span><span>
</span><span id="line-3610"></span><span class="hs-keyword">type</span><span> </span><span id="IsPred"><span class="annot"><a href="Constrained.Base.html#IsPred"><span class="hs-identifier hs-var">IsPred</span></a></span></span><span> </span><span id="local-6989586621679171681"><span class="annot"><a href="#local-6989586621679171681"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span id="local-6989586621679171680"><span class="annot"><a href="#local-6989586621679171680"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#PredLike"><span class="hs-identifier hs-type">PredLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171681"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#UnivConstr"><span class="hs-identifier hs-type">UnivConstr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171681"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171680"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3611"></span><span>
</span><span id="line-3612"></span><span class="hs-keyword">class</span><span> </span><span id="PredLike"><span class="annot"><a href="Constrained.Base.html#PredLike"><span class="hs-identifier hs-var">PredLike</span></a></span></span><span> </span><span id="local-6989586621679181627"><span class="annot"><a href="#local-6989586621679181627"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3613"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="UnivConstr"><span class="annot"><a href="Constrained.Base.html#UnivConstr"><span class="hs-identifier hs-var">UnivConstr</span></a></span></span><span> </span><span id="local-6989586621679181627"><span class="annot"><a href="#local-6989586621679181627"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679171679"><span class="annot"><a href="#local-6989586621679171679"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Constraint</span></a></span><span>
</span><span id="line-3614"></span><span>  </span><span id="toPredExplain"><span class="annot"><a href="Constrained.Base.html#toPredExplain"><span class="hs-identifier hs-type">toPredExplain</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679181626"><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181626"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#UnivConstr"><span class="hs-identifier hs-type">UnivConstr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181627"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181626"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679181627"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181626"><span class="hs-identifier hs-type">fn</span></a></span></span><span>
</span><span id="line-3615"></span><span>
</span><span id="line-3616"></span><span id="local-6989586621679171677"><span id="local-6989586621679171678"><span class="annot"><a href="Constrained.Base.html#toPred"><span class="hs-identifier hs-type">toPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171678"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#IsPred"><span class="hs-identifier hs-type">IsPred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171677"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171678"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679171677"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171678"><span class="hs-identifier hs-type">fn</span></a></span></span></span><span>
</span><span id="line-3617"></span><span id="toPred"><span class="annot"><span class="annottext">toPred :: forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
p -&gt; Pred fn
</span><a href="Constrained.Base.html#toPred"><span class="hs-identifier hs-var hs-var">toPred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall p (fn :: [*] -&gt; * -&gt; *).
(PredLike p, BaseUniverse fn, UnivConstr p fn) =&gt;
[String] -&gt; p -&gt; Pred fn
</span><a href="Constrained.Base.html#toPredExplain"><span class="hs-identifier hs-var">toPredExplain</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-3618"></span><span>
</span><span id="line-3619"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182892"><span class="annot"><a href="Constrained.Base.html#PredLike"><span class="hs-identifier hs-type">PredLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182892"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3620"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="UnivConstr"><span class="annot"><a href="Constrained.Base.html#UnivConstr"><span class="hs-identifier hs-var">UnivConstr</span></a></span></span><span> </span><span id="local-6989586621679171667"><span id="local-6989586621679182892"><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182892"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679171667"><span class="hs-identifier hs-type">fn'</span></a></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679182892"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171667"><span class="hs-identifier hs-type">fn'</span></a></span><span>
</span><span id="line-3621"></span><span>  </span><span id="local-6989586621679171661"><span class="annot"><span class="annottext">toPredExplain :: forall (fn :: [*] -&gt; * -&gt; *).
(BaseUniverse fn, UnivConstr (Pred fn) fn) =&gt;
[String] -&gt; Pred fn -&gt; Pred fn
</span><a href="#local-6989586621679171661"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPredExplain</span></a></span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-3622"></span><span>
</span><span id="line-3623"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679182018"><span class="annot"><a href="Constrained.Base.html#PredLike"><span class="hs-identifier hs-type">PredLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182018"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#PredLike"><span class="hs-identifier hs-type">PredLike</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182018"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">]</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3624"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="UnivConstr"><span class="annot"><a href="Constrained.Base.html#UnivConstr"><span class="hs-identifier hs-var">UnivConstr</span></a></span></span><span> </span><span id="local-6989586621679171658"><span id="local-6989586621679182018"><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679182018"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679171658"><span class="hs-identifier hs-type">fn</span></a></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Base.html#UnivConstr"><span class="hs-identifier hs-type">UnivConstr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182018"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171658"><span class="hs-identifier hs-type">fn</span></a></span><span>
</span><span id="line-3625"></span><span>  </span><span id="local-6989586621679171649"><span class="annot"><span class="annottext">toPredExplain :: forall (fn :: [*] -&gt; * -&gt; *).
(BaseUniverse fn, UnivConstr [p] fn) =&gt;
[String] -&gt; [p] -&gt; Pred fn
</span><a href="#local-6989586621679171649"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPredExplain</span></a></span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
p -&gt; Pred fn
</span><a href="Constrained.Base.html#toPred"><span class="hs-identifier hs-var">toPred</span></a></span><span>
</span><span id="line-3626"></span><span>
</span><span id="line-3627"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Constrained.Base.html#PredLike"><span class="hs-identifier hs-type">PredLike</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3628"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="UnivConstr"><span class="annot"><a href="Constrained.Base.html#UnivConstr"><span class="hs-identifier hs-var">UnivConstr</span></a></span></span><span> </span><span id="local-6989586621679171647"><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171647"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3629"></span><span>  </span><span id="local-6989586621679171644"><span class="annot"><span class="annottext">toPredExplain :: forall (fn :: [*] -&gt; * -&gt; *).
(BaseUniverse fn, UnivConstr Bool fn) =&gt;
[String] -&gt; Bool -&gt; Pred fn
</span><a href="#local-6989586621679171644"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPredExplain</span></a></span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span>
</span><span id="line-3630"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#toPredExplain"><span class="hs-identifier hs-var">toPredExplain</span></a></span><span> </span><span id="local-6989586621679171643"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679171643"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *). [String] -&gt; Pred fn
</span><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-var">FalsePred</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679171643"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-3631"></span><span>
</span><span id="line-3632"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679183085"><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183085"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#PredLike"><span class="hs-identifier hs-type">PredLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183085"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3633"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="UnivConstr"><span class="annot"><a href="Constrained.Base.html#UnivConstr"><span class="hs-identifier hs-var">UnivConstr</span></a></span></span><span> </span><span id="local-6989586621679171640"><span id="local-6989586621679183085"><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183085"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679171640"><span class="hs-identifier hs-type">fn'</span></a></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679183085"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171640"><span class="hs-identifier hs-type">fn'</span></a></span><span>
</span><span id="line-3634"></span><span>  </span><span id="local-6989586621679171633"><span class="annot"><span class="annottext">toPredExplain :: forall (fn :: [*] -&gt; * -&gt; *).
(BaseUniverse fn, UnivConstr (Term fn Bool) fn) =&gt;
[String] -&gt; Term fn Bool -&gt; Pred fn
</span><a href="#local-6989586621679171633"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPredExplain</span></a></span></span><span> </span><span id="local-6989586621679171632"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679171632"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679171626"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679171626"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall p (fn :: [*] -&gt; * -&gt; *).
(PredLike p, BaseUniverse fn, UnivConstr p fn) =&gt;
[String] -&gt; p -&gt; Pred fn
</span><a href="Constrained.Base.html#toPredExplain"><span class="hs-identifier hs-var">toPredExplain</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679171632"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679171626"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-3635"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#toPredExplain"><span class="hs-identifier hs-var">toPredExplain</span></a></span><span> </span><span id="local-6989586621679171625"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679171625"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679171624"><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679171624"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *).
BaseUniverse fn =&gt;
[String] -&gt; Term fn Bool -&gt; Pred fn
</span><a href="Constrained.Base.html#Assert"><span class="hs-identifier hs-var">Assert</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679171625"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679171624"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-3636"></span><span>
</span><span id="line-3637"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-3638"></span><span class="hs-comment">-- Pretty printing</span><span>
</span><span id="line-3639"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-3640"></span><span>
</span><span id="line-3641"></span><span class="hs-keyword">data</span><span> </span><span id="WithPrec"><span class="annot"><a href="Constrained.Base.html#WithPrec"><span class="hs-identifier hs-var">WithPrec</span></a></span></span><span> </span><span id="local-6989586621679181535"><span class="annot"><a href="#local-6989586621679181535"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="WithPrec"><span class="annot"><a href="Constrained.Base.html#WithPrec"><span class="hs-identifier hs-var">WithPrec</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181535"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-3642"></span><span>
</span><span id="line-3643"></span><span id="local-6989586621679181541"><span class="annot"><a href="Constrained.Base.html#parensIf"><span class="hs-identifier hs-type">parensIf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181541"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181541"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-3644"></span><span id="parensIf"><span class="annot"><span class="annottext">parensIf :: forall ann. Bool -&gt; Doc ann -&gt; Doc ann
</span><a href="Constrained.Base.html#parensIf"><span class="hs-identifier hs-var hs-var">parensIf</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">parens</span></a></span><span>
</span><span id="line-3645"></span><span class="annot"><a href="Constrained.Base.html#parensIf"><span class="hs-identifier hs-var">parensIf</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-3646"></span><span>
</span><span id="line-3647"></span><span id="local-6989586621679181538"><span id="local-6989586621679181539"><span class="annot"><a href="Constrained.Base.html#prettyPrec"><span class="hs-identifier hs-type">prettyPrec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#WithPrec"><span class="hs-identifier hs-type">WithPrec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181539"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679181539"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181538"><span class="hs-identifier hs-type">ann</span></a></span></span></span><span>
</span><span id="line-3648"></span><span id="prettyPrec"><span class="annot"><span class="annottext">prettyPrec :: forall a ann. Pretty (WithPrec a) =&gt; Int -&gt; a -&gt; Doc ann
</span><a href="Constrained.Base.html#prettyPrec"><span class="hs-identifier hs-var hs-var">prettyPrec</span></a></span></span><span> </span><span id="local-6989586621679171617"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679171617"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; WithPrec a
</span><a href="Constrained.Base.html#WithPrec"><span class="hs-identifier hs-var">WithPrec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679171617"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-3649"></span><span>
</span><span id="line-3650"></span><span class="annot"><a href="Constrained.Base.html#ppList"><span class="hs-identifier hs-type">ppList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679181534"><span class="annot"><a href="#local-6989586621679181534"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679181531"><span class="annot"><a href="#local-6989586621679181531"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679181533"><span class="annot"><a href="#local-6989586621679181533"><span class="hs-keyword hs-type">as</span></a></span></span><span> </span><span id="local-6989586621679181530"><span class="annot"><a href="#local-6989586621679181530"><span class="hs-identifier hs-type">ann</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.List.html#All"><span class="hs-identifier hs-type">All</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181534"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679181533"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679181532"><span class="annot"><a href="#local-6989586621679181532"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181534"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181532"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679181531"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181532"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181530"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.List.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181531"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181533"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181530"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3651"></span><span id="ppList"><span class="annot"><span class="annottext">ppList :: forall (fn :: [*] -&gt; * -&gt; *) (f :: * -&gt; *) (as :: [*]) ann.
All (HasSpec fn) as =&gt;
(forall a. HasSpec fn a =&gt; f a -&gt; Doc ann)
-&gt; List f as -&gt; [Doc ann]
</span><a href="Constrained.Base.html#ppList"><span class="hs-identifier hs-var hs-var">ppList</span></a></span></span><span> </span><span class="annot"><span class="annottext">forall a. HasSpec fn a =&gt; f a -&gt; Doc ann
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">List f as
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-3652"></span><span class="annot"><a href="Constrained.Base.html#ppList"><span class="hs-identifier hs-var">ppList</span></a></span><span> </span><span id="local-6989586621679171613"><span class="annot"><span class="annottext">forall a. HasSpec fn a =&gt; f a -&gt; Doc ann
</span><a href="#local-6989586621679171613"><span class="hs-identifier hs-var">pp</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679171606"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679171606"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679171605"><span class="annot"><span class="annottext">List f as
</span><a href="#local-6989586621679171605"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasSpec fn a =&gt; f a -&gt; Doc ann
</span><a href="#local-6989586621679171613"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679171606"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (f :: * -&gt; *) (as :: [*]) ann.
All (HasSpec fn) as =&gt;
(forall a. HasSpec fn a =&gt; f a -&gt; Doc ann)
-&gt; List f as -&gt; [Doc ann]
</span><a href="Constrained.Base.html#ppList"><span class="hs-identifier hs-var">ppList</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679181534"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. HasSpec fn a =&gt; f a -&gt; Doc ann
</span><a href="#local-6989586621679171613"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">List f as
</span><a href="#local-6989586621679171605"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-3653"></span><span>
</span><span id="line-3654"></span><span class="annot"><a href="Constrained.Base.html#ppList_"><span class="hs-identifier hs-type">ppList_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679181522"><span class="annot"><a href="#local-6989586621679181522"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679181519"><span class="annot"><a href="#local-6989586621679181519"><span class="hs-keyword hs-type">as</span></a></span></span><span> </span><span id="local-6989586621679181520"><span class="annot"><a href="#local-6989586621679181520"><span class="hs-identifier hs-type">ann</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679181521"><span class="annot"><a href="#local-6989586621679181521"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679181522"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181521"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181520"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.List.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181522"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181519"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181520"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3655"></span><span id="ppList_"><span class="annot"><span class="annottext">ppList_ :: forall (f :: * -&gt; *) (as :: [*]) ann.
(forall a. f a -&gt; Doc ann) -&gt; List f as -&gt; [Doc ann]
</span><a href="Constrained.Base.html#ppList_"><span class="hs-identifier hs-var hs-var">ppList_</span></a></span></span><span> </span><span class="annot"><span class="annottext">forall a. f a -&gt; Doc ann
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">List f as
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-3656"></span><span class="annot"><a href="Constrained.Base.html#ppList_"><span class="hs-identifier hs-var">ppList_</span></a></span><span> </span><span id="local-6989586621679171600"><span class="annot"><span class="annottext">forall a. f a -&gt; Doc ann
</span><a href="#local-6989586621679171600"><span class="hs-identifier hs-var">pp</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679171598"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679171598"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679171597"><span class="annot"><span class="annottext">List f as
</span><a href="#local-6989586621679171597"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. f a -&gt; Doc ann
</span><a href="#local-6989586621679171600"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679171598"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) (as :: [*]) ann.
(forall a. f a -&gt; Doc ann) -&gt; List f as -&gt; [Doc ann]
</span><a href="Constrained.Base.html#ppList_"><span class="hs-identifier hs-var">ppList_</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. f a -&gt; Doc ann
</span><a href="#local-6989586621679171600"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">List f as
</span><a href="#local-6989586621679171597"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-3657"></span><span>
</span><span id="line-3658"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679171594"><span id="local-6989586621679181511"><span id="local-6989586621679181512"><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181512"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181511"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#WithPrec"><span class="hs-identifier hs-type">WithPrec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181512"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181511"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3659"></span><span>  </span><span id="local-6989586621679171592"><span class="annot"><span class="annottext">pretty :: forall ann. WithPrec (Term fn a) -&gt; Doc ann
</span><a href="#local-6989586621679171592"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#WithPrec"><span class="hs-identifier hs-type">WithPrec</span></a></span><span> </span><span id="local-6989586621679171591"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679171591"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679171590"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679171590"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679171590"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3660"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679171584"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679171584"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. IsString a =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromString</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">showsPrec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679171591"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679171584"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-3661"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span id="local-6989586621679171580"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679171580"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a ann. Show a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">viaShow</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679171580"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-3662"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span id="local-6989586621679171573"><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679171573"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="Constrained.List.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a ann. Show a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">viaShow</span></a></span><span> </span><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679171573"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-3663"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span id="local-6989586621679171560"><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679171560"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679171559"><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679171559"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall ann. Bool -&gt; Doc ann -&gt; Doc ann
</span><a href="Constrained.Base.html#parensIf"><span class="hs-identifier hs-var">parensIf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679171591"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Show a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">viaShow</span></a></span><span> </span><span class="annot"><span class="annottext">fn as a
</span><a href="#local-6989586621679171560"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. [Doc ann] -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">fillSep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (f :: * -&gt; *) (as :: [*]) ann.
All (HasSpec fn) as =&gt;
(forall a. HasSpec fn a =&gt; f a -&gt; Doc ann)
-&gt; List f as -&gt; [Doc ann]
</span><a href="Constrained.Base.html#ppList"><span class="hs-identifier hs-var">ppList</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679181512"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a ann. Pretty (WithPrec a) =&gt; Int -&gt; a -&gt; Doc ann
</span><a href="Constrained.Base.html#prettyPrec"><span class="hs-identifier hs-var">prettyPrec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List (Term fn) as
</span><a href="#local-6989586621679171559"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3664"></span><span>
</span><span id="line-3665"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679171552"><span id="local-6989586621679182598"><span id="local-6989586621679182599"><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182599"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182598"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182599"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182598"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3666"></span><span>  </span><span id="local-6989586621679171549"><span class="annot"><span class="annottext">pretty :: forall ann. Term fn a -&gt; Doc ann
</span><a href="#local-6989586621679171549"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty (WithPrec a) =&gt; Int -&gt; a -&gt; Doc ann
</span><a href="Constrained.Base.html#prettyPrec"><span class="hs-identifier hs-var">prettyPrec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-3667"></span><span>
</span><span id="line-3668"></span><span id="local-6989586621679171548"><span class="annot"><a href="Constrained.Base.html#vsep%27"><span class="hs-identifier hs-type">vsep'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171548"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171548"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-3669"></span><span id="vsep%27"><span class="annot"><span class="annottext">vsep' :: forall ann. [Doc ann] -&gt; Doc ann
</span><a href="Constrained.Base.html#vsep%27"><span class="hs-identifier hs-var hs-var">vsep'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; [Doc ann] -&gt; [Doc ann]
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">punctuate</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">hardline</span></a></span><span>
</span><span id="line-3670"></span><span>
</span><span id="line-3671"></span><span id="local-6989586621679171541"><span class="annot"><a href="Constrained.Base.html#%2F%3E"><span class="hs-operator hs-type">(/&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171541"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171541"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171541"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-3672"></span><span id="local-6989586621679171539"><span class="annot"><span class="annottext">Doc ann
</span><a href="#local-6989586621679171539"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="%2F%3E"><span class="annot"><span class="annottext">/&gt; :: forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="Constrained.Base.html#%2F%3E"><span class="hs-operator hs-var hs-var">/&gt;</span></a></span></span><span> </span><span id="local-6989586621679171538"><span class="annot"><span class="annottext">Doc ann
</span><a href="#local-6989586621679171538"><span class="hs-identifier hs-var">cont</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall ann. Int -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. [Doc ann] -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Doc ann
</span><a href="#local-6989586621679171539"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><a href="#local-6989586621679171538"><span class="hs-identifier hs-var">cont</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3673"></span><span>
</span><span id="line-3674"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">5</span><span> </span><span class="annot"><a href="Constrained.Base.html#%2F%3E"><span class="hs-operator hs-type">/&gt;</span></a></span><span>
</span><span id="line-3675"></span><span>
</span><span id="line-3676"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679171533"><span id="local-6989586621679181497"><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181497"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3677"></span><span>  </span><span id="local-6989586621679171529"><span class="annot"><span class="annottext">pretty :: forall ann. Pred fn -&gt; Doc ann
</span><a href="#local-6989586621679171529"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-3678"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Exists"><span class="hs-identifier hs-type">Exists</span></a></span><span> </span><span class="annot"><span class="annottext">(forall b. Term fn b -&gt; b) -&gt; GE a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679171523"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679171523"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679171522"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679171522"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. [Doc ann] -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;exists&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Show a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">viaShow</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679171523"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;in&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679171522"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3679"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span id="local-6989586621679171521"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679171521"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679171513"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679171513"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679171512"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679171512"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. [Doc ann] -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;let&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Show a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">viaShow</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679171513"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="Constrained.Base.html#%2F%3E"><span class="hs-operator hs-var">/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679171521"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;in&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679171512"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3680"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span id="local-6989586621679171511"><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679171511"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">braces</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. [Doc ann] -&gt; Doc ann
</span><a href="Constrained.Base.html#vsep%27"><span class="hs-identifier hs-var">vsep'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">[Pred fn]
</span><a href="#local-6989586621679171511"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-3681"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Assert"><span class="hs-identifier hs-type">Assert</span></a></span><span> </span><span id="local-6989586621679171505"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679171505"><span class="hs-identifier hs-var">_err</span></a></span></span><span> </span><span id="local-6989586621679171504"><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679171504"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;assert $&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn Bool
</span><a href="#local-6989586621679171504"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-3682"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Reify"><span class="hs-identifier hs-type">Reify</span></a></span><span> </span><span id="local-6989586621679171496"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679171496"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679171495"><span class="annot"><span class="annottext">Binder fn b
</span><a href="#local-6989586621679171495"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;reify&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; WithPrec a
</span><a href="Constrained.Base.html#WithPrec"><span class="hs-identifier hs-var">WithPrec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679171496"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;$ \\&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Binder fn b
</span><a href="#local-6989586621679171495"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-3683"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#DependsOn"><span class="hs-identifier hs-type">DependsOn</span></a></span><span> </span><span id="local-6989586621679171489"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679171489"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679171488"><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679171488"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679171489"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="Constrained.Base.html#%2F%3E"><span class="hs-operator hs-var">/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn b
</span><a href="#local-6989586621679171488"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-3684"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#ForAll"><span class="hs-identifier hs-type">ForAll</span></a></span><span> </span><span id="local-6989586621679171484"><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679171484"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679171476"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679171476"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679171475"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679171475"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;forall&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Show a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">viaShow</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679171476"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;in&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn t
</span><a href="#local-6989586621679171484"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;$&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="Constrained.Base.html#%2F%3E"><span class="hs-operator hs-var">/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679171475"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-3685"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Case"><span class="hs-identifier hs-type">Case</span></a></span><span> </span><span id="local-6989586621679171470"><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679171470"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679171469"><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679171469"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;case&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (SumOver as)
</span><a href="#local-6989586621679171470"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;of&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="Constrained.Base.html#%2F%3E"><span class="hs-operator hs-var">/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. [Doc ann] -&gt; Doc ann
</span><a href="Constrained.Base.html#vsep%27"><span class="hs-identifier hs-var">vsep'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) (as :: [*]) ann.
(forall a. f a -&gt; Doc ann) -&gt; List f as -&gt; [Doc ann]
</span><a href="Constrained.Base.html#ppList_"><span class="hs-identifier hs-var">ppList_</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">List (Binder fn) as
</span><a href="#local-6989586621679171469"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3686"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span id="local-6989586621679171454"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679171454"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679171453"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679171453"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679171452"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679171452"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679171453"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Show a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">viaShow</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679171454"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;]&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679171452"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-3687"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#GenHint"><span class="hs-identifier hs-type">GenHint</span></a></span><span> </span><span id="local-6989586621679171440"><span class="annot"><span class="annottext">Hint a
</span><a href="#local-6989586621679171440"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679171439"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679171439"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;genHint &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsString a =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">showsPrec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span> </span><span class="annot"><span class="annottext">Hint a
</span><a href="#local-6989586621679171440"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;$&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679171439"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-3688"></span><span>    </span><span class="annot"><span class="annottext">Pred fn
</span><a href="Constrained.Base.html#TruePred"><span class="hs-identifier hs-var">TruePred</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;True&quot;</span></span><span>
</span><span id="line-3689"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#FalsePred"><span class="hs-identifier hs-type">FalsePred</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;False&quot;</span></span><span>
</span><span id="line-3690"></span><span>
</span><span id="line-3691"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679171436"><span id="local-6989586621679181490"><span id="local-6989586621679181491"><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181491"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181490"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3692"></span><span>  </span><span id="local-6989586621679171435"><span class="annot"><span class="annottext">pretty :: forall ann. Binder fn a -&gt; Doc ann
</span><a href="#local-6989586621679171435"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679171430"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679171430"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679171429"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679171429"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a ann. Show a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">viaShow</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679171430"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;-&gt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679171429"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-3693"></span><span>
</span><span id="line-3694"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679171424"><span id="local-6989586621679171426"><span id="local-6989586621679183152"><span id="local-6989586621679183153"><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183153"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183152"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183153"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183152"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3695"></span><span>  </span><span id="local-6989586621679171421"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; Term fn a -&gt; ShowS
</span><a href="#local-6989586621679171421"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></a></span></span><span> </span><span id="local-6989586621679171420"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679171420"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679171419"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679171419"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; ShowS
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">shows</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; WithPrec a
</span><a href="Constrained.Base.html#WithPrec"><span class="hs-identifier hs-var">WithPrec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679171420"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679171419"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3696"></span><span>
</span><span id="line-3697"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679171413"><span id="local-6989586621679171416"><span id="local-6989586621679182988"><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Pred"><span class="hs-identifier hs-type">Pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182988"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3698"></span><span>  </span><span id="local-6989586621679171410"><span class="annot"><span class="annottext">show :: Pred fn -&gt; String
</span><a href="#local-6989586621679171410"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span>
</span><span id="line-3699"></span><span>
</span><span id="line-3700"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679171407"><span id="local-6989586621679181477"><span id="local-6989586621679181478"><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181478"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181477"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#WithPrec"><span class="hs-identifier hs-type">WithPrec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181478"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181477"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3701"></span><span>  </span><span id="local-6989586621679171399"><span class="annot"><span class="annottext">pretty :: forall ann. WithPrec (Spec fn a) -&gt; Doc ann
</span><a href="#local-6989586621679171399"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#WithPrec"><span class="hs-identifier hs-type">WithPrec</span></a></span><span> </span><span id="local-6989586621679171398"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679171398"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679171397"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679171397"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679171397"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3702"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span id="local-6989586621679171396"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679171396"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;ErrorSpec&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="Constrained.Base.html#%2F%3E"><span class="hs-operator hs-var">/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. [Doc ann] -&gt; Doc ann
</span><a href="Constrained.Base.html#vsep%27"><span class="hs-identifier hs-var">vsep'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsString a =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromString</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679171396"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3703"></span><span>    </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;TrueSpec&quot;</span></span><span>
</span><span id="line-3704"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span id="local-6989586621679171395"><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679171395"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall ann. Bool -&gt; Doc ann -&gt; Doc ann
</span><a href="Constrained.Base.html#parensIf"><span class="hs-identifier hs-var">parensIf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679171398"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;MemberSpec&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Show a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">viaShow</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679171395"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-3705"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-type">SuspendedSpec</span></a></span><span> </span><span id="local-6989586621679171387"><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679171387"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679171386"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679171386"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall ann. Bool -&gt; Doc ann -&gt; Doc ann
</span><a href="Constrained.Base.html#parensIf"><span class="hs-identifier hs-var">parensIf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679171398"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;constrained $ \\&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Show a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">viaShow</span></a></span><span> </span><span class="annot"><span class="annottext">Var a
</span><a href="#local-6989586621679171387"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;-&gt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="Constrained.Base.html#%2F%3E"><span class="hs-operator hs-var">/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679171386"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-3706"></span><span>    </span><span class="hs-comment">-- TODO: require pretty for `TypeSpec` to make this much nicer</span><span>
</span><span id="line-3707"></span><span>    </span><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-type">TypeSpec</span></a></span><span> </span><span id="local-6989586621679171375"><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679171375"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span id="local-6989586621679171374"><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679171374"><span class="hs-identifier hs-var">cant</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3708"></span><span>      </span><span class="annot"><span class="annottext">forall ann. Bool -&gt; Doc ann -&gt; Doc ann
</span><a href="Constrained.Base.html#parensIf"><span class="hs-identifier hs-var">parensIf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679171398"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-3709"></span><span>        </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;TypeSpec&quot;</span></span><span>
</span><span id="line-3710"></span><span>          </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsString a =&gt; String -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">showsPrec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679171375"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-3711"></span><span>          </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Show a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">viaShow</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSet a
</span><a href="#local-6989586621679171374"><span class="hs-identifier hs-var">cant</span></a></span><span>
</span><span id="line-3712"></span><span>
</span><span id="line-3713"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679171371"><span id="local-6989586621679183108"><span id="local-6989586621679183109"><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183109"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183108"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183109"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183108"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3714"></span><span>  </span><span id="local-6989586621679171368"><span class="annot"><span class="annottext">pretty :: forall ann. Spec fn a -&gt; Doc ann
</span><a href="#local-6989586621679171368"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; WithPrec a
</span><a href="Constrained.Base.html#WithPrec"><span class="hs-identifier hs-var">WithPrec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-3715"></span><span>
</span><span id="line-3716"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679171363"><span id="local-6989586621679171365"><span id="local-6989586621679183255"><span id="local-6989586621679183256"><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183256"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183255"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183256"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183255"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3717"></span><span>  </span><span id="local-6989586621679171360"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; Spec fn a -&gt; ShowS
</span><a href="#local-6989586621679171360"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></a></span></span><span> </span><span id="local-6989586621679171359"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679171359"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; ShowS
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">shows</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///home/runner/.local/state/cabal/store/ghc-9.2.8/prettyprinter-1.7.1-546164a61e33fff52b43324c1636e343b3360b907f873b5adf59f460acb23f60/share/doc/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; WithPrec a
</span><a href="Constrained.Base.html#WithPrec"><span class="hs-identifier hs-var">WithPrec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679171359"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-3718"></span></pre></body></html>