<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FunctionalDependencies #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ImportQualifiedPost #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Constrained.Spec.Tree</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#BinTree"><span class="hs-identifier">BinTree</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTree"><span class="hs-identifier">RoseTree</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTreeFn"><span class="hs-identifier">RoseTreeFn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Spec.Tree.html#roseRoot_"><span class="hs-identifier">roseRoot_</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Kind</span></a></span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Constrained.Base.html"><span class="hs-identifier">Constrained.Base</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Constrained.Core.html"><span class="hs-identifier">Constrained.Core</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Constrained.GenT.html"><span class="hs-identifier">Constrained.GenT</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Constrained.List.html"><span class="hs-identifier">Constrained.List</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Constrained.Spec.Generics.html"><span class="hs-identifier">Constrained.Spec.Generics</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Constrained.Spec.Pairs.html"><span class="hs-identifier">Constrained.Spec.Pairs</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Constrained.Univ.html"><span class="hs-identifier">Constrained.Univ</span></a></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- The types</span><span>
</span><span id="line-28"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">data</span><span> </span><span id="BinTree"><span class="annot"><a href="Constrained.Spec.Tree.html#BinTree"><span class="hs-identifier hs-var">BinTree</span></a></span></span><span> </span><span id="local-6989586621679188379"><span class="annot"><a href="#local-6989586621679188379"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="BinTip"><span class="annot"><a href="Constrained.Spec.Tree.html#BinTip"><span class="hs-identifier hs-var">BinTip</span></a></span></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="BinNode"><span class="annot"><a href="Constrained.Spec.Tree.html#BinNode"><span class="hs-identifier hs-var">BinNode</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#BinTree"><span class="hs-identifier hs-type">BinTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188379"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679188379"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#BinTree"><span class="hs-identifier hs-type">BinTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188379"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679187985"><span id="local-6989586621679187987"><span id="local-6989586621679187990"><span id="local-6989586621679187993"><span id="local-6989586621679187996"><span id="local-6989586621679188001"><span id="local-6989586621679188006"><span class="annot"><span class="annottext">BinTree a -&gt; BinTree a -&gt; Bool
BinTree a -&gt; BinTree a -&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {a}. Ord a =&gt; Eq (BinTree a)
forall a. Ord a =&gt; BinTree a -&gt; BinTree a -&gt; Bool
forall a. Ord a =&gt; BinTree a -&gt; BinTree a -&gt; Ordering
forall a. Ord a =&gt; BinTree a -&gt; BinTree a -&gt; BinTree a
min :: BinTree a -&gt; BinTree a -&gt; BinTree a
$cmin :: forall a. Ord a =&gt; BinTree a -&gt; BinTree a -&gt; BinTree a
max :: BinTree a -&gt; BinTree a -&gt; BinTree a
$cmax :: forall a. Ord a =&gt; BinTree a -&gt; BinTree a -&gt; BinTree a
&gt;= :: BinTree a -&gt; BinTree a -&gt; Bool
$c&gt;= :: forall a. Ord a =&gt; BinTree a -&gt; BinTree a -&gt; Bool
&gt; :: BinTree a -&gt; BinTree a -&gt; Bool
$c&gt; :: forall a. Ord a =&gt; BinTree a -&gt; BinTree a -&gt; Bool
&lt;= :: BinTree a -&gt; BinTree a -&gt; Bool
$c&lt;= :: forall a. Ord a =&gt; BinTree a -&gt; BinTree a -&gt; Bool
&lt; :: BinTree a -&gt; BinTree a -&gt; Bool
$c&lt; :: forall a. Ord a =&gt; BinTree a -&gt; BinTree a -&gt; Bool
compare :: BinTree a -&gt; BinTree a -&gt; Ordering
$ccompare :: forall a. Ord a =&gt; BinTree a -&gt; BinTree a -&gt; Ordering
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679187977"><span id="local-6989586621679187982"><span class="annot"><span class="annottext">BinTree a -&gt; BinTree a -&gt; Bool
forall a. Eq a =&gt; BinTree a -&gt; BinTree a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: BinTree a -&gt; BinTree a -&gt; Bool
$c/= :: forall a. Eq a =&gt; BinTree a -&gt; BinTree a -&gt; Bool
== :: BinTree a -&gt; BinTree a -&gt; Bool
$c== :: forall a. Eq a =&gt; BinTree a -&gt; BinTree a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679187965"><span id="local-6989586621679187967"><span id="local-6989586621679187974"><span class="annot"><span class="annottext">Int -&gt; BinTree a -&gt; ShowS
forall a. Show a =&gt; Int -&gt; BinTree a -&gt; ShowS
forall a. Show a =&gt; [BinTree a] -&gt; ShowS
forall a. Show a =&gt; BinTree a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [BinTree a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [BinTree a] -&gt; ShowS
show :: BinTree a -&gt; String
$cshow :: forall a. Show a =&gt; BinTree a -&gt; String
showsPrec :: Int -&gt; BinTree a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; BinTree a -&gt; ShowS
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">data</span><span> </span><span id="RoseTree"><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTree"><span class="hs-identifier hs-var">RoseTree</span></a></span></span><span> </span><span id="local-6989586621679188374"><span class="annot"><a href="#local-6989586621679188374"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RoseNode"><span class="annot"><a href="Constrained.Spec.Tree.html#RoseNode"><span class="hs-identifier hs-var">RoseNode</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679188374"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTree"><span class="hs-identifier hs-type">RoseTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188374"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679187937"><span id="local-6989586621679187939"><span id="local-6989586621679187942"><span id="local-6989586621679187945"><span id="local-6989586621679187948"><span id="local-6989586621679187953"><span id="local-6989586621679187959"><span class="annot"><span class="annottext">RoseTree a -&gt; RoseTree a -&gt; Bool
RoseTree a -&gt; RoseTree a -&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {a}. Ord a =&gt; Eq (RoseTree a)
forall a. Ord a =&gt; RoseTree a -&gt; RoseTree a -&gt; Bool
forall a. Ord a =&gt; RoseTree a -&gt; RoseTree a -&gt; Ordering
forall a. Ord a =&gt; RoseTree a -&gt; RoseTree a -&gt; RoseTree a
min :: RoseTree a -&gt; RoseTree a -&gt; RoseTree a
$cmin :: forall a. Ord a =&gt; RoseTree a -&gt; RoseTree a -&gt; RoseTree a
max :: RoseTree a -&gt; RoseTree a -&gt; RoseTree a
$cmax :: forall a. Ord a =&gt; RoseTree a -&gt; RoseTree a -&gt; RoseTree a
&gt;= :: RoseTree a -&gt; RoseTree a -&gt; Bool
$c&gt;= :: forall a. Ord a =&gt; RoseTree a -&gt; RoseTree a -&gt; Bool
&gt; :: RoseTree a -&gt; RoseTree a -&gt; Bool
$c&gt; :: forall a. Ord a =&gt; RoseTree a -&gt; RoseTree a -&gt; Bool
&lt;= :: RoseTree a -&gt; RoseTree a -&gt; Bool
$c&lt;= :: forall a. Ord a =&gt; RoseTree a -&gt; RoseTree a -&gt; Bool
&lt; :: RoseTree a -&gt; RoseTree a -&gt; Bool
$c&lt; :: forall a. Ord a =&gt; RoseTree a -&gt; RoseTree a -&gt; Bool
compare :: RoseTree a -&gt; RoseTree a -&gt; Ordering
$ccompare :: forall a. Ord a =&gt; RoseTree a -&gt; RoseTree a -&gt; Ordering
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679187929"><span id="local-6989586621679187935"><span class="annot"><span class="annottext">RoseTree a -&gt; RoseTree a -&gt; Bool
forall a. Eq a =&gt; RoseTree a -&gt; RoseTree a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: RoseTree a -&gt; RoseTree a -&gt; Bool
$c/= :: forall a. Eq a =&gt; RoseTree a -&gt; RoseTree a -&gt; Bool
== :: RoseTree a -&gt; RoseTree a -&gt; Bool
$c== :: forall a. Eq a =&gt; RoseTree a -&gt; RoseTree a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679187918"><span id="local-6989586621679187920"><span id="local-6989586621679187927"><span class="annot"><span class="annottext">Int -&gt; RoseTree a -&gt; ShowS
forall a. Show a =&gt; Int -&gt; RoseTree a -&gt; ShowS
forall a. Show a =&gt; [RoseTree a] -&gt; ShowS
forall a. Show a =&gt; RoseTree a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [RoseTree a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [RoseTree a] -&gt; ShowS
show :: RoseTree a -&gt; String
$cshow :: forall a. Show a =&gt; RoseTree a -&gt; String
showsPrec :: Int -&gt; RoseTree a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; RoseTree a -&gt; ShowS
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- HasSpec for BinTree</span><span>
</span><span id="line-40"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">data</span><span> </span><span id="BinTreeSpec"><span class="annot"><a href="Constrained.Spec.Tree.html#BinTreeSpec"><span class="hs-identifier hs-var">BinTreeSpec</span></a></span></span><span> </span><span id="local-6989586621679188362"><span class="annot"><a href="#local-6989586621679188362"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679188361"><span class="annot"><a href="#local-6989586621679188361"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BinTreeSpec"><span class="annot"><a href="Constrained.Spec.Tree.html#BinTreeSpec"><span class="hs-identifier hs-var">BinTreeSpec</span></a></span></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188362"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#BinTree"><span class="hs-identifier hs-type">BinTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188361"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679188361"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Spec.Tree.html#BinTree"><span class="hs-identifier hs-type">BinTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188361"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679187905"><span id="local-6989586621679187907"><span id="local-6989586621679187915"><span class="annot"><span class="annottext">Int -&gt; BinTreeSpec fn a -&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Int -&gt; BinTreeSpec fn a -&gt; ShowS
forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
[BinTreeSpec fn a] -&gt; ShowS
forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
BinTreeSpec fn a -&gt; String
showList :: [BinTreeSpec fn a] -&gt; ShowS
$cshowList :: forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
[BinTreeSpec fn a] -&gt; ShowS
show :: BinTreeSpec fn a -&gt; String
$cshow :: forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
BinTreeSpec fn a -&gt; String
showsPrec :: Int -&gt; BinTreeSpec fn a -&gt; ShowS
$cshowsPrec :: forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Int -&gt; BinTreeSpec fn a -&gt; ShowS
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679188355"><span class="annot"><a href="Constrained.Base.html#Forallable"><span class="hs-identifier hs-type">Forallable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#BinTree"><span class="hs-identifier hs-type">BinTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188355"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#BinTree"><span class="hs-identifier hs-type">BinTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188355"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679188355"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Spec.Tree.html#BinTree"><span class="hs-identifier hs-type">BinTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188355"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-46"></span><span>  </span><span id="local-6989586621679187893"><span class="annot"><span class="annottext">forAllSpec :: forall (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn (BinTree a), HasSpec fn (BinTree a, a, BinTree a),
 BaseUniverse fn) =&gt;
Spec fn (BinTree a, a, BinTree a) -&gt; Spec fn (BinTree a)
</span><a href="Constrained.Base.html#forAllSpec"><span class="hs-identifier hs-var hs-var hs-var hs-var">forAllSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Int -&gt; Spec fn (BinTree a, a, BinTree a) -&gt; BinTreeSpec fn a
</span><a href="Constrained.Spec.Tree.html#BinTreeSpec"><span class="hs-identifier hs-var">BinTreeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1000</span></span><span>
</span><span id="line-47"></span><span>  </span><span id="local-6989586621679187887"><span class="annot"><span class="annottext">forAllToList :: BinTree a -&gt; [(BinTree a, a, BinTree a)]
</span><a href="Constrained.Base.html#forAllToList"><span class="hs-identifier hs-var hs-var hs-var hs-var">forAllToList</span></a></span></span><span> </span><span class="annot"><span class="annottext">BinTree a
</span><a href="Constrained.Spec.Tree.html#BinTip"><span class="hs-identifier hs-var">BinTip</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#forAllToList"><span class="hs-identifier hs-var">forAllToList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#BinNode"><span class="hs-identifier hs-type">BinNode</span></a></span><span> </span><span id="local-6989586621679187885"><span class="annot"><span class="annottext">BinTree a
</span><a href="#local-6989586621679187885"><span class="hs-identifier hs-var">left</span></a></span></span><span> </span><span id="local-6989586621679187884"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679187884"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679187883"><span class="annot"><span class="annottext">BinTree a
</span><a href="#local-6989586621679187883"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BinTree a
</span><a href="#local-6989586621679187885"><span class="hs-identifier hs-var">left</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679187884"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BinTree a
</span><a href="#local-6989586621679187883"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">forall t e. Forallable t e =&gt; t -&gt; [e]
</span><a href="Constrained.Base.html#forAllToList"><span class="hs-identifier hs-var">forAllToList</span></a></span><span> </span><span class="annot"><span class="annottext">BinTree a
</span><a href="#local-6989586621679187885"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall t e. Forallable t e =&gt; t -&gt; [e]
</span><a href="Constrained.Base.html#forAllToList"><span class="hs-identifier hs-var">forAllToList</span></a></span><span> </span><span class="annot"><span class="annottext">BinTree a
</span><a href="#local-6989586621679187883"><span class="hs-identifier hs-var">right</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679187864"><span id="local-6989586621679188363"><span id="local-6989586621679188364"><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188364"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188363"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188364"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#BinTree"><span class="hs-identifier hs-type">BinTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188363"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="TypeSpec"><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span></span><span> </span><span id="local-6989586621679188363"><span id="local-6989586621679188364"><span class="annot"><a href="#local-6989586621679188364"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#BinTree"><span class="hs-identifier hs-type">BinTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188363"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Spec.Tree.html#BinTreeSpec"><span class="hs-identifier hs-type">BinTreeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188364"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188363"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span>  </span><span id="local-6989586621679187862"><span class="annot"><span class="annottext">emptySpec :: TypeSpec fn (BinTree a)
</span><a href="Constrained.Base.html#emptySpec"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptySpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Int -&gt; Spec fn (BinTree a, a, BinTree a) -&gt; BinTreeSpec fn a
</span><a href="Constrained.Spec.Tree.html#BinTreeSpec"><span class="hs-identifier hs-var">BinTreeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1000</span></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span>  </span><span id="local-6989586621679187854"><span class="annot"><span class="annottext">combineSpec :: TypeSpec fn (BinTree a)
-&gt; TypeSpec fn (BinTree a) -&gt; Spec fn (BinTree a)
</span><a href="Constrained.Base.html#combineSpec"><span class="hs-identifier hs-var hs-var hs-var hs-var">combineSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#BinTreeSpec"><span class="hs-identifier hs-type">BinTreeSpec</span></a></span><span> </span><span id="local-6989586621679187852"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679187852"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span id="local-6989586621679187851"><span class="annot"><span class="annottext">Spec fn (BinTree a, a, BinTree a)
</span><a href="#local-6989586621679187851"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#BinTreeSpec"><span class="hs-identifier hs-type">BinTreeSpec</span></a></span><span> </span><span id="local-6989586621679187850"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679187850"><span class="hs-identifier hs-var">sz'</span></a></span></span><span> </span><span id="local-6989586621679187849"><span class="annot"><span class="annottext">Spec fn (BinTree a, a, BinTree a)
</span><a href="#local-6989586621679187849"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Int -&gt; Spec fn (BinTree a, a, BinTree a) -&gt; BinTreeSpec fn a
</span><a href="Constrained.Spec.Tree.html#BinTreeSpec"><span class="hs-identifier hs-var">BinTreeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">min</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679187852"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679187850"><span class="hs-identifier hs-var">sz'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Spec fn (BinTree a, a, BinTree a)
</span><a href="#local-6989586621679187851"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn (BinTree a, a, BinTree a)
</span><a href="#local-6989586621679187849"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span>  </span><span id="local-6989586621679187835"><span class="annot"><span class="annottext">conformsTo :: HasCallStack =&gt; BinTree a -&gt; TypeSpec fn (BinTree a) -&gt; Bool
</span><a href="Constrained.Base.html#conformsTo"><span class="hs-identifier hs-var hs-var hs-var hs-var">conformsTo</span></a></span></span><span> </span><span class="annot"><span class="annottext">BinTree a
</span><a href="Constrained.Spec.Tree.html#BinTip"><span class="hs-identifier hs-var">BinTip</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn (BinTree a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#conformsTo"><span class="hs-identifier hs-var">conformsTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#BinNode"><span class="hs-identifier hs-type">BinNode</span></a></span><span> </span><span id="local-6989586621679187833"><span class="annot"><span class="annottext">BinTree a
</span><a href="#local-6989586621679187833"><span class="hs-identifier hs-var">left</span></a></span></span><span> </span><span id="local-6989586621679187832"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679187832"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679187831"><span class="annot"><span class="annottext">BinTree a
</span><a href="#local-6989586621679187831"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679187830"><span class="annot"><span class="annottext">s :: TypeSpec fn (BinTree a)
</span><a href="#local-6989586621679187830"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#BinTreeSpec"><span class="hs-identifier hs-type">BinTreeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679187829"><span class="annot"><span class="annottext">Spec fn (BinTree a, a, BinTree a)
</span><a href="#local-6989586621679187829"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">and</span></a></span><span>
</span><span id="line-61"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BinTree a
</span><a href="#local-6989586621679187833"><span class="hs-identifier hs-var">left</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679187832"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BinTree a
</span><a href="#local-6989586621679187831"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-operator hs-var">`conformsToSpec`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn (BinTree a, a, BinTree a)
</span><a href="#local-6989586621679187829"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-62"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BinTree a
</span><a href="#local-6989586621679187833"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn a, HasCallStack) =&gt;
a -&gt; TypeSpec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsTo"><span class="hs-operator hs-var">`conformsTo`</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn (BinTree a)
</span><a href="#local-6989586621679187830"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-63"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BinTree a
</span><a href="#local-6989586621679187831"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn a, HasCallStack) =&gt;
a -&gt; TypeSpec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsTo"><span class="hs-operator hs-var">`conformsTo`</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn (BinTree a)
</span><a href="#local-6989586621679187830"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-64"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span>  </span><span id="local-6989586621679187749"><span class="annot"><span class="annottext">genFromTypeSpec :: forall (m :: * -&gt; *).
(HasCallStack, MonadGenError m) =&gt;
TypeSpec fn (BinTree a) -&gt; GenT m (BinTree a)
</span><a href="Constrained.Base.html#genFromTypeSpec"><span class="hs-identifier hs-var hs-var hs-var hs-var">genFromTypeSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#BinTreeSpec"><span class="hs-identifier hs-type">BinTreeSpec</span></a></span><span> </span><span id="local-6989586621679187747"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679187747"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span id="local-6989586621679187746"><span class="annot"><span class="annottext">Spec fn (BinTree a, a, BinTree a)
</span><a href="#local-6989586621679187746"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679187747"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. BinTree a
</span><a href="Constrained.Spec.Tree.html#BinTip"><span class="hs-identifier hs-var">BinTip</span></a></span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-69"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679187744"><span class="annot"><span class="annottext">sz' :: Int
</span><a href="#local-6989586621679187744"><span class="hs-identifier hs-var hs-var">sz'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679187747"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-70"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadGenError m =&gt; [GenT GE a] -&gt; GenT m a
</span><a href="Constrained.GenT.html#oneofT"><span class="hs-identifier hs-var">oneofT</span></a></span><span>
</span><span id="line-71"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-72"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621679187741"><span class="annot"><span class="annottext">BinTree a
</span><a href="#local-6989586621679187741"><span class="hs-identifier hs-var">left</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679187740"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679187740"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679187739"><span class="annot"><span class="annottext">BinTree a
</span><a href="#local-6989586621679187739"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (m :: * -&gt; *).
(HasCallStack, HasSpec fn a, MonadGenError m) =&gt;
Spec fn a -&gt; GenT m a
</span><a href="Constrained.Base.html#genFromSpec"><span class="hs-identifier hs-var">genFromSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679188364"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#BinTree"><span class="hs-identifier hs-type">BinTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188363"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679188363"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Spec.Tree.html#BinTree"><span class="hs-identifier hs-type">BinTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188363"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-73"></span><span>                </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) p.
(IsPred p fn, HasSpec fn a) =&gt;
(Term fn a -&gt; p) -&gt; Spec fn a
</span><a href="Constrained.Base.html#constrained"><span class="hs-identifier hs-var">constrained</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679187736"><span class="annot"><span class="annottext">Term fn (BinTree a, a, BinTree a)
</span><a href="#local-6989586621679187736"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-74"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) p a.
(HasSpec fn a, HasSpec fn (SimpleRep a), HasSimpleRep a,
 Cases (SimpleRep a) ~ '[SimpleRep a],
 SimpleRep a ~ SumOver (Cases (SimpleRep a)),
 TypeSpec fn a ~ TypeSpec fn (SimpleRep a), IsProd (SimpleRep a),
 All (HasSpec fn) (Args (SimpleRep a)), IsPred p fn) =&gt;
Term fn a
-&gt; FunTy (MapList (Term fn) (Args (SimpleRep a))) p -&gt; Pred fn
</span><a href="Constrained.Spec.Generics.html#match"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (BinTree a, a, BinTree a)
</span><a href="#local-6989586621679187736"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679187734"><span class="annot"><span class="annottext">Term fn (BinTree a)
</span><a href="#local-6989586621679187734"><span class="hs-identifier hs-var">left</span></a></span></span><span> </span><span class="annot"><span class="annottext">Term fn a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679187733"><span class="annot"><span class="annottext">Term fn (BinTree a)
</span><a href="#local-6989586621679187733"><span class="hs-identifier hs-var">right</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-75"></span><span>                      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall t a (fn :: [*] -&gt; * -&gt; *) p.
(Forallable t a, HasSpec fn t, HasSpec fn a, IsPred p fn) =&gt;
Term fn t -&gt; (Term fn a -&gt; p) -&gt; Pred fn
</span><a href="Constrained.Base.html#forAll"><span class="hs-identifier hs-var">forAll</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (BinTree a)
</span><a href="#local-6989586621679187734"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Spec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#satisfies"><span class="hs-operator hs-var">`satisfies`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn (BinTree a, a, BinTree a)
</span><a href="#local-6989586621679187746"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) t.
HasGenHint fn t =&gt;
Hint t -&gt; Term fn t -&gt; Pred fn
</span><a href="Constrained.Base.html#genHint"><span class="hs-identifier hs-var">genHint</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679187744"><span class="hs-identifier hs-var">sz'</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (BinTree a)
</span><a href="#local-6989586621679187734"><span class="hs-identifier hs-var">left</span></a></span><span>
</span><span id="line-77"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall t a (fn :: [*] -&gt; * -&gt; *) p.
(Forallable t a, HasSpec fn t, HasSpec fn a, IsPred p fn) =&gt;
Term fn t -&gt; (Term fn a -&gt; p) -&gt; Pred fn
</span><a href="Constrained.Base.html#forAll"><span class="hs-identifier hs-var">forAll</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (BinTree a)
</span><a href="#local-6989586621679187733"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Spec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#satisfies"><span class="hs-operator hs-var">`satisfies`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn (BinTree a, a, BinTree a)
</span><a href="#local-6989586621679187746"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) t.
HasGenHint fn t =&gt;
Hint t -&gt; Term fn t -&gt; Pred fn
</span><a href="Constrained.Base.html#genHint"><span class="hs-identifier hs-var">genHint</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679187744"><span class="hs-identifier hs-var">sz'</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (BinTree a)
</span><a href="#local-6989586621679187733"><span class="hs-identifier hs-var">right</span></a></span><span>
</span><span id="line-79"></span><span>                      </span><span class="hs-special">]</span><span>
</span><span id="line-80"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term fn (BinTree a, a, BinTree a)
</span><a href="#local-6989586621679187736"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Spec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#satisfies"><span class="hs-operator hs-var">`satisfies`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn (BinTree a, a, BinTree a)
</span><a href="#local-6989586621679187746"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-81"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-82"></span><span>              </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. BinTree a -&gt; a -&gt; BinTree a -&gt; BinTree a
</span><a href="Constrained.Spec.Tree.html#BinNode"><span class="hs-identifier hs-var">BinNode</span></a></span><span> </span><span class="annot"><span class="annottext">BinTree a
</span><a href="#local-6989586621679187741"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679187740"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">BinTree a
</span><a href="#local-6989586621679187739"><span class="hs-identifier hs-var">right</span></a></span><span>
</span><span id="line-83"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. BinTree a
</span><a href="Constrained.Spec.Tree.html#BinTip"><span class="hs-identifier hs-var">BinTip</span></a></span><span>
</span><span id="line-84"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span>  </span><span id="local-6989586621679187718"><span class="annot"><span class="annottext">toPreds :: Term fn (BinTree a) -&gt; TypeSpec fn (BinTree a) -&gt; Pred fn
</span><a href="Constrained.Base.html#toPreds"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPreds</span></a></span></span><span> </span><span id="local-6989586621679187716"><span class="annot"><span class="annottext">Term fn (BinTree a)
</span><a href="#local-6989586621679187716"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#BinTreeSpec"><span class="hs-identifier hs-type">BinTreeSpec</span></a></span><span> </span><span id="local-6989586621679187715"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679187715"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span id="local-6989586621679187714"><span class="annot"><span class="annottext">Spec fn (BinTree a, a, BinTree a)
</span><a href="#local-6989586621679187714"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t a (fn :: [*] -&gt; * -&gt; *) p.
(Forallable t a, HasSpec fn t, HasSpec fn a, IsPred p fn) =&gt;
Term fn t -&gt; (Term fn a -&gt; p) -&gt; Pred fn
</span><a href="Constrained.Base.html#forAll"><span class="hs-identifier hs-var">forAll</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (BinTree a)
</span><a href="#local-6989586621679187716"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679187713"><span class="annot"><span class="annottext">Term fn (BinTree a, a, BinTree a)
</span><a href="#local-6989586621679187713"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term fn (BinTree a, a, BinTree a)
</span><a href="#local-6989586621679187713"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Spec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#satisfies"><span class="hs-operator hs-var">`satisfies`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn (BinTree a, a, BinTree a)
</span><a href="#local-6989586621679187714"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) t.
HasGenHint fn t =&gt;
Hint t -&gt; Term fn t -&gt; Pred fn
</span><a href="Constrained.Base.html#genHint"><span class="hs-identifier hs-var">genHint</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679187715"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (BinTree a)
</span><a href="#local-6989586621679187716"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679188297"><span id="local-6989586621679188298"><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188298"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188297"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasGenHint"><span class="hs-identifier hs-type">HasGenHint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188298"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#BinTree"><span class="hs-identifier hs-type">BinTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188297"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Hint"><span class="annot"><a href="Constrained.Base.html#Hint"><span class="hs-identifier hs-var">Hint</span></a></span></span><span> </span><span id="local-6989586621679188297"><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#BinTree"><span class="hs-identifier hs-type">BinTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188297"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-92"></span><span>  </span><span id="local-6989586621679187703"><span class="annot"><span class="annottext">giveHint :: Hint (BinTree a) -&gt; Spec fn (BinTree a)
</span><a href="Constrained.Base.html#giveHint"><span class="hs-identifier hs-var hs-var hs-var hs-var">giveHint</span></a></span></span><span> </span><span id="local-6989586621679187701"><span class="annot"><span class="annottext">Hint (BinTree a)
</span><a href="#local-6989586621679187701"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Int -&gt; Spec fn (BinTree a, a, BinTree a) -&gt; BinTreeSpec fn a
</span><a href="Constrained.Spec.Tree.html#BinTreeSpec"><span class="hs-identifier hs-var">BinTreeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Hint (BinTree a)
</span><a href="#local-6989586621679187701"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- HasSpec for RoseTree</span><span>
</span><span id="line-96"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-keyword">data</span><span> </span><span id="RoseTreeSpec"><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTreeSpec"><span class="hs-identifier hs-var">RoseTreeSpec</span></a></span></span><span> </span><span id="local-6989586621679188266"><span class="annot"><a href="#local-6989586621679188266"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679188265"><span class="annot"><a href="#local-6989586621679188265"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RoseTreeSpec"><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTreeSpec"><span class="hs-identifier hs-var">RoseTreeSpec</span></a></span></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="roseTreeAvgLength"><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. RoseTreeSpec fn a -&gt; Maybe Int
</span><a href="Constrained.Spec.Tree.html#roseTreeAvgLength"><span class="hs-identifier hs-var hs-var">roseTreeAvgLength</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="roseTreeMaxSize"><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. RoseTreeSpec fn a -&gt; Int
</span><a href="Constrained.Spec.Tree.html#roseTreeMaxSize"><span class="hs-identifier hs-var hs-var">roseTreeMaxSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="roseTreeRootSpec"><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. RoseTreeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Spec.Tree.html#roseTreeRootSpec"><span class="hs-identifier hs-var hs-var">roseTreeRootSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188266"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188265"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="roseTreeCtxSpec"><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
RoseTreeSpec fn a -&gt; Spec fn (a, [RoseTree a])
</span><a href="Constrained.Spec.Tree.html#roseTreeCtxSpec"><span class="hs-identifier hs-var hs-var">roseTreeCtxSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188266"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188265"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTree"><span class="hs-identifier hs-type">RoseTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188265"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span id="local-6989586621679187682"><span id="local-6989586621679187684"><span id="local-6989586621679187694"><span id="local-6989586621679188247"><span id="local-6989586621679188248"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188248"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188247"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Univ.html#Member"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTreeFn"><span class="hs-identifier hs-type">RoseTreeFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188248"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679188248"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTreeSpec"><span class="hs-identifier hs-type">RoseTreeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188248"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188247"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679188245"><span class="annot"><a href="Constrained.Base.html#Forallable"><span class="hs-identifier hs-type">Forallable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTree"><span class="hs-identifier hs-type">RoseTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188245"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188245"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTree"><span class="hs-identifier hs-type">RoseTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188245"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-108"></span><span>  </span><span id="local-6989586621679187670"><span class="annot"><span class="annottext">forAllSpec :: forall (fn :: [*] -&gt; * -&gt; *).
(HasSpec fn (RoseTree a), HasSpec fn (a, [RoseTree a]),
 BaseUniverse fn) =&gt;
Spec fn (a, [RoseTree a]) -&gt; Spec fn (RoseTree a)
</span><a href="#local-6989586621679187670"><span class="hs-identifier hs-var hs-var hs-var hs-var">forAllSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn (RoseTree a) =&gt;
RoseTreeSpec fn a -&gt; Spec fn (RoseTree a)
</span><a href="Constrained.Spec.Tree.html#guardRoseSpec"><span class="hs-identifier hs-var">guardRoseSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Maybe Int
-&gt; Int
-&gt; Spec fn a
-&gt; Spec fn (a, [RoseTree a])
-&gt; RoseTreeSpec fn a
</span><a href="Constrained.Spec.Tree.html#RoseTreeSpec"><span class="hs-identifier hs-var">RoseTreeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8000</span></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span>
</span><span id="line-109"></span><span>  </span><span id="local-6989586621679187666"><span class="annot"><span class="annottext">forAllToList :: RoseTree a -&gt; [(a, [RoseTree a])]
</span><a href="#local-6989586621679187666"><span class="hs-identifier hs-var hs-var hs-var hs-var">forAllToList</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseNode"><span class="hs-identifier hs-type">RoseNode</span></a></span><span> </span><span id="local-6989586621679187665"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679187665"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679187664"><span class="annot"><span class="annottext">[RoseTree a]
</span><a href="#local-6989586621679187664"><span class="hs-identifier hs-var">children</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679187665"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[RoseTree a]
</span><a href="#local-6989586621679187664"><span class="hs-identifier hs-var">children</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall t e. Forallable t e =&gt; t -&gt; [e]
</span><a href="Constrained.Base.html#forAllToList"><span class="hs-identifier hs-var">forAllToList</span></a></span><span> </span><span class="annot"><span class="annottext">[RoseTree a]
</span><a href="#local-6989586621679187664"><span class="hs-identifier hs-var">children</span></a></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span id="local-6989586621679188237"><span id="local-6989586621679188238"><span class="annot"><a href="Constrained.Spec.Tree.html#isErrorLike"><span class="hs-identifier hs-type">isErrorLike</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188238"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188237"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span><span>
</span><span id="line-112"></span><span id="isErrorLike"><span class="annot"><span class="annottext">isErrorLike :: forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a -&gt; Bool
</span><a href="Constrained.Spec.Tree.html#isErrorLike"><span class="hs-identifier hs-var hs-var">isErrorLike</span></a></span></span><span> </span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-113"></span><span class="annot"><a href="Constrained.Spec.Tree.html#isErrorLike"><span class="hs-identifier hs-var">isErrorLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-114"></span><span class="annot"><a href="Constrained.Spec.Tree.html#isErrorLike"><span class="hs-identifier hs-var">isErrorLike</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">-- TODO: get rid of this when we implement `cardinality`</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- in `HasSpec`</span><span>
</span><span id="line-118"></span><span id="local-6989586621679188242"><span id="local-6989586621679188243"><span class="annot"><a href="Constrained.Spec.Tree.html#guardRoseSpec"><span class="hs-identifier hs-type">guardRoseSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188243"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTree"><span class="hs-identifier hs-type">RoseTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188242"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTreeSpec"><span class="hs-identifier hs-type">RoseTreeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188243"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188242"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188243"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTree"><span class="hs-identifier hs-type">RoseTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188242"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-119"></span><span id="guardRoseSpec"><span class="annot"><span class="annottext">guardRoseSpec :: forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn (RoseTree a) =&gt;
RoseTreeSpec fn a -&gt; Spec fn (RoseTree a)
</span><a href="Constrained.Spec.Tree.html#guardRoseSpec"><span class="hs-identifier hs-var hs-var">guardRoseSpec</span></a></span></span><span> </span><span id="local-6989586621679187657"><span class="annot"><span class="annottext">spec :: RoseTreeSpec fn a
</span><a href="#local-6989586621679187657"><span class="hs-identifier hs-var">spec</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTreeSpec"><span class="hs-identifier hs-type">RoseTreeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679187656"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679187656"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span id="local-6989586621679187655"><span class="annot"><span class="annottext">Spec fn (a, [RoseTree a])
</span><a href="#local-6989586621679187655"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a -&gt; Bool
</span><a href="Constrained.Spec.Tree.html#isErrorLike"><span class="hs-identifier hs-var">isErrorLike</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679187656"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;guardRoseSpec: rootSpec is error&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a -&gt; Bool
</span><a href="Constrained.Spec.Tree.html#isErrorLike"><span class="hs-identifier hs-var">isErrorLike</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn (a, [RoseTree a])
</span><a href="#local-6989586621679187655"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;guardRoseSpec: ctxSpec is error&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">RoseTreeSpec fn a
</span><a href="#local-6989586621679187657"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679187635"><span id="local-6989586621679188249"><span id="local-6989586621679188250"><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188250"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188249"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Univ.html#Member"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTreeFn"><span class="hs-identifier hs-type">RoseTreeFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188250"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679188250"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188250"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTree"><span class="hs-identifier hs-type">RoseTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188249"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="TypeSpec"><span class="annot"><a href="Constrained.Base.html#TypeSpec"><span class="hs-identifier hs-var">TypeSpec</span></a></span></span><span> </span><span id="local-6989586621679188249"><span id="local-6989586621679188250"><span class="annot"><a href="#local-6989586621679188250"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTree"><span class="hs-identifier hs-type">RoseTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188249"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTreeSpec"><span class="hs-identifier hs-type">RoseTreeSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188250"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188249"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span>  </span><span id="local-6989586621679187634"><span class="annot"><span class="annottext">emptySpec :: TypeSpec fn (RoseTree a)
</span><a href="#local-6989586621679187634"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptySpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Maybe Int
-&gt; Int
-&gt; Spec fn a
-&gt; Spec fn (a, [RoseTree a])
-&gt; RoseTreeSpec fn a
</span><a href="Constrained.Spec.Tree.html#RoseTreeSpec"><span class="hs-identifier hs-var">RoseTreeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8000</span></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span>  </span><span id="local-6989586621679187623"><span class="annot"><span class="annottext">combineSpec :: TypeSpec fn (RoseTree a)
-&gt; TypeSpec fn (RoseTree a) -&gt; Spec fn (RoseTree a)
</span><a href="#local-6989586621679187623"><span class="hs-identifier hs-var hs-var hs-var hs-var">combineSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTreeSpec"><span class="hs-identifier hs-type">RoseTreeSpec</span></a></span><span> </span><span id="local-6989586621679187622"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679187622"><span class="hs-identifier hs-var">mal</span></a></span></span><span> </span><span id="local-6989586621679187621"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679187621"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span id="local-6989586621679187620"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679187620"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span id="local-6989586621679187619"><span class="annot"><span class="annottext">Spec fn (a, [RoseTree a])
</span><a href="#local-6989586621679187619"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTreeSpec"><span class="hs-identifier hs-type">RoseTreeSpec</span></a></span><span> </span><span id="local-6989586621679187618"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679187618"><span class="hs-identifier hs-var">mal'</span></a></span></span><span> </span><span id="local-6989586621679187617"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679187617"><span class="hs-identifier hs-var">sz'</span></a></span></span><span> </span><span id="local-6989586621679187616"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679187616"><span class="hs-identifier hs-var">rs'</span></a></span></span><span> </span><span id="local-6989586621679187615"><span class="annot"><span class="annottext">Spec fn (a, [RoseTree a])
</span><a href="#local-6989586621679187615"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a -&gt; Bool
</span><a href="Constrained.Spec.Tree.html#isErrorLike"><span class="hs-identifier hs-var">isErrorLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
Spec fn a -&gt; Spec fn b -&gt; PairSpec fn a b
</span><a href="Constrained.Spec.Pairs.html#Cartesian"><span class="hs-identifier hs-var">Cartesian</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679187613"><span class="hs-identifier hs-var">rs''</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn (a, [RoseTree a])
</span><a href="#local-6989586621679187612"><span class="hs-identifier hs-var">s''</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-132"></span><span>        </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn (RoseTree a) =&gt;
RoseTreeSpec fn a -&gt; Spec fn (RoseTree a)
</span><a href="Constrained.Spec.Tree.html#guardRoseSpec"><span class="hs-identifier hs-var">guardRoseSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-133"></span><span>          </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Maybe Int
-&gt; Int
-&gt; Spec fn a
-&gt; Spec fn (a, [RoseTree a])
-&gt; RoseTreeSpec fn a
</span><a href="Constrained.Spec.Tree.html#RoseTreeSpec"><span class="hs-identifier hs-var">RoseTreeSpec</span></a></span><span>
</span><span id="line-134"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; a) -&gt; Maybe a -&gt; Maybe a -&gt; Maybe a
</span><a href="Constrained.Core.html#unionWithMaybe"><span class="hs-identifier hs-var">unionWithMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">max</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679187622"><span class="hs-identifier hs-var">mal</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679187618"><span class="hs-identifier hs-var">mal'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">min</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679187621"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679187617"><span class="hs-identifier hs-var">sz'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>            </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679187613"><span class="hs-identifier hs-var">rs''</span></a></span><span>
</span><span id="line-137"></span><span>            </span><span class="annot"><span class="annottext">Spec fn (a, [RoseTree a])
</span><a href="#local-6989586621679187612"><span class="hs-identifier hs-var">s''</span></a></span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-139"></span><span>      </span><span id="local-6989586621679187613"><span class="annot"><span class="annottext">rs'' :: Spec fn a
</span><a href="#local-6989586621679187613"><span class="hs-identifier hs-var hs-var">rs''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679187620"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679187616"><span class="hs-identifier hs-var">rs'</span></a></span><span>
</span><span id="line-140"></span><span>      </span><span id="local-6989586621679187612"><span class="annot"><span class="annottext">s'' :: Spec fn (a, [RoseTree a])
</span><a href="#local-6989586621679187612"><span class="hs-identifier hs-var hs-var">s''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Spec fn (a, [RoseTree a])
</span><a href="#local-6989586621679187619"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn (a, [RoseTree a])
</span><a href="#local-6989586621679187615"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span>  </span><span id="local-6989586621679187599"><span class="annot"><span class="annottext">conformsTo :: HasCallStack =&gt; RoseTree a -&gt; TypeSpec fn (RoseTree a) -&gt; Bool
</span><a href="#local-6989586621679187599"><span class="hs-identifier hs-var hs-var hs-var hs-var">conformsTo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseNode"><span class="hs-identifier hs-type">RoseNode</span></a></span><span> </span><span id="local-6989586621679187598"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679187598"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679187597"><span class="annot"><span class="annottext">[RoseTree a]
</span><a href="#local-6989586621679187597"><span class="hs-identifier hs-var">children</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679187596"><span class="annot"><span class="annottext">spec :: TypeSpec fn (RoseTree a)
</span><a href="#local-6989586621679187596"><span class="hs-identifier hs-var">spec</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTreeSpec"><span class="hs-identifier hs-type">RoseTreeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679187595"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679187595"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span id="local-6989586621679187594"><span class="annot"><span class="annottext">Spec fn (a, [RoseTree a])
</span><a href="#local-6989586621679187594"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">and</span></a></span><span>
</span><span id="line-144"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679187598"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[RoseTree a]
</span><a href="#local-6989586621679187597"><span class="hs-identifier hs-var">children</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-operator hs-var">`conformsToSpec`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn (a, [RoseTree a])
</span><a href="#local-6989586621679187594"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-145"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(HasSpec fn a, HasCallStack) =&gt;
a -&gt; TypeSpec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsTo"><span class="hs-operator hs-var">`conformsTo`</span></a></span><span> </span><span class="annot"><span class="annottext">TypeSpec fn (RoseTree a)
</span><a href="#local-6989586621679187596"><span class="hs-identifier hs-var">spec</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[RoseTree a]
</span><a href="#local-6989586621679187597"><span class="hs-identifier hs-var">children</span></a></span><span>
</span><span id="line-146"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679187598"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
a -&gt; Spec fn a -&gt; Bool
</span><a href="Constrained.Base.html#conformsToSpec"><span class="hs-operator hs-var">`conformsToSpec`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679187595"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-147"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span>  </span><span id="local-6989586621679187529"><span class="annot"><span class="annottext">genFromTypeSpec :: forall (m :: * -&gt; *).
(HasCallStack, MonadGenError m) =&gt;
TypeSpec fn (RoseTree a) -&gt; GenT m (RoseTree a)
</span><a href="#local-6989586621679187529"><span class="hs-identifier hs-var hs-var hs-var hs-var">genFromTypeSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTreeSpec"><span class="hs-identifier hs-type">RoseTreeSpec</span></a></span><span> </span><span id="local-6989586621679187528"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679187528"><span class="hs-identifier hs-var">mal</span></a></span></span><span> </span><span id="local-6989586621679187527"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679187527"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span id="local-6989586621679187526"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679187526"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span id="local-6989586621679187525"><span class="annot"><span class="annottext">Spec fn (a, [RoseTree a])
</span><a href="#local-6989586621679187525"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679187524"><span class="annot"><span class="annottext">sz' :: Int
</span><a href="#local-6989586621679187524"><span class="hs-identifier hs-var hs-var">sz'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679187527"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679187527"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`div`</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679187528"><span class="hs-identifier hs-var">mal</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [RoseTree a] -&gt; RoseTree a
</span><a href="Constrained.Spec.Tree.html#RoseNode"><span class="hs-identifier hs-var">RoseNode</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-152"></span><span>      </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a (m :: * -&gt; *).
(HasCallStack, HasSpec fn a, MonadGenError m) =&gt;
Spec fn a -&gt; GenT m a
</span><a href="Constrained.Base.html#genFromSpec"><span class="hs-identifier hs-var">genFromSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679188250"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188249"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTree"><span class="hs-identifier hs-type">RoseTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188249"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-153"></span><span>        </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) p.
(IsPred p fn, HasSpec fn a) =&gt;
(Term fn a -&gt; p) -&gt; Spec fn a
</span><a href="Constrained.Base.html#constrained"><span class="hs-identifier hs-var">constrained</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679187521"><span class="annot"><span class="annottext">Term fn (a, [RoseTree a])
</span><a href="#local-6989586621679187521"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-154"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall t a (fn :: [*] -&gt; * -&gt; *) p.
(Forallable t a, HasSpec fn t, HasSpec fn a, IsPred p fn) =&gt;
Term fn t -&gt; (Term fn a -&gt; p) -&gt; Pred fn
</span><a href="Constrained.Base.html#forAll"><span class="hs-identifier hs-var">forAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
(HasSpec fn a, HasSpec fn b) =&gt;
Term fn (a, b) -&gt; Term fn b
</span><a href="Constrained.Spec.Generics.html#snd_"><span class="hs-identifier hs-var">snd_</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (a, [RoseTree a])
</span><a href="#local-6989586621679187521"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679187519"><span class="annot"><span class="annottext">Term fn (RoseTree a)
</span><a href="#local-6989586621679187519"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-155"></span><span>              </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall t a (fn :: [*] -&gt; * -&gt; *) p.
(Forallable t a, HasSpec fn t, HasSpec fn a, IsPred p fn) =&gt;
Term fn t -&gt; (Term fn a -&gt; p) -&gt; Pred fn
</span><a href="Constrained.Base.html#forAll"><span class="hs-identifier hs-var">forAll</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (RoseTree a)
</span><a href="#local-6989586621679187519"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Spec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#satisfies"><span class="hs-operator hs-var">`satisfies`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn (a, [RoseTree a])
</span><a href="#local-6989586621679187525"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) t.
HasGenHint fn t =&gt;
Hint t -&gt; Term fn t -&gt; Pred fn
</span><a href="Constrained.Base.html#genHint"><span class="hs-identifier hs-var">genHint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679187528"><span class="hs-identifier hs-var">mal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679187524"><span class="hs-identifier hs-var">sz'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term fn (RoseTree a)
</span><a href="#local-6989586621679187519"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-157"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-158"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) p.
(BaseUniverse fn, IsPred p fn) =&gt;
p -&gt; Pred fn
</span><a href="Constrained.Base.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
HasSpec fn [a] =&gt;
Term fn [a] -&gt; Term fn Int
</span><a href="Constrained.Base.html#length_"><span class="hs-identifier hs-var">length_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
(HasSpec fn a, HasSpec fn b) =&gt;
Term fn (a, b) -&gt; Term fn b
</span><a href="Constrained.Spec.Generics.html#snd_"><span class="hs-identifier hs-var">snd_</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (a, [RoseTree a])
</span><a href="#local-6989586621679187521"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *).
(Ord a, OrdLike fn a) =&gt;
Term fn a -&gt; Term fn a -&gt; Term fn Bool
</span><a href="Constrained.Base.html#%3C%3D."><span class="hs-operator hs-var">&lt;=.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#lit"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679187527"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-159"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a b.
(HasSpec fn a, HasSpec fn b) =&gt;
Term fn (a, b) -&gt; Term fn a
</span><a href="Constrained.Spec.Generics.html#fst_"><span class="hs-identifier hs-var">fst_</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (a, [RoseTree a])
</span><a href="#local-6989586621679187521"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Spec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#satisfies"><span class="hs-operator hs-var">`satisfies`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679187526"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-160"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term fn (a, [RoseTree a])
</span><a href="#local-6989586621679187521"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Spec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#satisfies"><span class="hs-operator hs-var">`satisfies`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn (a, [RoseTree a])
</span><a href="#local-6989586621679187525"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-161"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span>  </span><span id="local-6989586621679187498"><span class="annot"><span class="annottext">toPreds :: Term fn (RoseTree a) -&gt; TypeSpec fn (RoseTree a) -&gt; Pred fn
</span><a href="#local-6989586621679187498"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPreds</span></a></span></span><span> </span><span id="local-6989586621679187497"><span class="annot"><span class="annottext">Term fn (RoseTree a)
</span><a href="#local-6989586621679187497"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTreeSpec"><span class="hs-identifier hs-type">RoseTreeSpec</span></a></span><span> </span><span id="local-6989586621679187496"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679187496"><span class="hs-identifier hs-var">mal</span></a></span></span><span> </span><span id="local-6989586621679187495"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679187495"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span id="local-6989586621679187494"><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679187494"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span id="local-6989586621679187493"><span class="annot"><span class="annottext">Spec fn (a, [RoseTree a])
</span><a href="#local-6989586621679187493"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t a (fn :: [*] -&gt; * -&gt; *) p.
(Forallable t a, HasSpec fn t, HasSpec fn a, IsPred p fn) =&gt;
Term fn t -&gt; (Term fn a -&gt; p) -&gt; Pred fn
</span><a href="Constrained.Base.html#forAll"><span class="hs-identifier hs-var">forAll</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (RoseTree a)
</span><a href="#local-6989586621679187497"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679187492"><span class="annot"><span class="annottext">Term fn (a, [RoseTree a])
</span><a href="#local-6989586621679187492"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term fn (a, [RoseTree a])
</span><a href="#local-6989586621679187492"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Spec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#satisfies"><span class="hs-operator hs-var">`satisfies`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn (a, [RoseTree a])
</span><a href="#local-6989586621679187493"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
(Member (RoseTreeFn fn) fn, HasSpec fn a) =&gt;
Term fn (RoseTree a) -&gt; Term fn a
</span><a href="Constrained.Spec.Tree.html#roseRoot_"><span class="hs-identifier hs-var">roseRoot_</span></a></span><span> </span><span class="annot"><span class="annottext">Term fn (RoseTree a)
</span><a href="#local-6989586621679187497"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Term fn a -&gt; Spec fn a -&gt; Pred fn
</span><a href="Constrained.Base.html#satisfies"><span class="hs-operator hs-var">`satisfies`</span></a></span><span> </span><span class="annot"><span class="annottext">Spec fn a
</span><a href="#local-6989586621679187494"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-166"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) t.
HasGenHint fn t =&gt;
Hint t -&gt; Term fn t -&gt; Pred fn
</span><a href="Constrained.Base.html#genHint"><span class="hs-identifier hs-var">genHint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679187496"><span class="hs-identifier hs-var">mal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679187495"><span class="hs-identifier hs-var">sz</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term fn (RoseTree a)
</span><a href="#local-6989586621679187497"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679188209"><span id="local-6989586621679188210"><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#Member"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTreeFn"><span class="hs-identifier hs-type">RoseTreeFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188210"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679188210"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188210"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188209"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasGenHint"><span class="hs-identifier hs-type">HasGenHint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188210"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTree"><span class="hs-identifier hs-type">RoseTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188209"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Hint"><span class="annot"><a href="Constrained.Base.html#Hint"><span class="hs-identifier hs-var">Hint</span></a></span></span><span> </span><span id="local-6989586621679188209"><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTree"><span class="hs-identifier hs-type">RoseTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188209"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>  </span><span id="local-6989586621679187478"><span class="annot"><span class="annottext">giveHint :: Hint (RoseTree a) -&gt; Spec fn (RoseTree a)
</span><a href="#local-6989586621679187478"><span class="hs-identifier hs-var hs-var hs-var hs-var">giveHint</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679187477"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679187477"><span class="hs-identifier hs-var">avgLen</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679187476"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679187476"><span class="hs-identifier hs-var">sz</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Maybe Int
-&gt; Int
-&gt; Spec fn a
-&gt; Spec fn (a, [RoseTree a])
-&gt; RoseTreeSpec fn a
</span><a href="Constrained.Spec.Tree.html#RoseTreeSpec"><span class="hs-identifier hs-var">RoseTreeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679187477"><span class="hs-identifier hs-var">avgLen</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679187476"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-keyword">data</span><span> </span><span id="RoseTreeFn"><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTreeFn"><span class="hs-identifier hs-var">RoseTreeFn</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679187475"><span class="annot"><a href="#local-6989586621679187475"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679187474"><span class="annot"><a href="#local-6989586621679187474"><span class="hs-identifier hs-type">args</span></a></span></span><span> </span><span id="local-6989586621679187473"><span class="annot"><a href="#local-6989586621679187473"><span class="hs-identifier hs-type">res</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-173"></span><span>  </span><span id="local-6989586621679188091"><span id="local-6989586621679188092"><span id="RoseRoot"><span class="annot"><a href="Constrained.Spec.Tree.html#RoseRoot"><span class="hs-identifier hs-var">RoseRoot</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTreeFn"><span class="hs-identifier hs-type">RoseTreeFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188092"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTree"><span class="hs-identifier hs-type">RoseTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188091"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679188091"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span id="local-6989586621679187468"><span id="local-6989586621679187470"><span id="local-6989586621679188178"><span id="local-6989586621679188179"><span id="local-6989586621679188180"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTreeFn"><span class="hs-identifier hs-type">RoseTreeFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188180"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188179"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188178"><span class="hs-identifier hs-type">res</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-176"></span><span id="local-6989586621679187462"><span id="local-6989586621679187464"><span id="local-6989586621679187466"><span id="local-6989586621679188175"><span id="local-6989586621679188176"><span id="local-6989586621679188177"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTreeFn"><span class="hs-identifier hs-type">RoseTreeFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188177"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188176"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188175"><span class="hs-identifier hs-type">res</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679188169"><span class="annot"><a href="Constrained.Univ.html#FunctionLike"><span class="hs-identifier hs-type">FunctionLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTreeFn"><span class="hs-identifier hs-type">RoseTreeFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188169"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-179"></span><span>  </span><span id="local-6989586621679187458"><span class="annot"><span class="annottext">sem :: forall (as :: [*]) b. RoseTreeFn fn as b -&gt; FunTy as b
</span><a href="Constrained.Univ.html#sem"><span class="hs-identifier hs-var hs-var hs-var hs-var">sem</span></a></span></span><span> </span><span class="annot"><span class="annottext">RoseTreeFn fn as b
</span><a href="Constrained.Spec.Tree.html#RoseRoot"><span class="hs-identifier hs-var">RoseRoot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseNode"><span class="hs-identifier hs-type">RoseNode</span></a></span><span> </span><span id="local-6989586621679187455"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679187455"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">[RoseTree b]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679187455"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679187443"><span id="local-6989586621679188138"><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#Member"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTreeFn"><span class="hs-identifier hs-type">RoseTreeFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188138"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679188138"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#BaseUniverse"><span class="hs-identifier hs-type">BaseUniverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188138"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Constrained.Base.html#Functions"><span class="hs-identifier hs-type">Functions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTreeFn"><span class="hs-identifier hs-type">RoseTreeFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188138"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679188138"><span class="hs-identifier hs-type">fn</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-182"></span><span>  </span><span id="local-6989586621679187436"><span class="annot"><span class="annottext">propagateSpecFun :: forall (as :: [*]) a b.
(TypeList as, Typeable as, HasSpec fn a, All (HasSpec fn) as) =&gt;
RoseTreeFn fn as b
-&gt; ListCtx Value as (HOLE a) -&gt; Spec fn b -&gt; Spec fn a
</span><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var hs-var hs-var hs-var">propagateSpecFun</span></a></span></span><span> </span><span class="annot"><span class="annottext">RoseTreeFn fn as b
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var">propagateSpecFun</span></a></span><span> </span><span class="annot"><span class="annottext">RoseTreeFn fn as b
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-type">ErrorSpec</span></a></span><span> </span><span id="local-6989586621679187434"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679187434"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. [String] -&gt; Spec fn a
</span><a href="Constrained.Base.html#ErrorSpec"><span class="hs-identifier hs-var">ErrorSpec</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679187434"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-184"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var">propagateSpecFun</span></a></span><span> </span><span class="annot"><span class="annottext">RoseTreeFn fn as b
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-type">MemberSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). OrdSet a -&gt; Spec fn a
</span><a href="Constrained.Base.html#MemberSpec"><span class="hs-identifier hs-var">MemberSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-185"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#propagateSpecFun"><span class="hs-identifier hs-var">propagateSpecFun</span></a></span><span> </span><span id="local-6989586621679187433"><span class="annot"><span class="annottext">RoseTreeFn fn as b
</span><a href="#local-6989586621679187433"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679187432"><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679187432"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679187431"><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679187431"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">RoseTreeFn fn as b
</span><a href="#local-6989586621679187433"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-186"></span><span>    </span><span class="annot"><span class="annottext">RoseTreeFn fn as b
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-187"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.Base.html#SuspendedSpec"><span class="hs-identifier hs-type">SuspendedSpec</span></a></span><span> </span><span id="local-6989586621679187428"><span class="annot"><span class="annottext">Var b
</span><a href="#local-6989586621679187428"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679187427"><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679187427"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679187431"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-188"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.List.html#ListCtx"><span class="hs-identifier hs-type">ListCtx</span></a></span><span> </span><span id="local-6989586621679187422"><span class="annot"><span class="annottext">List Value as
</span><a href="#local-6989586621679187422"><span class="hs-identifier hs-var">pre</span></a></span></span><span> </span><span class="annot"><span class="annottext">HOLE a a
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span id="local-6989586621679187404"><span class="annot"><span class="annottext">List Value as'
</span><a href="#local-6989586621679187404"><span class="hs-identifier hs-var">suf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679187432"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-189"></span><span>          </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *) p.
(IsPred p fn, HasSpec fn a) =&gt;
(Term fn a -&gt; p) -&gt; Spec fn a
</span><a href="Constrained.Base.html#constrained"><span class="hs-identifier hs-var">constrained</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679187403"><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679187403"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-190"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679187402"><span class="annot"><span class="annottext">args :: List (Term fn) (Append as (a : as'))
</span><a href="#local-6989586621679187402"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {a} (f :: a -&gt; *) (as :: [a]) (bs :: [a]).
List f as -&gt; List f bs -&gt; List f (Append as bs)
</span><a href="Constrained.List.html#appendList"><span class="hs-identifier hs-var">appendList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (as :: [k]).
(forall (a :: k). f a -&gt; g a) -&gt; List f as -&gt; List g as
</span><a href="Constrained.List.html#mapList"><span class="hs-identifier hs-var">mapList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679187396"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679187396"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679187396"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List Value as
</span><a href="#local-6989586621679187422"><span class="hs-identifier hs-var">pre</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term fn a
</span><a href="#local-6989586621679187403"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (as :: k) (as :: [k]).
f as -&gt; List f as -&gt; List f (as : as)
</span><a href="Constrained.List.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (as :: [k]).
(forall (a :: k). f a -&gt; g a) -&gt; List f as -&gt; List g as
</span><a href="Constrained.List.html#mapList"><span class="hs-identifier hs-var">mapList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679187391"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679187391"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (fn :: [*] -&gt; * -&gt; *). Show a =&gt; a -&gt; Term fn a
</span><a href="Constrained.Base.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679187391"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List Value as'
</span><a href="#local-6989586621679187404"><span class="hs-identifier hs-var">suf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) as.
Term fn as -&gt; Binder fn as -&gt; Pred fn
</span><a href="Constrained.Base.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (as :: [*]) (fn :: [*] -&gt; * -&gt; *) b.
(Typeable as, TypeList as, All (HasSpec fn) as, HasSpec fn b,
 BaseUniverse fn) =&gt;
fn as b -&gt; List (Term fn) as -&gt; Term fn b
</span><a href="Constrained.Base.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="annot"><span class="annottext">RoseTreeFn fn as b
</span><a href="#local-6989586621679187433"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List (Term fn) (Append as (a : as'))
</span><a href="#local-6989586621679187402"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var b
</span><a href="#local-6989586621679187428"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
Var a -&gt; Pred fn -&gt; Binder fn a
</span><a href="Constrained.Base.html#%3A-%3E"><span class="hs-operator hs-var">:-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Pred fn
</span><a href="#local-6989586621679187427"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><span class="annottext">RoseTreeFn fn as b
</span><a href="Constrained.Spec.Tree.html#RoseRoot"><span class="hs-identifier hs-var">RoseRoot</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-193"></span><span>      </span><span class="hs-comment">-- No TypeAbstractions in ghc-8.10</span><span>
</span><span id="line-194"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">RoseTreeFn fn as b
</span><a href="#local-6989586621679187433"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-195"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679187383"><span class="annot"><span class="annottext">RoseTreeFn fn '[RoseTree b] b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTreeFn"><span class="hs-identifier hs-type">RoseTreeFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188138"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTree"><span class="hs-identifier hs-type">RoseTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679187383"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679187383"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.List.html#NilCtx"><span class="hs-identifier hs-type">NilCtx</span></a></span><span> </span><span class="annot"><span class="annottext">HOLE a (RoseTree b)
</span><a href="Constrained.Base.html#HOLE"><span class="hs-identifier hs-var">HOLE</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListCtx Value as (HOLE a)
</span><a href="#local-6989586621679187432"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
HasSpec fn a =&gt;
TypeSpec fn a -&gt; Spec fn a
</span><a href="Constrained.Base.html#typeSpec"><span class="hs-identifier hs-var">typeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a.
Maybe Int
-&gt; Int
-&gt; Spec fn a
-&gt; Spec fn (a, [RoseTree a])
-&gt; RoseTreeSpec fn a
</span><a href="Constrained.Spec.Tree.html#RoseTreeSpec"><span class="hs-identifier hs-var">RoseTreeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8000</span></span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679187431"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. Spec fn a
</span><a href="Constrained.Base.html#TrueSpec"><span class="hs-identifier hs-var">TrueSpec</span></a></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-comment">-- NOTE: this function over-approximates and returns a liberal spec.</span><span>
</span><span id="line-199"></span><span>  </span><span id="local-6989586621679187376"><span class="annot"><span class="annottext">mapTypeSpec :: forall a b.
(HasSpec fn a, HasSpec fn b) =&gt;
RoseTreeFn fn '[a] b -&gt; TypeSpec fn a -&gt; Spec fn b
</span><a href="Constrained.Base.html#mapTypeSpec"><span class="hs-identifier hs-var hs-var hs-var hs-var">mapTypeSpec</span></a></span></span><span> </span><span id="local-6989586621679187374"><span class="annot"><span class="annottext">RoseTreeFn fn '[a] b
</span><a href="#local-6989586621679187374"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679187373"><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679187373"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">RoseTreeFn fn '[a] b
</span><a href="#local-6989586621679187374"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><span class="annottext">RoseTreeFn fn '[a] b
</span><a href="Constrained.Spec.Tree.html#RoseRoot"><span class="hs-identifier hs-var">RoseRoot</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-201"></span><span>      </span><span class="hs-comment">-- No TypeAbstractions in ghc-8.10</span><span>
</span><span id="line-202"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">RoseTreeFn fn '[a] b
</span><a href="#local-6989586621679187374"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-203"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679187370"><span class="annot"><span class="annottext">RoseTreeFn fn '[RoseTree b] b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTreeFn"><span class="hs-identifier hs-type">RoseTreeFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188138"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTree"><span class="hs-identifier hs-type">RoseTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679187370"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679187370"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTreeSpec"><span class="hs-identifier hs-type">RoseTreeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679187369"><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679187369"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="annot"><span class="annottext">Spec fn (b, [RoseTree b])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TypeSpec fn a
</span><a href="#local-6989586621679187373"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Spec fn b
</span><a href="#local-6989586621679187369"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="annot"><a href="Constrained.Spec.Tree.html#roseRoot_"><span class="hs-identifier hs-type">roseRoot_</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679188186"><span class="annot"><a href="#local-6989586621679188186"><span class="hs-identifier hs-type">fn</span></a></span></span><span> </span><span id="local-6989586621679188185"><span class="annot"><a href="#local-6989586621679188185"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Univ.html#Member"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTreeFn"><span class="hs-identifier hs-type">RoseTreeFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188186"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679188186"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Constrained.Base.html#HasSpec"><span class="hs-identifier hs-type">HasSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188186"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188185"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-209"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188186"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Constrained.Spec.Tree.html#RoseTree"><span class="hs-identifier hs-type">RoseTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188185"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-210"></span><span>  </span><span class="annot"><a href="Constrained.Base.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188186"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188185"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-211"></span><span id="roseRoot_"><span class="annot"><span class="annottext">roseRoot_ :: forall (fn :: [*] -&gt; * -&gt; *) a.
(Member (RoseTreeFn fn) fn, HasSpec fn a) =&gt;
Term fn (RoseTree a) -&gt; Term fn a
</span><a href="Constrained.Spec.Tree.html#roseRoot_"><span class="hs-identifier hs-var hs-var">roseRoot_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) b (as :: [*]).
(HasSpec fn b, Typeable as, TypeList as, All (HasSpec fn) as) =&gt;
fn as b -&gt; FunTy (MapList (Term fn) as) (Term fn b)
</span><a href="Constrained.Base.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) (fnU :: [*] -&gt; * -&gt; *) (as :: [*]) b.
Member fn fnU =&gt;
fn as b -&gt; fnU as b
</span><a href="Constrained.Univ.html#injectFn"><span class="hs-identifier hs-var">injectFn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (fn :: [*] -&gt; * -&gt; *) a. RoseTreeFn fn '[RoseTree a] a
</span><a href="Constrained.Spec.Tree.html#RoseRoot"><span class="hs-identifier hs-var">RoseRoot</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679188186"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span></pre></body></html>